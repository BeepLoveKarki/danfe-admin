function _templateObject5(){var t=_taggedTemplateLiteral(["\n  query GetEmail($id: ID!) {\n    SubscriptionEmail(id: $id) {\n      ...SubscribedEmails\n    }\n  }\n  ","\n"]);return _templateObject5=function(){return t},t}function _templateObject4(){var t=_taggedTemplateLiteral(["\n    mutation CreateEmail($input: [EmailAddInput!]!) {\n        addSubscriptionEmail(input: $input) {\n            ...SubscribedEmails\n        }\n    }\n    ","\n"]);return _templateObject4=function(){return t},t}function _templateObject3(){var t=_taggedTemplateLiteral(["\n    mutation UpdateEmail($input: [EmailUpdateInput!]!) {\n        updateSubscriptionEmail(input: $input) {\n            ...SubscribedEmails\n        }\n    }\n    ","\n"]);return _templateObject3=function(){return t},t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(t);if(e){var r=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=_superPropBase(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _templateObject2(){var t=_taggedTemplateLiteral(["\n   mutation DeleteEmail($input:[ID!]!){\n      deleteSubscriptionEmail(id:$input){\n\t     ...SubscribedEmails \n\t  }\n   }\n   ","\n"]);return _templateObject2=function(){return t},t}function _templateObject(){var t=_taggedTemplateLiteral(["\n    query GetAllEmails($options: EmailListOptions){\n\t\tSubscriptionEmails(options: $options){\n\t\t\titems{\n\t\t\t...SubscribedEmails\n\t\t\t}\n\t\t\ttotalItems\n       }\n    }\n\t","\n"]);return _templateObject=function(){return t},t}function _taggedTemplateLiteral(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{UmAP:function(t,e,n){"use strict";n.r(e);var i=n("sEIs"),r=n("ixhn"),c=n("nIj0"),a=n("OxKu"),o=n("FOa3"),s=n("6Oco"),l=n("mWib"),u=n("kuMc"),d=n("TLy2"),m=n("7RXT"),b=n("H5qd"),p=n.n(b),f=n("JReq"),v=p.a(_templateObject(),f.a),h=p.a(_templateObject2(),f.a),y=n("EM62"),g=n("DEd4"),_=n("Kej3"),O=n("s2Ay"),E=n("2kYt");function P(t,e){if(1&t){var n=y.oc();y.nc(0,"a",5),y.vc("click",(function(){return y.Sc(n),y.xc().downloadcsv()})),y.ic(1,"clr-icon",6),y.bd(2),y.yc(3,"translate"),y.mc()}2&t&&(y.Vb(2),y.dd(" ",y.zc(3,1,"vdr-subscription-plugin.download-csv")," "))}var S=function(){return["./create"]};function k(t,e){1&t&&(y.nc(0,"a",7),y.ic(1,"clr-icon",8),y.bd(2),y.yc(3,"translate"),y.mc()),2&t&&(y.Ec("routerLink",y.Ic(4,S)),y.Vb(2),y.dd(" ",y.zc(3,2,"vdr-subscription-plugin.create-new-email")," "))}var j=function(t){return["/extensions","subscribedmails",t]};function w(t,e){if(1&t&&(y.nc(0,"td",11),y.ic(1,"vdr-table-row-action",12),y.yc(2,"translate"),y.mc()),2&t){var n=y.xc().item;y.Vb(1),y.Ec("label",y.zc(2,2,"common.edit"))("linkTo",y.Jc(4,j,n.id))}}function C(t,e){if(1&t){var n=y.oc();y.nc(0,"td",11),y.nc(1,"vdr-dropdown"),y.nc(2,"button",13),y.bd(3),y.yc(4,"translate"),y.ic(5,"clr-icon",14),y.mc(),y.nc(6,"vdr-dropdown-menu",15),y.nc(7,"button",16),y.vc("click",(function(){y.Sc(n);var t=y.xc().item;return y.xc().deleteEmail(t.id)})),y.ic(8,"clr-icon",17),y.bd(9),y.yc(10,"translate"),y.mc(),y.mc(),y.mc(),y.mc()}2&t&&(y.Vb(3),y.dd(" ",y.zc(4,2,"common.actions")," "),y.Vb(6),y.dd(" ",y.zc(10,4,"common.delete")," "))}function I(t,e){if(1&t&&(y.nc(0,"td",9),y.bd(1),y.mc(),y.nc(2,"td",9),y.bd(3),y.yc(4,"date"),y.mc(),y.nc(5,"td",9),y.bd(6),y.yc(7,"date"),y.mc(),y.Zc(8,w,3,6,"td",10),y.Zc(9,C,11,6,"td",10)),2&t){var n=e.item;y.Vb(1),y.cd(n.email),y.Vb(2),y.cd(y.Ac(4,5,n.createdAt,"longDate")),y.Vb(3),y.cd(y.Ac(7,8,n.updatedAt,"longDate")),y.Vb(2),y.Ec("vdrIfPermissions","UpdateSettings"),y.Vb(1),y.Ec("vdrIfPermissions","DeleteSettings")}}var V=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,r,a,s,l){var u,d;return _classCallCheck(this,n),(d=e.call(this,s,l)).dataService=t,d.modalService=i,d.notificationService=r,d.apollo=a,d.searchTerm=new c.f(""),_get((u=_assertThisInitialized(d),_getPrototypeOf(n.prototype)),"setQueryFn",u).call(u,(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d.dataService.query(v,e)}),(function(t){return t.SubscriptionEmails}),(function(t,e){return{options:{skip:t,take:e,filter:{email:{contains:d.searchTerm.value}},sort:{updatedAt:o.a.Desc}}}})),d}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.searchTerm.valueChanges.pipe(Object(l.a)(250),Object(u.a)(this.destroy$)).subscribe((function(){t.refresh()}))}},{key:"downloadcsv",value:function(){this.apollo.watchQuery({query:v,variables:[]}).valueChanges.subscribe((function(t){m.a.exportToCsv("danfe-subscribed-emails.csv",t.data.SubscriptionEmails.items)}))}},{key:"deleteEmail",value:function(t){var e=this,n=[t];this.modalService.dialog({title:Object(a.a)("vdr-subscription-plugin.confirm-delete-email"),buttons:[{type:"secondary",label:Object(a.a)("common.cancel")},{type:"danger",label:Object(a.a)("common.delete"),returnValue:!0}]}).pipe(Object(d.a)((function(t){return t?e.dataService.mutate(h,{input:n}):s.a}))).subscribe((function(){e.notificationService.success(Object(a.a)("common.notify-delete-success"),{entity:"Email"}),e.refresh()}),(function(t){e.notificationService.error(Object(a.a)("common.notify-delete-error"),{entity:"Email"})}))}}]),n}(r.w);V.\u0275fac=function(t){return new(t||V)(y.hc(r.K),y.hc(r.xb),y.hc(r.yb),y.hc(g.b),y.hc(i.e),y.hc(i.a))},V.\u0275cmp=y.bc({type:V,selectors:[["vdr-all-mails-list"]],features:[y.Sb],decls:25,vars:27,consts:[["type","text","name","searchTerm",1,"clr-input","search-input",3,"formControl","placeholder"],["locationId","email-list"],["href","javascript:void(0)","class","btn btn-primary","id","downloadbtn",3,"click",4,"vdrIfPermissions"],["class","btn btn-primary","id","createbtn",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],["href","javascript:void(0)","id","downloadbtn",1,"btn","btn-primary",3,"click"],["shape","download-cloud"],["id","createbtn",1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],["class","right align-middle",4,"vdrIfPermissions"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click"],["shape","trash",1,"is-danger"]],template:function(t,e){1&t&&(y.nc(0,"vdr-action-bar"),y.nc(1,"vdr-ab-left"),y.ic(2,"input",0),y.yc(3,"translate"),y.mc(),y.nc(4,"vdr-ab-right"),y.ic(5,"vdr-action-bar-items",1),y.Zc(6,P,4,3,"a",2),y.Zc(7,k,4,5,"a",3),y.mc(),y.mc(),y.nc(8,"vdr-data-table",4),y.vc("pageChange",(function(t){return e.setPageNumber(t)}))("itemsPerPageChange",(function(t){return e.setItemsPerPage(t)})),y.yc(9,"async"),y.yc(10,"async"),y.yc(11,"async"),y.yc(12,"async"),y.nc(13,"vdr-dt-column"),y.bd(14),y.yc(15,"translate"),y.mc(),y.nc(16,"vdr-dt-column"),y.bd(17),y.yc(18,"translate"),y.mc(),y.nc(19,"vdr-dt-column"),y.bd(20),y.yc(21,"translate"),y.mc(),y.ic(22,"vdr-dt-column"),y.ic(23,"vdr-dt-column"),y.Zc(24,I,10,11,"ng-template"),y.mc()),2&t&&(y.Vb(2),y.Ec("formControl",e.searchTerm)("placeholder",y.zc(3,11,"vdr-subscription-plugin.search-by-email")),y.Vb(4),y.Ec("vdrIfPermissions","CreateSettings"),y.Vb(1),y.Ec("vdrIfPermissions","CreateSettings"),y.Vb(1),y.Ec("items",y.zc(9,13,e.items$))("itemsPerPage",y.zc(10,15,e.itemsPerPage$))("totalItems",y.zc(11,17,e.totalItems$))("currentPage",y.zc(12,19,e.currentPage$)),y.Vb(6),y.cd(y.zc(15,21,"vdr-subscription-plugin.email")),y.Vb(3),y.cd(y.zc(18,23,"vdr-subscription-plugin.created")),y.Vb(3),y.cd(y.zc(21,25,"vdr-subscription-plugin.updated")))},directives:[r.c,r.e,r.db,c.b,c.p,c.g,r.f,r.d,r.ob,r.M,r.L,_.o,i.h,r.Lb,r.S,r.V,r.U,r.T],pipes:[O.d,E.b,E.f],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"],changeDetection:0});var x=n("ROBh"),T=n("xVbo"),z=n("7SLS"),D=p.a(_templateObject3(),f.a),F=p.a(_templateObject4(),f.a);function R(t,e){if(1&t){var n=y.oc();y.nc(0,"button",5),y.vc("click",(function(){return y.Sc(n),y.xc().create()})),y.bd(1),y.yc(2,"translate"),y.mc()}if(2&t){var i=y.xc();y.Ec("disabled",!(i.detailForm.valid&&i.detailForm.dirty)),y.Vb(1),y.dd(" ",y.zc(2,2,"common.create")," ")}}function $(t,e){if(1&t){var n=y.oc();y.nc(0,"button",6),y.vc("click",(function(){return y.Sc(n),y.xc().save()})),y.bd(1),y.yc(2,"translate"),y.mc()}if(2&t){var i=y.xc();y.Ec("disabled",!(i.detailForm.valid&&i.detailForm.dirty)),y.Vb(1),y.dd(" ",y.zc(2,2,"common.update")," ")}}var A=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,r,a,o,s,l){var u;return _classCallCheck(this,n),(u=e.call(this,t,i,r,o)).formBuilder=a,u.dataService=o,u.changeDetector=s,u.notificationService=l,u.which=!1,u.detailForm=u.formBuilder.group({email:["",c.C.required]}),u}return _createClass(n,[{key:"ngOnInit",value:function(){"/extensions/subscribedmails/create"!=this.router.url?(this.which=!1,this.init()):this.which=!0}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"create",value:function(){var t=this;this.addNew().pipe(Object(T.a)((function(t){return!!t}))).subscribe((function(){t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success("common.notify-create-success",{entity:"Email"})}),(function(){t.notificationService.error("common.notify-create-error",{entity:"Email"})}))}},{key:"save",value:function(){var t=this;this.saveChanges().pipe(Object(T.a)((function(t){return!!t}))).subscribe((function(){t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success("common.notify-update-success",{entity:"Email"})}),(function(){t.notificationService.error("common.notify-update-error",{entity:"Email"})}))}},{key:"addNew",value:function(){if(this.detailForm.dirty){var t=[{email:this.detailForm.value.email}];return this.dataService.mutate(F,{input:t}).pipe(Object(z.a)(!0))}return Object(x.a)(!1)}},{key:"saveChanges",value:function(){if(this.detailForm.dirty){var t=this.detailForm.value,e=[{id:this.id,email:t.email}];return this.dataService.mutate(D,{input:e}).pipe(Object(z.a)(!0))}return Object(x.a)(!1)}},{key:"setFormValues",value:function(t){this.detailForm.patchValue({email:t.email})}}]),n}(r.u);A.\u0275fac=function(t){return new(t||A)(y.hc(i.a),y.hc(i.e),y.hc(r.Gb),y.hc(c.e),y.hc(r.K),y.hc(y.k),y.hc(r.yb))},A.\u0275cmp=y.bc({type:A,selectors:[["vdr-subscription-mail-detail"]],features:[y.Sb],decls:9,vars:7,consts:[["class","btn btn-primary","id","custbtn",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","email",3,"label"],["id","email","type","email","formControlName","email",3,"readonly"],["id","custbtn",1,"btn","btn-primary",3,"disabled","click"],["id","editbtn",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(y.nc(0,"vdr-action-bar"),y.nc(1,"vdr-ab-right"),y.Zc(2,R,3,4,"button",0),y.Zc(3,$,3,4,"ng-template",null,1,y.ad),y.mc(),y.mc(),y.nc(5,"form",2),y.nc(6,"vdr-form-field",3),y.yc(7,"translate"),y.ic(8,"input",4),y.mc(),y.mc()),2&t){var n=y.Pc(4);y.Vb(2),y.Ec("ngIf",e.which)("ngIfElse",n),y.Vb(3),y.Ec("formGroup",e.detailForm),y.Vb(1),y.Ec("label",y.zc(7,5,"vdr-subscription-plugin.email-label")),y.Vb(2),y.Ec("readonly",!1)}},directives:[r.c,r.f,E.p,c.E,c.q,c.j,r.cb,r.db,c.b,c.p,c.h],pipes:[O.d],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]});var L=p.a(_templateObject5(),f.a),M=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i){return _classCallCheck(this,n),e.call(this,t,{__typename:"Email",id:"",email:"",createdAt:"",updatedAt:""},(function(t){return i.query(L,{id:t}).mapStream((function(t){return t.SubscriptionEmail}))}))}return n}(r.v);M.\u0275fac=function(t){return new(t||M)(y.rc(i.e),y.rc(r.K))},M.\u0275prov=y.dc({token:M,factory:M.\u0275fac});var q=n("YtkY");n.d(e,"MailSubscriptionUIModule",(function(){return B})),n.d(e,"mailDetailBreadcrumb",(function(){return Z}));var B=function t(){_classCallCheck(this,t)};function Z(t){return t.entity.pipe(Object(q.a)((function(t){return[{label:"Subscribed Mails",link:["/extensions","subscribedmails"]},{label:"".concat(t.email),link:[]}]})))}B.\u0275mod=y.fc({type:B}),B.\u0275inj=y.ec({factory:function(t){return new(t||B)},providers:[M],imports:[[r.Hb,i.i.forChild([{path:"",pathMatch:"full",component:V,data:{breadcrumb:"Subscribed Mails"}},{path:"create",component:A,data:{breadcrumb:[{label:"Subscribed Mails",link:["/extensions","subscribedmails"]},{label:"Create Email",link:[]}]}},{path:":id",component:A,resolve:Object(r.Rb)(M),data:{breadcrumb:Z}}])]]})}}]);