function _templateObject5(){var t=_taggedTemplateLiteral(["\n  query GetEmail($id: ID!) {\n    SubscriptionEmail(id: $id) {\n      ...SubscribedEmails\n    }\n  }\n  ","\n"]);return _templateObject5=function(){return t},t}function _templateObject4(){var t=_taggedTemplateLiteral(["\n    mutation CreateEmail($input: [EmailAddInput!]!) {\n        addSubscriptionEmail(input: $input) {\n            ...SubscribedEmails\n        }\n    }\n    ","\n"]);return _templateObject4=function(){return t},t}function _templateObject3(){var t=_taggedTemplateLiteral(["\n    mutation UpdateEmail($input: [EmailUpdateInput!]!) {\n        updateSubscriptionEmail(input: $input) {\n            ...SubscribedEmails\n        }\n    }\n    ","\n"]);return _templateObject3=function(){return t},t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _templateObject2(){var t=_taggedTemplateLiteral(["\n   mutation DeleteEmail($input:[ID!]!){\n      deleteSubscriptionEmail(id:$input){\n\t     ...SubscribedEmails \n\t  }\n   }\n   ","\n"]);return _templateObject2=function(){return t},t}function _templateObject(){var t=_taggedTemplateLiteral(["\n    query GetAllEmails($options: EmailListOptions){\n\t\tSubscriptionEmails(options: $options){\n\t\t\titems{\n\t\t\t...SubscribedEmails\n\t\t\t}\n\t\t\ttotalItems\n       }\n    }\n\t","\n"]);return _templateObject=function(){return t},t}function _taggedTemplateLiteral(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{UmAP:function(t,e,n){"use strict";n.r(e);var r=n("sEIs"),i=n("ixhn"),c=n("nIj0"),a=n("OxKu"),o=n("FOa3"),l=n("6Oco"),s=n("mWib"),u=n("kuMc"),d=n("TLy2"),m=n("7RXT"),p=n("H5qd"),b=n.n(p),f=n("JReq"),v=b.a(_templateObject(),f.a),h=b.a(_templateObject2(),f.a),y=n("EM62"),g=n("DEd4"),_=n("Kej3"),O=n("s2Ay"),w=n("2kYt");function P(t,e){if(1&t){var n=y.nc();y.mc(0,"a",5),y.uc("click",(function(){return y.Rc(n),y.wc().downloadcsv()})),y.hc(1,"clr-icon",6),y.ad(2),y.xc(3,"translate"),y.lc()}2&t&&(y.Ub(2),y.cd(" ",y.yc(3,1,"vdr-subscription-plugin.download-csv")," "))}var k=function(){return["./create"]};function j(t,e){1&t&&(y.mc(0,"a",7),y.hc(1,"clr-icon",8),y.ad(2),y.xc(3,"translate"),y.lc()),2&t&&(y.Dc("routerLink",y.Hc(4,k)),y.Ub(2),y.cd(" ",y.yc(3,2,"vdr-subscription-plugin.create-new-email")," "))}var S=function(t){return["/extensions","subscribedmails",t]};function C(t,e){if(1&t&&(y.mc(0,"td",11),y.hc(1,"vdr-table-row-action",12),y.xc(2,"translate"),y.lc()),2&t){var n=y.wc().item;y.Ub(1),y.Dc("label",y.yc(2,2,"common.edit"))("linkTo",y.Ic(4,S,n.id))}}function E(t,e){if(1&t){var n=y.nc();y.mc(0,"td",11),y.mc(1,"vdr-dropdown"),y.mc(2,"button",13),y.ad(3),y.xc(4,"translate"),y.hc(5,"clr-icon",14),y.lc(),y.mc(6,"vdr-dropdown-menu",15),y.mc(7,"button",16),y.uc("click",(function(){y.Rc(n);var t=y.wc().item;return y.wc().deleteEmail(t.id)})),y.hc(8,"clr-icon",17),y.ad(9),y.xc(10,"translate"),y.lc(),y.lc(),y.lc(),y.lc()}2&t&&(y.Ub(3),y.cd(" ",y.yc(4,2,"common.actions")," "),y.Ub(6),y.cd(" ",y.yc(10,4,"common.delete")," "))}function x(t,e){if(1&t&&(y.mc(0,"td",9),y.ad(1),y.lc(),y.mc(2,"td",9),y.ad(3),y.xc(4,"date"),y.lc(),y.mc(5,"td",9),y.ad(6),y.xc(7,"date"),y.lc(),y.Yc(8,C,3,6,"td",10),y.Yc(9,E,11,6,"td",10)),2&t){var n=e.item;y.Ub(1),y.bd(n.email),y.Ub(2),y.bd(y.zc(4,5,n.createdAt,"longDate")),y.Ub(3),y.bd(y.zc(7,8,n.updatedAt,"longDate")),y.Ub(2),y.Dc("vdrIfPermissions","UpdateSettings"),y.Ub(1),y.Dc("vdrIfPermissions","DeleteSettings")}}var D=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a,l,s){var u,d;return _classCallCheck(this,n),(d=e.call(this,l,s)).dataService=t,d.modalService=r,d.notificationService=i,d.apollo=a,d.searchTerm=new c.f(""),_get((u=_assertThisInitialized(d),_getPrototypeOf(n.prototype)),"setQueryFn",u).call(u,(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d.dataService.query(v,e)}),(function(t){return t.SubscriptionEmails}),(function(t,e){return{options:{skip:t,take:e,filter:{email:{contains:d.searchTerm.value}},sort:{updatedAt:o.a.Desc}}}})),d}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.searchTerm.valueChanges.pipe(Object(s.a)(250),Object(u.a)(this.destroy$)).subscribe((function(){t.refresh()}))}},{key:"downloadcsv",value:function(){this.apollo.watchQuery({query:v,variables:[]}).valueChanges.subscribe((function(t){m.a.exportToCsv("danfe-subscribed-emails.csv",t.data.SubscriptionEmails.items)}))}},{key:"deleteEmail",value:function(t){var e=this,n=[t];this.modalService.dialog({title:Object(a.a)("vdr-subscription-plugin.confirm-delete-email"),buttons:[{type:"secondary",label:Object(a.a)("common.cancel")},{type:"danger",label:Object(a.a)("common.delete"),returnValue:!0}]}).pipe(Object(d.a)((function(t){return t?e.dataService.mutate(h,{input:n}):l.a}))).subscribe((function(){e.notificationService.success(Object(a.a)("common.notify-delete-success"),{entity:"Email"}),e.refresh()}),(function(t){e.notificationService.error(Object(a.a)("common.notify-delete-error"),{entity:"Email"})}))}}]),n}(i.w);D.\u0275fac=function(t){return new(t||D)(y.gc(i.K),y.gc(i.xb),y.gc(i.yb),y.gc(g.b),y.gc(r.e),y.gc(r.a))},D.\u0275cmp=y.ac({type:D,selectors:[["vdr-all-mails-list"]],features:[y.Rb],decls:25,vars:27,consts:[["type","text","name","searchTerm",1,"clr-input","search-input",3,"formControl","placeholder"],["locationId","email-list"],["href","javascript:void(0)","class","btn btn-primary","id","downloadbtn",3,"click",4,"vdrIfPermissions"],["class","btn btn-primary","id","createbtn",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],["href","javascript:void(0)","id","downloadbtn",1,"btn","btn-primary",3,"click"],["shape","download-cloud"],["id","createbtn",1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],["class","right align-middle",4,"vdrIfPermissions"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click"],["shape","trash",1,"is-danger"]],template:function(t,e){1&t&&(y.mc(0,"vdr-action-bar"),y.mc(1,"vdr-ab-left"),y.hc(2,"input",0),y.xc(3,"translate"),y.lc(),y.mc(4,"vdr-ab-right"),y.hc(5,"vdr-action-bar-items",1),y.Yc(6,P,4,3,"a",2),y.Yc(7,j,4,5,"a",3),y.lc(),y.lc(),y.mc(8,"vdr-data-table",4),y.uc("pageChange",(function(t){return e.setPageNumber(t)}))("itemsPerPageChange",(function(t){return e.setItemsPerPage(t)})),y.xc(9,"async"),y.xc(10,"async"),y.xc(11,"async"),y.xc(12,"async"),y.mc(13,"vdr-dt-column"),y.ad(14),y.xc(15,"translate"),y.lc(),y.mc(16,"vdr-dt-column"),y.ad(17),y.xc(18,"translate"),y.lc(),y.mc(19,"vdr-dt-column"),y.ad(20),y.xc(21,"translate"),y.lc(),y.hc(22,"vdr-dt-column"),y.hc(23,"vdr-dt-column"),y.Yc(24,x,10,11,"ng-template"),y.lc()),2&t&&(y.Ub(2),y.Dc("formControl",e.searchTerm)("placeholder",y.yc(3,11,"vdr-subscription-plugin.search-by-email")),y.Ub(4),y.Dc("vdrIfPermissions","CreateSettings"),y.Ub(1),y.Dc("vdrIfPermissions","CreateSettings"),y.Ub(1),y.Dc("items",y.yc(9,13,e.items$))("itemsPerPage",y.yc(10,15,e.itemsPerPage$))("totalItems",y.yc(11,17,e.totalItems$))("currentPage",y.yc(12,19,e.currentPage$)),y.Ub(6),y.bd(y.yc(15,21,"vdr-subscription-plugin.email")),y.Ub(3),y.bd(y.yc(18,23,"vdr-subscription-plugin.created")),y.Ub(3),y.bd(y.yc(21,25,"vdr-subscription-plugin.updated")))},directives:[i.c,i.e,i.db,c.b,c.p,c.g,i.f,i.d,i.ob,i.M,i.L,_.o,r.h,i.Kb,i.S,i.V,i.U,i.T],pipes:[O.d,w.b,w.f],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"],changeDetection:0});var I=n("ROBh"),U=n("xVbo"),T=n("7SLS"),R=b.a(_templateObject3(),f.a),F=b.a(_templateObject4(),f.a);function $(t,e){if(1&t){var n=y.nc();y.mc(0,"button",5),y.uc("click",(function(){return y.Rc(n),y.wc().create()})),y.ad(1),y.xc(2,"translate"),y.lc()}if(2&t){var r=y.wc();y.Dc("disabled",!(r.detailForm.valid&&r.detailForm.dirty)),y.Ub(1),y.cd(" ",y.yc(2,2,"common.create")," ")}}function L(t,e){if(1&t){var n=y.nc();y.mc(0,"button",6),y.uc("click",(function(){return y.Rc(n),y.wc().save()})),y.ad(1),y.xc(2,"translate"),y.lc()}if(2&t){var r=y.wc();y.Dc("disabled",!(r.detailForm.valid&&r.detailForm.dirty)),y.Ub(1),y.cd(" ",y.yc(2,2,"common.update")," ")}}var A=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a,o,l,s){var u;return _classCallCheck(this,n),(u=e.call(this,t,r,i,o)).formBuilder=a,u.dataService=o,u.changeDetector=l,u.notificationService=s,u.which=!1,u.detailForm=u.formBuilder.group({email:["",c.C.required]}),u}return _createClass(n,[{key:"ngOnInit",value:function(){"/extensions/subscribedmails/create"!=this.router.url?(this.which=!1,this.init()):this.which=!0}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"create",value:function(){var t=this;this.addNew().pipe(Object(U.a)((function(t){return!!t}))).subscribe((function(){t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success("common.notify-create-success",{entity:"Email"})}),(function(){t.notificationService.error("common.notify-create-error",{entity:"Email"})}))}},{key:"save",value:function(){var t=this;this.saveChanges().pipe(Object(U.a)((function(t){return!!t}))).subscribe((function(){t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success("common.notify-update-success",{entity:"Email"})}),(function(){t.notificationService.error("common.notify-update-error",{entity:"Email"})}))}},{key:"addNew",value:function(){if(this.detailForm.dirty){var t=[{email:this.detailForm.value.email}];return this.dataService.mutate(F,{input:t}).pipe(Object(T.a)(!0))}return Object(I.a)(!1)}},{key:"saveChanges",value:function(){if(this.detailForm.dirty){var t=this.detailForm.value,e=[{id:this.id,email:t.email}];return this.dataService.mutate(R,{input:e}).pipe(Object(T.a)(!0))}return Object(I.a)(!1)}},{key:"setFormValues",value:function(t){this.detailForm.patchValue({email:t.email})}}]),n}(i.u);A.\u0275fac=function(t){return new(t||A)(y.gc(r.a),y.gc(r.e),y.gc(i.Fb),y.gc(c.e),y.gc(i.K),y.gc(y.k),y.gc(i.yb))},A.\u0275cmp=y.ac({type:A,selectors:[["vdr-subscription-mail-detail"]],features:[y.Rb],decls:9,vars:7,consts:[["class","btn btn-primary","id","custbtn",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","email",3,"label"],["id","email","type","email","formControlName","email",3,"readonly"],["id","custbtn",1,"btn","btn-primary",3,"disabled","click"],["id","editbtn",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(y.mc(0,"vdr-action-bar"),y.mc(1,"vdr-ab-right"),y.Yc(2,$,3,4,"button",0),y.Yc(3,L,3,4,"ng-template",null,1,y.Zc),y.lc(),y.lc(),y.mc(5,"form",2),y.mc(6,"vdr-form-field",3),y.xc(7,"translate"),y.hc(8,"input",4),y.lc(),y.lc()),2&t){var n=y.Oc(4);y.Ub(2),y.Dc("ngIf",e.which)("ngIfElse",n),y.Ub(3),y.Dc("formGroup",e.detailForm),y.Ub(1),y.Dc("label",y.yc(7,5,"vdr-subscription-plugin.email-label")),y.Ub(2),y.Dc("readonly",!1)}},directives:[i.c,i.f,w.p,c.E,c.q,c.j,i.cb,i.db,c.b,c.p,c.h],pipes:[O.d],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]});var q=b.a(_templateObject5(),f.a),M=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){return _classCallCheck(this,n),e.call(this,t,{__typename:"Email",id:"",email:"",createdAt:"",updatedAt:""},(function(t){return r.query(q,{id:t}).mapStream((function(t){return t.SubscriptionEmail}))}))}return n}(i.v);M.\u0275fac=function(t){return new(t||M)(y.qc(r.e),y.qc(i.K))},M.\u0275prov=y.cc({token:M,factory:M.\u0275fac});var Y=n("YtkY");n.d(e,"MailSubscriptionUIModule",(function(){return z})),n.d(e,"mailDetailBreadcrumb",(function(){return B}));var z=function t(){_classCallCheck(this,t)};function B(t){return t.entity.pipe(Object(Y.a)((function(t){return[{label:"Subscribed Mails",link:["/extensions","subscribedmails"]},{label:"".concat(t.email),link:[]}]})))}z.\u0275mod=y.ec({type:z}),z.\u0275inj=y.dc({factory:function(t){return new(t||z)},providers:[M],imports:[[i.Gb,r.i.forChild([{path:"",pathMatch:"full",component:D,data:{breadcrumb:"Subscribed Mails"}},{path:"create",component:A,data:{breadcrumb:[{label:"Subscribed Mails",link:["/extensions","subscribedmails"]},{label:"Create Email",link:[]}]}},{path:":id",component:A,resolve:Object(i.Qb)(M),data:{breadcrumb:B}}])]]})}}]);
//# sourceMappingURL=10-es5.63302604b35d682d67da.js.map