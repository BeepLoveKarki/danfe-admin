(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"2VDt":function(e,t,c){"use strict";c.r(t),c.d(t,"CancelOrderDialogComponent",(function(){return xt})),c.d(t,"FulfillOrderDialogComponent",(function(){return St})),c.d(t,"FulfillmentDetailComponent",(function(){return _t})),c.d(t,"LineFulfillmentComponent",(function(){return kt})),c.d(t,"LineRefundsComponent",(function(){return Tt})),c.d(t,"NODE_HEIGHT",(function(){return Vt})),c.d(t,"OrderCustomFieldsCardComponent",(function(){return Dt})),c.d(t,"OrderDetailComponent",(function(){return Lt})),c.d(t,"OrderHistoryComponent",(function(){return Et})),c.d(t,"OrderListComponent",(function(){return Bt})),c.d(t,"OrderModule",(function(){return nc})),c.d(t,"OrderPaymentCardComponent",(function(){return qt})),c.d(t,"OrderProcessEdgeComponent",(function(){return Ut})),c.d(t,"OrderProcessGraphComponent",(function(){return Kt})),c.d(t,"OrderProcessGraphDialogComponent",(function(){return Nt})),c.d(t,"OrderProcessNodeComponent",(function(){return Qt})),c.d(t,"OrderResolver",(function(){return Xt})),c.d(t,"PaymentDetailComponent",(function(){return Ht})),c.d(t,"PaymentStateLabelComponent",(function(){return Gt})),c.d(t,"RefundOrderDialogComponent",(function(){return $t})),c.d(t,"RefundStateLabelComponent",(function(){return Zt})),c.d(t,"SettleRefundDialogComponent",(function(){return Rt})),c.d(t,"SimpleItemListComponent",(function(){return Yt})),c.d(t,"orderBreadcrumb",(function(){return cc})),c.d(t,"orderRoutes",(function(){return tc})),c.d(t,"\u02750",(function(){return Jt})),c.d(t,"\u02751",(function(){return ec}));var n=c("D57K"),o=c("EM62"),i=c("OxKu"),r=c("ixhn"),d=c("nIj0"),a=c("sEIs"),l=c("yPeg"),s=c("ZTXN"),u=c("ROBh"),f=c("6Oco"),p=c("g6G6"),m=c("C05f"),b=c("jIqt"),g=c("TLy2"),h=c("YtkY"),y=c("J+dc"),O=c("mWib"),v=c("kuMc"),C=c("8j5Y"),F=c("2kYt"),W=c("Kej3"),j=c("jY47"),P=c("s2Ay"),M=c("E5oP");function I(e,t){1&e&&(o.cd(0),o.zc(1,"translate")),2&e&&o.dd(o.Ac(1,1,"order.cancel-order"))}function A(e,t){if(1&e){const e=o.pc();o.oc(0,"input",18),o.wc("ngModelChange",(function(t){o.Tc(e);const c=o.yc().$implicit;return o.yc().lineQuantities[c.id]=t})),o.nc()}if(2&e){const e=o.yc().$implicit,t=o.yc();o.Fc("ngModel",t.lineQuantities[e.id])("max",e.quantity)}}function w(e,t){if(1&e&&o.cd(0),2&e){const e=o.yc().$implicit;o.dd(e.quantity)}}function z(e,t){if(1&e&&(o.oc(0,"tr",9),o.oc(1,"td",10),o.jc(2,"img",11),o.zc(3,"assetPreview"),o.nc(),o.oc(4,"td",12),o.cd(5),o.nc(),o.oc(6,"td",13),o.cd(7),o.nc(),o.oc(8,"td",14),o.cd(9),o.nc(),o.oc(10,"td",14),o.cd(11),o.zc(12,"currency"),o.nc(),o.oc(13,"td",15),o.ad(14,A,1,2,"input",16),o.ad(15,w,1,1,"ng-template",null,17,o.bd),o.nc(),o.nc()),2&e){const e=t.$implicit,c=o.Qc(16),n=o.yc();o.Zb("is-cancelled",0===e.quantity),o.Wb(2),o.Fc("src",o.Bc(3,9,e.featuredAsset,"tiny"),o.Vc),o.Wb(3),o.dd(e.productVariant.name),o.Wb(2),o.dd(e.productVariant.sku),o.Wb(2),o.dd(e.quantity),o.Wb(2),o.ed(" ",o.Bc(12,12,e.unitPriceWithTax/100,n.order.currencyCode)," "),o.Wb(3),o.Fc("ngIf",e.quantity>0&&!n.order.active)("ngIfElse",c)}}function x(e,t){1&e&&(o.mc(0),o.cd(1),o.zc(2,"translate"),o.lc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.cancel-selected-items")," "))}function S(e,t){1&e&&(o.mc(0),o.cd(1),o.zc(2,"translate"),o.lc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.cancel-order")," "))}function _(e,t){if(1&e){const e=o.pc();o.oc(0,"button",19),o.wc("click",(function(){return o.Tc(e),o.yc().cancel()})),o.cd(1),o.zc(2,"translate"),o.nc(),o.oc(3,"button",20),o.wc("click",(function(){return o.Tc(e),o.yc().select()})),o.ad(4,x,3,3,"ng-container",21),o.ad(5,S,3,3,"ng-container",21),o.nc()}if(2&e){const e=o.yc();o.Wb(1),o.dd(o.Ac(2,4,"common.cancel")),o.Wb(2),o.Fc("disabled",!e.reason||!e.order.active&&0===e.selectionCount),o.Wb(1),o.Fc("ngIf",!e.order.active),o.Wb(1),o.Fc("ngIf",e.order.active)}}function k(e,t){1&e&&(o.cd(0),o.zc(1,"translate")),2&e&&o.dd(o.Ac(1,1,"order.fulfill-order"))}function T(e,t){if(1&e&&(o.jc(0,"img",18),o.zc(1,"assetPreview")),2&e){const e=o.yc().$implicit;o.Fc("src",o.Bc(1,1,e.featuredAsset,"tiny"),o.Vc)}}function D(e,t){if(1&e){const e=o.pc();o.oc(0,"tr",10),o.oc(1,"td",11),o.ad(2,T,2,4,"img",12),o.nc(),o.oc(3,"td",13),o.cd(4),o.nc(),o.oc(5,"td",14),o.cd(6),o.nc(),o.oc(7,"td",15),o.cd(8),o.nc(),o.oc(9,"td",16),o.oc(10,"input",17),o.wc("ngModelChange",(function(c){o.Tc(e);const n=t.$implicit;return o.yc().fulfillmentQuantities[n.id]=c})),o.nc(),o.nc(),o.nc()}if(2&e){const e=t.$implicit,c=o.yc();o.Zb("ignore",0===c.getUnfulfilledCount(e)),o.Wb(2),o.Fc("ngIf",e.featuredAsset),o.Wb(2),o.dd(e.productVariant.name),o.Wb(2),o.dd(e.productVariant.sku),o.Wb(2),o.dd(c.getUnfulfilledCount(e)),o.Wb(2),o.Fc("disabled",0===c.getUnfulfilledCount(e))("ngModel",c.fulfillmentQuantities[e.id])("max",e.quantity)}}function N(e,t){if(1&e){const e=o.pc();o.oc(0,"button",19),o.wc("click",(function(){return o.Tc(e),o.yc().cancel()})),o.cd(1),o.zc(2,"translate"),o.nc(),o.oc(3,"button",20),o.wc("click",(function(){return o.Tc(e),o.yc().select()})),o.cd(4),o.zc(5,"translate"),o.nc()}if(2&e){const e=o.yc();o.Wb(1),o.dd(o.Ac(2,3,"common.cancel")),o.Wb(2),o.Fc("disabled",!e.method),o.Wb(1),o.ed(" ",o.Ac(5,5,"order.create-fulfillment")," ")}}function $(e,t){if(1&e&&(o.oc(0,"vdr-labeled-data",0),o.zc(1,"translate"),o.cd(2),o.nc()),2&e){const e=o.yc();o.Fc("label",o.Ac(1,2,"order.tracking-code")),o.Wb(2),o.ed(" ",null==e.fulfillment?null:e.fulfillment.trackingCode,"\n")}}function R(e,t){1&e&&o.jc(0,"clr-icon",9)}function L(e,t){1&e&&o.jc(0,"clr-icon",10)}function E(e,t){1&e&&o.jc(0,"clr-icon",11)}function B(e,t){1&e&&(o.oc(0,"label",12),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.line-fulfillment-all")," "))}const q=function(e,t){return{total:e,count:t}};function V(e,t){if(1&e&&(o.oc(0,"label",12),o.cd(1),o.zc(2,"translate"),o.nc()),2&e){const e=o.yc(2);o.Wb(1),o.ed(" ",o.Bc(2,1,"order.line-fulfillment-partial",o.Lc(4,q,e.line.quantity,e.fulfilledCount))," ")}}function Q(e,t){1&e&&(o.oc(0,"label",12),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.line-fulfillment-none")," "))}function U(e,t){if(1&e&&(o.oc(0,"vdr-labeled-data",15),o.zc(1,"translate"),o.cd(2),o.nc()),2&e){const e=o.yc().$implicit;o.Fc("label",o.Ac(1,2,"order.tracking-code")),o.Wb(2),o.ed(" ",e.fulfillment.trackingCode," ")}}const K=function(e){return{count:e}};function H(e,t){if(1&e&&(o.oc(0,"div",13),o.oc(1,"div",14),o.cd(2),o.zc(3,"translate"),o.zc(4,"translate"),o.nc(),o.oc(5,"vdr-labeled-data",15),o.zc(6,"translate"),o.cd(7),o.zc(8,"date"),o.nc(),o.oc(9,"vdr-labeled-data",15),o.zc(10,"translate"),o.cd(11),o.nc(),o.ad(12,U,3,4,"vdr-labeled-data",16),o.nc()),2&e){const e=t.$implicit;o.Wb(2),o.gd(" ",o.Ac(3,8,"order.fulfillment")," #",e.fulfillment.id," (",o.Bc(4,10,"order.item-count",o.Kc(20,K,e.count)),") "),o.Wb(3),o.Fc("label",o.Ac(6,13,"common.created-at")),o.Wb(2),o.ed(" ",o.Bc(8,15,e.fulfillment.createdAt,"medium")," "),o.Wb(2),o.Fc("label",o.Ac(10,18,"order.fulfillment-method")),o.Wb(2),o.ed(" ",e.fulfillment.method," "),o.Wb(1),o.Fc("ngIf",e.fulfillment.trackingCode)}}function G(e,t){if(1&e&&(o.oc(0,"vdr-dropdown",1),o.oc(1,"button",2),o.ad(2,R,1,0,"clr-icon",3),o.ad(3,L,1,0,"clr-icon",4),o.ad(4,E,1,0,"clr-icon",5),o.nc(),o.oc(5,"vdr-dropdown-menu",6),o.ad(6,B,3,3,"label",7),o.ad(7,V,3,7,"label",7),o.ad(8,Q,3,3,"label",7),o.ad(9,H,13,22,"div",8),o.nc(),o.nc()),2&e){const e=o.yc();o.Wb(2),o.Fc("ngIf","full"===e.fulfillmentStatus),o.Wb(1),o.Fc("ngIf","partial"===e.fulfillmentStatus),o.Wb(1),o.Fc("ngIf","none"===e.fulfillmentStatus),o.Wb(2),o.Fc("ngIf","full"===e.fulfillmentStatus),o.Wb(1),o.Fc("ngIf","partial"===e.fulfillmentStatus),o.Wb(1),o.Fc("ngIf","none"===e.fulfillmentStatus),o.Wb(1),o.Fc("ngForOf",e.fulfillments)}}function Z(e,t){if(1&e&&(o.oc(0,"span",1),o.zc(1,"translate"),o.jc(2,"clr-icon",2),o.nc()),2&e){const e=o.yc();o.Fc("title",o.Bc(1,1,"order.refunded-count",o.Kc(4,K,e.getRefundedCount())))}}function Y(e,t){if(1&e&&(o.mc(0),o.jc(1,"vdr-custom-field-control",9),o.lc()),2&e){const e=t.$implicit,c=o.yc(2);o.Wb(1),o.Fc("customFieldsFormGroup",c.customFieldForm)("compact",!0)("readonly",e.readonly||!c.editable)("customField",e)}}function X(e,t){if(1&e){const e=o.pc();o.oc(0,"button",10),o.wc("click",(function(){return o.Tc(e),o.yc(2).editable=!0})),o.jc(1,"clr-icon",11),o.cd(2),o.zc(3,"translate"),o.nc()}2&e&&(o.Wb(2),o.ed(" ",o.Ac(3,1,"common.edit")," "))}function J(e,t){if(1&e){const e=o.pc();o.oc(0,"button",12),o.wc("click",(function(){return o.Tc(e),o.yc(2).onUpdateClick()})),o.jc(1,"clr-icon",13),o.cd(2),o.zc(3,"translate"),o.nc()}if(2&e){const e=o.yc(2);o.Fc("disabled",e.customFieldForm.pristine||e.customFieldForm.invalid),o.Wb(2),o.ed(" ",o.Ac(3,2,"common.update")," ")}}function ee(e,t){if(1&e&&(o.oc(0,"div",1),o.oc(1,"div",2),o.cd(2),o.zc(3,"translate"),o.nc(),o.oc(4,"div",3),o.oc(5,"div",4),o.ad(6,Y,2,4,"ng-container",5),o.nc(),o.nc(),o.oc(7,"div",6),o.ad(8,X,4,3,"button",7),o.ad(9,J,4,4,"button",8),o.nc(),o.nc()),2&e){const e=o.yc();o.Wb(2),o.ed(" ",o.Ac(3,6,"common.custom-fields")," "),o.Wb(3),o.Zb("editable",e.editable),o.Wb(1),o.Fc("ngForOf",e.customFieldsConfig),o.Wb(2),o.Fc("ngIf",!e.editable),o.Wb(1),o.Fc("ngIf",e.editable)}}function te(e,t){1&e&&(o.cd(0),o.zc(1,"translate")),2&e&&o.dd(o.Ac(1,1,"order.order-state-diagram"))}function ce(e,t){1&e&&(o.cd(0),o.zc(1,"translate")),2&e&&o.dd(o.Ac(1,1,"order.refund-order"))}function ne(e,t){if(1&e){const e=o.pc();o.oc(0,"input",29),o.wc("ngModelChange",(function(t){o.Tc(e);const c=o.yc().$implicit;return o.yc().lineQuantities[c.id].quantity=t})),o.nc()}if(2&e){const e=o.yc().$implicit,t=o.yc();o.Fc("ngModel",t.lineQuantities[e.id].quantity)("max",e.quantity)}}function oe(e,t){if(1&e){const e=o.pc();o.oc(0,"input",30),o.wc("ngModelChange",(function(t){o.Tc(e);const c=o.yc().$implicit;return o.yc().lineQuantities[c.id].cancel=t})),o.nc()}if(2&e){const e=o.yc().$implicit,t=o.yc();o.Fc("disabled",0===t.lineQuantities[e.id].quantity)("ngModel",t.lineQuantities[e.id].cancel)}}function ie(e,t){if(1&e&&(o.oc(0,"tr",17),o.oc(1,"td",18),o.jc(2,"img",19),o.zc(3,"assetPreview"),o.nc(),o.oc(4,"td",20),o.cd(5),o.nc(),o.oc(6,"td",21),o.cd(7),o.nc(),o.oc(8,"td",22),o.cd(9),o.jc(10,"vdr-line-refunds",23),o.nc(),o.oc(11,"td",22),o.cd(12),o.zc(13,"currency"),o.nc(),o.oc(14,"td",24),o.ad(15,ne,1,2,"input",25),o.nc(),o.oc(16,"td",26),o.oc(17,"div",27),o.ad(18,oe,1,2,"input",28),o.nc(),o.nc(),o.nc()),2&e){const e=t.$implicit,c=o.yc();o.Wb(2),o.Fc("src",o.Bc(3,8,e.featuredAsset,"tiny"),o.Vc),o.Wb(3),o.dd(e.productVariant.name),o.Wb(2),o.dd(e.productVariant.sku),o.Wb(2),o.ed(" ",e.quantity," "),o.Wb(1),o.Fc("line",e),o.Wb(2),o.ed(" ",o.Bc(13,11,e.unitPriceWithTax/100,c.order.currencyCode)," "),o.Wb(3),o.Fc("ngIf",c.lineCanBeRefunded(e)),o.Wb(3),o.Fc("ngIf",c.lineCanBeRefunded(e))}}function re(e,t){if(1&e&&(o.oc(0,"option",31),o.cd(1),o.zc(2,"currency"),o.nc()),2&e){const e=t.$implicit,c=o.yc();o.Fc("ngValue",e)("disabled","Settled"!==e.state),o.Wb(1),o.gd(" #",e.id," ",e.method,": ",o.Bc(2,5,e.amount/100,c.order.currencyCode)," ")}}const de=function(e,t){return{min:e,max:t}};function ae(e,t){if(1&e&&(o.oc(0,"div",32),o.cd(1),o.zc(2,"translate"),o.zc(3,"currency"),o.zc(4,"currency"),o.nc()),2&e){const e=o.yc();o.Wb(1),o.ed(" ",o.Bc(2,1,"order.refund-total-error",o.Lc(10,de,o.Bc(3,4,0,e.order.currencyCode),o.Bc(4,7,e.selectedPayment.amount/100,e.order.currencyCode)))," ")}}const le=function(e){return{amount:e}};function se(e,t){if(1&e){const e=o.pc();o.oc(0,"button",33),o.wc("click",(function(){return o.Tc(e),o.yc().cancel()})),o.cd(1),o.zc(2,"translate"),o.nc(),o.oc(3,"button",34),o.wc("click",(function(){return o.Tc(e),o.yc().select()})),o.cd(4),o.zc(5,"translate"),o.zc(6,"currency"),o.nc()}if(2&e){const e=o.yc();o.Wb(1),o.dd(o.Ac(2,3,"common.cancel")),o.Wb(2),o.Fc("disabled",!e.selectedPayment||!e.reason||0===e.refundTotal||e.refundTotal>e.selectedPayment.amount),o.Wb(1),o.ed(" ",o.Bc(5,5,"order.refund-with-amount",o.Kc(11,le,o.Bc(6,8,e.refundTotal/100,e.order.currencyCode)))," ")}}function ue(e,t){1&e&&(o.cd(0),o.zc(1,"translate")),2&e&&o.dd(o.Ac(1,1,"order.settle-refund"))}function fe(e,t){if(1&e){const e=o.pc();o.oc(0,"button",4),o.wc("click",(function(){return o.Tc(e),o.yc().cancel()})),o.cd(1),o.zc(2,"translate"),o.nc(),o.oc(3,"button",5),o.wc("click",(function(){return o.Tc(e),o.yc().submit()})),o.cd(4),o.zc(5,"translate"),o.nc()}if(2&e){const e=o.yc();o.Wb(1),o.dd(o.Ac(2,3,"common.cancel")),o.Wb(2),o.Fc("disabled",!e.transactionId),o.Wb(1),o.ed(" ",o.Ac(5,5,"order.settle-refund")," ")}}const pe=function(e){return{method:e}};function me(e,t){1&e&&(o.mc(0),o.cd(1),o.zc(2,"translate"),o.lc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.refund-and-cancel-order")," "))}function be(e,t){1&e&&(o.cd(0),o.zc(1,"translate")),2&e&&o.ed(" ",o.Ac(1,1,"order.cancel-order")," ")}function ge(e,t){if(1&e){const e=o.pc();o.oc(0,"button",13),o.wc("click",(function(){o.Tc(e);const t=o.yc().ngIf;return o.yc().cancelOrRefund(t)})),o.jc(1,"clr-icon",14),o.ad(2,me,3,3,"ng-container",15),o.ad(3,be,2,3,"ng-template",null,16,o.bd),o.nc()}if(2&e){const e=o.Qc(4),t=o.yc().ngIf;o.Wb(2),o.Fc("ngIf","PaymentAuthorized"!==t.state&&!t.active)("ngIfElse",e)}}const he=function(e){return{state:e}};function ye(e,t){if(1&e){const e=o.pc();o.mc(0),o.jc(1,"div",17),o.oc(2,"button",13),o.wc("click",(function(){o.Tc(e);const c=t.$implicit;return o.yc(2).transitionToState(c)})),o.jc(3,"clr-icon",18),o.cd(4),o.zc(5,"translate"),o.nc(),o.lc()}if(2&e){const e=t.$implicit;o.Wb(4),o.ed(" ",o.Bc(5,1,"order.transition-to-state",o.Kc(4,he,e))," ")}}function Oe(e,t){if(1&e){const e=o.pc();o.oc(0,"vdr-action-bar"),o.oc(1,"vdr-ab-left"),o.oc(2,"div",1),o.jc(3,"vdr-entity-info",2),o.zc(4,"async"),o.oc(5,"vdr-order-state-label",3),o.oc(6,"button",4),o.wc("click",(function(){return o.Tc(e),o.yc().openStateDiagram()})),o.zc(7,"translate"),o.jc(8,"clr-icon",5),o.nc(),o.nc(),o.nc(),o.nc(),o.oc(9,"vdr-ab-right"),o.jc(10,"vdr-action-bar-items",6),o.oc(11,"button",7),o.wc("click",(function(){return o.Tc(e),o.yc().fulfillOrder()})),o.cd(12),o.zc(13,"translate"),o.nc(),o.oc(14,"vdr-dropdown"),o.oc(15,"button",8),o.jc(16,"clr-icon",9),o.nc(),o.oc(17,"vdr-dropdown-menu",10),o.ad(18,ge,5,2,"button",11),o.ad(19,ye,6,6,"ng-container",12),o.zc(20,"async"),o.nc(),o.nc(),o.nc(),o.nc()}if(2&e){const e=t.ngIf,c=o.yc();o.Wb(3),o.Fc("entity",o.Ac(4,7,c.entity$)),o.Wb(2),o.Fc("state",e.state),o.Wb(1),o.Fc("title",o.Ac(7,9,"order.order-state-diagram")),o.Wb(5),o.Fc("disabled","PaymentSettled"!==e.state&&"PartiallyFulfilled"!==e.state),o.Wb(1),o.ed(" ",o.Ac(13,11,"order.fulfill-order")," "),o.Wb(6),o.Fc("ngIf",e.nextStates.includes("Cancelled")),o.Wb(1),o.Fc("ngForOf",o.Ac(20,13,c.nextStates$))}}function ve(e,t){if(1&e){const e=o.pc();o.mc(0),o.oc(1,"th",39),o.oc(2,"button",40),o.wc("click",(function(){return o.Tc(e),o.yc(2).toggleOrderLineCustomFields()})),o.zc(3,"translate"),o.cd(4),o.zc(5,"customFieldLabel"),o.nc(),o.nc(),o.lc()}if(2&e){const e=t.$implicit;o.Wb(2),o.Fc("title",o.Ac(3,2,"common.hide-custom-fields")),o.Wb(2),o.ed(" ",o.Ac(5,4,e)," ")}}function Ce(e,t){if(1&e){const e=o.pc();o.mc(0),o.oc(1,"th"),o.oc(2,"button",40),o.wc("click",(function(){return o.Tc(e),o.yc(2).toggleOrderLineCustomFields()})),o.zc(3,"translate"),o.jc(4,"clr-icon",41),o.nc(),o.nc(),o.lc()}2&e&&(o.Wb(2),o.Fc("title",o.Ac(3,1,"common.display-custom-fields")))}function Fe(e,t){if(1&e&&(o.jc(0,"img",52),o.zc(1,"assetPreview")),2&e){const e=o.yc().$implicit;o.Fc("src",o.Bc(1,1,e.featuredAsset,"tiny"),o.Vc)}}function We(e,t){if(1&e&&(o.oc(0,"span",57),o.cd(1),o.zc(2,"date"),o.nc()),2&e){const e=o.yc().$implicit,t=o.yc().$implicit;o.Fc("title",t.customFields[e.name]),o.Wb(1),o.dd(o.Bc(2,2,t.customFields[e.name],"short"))}}function je(e,t){1&e&&o.jc(0,"clr-icon",59)}function Pe(e,t){1&e&&o.jc(0,"clr-icon",60)}function Me(e,t){if(1&e&&(o.ad(0,je,1,0,"ng-template",58),o.ad(1,Pe,1,0,"ng-template",58)),2&e){const e=o.yc().$implicit,t=o.yc().$implicit;o.Fc("ngIf",!0===t.customFields[e.name]),o.Wb(1),o.Fc("ngIf",!1===t.customFields[e.name])}}function Ie(e,t){if(1&e&&o.cd(0),2&e){const e=o.yc().$implicit,t=o.yc().$implicit;o.ed(" ",t.customFields[e.name]," ")}}function Ae(e,t){if(1&e&&(o.mc(0),o.oc(1,"td",53),o.mc(2,54),o.ad(3,We,3,5,"ng-template",55),o.ad(4,Me,2,2,"ng-template",55),o.ad(5,Ie,1,1,"ng-template",56),o.lc(),o.nc(),o.lc()),2&e){const e=t.$implicit;o.Wb(2),o.Fc("ngSwitch",e.type),o.Wb(1),o.Fc("ngSwitchCase","datetime"),o.Wb(1),o.Fc("ngSwitchCase","boolean")}}function we(e,t){1&e&&(o.mc(0),o.oc(1,"td",53),o.jc(2,"clr-icon",41),o.nc(),o.lc())}function ze(e,t){if(1&e&&(o.oc(0,"div",63),o.oc(1,"a",64),o.cd(2),o.nc(),o.oc(3,"div",65),o.cd(4),o.zc(5,"currency"),o.nc(),o.nc()),2&e){const e=t.$implicit,c=o.yc(4).ngIf,n=o.yc();o.Wb(1),o.Fc("routerLink",n.getPromotionLink(e)),o.Wb(1),o.dd(e.description),o.Wb(2),o.ed(" ",o.Bc(5,3,e.amount/100,c.currencyCode)," ")}}function xe(e,t){if(1&e&&(o.oc(0,"vdr-dropdown"),o.oc(1,"div",61),o.cd(2),o.zc(3,"translate"),o.nc(),o.oc(4,"vdr-dropdown-menu"),o.ad(5,ze,6,6,"div",62),o.nc(),o.nc()),2&e){const e=o.yc(2).$implicit,t=o.yc(2);o.Wb(2),o.ed(" ",o.Ac(3,2,"order.promotions-applied")," "),o.Wb(3),o.Fc("ngForOf",t.getLinePromotions(e))}}function Se(e,t){if(1&e&&(o.mc(0),o.ad(1,xe,6,4,"vdr-dropdown",0),o.lc()),2&e){const e=t.ngIf;o.Wb(1),o.Fc("ngIf",e.length)}}function _e(e,t){if(1&e&&(o.oc(0,"tr",42),o.oc(1,"td",43),o.ad(2,Fe,2,4,"img",44),o.nc(),o.oc(3,"td",45),o.cd(4),o.nc(),o.oc(5,"td",46),o.cd(6),o.nc(),o.oc(7,"td",47),o.cd(8),o.zc(9,"currency"),o.oc(10,"div",26),o.zc(11,"translate"),o.cd(12),o.zc(13,"currency"),o.nc(),o.nc(),o.oc(14,"td",48),o.cd(15),o.jc(16,"vdr-line-refunds",49),o.jc(17,"vdr-line-fulfillment",50),o.nc(),o.ad(18,Ae,6,3,"ng-container",12),o.ad(19,we,3,0,"ng-container",0),o.oc(20,"td",51),o.cd(21),o.zc(22,"currency"),o.oc(23,"div",26),o.zc(24,"translate"),o.cd(25),o.zc(26,"currency"),o.nc(),o.ad(27,Se,2,1,"ng-container",0),o.nc(),o.nc()),2&e){const e=t.$implicit,c=o.yc().ngIf,n=o.yc();o.Zb("is-cancelled",0===e.quantity),o.Wb(2),o.Fc("ngIf",e.featuredAsset),o.Wb(2),o.dd(e.productVariant.name),o.Wb(2),o.dd(e.productVariant.sku),o.Wb(2),o.ed(" ",o.Bc(9,18,e.unitPriceWithTax/100,c.currencyCode)," "),o.Wb(2),o.Fc("title",o.Ac(11,21,"order.net-price")),o.Wb(2),o.ed(" ",o.Bc(13,23,e.unitPrice/100,c.currencyCode)," "),o.Wb(3),o.ed(" ",e.quantity," "),o.Wb(1),o.Fc("line",e),o.Wb(1),o.Fc("line",e)("orderState",c.state),o.Wb(1),o.Fc("ngForOf",n.visibleOrderLineCustomFields),o.Wb(1),o.Fc("ngIf",n.showElided),o.Wb(2),o.ed(" ",o.Bc(22,26,e.totalPrice/100,c.currencyCode)," "),o.Wb(2),o.Fc("title",o.Ac(24,29,"order.net-price")),o.Wb(2),o.ed(" ",o.Bc(26,31,e.unitPrice*e.quantity/100,c.currencyCode)," "),o.Wb(2),o.Fc("ngIf",n.getLinePromotions(e))}}function ke(e,t){1&e&&(o.mc(0),o.jc(1,"td"),o.lc())}function Te(e,t){if(1&e&&(o.oc(0,"vdr-chip"),o.cd(1),o.nc()),2&e){const e=t.ngIf;o.Wb(1),o.dd(e)}}function De(e,t){1&e&&(o.mc(0),o.jc(1,"td"),o.lc())}function Ne(e,t){if(1&e&&(o.oc(0,"tr",66),o.oc(1,"td",24),o.oc(2,"a",67),o.cd(3),o.nc(),o.ad(4,Te,2,1,"vdr-chip",0),o.nc(),o.ad(5,De,2,0,"ng-container",0),o.oc(6,"td",25),o.cd(7),o.zc(8,"currency"),o.nc(),o.nc()),2&e){const e=t.$implicit,c=o.yc().ngIf,n=o.yc();o.Wb(1),o.Xb("colspan",5+n.visibleOrderLineCustomFields.length),o.Wb(1),o.Fc("routerLink",n.getPromotionLink(e)),o.Wb(1),o.dd(e.description),o.Wb(1),o.Fc("ngIf",n.getCouponCodeForAdjustment(c,e)),o.Wb(1),o.Fc("ngIf",n.showElided),o.Wb(2),o.ed(" ",o.Bc(8,6,e.amount/100,c.currencyCode)," ")}}function $e(e,t){1&e&&(o.mc(0),o.jc(1,"td"),o.lc())}function Re(e,t){1&e&&(o.mc(0),o.jc(1,"td"),o.lc())}function Le(e,t){1&e&&(o.oc(0,"h6"),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.shipping-address")," "))}function Ee(e,t){1&e&&(o.oc(0,"h6"),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.billing-address")," "))}function Be(e,t){if(1&e){const e=o.pc();o.oc(0,"vdr-order-payment-detail",69),o.wc("settlePayment",(function(t){return o.Tc(e),o.yc(3).settlePayment(t)}))("settleRefund",(function(t){return o.Tc(e),o.yc(3).settleRefund(t)})),o.nc()}if(2&e){const e=t.$implicit,c=o.yc(2).ngIf;o.Fc("currencyCode",c.currencyCode)("payment",e)}}function qe(e,t){if(1&e&&(o.mc(0),o.ad(1,Be,1,2,"vdr-order-payment-detail",68),o.lc()),2&e){const e=o.yc().ngIf;o.Wb(1),o.Fc("ngForOf",e.payments)}}function Ve(e,t){if(1&e&&(o.oc(0,"div",71),o.jc(1,"vdr-fulfillment-detail",72),o.nc()),2&e){const e=t.$implicit,c=o.yc(2).ngIf;o.Wb(1),o.Fc("fulfillmentId",e.id)("order",c)}}function Qe(e,t){if(1&e&&(o.mc(0),o.oc(1,"div",33),o.oc(2,"div",34),o.cd(3),o.zc(4,"translate"),o.nc(),o.oc(5,"div",35),o.ad(6,Ve,2,2,"div",70),o.nc(),o.nc(),o.lc()),2&e){const e=o.yc().ngIf;o.Wb(3),o.ed(" ",o.Ac(4,2,"order.fulfillment")," "),o.Wb(3),o.Fc("ngForOf",e.fulfillments)}}function Ue(e,t){if(1&e){const e=o.pc();o.oc(0,"div"),o.oc(1,"div",19),o.oc(2,"div",20),o.oc(3,"table",21),o.oc(4,"thead"),o.oc(5,"tr"),o.jc(6,"th"),o.oc(7,"th"),o.cd(8),o.zc(9,"translate"),o.nc(),o.oc(10,"th"),o.cd(11),o.zc(12,"translate"),o.nc(),o.oc(13,"th"),o.cd(14),o.zc(15,"translate"),o.nc(),o.oc(16,"th"),o.cd(17),o.zc(18,"translate"),o.nc(),o.ad(19,ve,6,6,"ng-container",12),o.ad(20,Ce,5,3,"ng-container",0),o.oc(21,"th"),o.cd(22),o.zc(23,"translate"),o.nc(),o.nc(),o.nc(),o.ad(24,_e,28,34,"tr",22),o.oc(25,"tr",23),o.oc(26,"td",24),o.cd(27),o.zc(28,"translate"),o.nc(),o.jc(29,"td"),o.jc(30,"td"),o.ad(31,ke,2,0,"ng-container",0),o.oc(32,"td",25),o.cd(33),o.zc(34,"currency"),o.oc(35,"div",26),o.zc(36,"translate"),o.cd(37),o.zc(38,"currency"),o.nc(),o.nc(),o.nc(),o.ad(39,Ne,9,9,"tr",27),o.oc(40,"tr",28),o.oc(41,"td",24),o.cd(42),o.zc(43,"translate"),o.nc(),o.oc(44,"td",25),o.cd(45),o.nc(),o.jc(46,"td"),o.ad(47,$e,2,0,"ng-container",0),o.oc(48,"td",25),o.cd(49),o.zc(50,"currency"),o.oc(51,"div",26),o.zc(52,"translate"),o.cd(53),o.zc(54,"currency"),o.nc(),o.nc(),o.nc(),o.oc(55,"tr",29),o.oc(56,"td",24),o.cd(57),o.zc(58,"translate"),o.nc(),o.jc(59,"td"),o.jc(60,"td"),o.ad(61,Re,2,0,"ng-container",0),o.oc(62,"td",25),o.cd(63),o.zc(64,"currency"),o.oc(65,"div",26),o.zc(66,"translate"),o.cd(67),o.zc(68,"currency"),o.nc(),o.nc(),o.nc(),o.nc(),o.oc(69,"vdr-order-history",30),o.wc("addNote",(function(t){return o.Tc(e),o.yc().addNote(t)}))("updateNote",(function(t){return o.Tc(e),o.yc().updateNote(t)}))("deleteNote",(function(t){return o.Tc(e),o.yc().deleteNote(t)})),o.zc(70,"async"),o.nc(),o.nc(),o.oc(71,"div",31),o.oc(72,"vdr-order-custom-fields-card",32),o.wc("updateClick",(function(t){return o.Tc(e),o.yc().updateCustomFields(t)})),o.nc(),o.oc(73,"div",33),o.oc(74,"div",34),o.cd(75),o.zc(76,"translate"),o.nc(),o.oc(77,"div",35),o.oc(78,"div",36),o.jc(79,"vdr-customer-label",37),o.ad(80,Le,3,3,"h6",0),o.jc(81,"vdr-formatted-address",38),o.ad(82,Ee,3,3,"h6",0),o.jc(83,"vdr-formatted-address",38),o.nc(),o.nc(),o.nc(),o.ad(84,qe,2,1,"ng-container",0),o.ad(85,Qe,7,4,"ng-container",0),o.nc(),o.nc(),o.nc()}if(2&e){const e=t.ngIf,c=o.yc();o.Wb(8),o.dd(o.Ac(9,40,"order.product-name")),o.Wb(3),o.dd(o.Ac(12,42,"order.product-sku")),o.Wb(3),o.dd(o.Ac(15,44,"order.unit-price")),o.Wb(3),o.dd(o.Ac(18,46,"order.quantity")),o.Wb(2),o.Fc("ngForOf",c.visibleOrderLineCustomFields),o.Wb(1),o.Fc("ngIf",c.showElided),o.Wb(2),o.dd(o.Ac(23,48,"order.total")),o.Wb(2),o.Fc("ngForOf",e.lines),o.Wb(3),o.dd(o.Ac(28,50,"order.sub-total")),o.Wb(3),o.Xb("colspan",3+c.visibleOrderLineCustomFields.length),o.Wb(1),o.Fc("ngIf",c.showElided),o.Wb(2),o.ed(" ",o.Bc(34,52,e.subTotal/100,e.currencyCode)," "),o.Wb(2),o.Fc("title",o.Ac(36,55,"order.net-price")),o.Wb(2),o.ed(" ",o.Bc(38,57,e.subTotalBeforeTax/100,e.currencyCode)," "),o.Wb(2),o.Fc("ngForOf",e.adjustments),o.Wb(3),o.dd(o.Ac(43,60,"order.shipping")),o.Wb(3),o.dd(null==e.shippingMethod?null:e.shippingMethod.description),o.Wb(1),o.Xb("colspan",3+c.visibleOrderLineCustomFields.length),o.Wb(1),o.Fc("ngIf",c.showElided),o.Wb(2),o.ed(" ",o.Bc(50,62,e.shippingWithTax/100,e.currencyCode)," "),o.Wb(2),o.Fc("title",o.Ac(52,65,"order.net-price")),o.Wb(2),o.ed(" ",o.Bc(54,67,e.shipping/100,e.currencyCode)," "),o.Wb(4),o.dd(o.Ac(58,70,"order.total")),o.Wb(3),o.Xb("colspan",3+c.visibleOrderLineCustomFields.length),o.Wb(1),o.Fc("ngIf",c.showElided),o.Wb(2),o.ed(" ",o.Bc(64,72,e.total/100,e.currencyCode)," "),o.Wb(2),o.Fc("title",o.Ac(66,75,"order.net-price")),o.Wb(2),o.ed(" ",o.Bc(68,77,e.totalBeforeTax/100,e.currencyCode)," "),o.Wb(2),o.Fc("order",e)("history",o.Ac(70,80,c.history$)),o.Wb(3),o.Fc("customFieldsConfig",c.customFields)("customFieldValues",e.customFields),o.Wb(3),o.ed(" ",o.Ac(76,82,"order.customer")," "),o.Wb(4),o.Fc("customer",e.customer),o.Wb(1),o.Fc("ngIf",c.getOrderAddressLines(e.shippingAddress).length),o.Wb(1),o.Fc("address",e.shippingAddress),o.Wb(1),o.Fc("ngIf",c.getOrderAddressLines(e.billingAddress).length),o.Wb(1),o.Fc("address",e.billingAddress),o.Wb(1),o.Fc("ngIf",e.payments&&e.payments.length),o.Wb(1),o.Fc("ngIf",e.fulfillments&&e.fulfillments.length)}}function Ke(e,t){1&e&&(o.oc(0,"span",11),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.note-only-visible-to-administrators")," "))}function He(e,t){1&e&&(o.oc(0,"span",12),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.note-visible-to-customer")," "))}function Ge(e,t){1&e&&(o.oc(0,"div",18),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.history-order-fulfilled")," "))}function Ze(e,t){1&e&&(o.oc(0,"div",18),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.ed(" ",o.Ac(2,1,"order.history-order-cancelled")," "))}const Ye=function(e,t){return{from:e,to:t}};function Xe(e,t){if(1&e&&(o.cd(0),o.zc(1,"translate")),2&e){const e=o.yc(2).$implicit;o.ed(" ",o.Bc(1,1,"order.history-order-transition",o.Lc(4,Ye,e.data.from,e.data.to))," ")}}function Je(e,t){if(1&e&&(o.mc(0),o.ad(1,Ge,3,3,"div",16),o.ad(2,Ze,3,3,"div",16),o.ad(3,Xe,2,7,"ng-template",17),o.lc()),2&e){const e=o.yc().$implicit;o.Wb(1),o.Fc("ngIf","Fulfilled"===e.data.to),o.Wb(1),o.Fc("ngIf","Cancelled"===e.data.to),o.Wb(1),o.Fc("ngIf","Cancelled"!==e.data.to&&"Fulfilled"!==e.data.to)}}function et(e,t){if(1&e&&(o.oc(0,"vdr-history-entry-detail"),o.jc(1,"vdr-payment-detail",22),o.nc()),2&e){const e=t.ngIf,c=o.yc(4);o.Wb(1),o.Fc("payment",e)("currencyCode",c.order.currencyCode)}}function tt(e,t){if(1&e&&(o.mc(0),o.oc(1,"div",18),o.cd(2),o.zc(3,"translate"),o.nc(),o.cd(4),o.zc(5,"translate"),o.ad(6,et,2,2,"vdr-history-entry-detail",21),o.lc()),2&e){const e=o.yc(2).$implicit,t=o.yc();var c;o.Wb(2),o.ed(" ",o.Ac(3,4,"order.history-payment-settled")," "),o.Wb(2),o.fd(" ",o.Ac(5,6,"order.transaction-id"),": ",null==(c=t.getPayment(e))?null:c.transactionId," "),o.Wb(2),o.Fc("ngIf",t.getPayment(e))}}const ct=function(e,t,c){return{from:e,to:t,id:c}};function nt(e,t){if(1&e&&(o.cd(0),o.zc(1,"translate")),2&e){const e=o.yc(2).$implicit;o.ed(" ",o.Bc(1,1,"order.history-payment-transition",o.Mc(4,ct,e.data.from,e.data.to,e.data.paymentId))," ")}}function ot(e,t){if(1&e&&(o.mc(0),o.ad(1,tt,7,8,"ng-container",19),o.ad(2,nt,2,8,"ng-template",null,20,o.bd),o.lc()),2&e){const e=o.Qc(3),t=o.yc().$implicit;o.Wb(1),o.Fc("ngIf","Settled"===t.data.to)("ngIfElse",e)}}function it(e,t){if(1&e&&(o.mc(0),o.cd(1),o.zc(2,"translate"),o.lc()),2&e){const e=o.yc().$implicit;o.Wb(1),o.ed(" ",o.Bc(2,1,"order.history-refund-transition",o.Mc(4,ct,e.data.from,e.data.to,e.data.refundId))," ")}}function rt(e,t){if(1&e&&(o.oc(0,"vdr-history-entry-detail"),o.oc(1,"vdr-labeled-data",23),o.zc(2,"translate"),o.cd(3),o.nc(),o.oc(4,"vdr-labeled-data",23),o.zc(5,"translate"),o.jc(6,"vdr-simple-item-list",24),o.nc(),o.nc()),2&e){const e=t.ngIf,c=o.yc(2).$implicit;o.Wb(1),o.Fc("label",o.Ac(2,4,"order.cancellation-reason")),o.Wb(2),o.ed(" ",c.data.reason," "),o.Wb(1),o.Fc("label",o.Ac(5,6,"order.contents")),o.Wb(2),o.Fc("items",e)}}function dt(e,t){if(1&e&&(o.mc(0),o.cd(1),o.zc(2,"translate"),o.ad(3,rt,7,8,"vdr-history-entry-detail",21),o.lc()),2&e){const e=o.yc().$implicit,t=o.yc();o.Wb(1),o.ed(" ",o.Bc(2,2,"order.history-items-cancelled",o.Kc(5,K,e.data.orderItemIds.length))," "),o.Wb(2),o.Fc("ngIf",t.getCancelledItems(e))}}function at(e,t){if(1&e&&(o.oc(0,"vdr-history-entry-detail"),o.jc(1,"vdr-fulfillment-detail",25),o.nc()),2&e){const e=t.ngIf,c=o.yc(3);o.Wb(1),o.Fc("fulfillmentId",e.id)("order",c.order)}}function lt(e,t){if(1&e&&(o.mc(0),o.oc(1,"div",18),o.cd(2),o.zc(3,"translate"),o.nc(),o.cd(4),o.zc(5,"translate"),o.ad(6,at,2,2,"vdr-history-entry-detail",21),o.lc()),2&e){const e=o.yc().$implicit,t=o.yc();var c;o.Wb(2),o.ed(" ",o.Ac(3,4,"order.history-fulfillment-created")," "),o.Wb(2),o.fd(" ",o.Ac(5,6,"order.tracking-code"),": ",null==(c=t.getFullfillment(e))?null:c.trackingCode," "),o.Wb(2),o.Fc("ngIf",t.getFullfillment(e))}}function st(e,t){1&e&&(o.oc(0,"span",38),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.dd(o.Ac(2,1,"common.public")))}function ut(e,t){1&e&&(o.oc(0,"span",39),o.cd(1),o.zc(2,"translate"),o.nc()),2&e&&(o.Wb(1),o.dd(o.Ac(2,1,"common.private")))}function ft(e,t){if(1&e){const e=o.pc();o.mc(0),o.oc(1,"div",26),o.oc(2,"div",27),o.ad(3,st,3,3,"span",28),o.ad(4,ut,3,3,"span",29),o.cd(5),o.nc(),o.jc(6,"div",30),o.oc(7,"vdr-dropdown"),o.oc(8,"button",31),o.jc(9,"clr-icon",32),o.nc(),o.oc(10,"vdr-dropdown-menu",33),o.oc(11,"button",34),o.wc("click",(function(){o.Tc(e);const t=o.yc().$implicit;return o.yc().updateNote.emit(t)})),o.zc(12,"hasPermission"),o.jc(13,"clr-icon",35),o.cd(14),o.zc(15,"translate"),o.nc(),o.jc(16,"div",36),o.oc(17,"button",34),o.wc("click",(function(){o.Tc(e);const t=o.yc().$implicit;return o.yc().deleteNote.emit(t)})),o.zc(18,"hasPermission"),o.jc(19,"clr-icon",37),o.cd(20),o.zc(21,"translate"),o.nc(),o.nc(),o.nc(),o.nc(),o.lc()}if(2&e){const e=o.yc().$implicit;o.Wb(3),o.Fc("ngIf",e.isPublic),o.Wb(1),o.Fc("ngIf",!e.isPublic),o.Wb(1),o.ed(" ",e.data.note," "),o.Wb(6),o.Fc("disabled",!o.Ac(12,7,"UpdateOrder")),o.Wb(3),o.ed(" ",o.Ac(15,9,"common.edit")," "),o.Wb(3),o.Fc("disabled",!o.Ac(18,11,"UpdateOrder")),o.Wb(3),o.ed(" ",o.Ac(21,13,"common.delete")," ")}}const pt=function(e){return["/marketing","promotions",e]};function mt(e,t){if(1&e&&(o.mc(0),o.cd(1),o.zc(2,"translate"),o.oc(3,"vdr-chip"),o.oc(4,"a",40),o.cd(5),o.nc(),o.nc(),o.lc()),2&e){const e=o.yc().$implicit;o.Wb(1),o.ed(" ",o.Ac(2,3,"order.history-coupon-code-applied"),": "),o.Wb(3),o.Fc("routerLink",o.Kc(5,pt,e.data.promotionId)),o.Wb(1),o.dd(e.data.couponCode)}}function bt(e,t){if(1&e&&(o.mc(0),o.cd(1),o.zc(2,"translate"),o.oc(3,"vdr-chip"),o.oc(4,"span",41),o.cd(5),o.nc(),o.nc(),o.lc()),2&e){const e=o.yc().$implicit;o.Wb(1),o.ed(" ",o.Ac(2,2,"order.history-coupon-code-removed"),": "),o.Wb(4),o.dd(e.data.couponCode)}}function gt(e,t){if(1&e&&(o.oc(0,"vdr-timeline-entry",13),o.mc(1,14),o.ad(2,Je,4,3,"ng-container",15),o.ad(3,ot,4,2,"ng-container",15),o.ad(4,it,3,8,"ng-container",15),o.ad(5,dt,4,7,"ng-container",15),o.ad(6,lt,7,8,"ng-container",15),o.ad(7,ft,22,15,"ng-container",15),o.ad(8,mt,6,7,"ng-container",15),o.ad(9,bt,6,4,"ng-container",15),o.lc(),o.nc()),2&e){const e=t.$implicit,c=o.yc();o.Fc("displayType",c.getDisplayType(e))("iconShape",c.getTimelineIcon(e))("createdAt",e.createdAt)("name",c.getName(e))("featured",c.isFeatured(e)),o.Wb(1),o.Fc("ngSwitch",e.type),o.Wb(1),o.Fc("ngSwitchCase",c.type.ORDER_STATE_TRANSITION),o.Wb(1),o.Fc("ngSwitchCase",c.type.ORDER_PAYMENT_TRANSITION),o.Wb(1),o.Fc("ngSwitchCase",c.type.ORDER_REFUND_TRANSITION),o.Wb(1),o.Fc("ngSwitchCase",c.type.ORDER_CANCELLATION),o.Wb(1),o.Fc("ngSwitchCase",c.type.ORDER_FULLFILLMENT),o.Wb(1),o.Fc("ngSwitchCase",c.type.ORDER_NOTE),o.Wb(1),o.Fc("ngSwitchCase",c.type.ORDER_COUPON_APPLIED),o.Wb(1),o.Fc("ngSwitchCase",c.type.ORDER_COUPON_REMOVED)}}const ht=function(e){return["./",e]};function yt(e,t){if(1&e&&(o.oc(0,"td",13),o.cd(1),o.nc(),o.oc(2,"td",13),o.jc(3,"vdr-customer-label",14),o.nc(),o.oc(4,"td",13),o.jc(5,"vdr-order-state-label",15),o.nc(),o.oc(6,"td",13),o.cd(7),o.zc(8,"currency"),o.nc(),o.oc(9,"td",13),o.cd(10),o.zc(11,"date"),o.nc(),o.oc(12,"td",16),o.jc(13,"vdr-table-row-action",17),o.zc(14,"translate"),o.nc()),2&e){const e=t.item;o.Wb(1),o.dd(e.code),o.Wb(2),o.Fc("customer",e.customer),o.Wb(2),o.Fc("state",e.state),o.Wb(2),o.dd(o.Bc(8,7,e.total/100,e.currencyCode)),o.Wb(3),o.dd(o.Bc(11,10,e.updatedAt,"medium")),o.Wb(3),o.Fc("label",o.Ac(14,13,"common.open"))("linkTo",o.Kc(15,ht,e.id))}}function Ot(e,t){if(1&e&&(o.oc(0,"vdr-labeled-data",10),o.zc(1,"translate"),o.cd(2),o.nc()),2&e){const e=o.yc().$implicit;o.Fc("label",o.Ac(1,2,"order.transaction-id")),o.Wb(2),o.ed(" ",e.transactionId," ")}}function vt(e,t){if(1&e&&(o.oc(0,"vdr-labeled-data",10),o.zc(1,"translate"),o.cd(2),o.nc()),2&e){const e=o.yc().$implicit;o.Fc("label",o.Ac(1,2,"order.refund-reason")),o.Wb(2),o.ed(" ",e.reason," ")}}function Ct(e,t){if(1&e&&(o.oc(0,"vdr-labeled-data",10),o.zc(1,"translate"),o.jc(2,"vdr-object-tree",12),o.nc()),2&e){const e=o.yc().$implicit;o.Fc("label",o.Ac(1,2,"order.refund-metadata")),o.Wb(2),o.Fc("value",e.metadata)}}function Ft(e,t){if(1&e){const e=o.pc();o.oc(0,"div",13),o.oc(1,"button",14),o.wc("click",(function(){o.Tc(e);const t=o.yc().$implicit;return o.yc().settleRefund.emit(t)})),o.cd(2),o.zc(3,"translate"),o.nc(),o.nc()}2&e&&(o.Wb(2),o.ed(" ",o.Ac(3,1,"order.settle-refund")," "))}function Wt(e,t){if(1&e&&(o.mc(0),o.oc(1,"div",1),o.jc(2,"clr-icon",8),o.cd(3),o.zc(4,"translate"),o.jc(5,"div",9),o.jc(6,"vdr-refund-state-label",3),o.nc(),o.oc(7,"div",4),o.oc(8,"vdr-labeled-data",10),o.zc(9,"translate"),o.cd(10),o.zc(11,"date"),o.nc(),o.oc(12,"vdr-labeled-data",10),o.zc(13,"translate"),o.cd(14),o.zc(15,"currency"),o.nc(),o.ad(16,Ot,3,4,"vdr-labeled-data",11),o.ad(17,vt,3,4,"vdr-labeled-data",11),o.ad(18,Ct,3,4,"vdr-labeled-data",11),o.nc(),o.ad(19,Ft,4,3,"div",7),o.lc()),2&e){const e=t.$implicit,c=o.yc();o.Wb(3),o.fd(" ",o.Ac(4,11,"order.refund")," #",e.id," "),o.Wb(3),o.Fc("state",e.state),o.Wb(2),o.Fc("label",o.Ac(9,13,"common.created-at")),o.Wb(2),o.ed(" ",o.Bc(11,15,e.createdAt,"medium")," "),o.Wb(2),o.Fc("label",o.Ac(13,18,"order.refund-total")),o.Wb(2),o.ed(" ",o.Bc(15,20,e.total/100,c.currencyCode)," "),o.Wb(2),o.Fc("ngIf",e.transactionId),o.Wb(1),o.Fc("ngIf",e.reason),o.Wb(1),o.Fc("ngIf",c.refundHasMetadata(e)),o.Wb(1),o.Fc("ngIf","Pending"===e.state)}}function jt(e,t){if(1&e){const e=o.pc();o.oc(0,"div",13),o.oc(1,"button",14),o.wc("click",(function(){o.Tc(e);const t=o.yc();return t.settlePayment.emit(t.payment)})),o.cd(2),o.zc(3,"translate"),o.nc(),o.nc()}2&e&&(o.Wb(2),o.ed(" ",o.Ac(3,1,"order.settle-payment")," "))}function Pt(e,t){if(1&e&&(o.oc(0,"div",3),o.jc(1,"div",4),o.jc(2,"clr-icon",5),o.oc(3,"div",6),o.cd(4),o.zc(5,"translate"),o.zc(6,"orderStateI18nToken"),o.nc(),o.nc()),2&e){const e=o.yc();o.Wb(4),o.ed(" ",o.Ac(5,1,o.Ac(6,3,e.cancelledState))," ")}}function Mt(e,t){if(1&e){const e=o.pc();o.mc(0),o.oc(1,"vdr-order-process-node",1),o.wc("mouseenter",(function(){o.Tc(e);const c=t.$implicit;return o.yc().onMouseOver(c.name)}))("mouseleave",(function(){return o.Tc(e),o.yc().onMouseOut()})),o.zc(2,"async"),o.nc(),o.lc()}if(2&e){const e=t.$implicit,c=t.index,n=o.yc();o.Wb(1),o.Fc("node",e)("index",c)("active",o.Ac(2,3,n.activeState$)===e.name)}}function It(e,t){if(1&e&&(o.mc(0),o.jc(1,"vdr-order-process-edge",2),o.lc()),2&e){const e=t.$implicit;o.Wb(1),o.Fc("from",e.from)("to",e.to)("index",e.index)}}function At(e,t){1&e&&o.jc(0,"clr-icon",2)}function wt(e,t){1&e&&o.jc(0,"clr-icon",2)}function zt(e,t){if(1&e&&(o.oc(0,"li",2),o.oc(1,"div",3),o.cd(2),o.nc(),o.jc(3,"clr-icon",4),o.cd(4),o.nc()),2&e){const e=t.$implicit;o.Fc("title",e.name),o.Wb(2),o.dd(e.quantity),o.Wb(2),o.ed(" ",e.name," ")}}let xt=class{constructor(e){this.i18nService=e,this.lineQuantities={},this.reasons=[Object(i.a)("order.cancel-reason-customer-request"),Object(i.a)("order.cancel-reason-not-available")],this.reasons=this.reasons.map(e=>this.i18nService.translate(e))}get selectionCount(){return Object.values(this.lineQuantities).reduce((e,t)=>e+t,0)}ngOnInit(){this.lineQuantities=this.order.lines.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.id]:0}),{})}select(){this.resolveWith({orderId:this.order.id,lines:this.getLineInputs(),reason:this.reason})}cancel(){this.resolveWith()}getLineInputs(){if(!this.order.active)return Object.entries(this.lineQuantities).map(([e,t])=>({orderLineId:e,quantity:t})).filter(e=>0<e.quantity)}};xt.\u0275fac=function(e){return new(e||xt)(o.ic(r.kb))},xt.\u0275cmp=o.cc({type:xt,selectors:[["vdr-cancel-order-dialog"]],decls:29,vars:22,consts:[["vdrDialogTitle",""],[1,"fulfillment-wrapper"],[1,"order-lines"],[1,"table"],["class","order-line",3,"is-cancelled",4,"ngFor","ngForOf"],[1,"cancellation-details"],[1,"clr-control-label"],["bindLabel","name","autofocus","","bindValue","id",3,"items","addTag","ngModel","ngModelChange"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[1,"align-middle","fulfil"],["type","number","min","0",3,"ngModel","max","ngModelChange",4,"ngIf","ngIfElse"],["nonEditable",""],["type","number","min","0",3,"ngModel","max","ngModelChange"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[4,"ngIf"]],template:function(e,t){1&e&&(o.ad(0,I,2,3,"ng-template",0),o.oc(1,"div",1),o.oc(2,"div",2),o.oc(3,"table",3),o.oc(4,"thead"),o.oc(5,"tr"),o.jc(6,"th"),o.oc(7,"th"),o.cd(8),o.zc(9,"translate"),o.nc(),o.oc(10,"th"),o.cd(11),o.zc(12,"translate"),o.nc(),o.oc(13,"th"),o.cd(14),o.zc(15,"translate"),o.nc(),o.oc(16,"th"),o.cd(17),o.zc(18,"translate"),o.nc(),o.oc(19,"th"),o.cd(20),o.zc(21,"translate"),o.nc(),o.nc(),o.nc(),o.ad(22,z,17,15,"tr",4),o.nc(),o.nc(),o.oc(23,"div",5),o.oc(24,"label",6),o.cd(25),o.zc(26,"translate"),o.nc(),o.oc(27,"ng-select",7),o.wc("ngModelChange",(function(e){return t.reason=e})),o.nc(),o.nc(),o.nc(),o.ad(28,_,6,6,"ng-template",8)),2&e&&(o.Wb(8),o.dd(o.Ac(9,10,"order.product-name")),o.Wb(3),o.dd(o.Ac(12,12,"order.product-sku")),o.Wb(3),o.dd(o.Ac(15,14,"order.quantity")),o.Wb(3),o.dd(o.Ac(18,16,"order.unit-price")),o.Wb(3),o.dd(o.Ac(21,18,"order.cancel")),o.Wb(2),o.Fc("ngForOf",t.order.lines),o.Wb(3),o.dd(o.Ac(26,20,"order.cancellation-reason")),o.Wb(2),o.Fc("items",t.reasons)("addTag",!0)("ngModel",t.reason))},directives:[r.Q,F.o,W.t,j.a,d.p,d.s,r.P,F.p,r.db,d.v,d.b],pipes:[P.d,r.q,F.d],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}.fulfillment-wrapper[_ngcontent-%COMP%]{flex:1}@media screen and (min-width:768px){.fulfillment-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}.fulfillment-wrapper[_ngcontent-%COMP%]   .cancellation-details[_ngcontent-%COMP%]{margin-top:0;margin-left:24px;width:250px}}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.fulfillment-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:#bfc3cc}.fulfillment-wrapper[_ngcontent-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:#f2f3f5}"],changeDetection:0}),xt.ctorParameters=()=>[{type:r.kb}],xt=Object(n.c)([Object(n.f)("design:paramtypes",[r.kb])],xt);let St=class{constructor(){this.method="",this.trackingCode="",this.fulfillmentQuantities={}}ngOnInit(){this.fulfillmentQuantities=this.order.lines.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.id]:this.getUnfulfilledCount(t)}),{}),this.order.shippingMethod&&(this.method=this.order.shippingMethod.description)}getUnfulfilledCount(e){const t=e.items.reduce((e,t)=>e+(t.fulfillment?1:0),0);return e.quantity-t}select(){const e=Object.entries(this.fulfillmentQuantities).map(([e,t])=>({orderLineId:e,quantity:t}));this.resolveWith({lines:e,trackingCode:this.trackingCode,method:this.method})}cancel(){this.resolveWith()}};St.\u0275fac=function(e){return new(e||St)},St.\u0275cmp=o.cc({type:St,selectors:[["vdr-fulfill-order-dialog"]],decls:40,vars:30,consts:[["vdrDialogTitle",""],[1,"fulfillment-wrapper"],[1,"order-lines"],[1,"table"],["class","order-line",3,"ignore",4,"ngFor","ngForOf"],[1,"shipping-details"],[3,"address"],["clrInput","","placeholder","","name","method","required","",3,"ngModel","ngModelChange"],["clrInput","","placeholder","","name","trackingCode",3,"ngModel","ngModelChange"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src",4,"ngIf"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[1,"align-middle","fulfil"],["type","number","min","0",3,"disabled","ngModel","max","ngModelChange"],[3,"src"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(o.ad(0,k,2,3,"ng-template",0),o.oc(1,"div",1),o.oc(2,"div",2),o.oc(3,"table",3),o.oc(4,"thead"),o.oc(5,"tr"),o.jc(6,"th"),o.oc(7,"th"),o.cd(8),o.zc(9,"translate"),o.nc(),o.oc(10,"th"),o.cd(11),o.zc(12,"translate"),o.nc(),o.oc(13,"th"),o.cd(14),o.zc(15,"translate"),o.nc(),o.oc(16,"th"),o.cd(17),o.zc(18,"translate"),o.nc(),o.nc(),o.nc(),o.ad(19,D,11,9,"tr",4),o.nc(),o.nc(),o.oc(20,"div",5),o.jc(21,"vdr-formatted-address",6),o.oc(22,"h6"),o.cd(23),o.zc(24,"translate"),o.nc(),o.cd(25),o.oc(26,"strong"),o.cd(27),o.zc(28,"currency"),o.nc(),o.oc(29,"clr-input-container"),o.oc(30,"label"),o.cd(31),o.zc(32,"translate"),o.nc(),o.oc(33,"input",7),o.wc("ngModelChange",(function(e){return t.method=e})),o.nc(),o.nc(),o.oc(34,"clr-input-container"),o.oc(35,"label"),o.cd(36),o.zc(37,"translate"),o.nc(),o.oc(38,"input",8),o.wc("ngModelChange",(function(e){return t.trackingCode=e})),o.nc(),o.nc(),o.nc(),o.nc(),o.ad(39,N,6,7,"ng-template",9)),2&e&&(o.Wb(8),o.dd(o.Ac(9,13,"order.product-name")),o.Wb(3),o.dd(o.Ac(12,15,"order.product-sku")),o.Wb(3),o.dd(o.Ac(15,17,"order.unfulfilled")),o.Wb(3),o.dd(o.Ac(18,19,"order.fulfill")),o.Wb(2),o.Fc("ngForOf",t.order.lines),o.Wb(2),o.Fc("address",t.order.shippingAddress),o.Wb(2),o.dd(o.Ac(24,21,"order.shipping-method")),o.Wb(2),o.ed(" ",null==t.order.shippingMethod?null:t.order.shippingMethod.description," "),o.Wb(2),o.dd(o.Bc(28,23,t.order.shipping/100,t.order.currencyCode)),o.Wb(4),o.dd(o.Ac(32,26,"order.fulfillment-method")),o.Wb(2),o.Fc("ngModel",t.method),o.Wb(3),o.dd(o.Ac(37,28,"order.tracking-code")),o.Wb(2),o.Fc("ngModel",t.trackingCode))},directives:[r.Q,F.o,r.fb,W.s,W.t,r.db,d.b,W.r,d.z,d.p,d.s,r.P,F.p,d.v],pipes:[P.d,F.d,r.q],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}.fulfillment-wrapper[_ngcontent-%COMP%]{flex:1}.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]{margin-top:24px}@media screen and (min-width:768px){.fulfillment-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]{margin-top:0;margin-left:24px;width:250px}}.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]   clr-input-container[_ngcontent-%COMP%]{margin-top:24px}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.fulfillment-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:#bfc3cc}"],changeDetection:0});let _t=class{get fulfillment(){return this.order.fulfillments&&this.order.fulfillments.find(e=>e.id===this.fulfillmentId)}get items(){const e=new Map;for(const t of this.order.lines)for(const c of t.items)if(c.fulfillment&&c.fulfillment.id===this.fulfillmentId){const c=e.get(t.productVariant.name);null!=c?e.set(t.productVariant.name,c+1):e.set(t.productVariant.name,1)}return Array.from(e.entries()).map(([e,t])=>({name:e,quantity:t}))}};_t.\u0275fac=function(e){return new(e||_t)},_t.\u0275cmp=o.cc({type:_t,selectors:[["vdr-fulfillment-detail"]],inputs:{fulfillmentId:"fulfillmentId",order:"order"},decls:11,vars:16,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"items"]],template:function(e,t){1&e&&(o.oc(0,"vdr-labeled-data",0),o.zc(1,"translate"),o.cd(2),o.zc(3,"date"),o.nc(),o.oc(4,"vdr-labeled-data",0),o.zc(5,"translate"),o.cd(6),o.nc(),o.ad(7,$,3,4,"vdr-labeled-data",1),o.oc(8,"vdr-labeled-data",0),o.zc(9,"translate"),o.jc(10,"vdr-simple-item-list",2),o.nc()),2&e&&(o.Fc("label",o.Ac(1,7,"common.created-at")),o.Wb(2),o.ed(" ",o.Bc(3,9,null==t.fulfillment?null:t.fulfillment.createdAt,"medium"),"\n"),o.Wb(2),o.Fc("label",o.Ac(5,12,"order.fulfillment-method")),o.Wb(2),o.ed(" ",null==t.fulfillment?null:t.fulfillment.method,"\n"),o.Wb(1),o.Fc("ngIf",null==t.fulfillment?null:t.fulfillment.trackingCode),o.Wb(1),o.Fc("label",o.Ac(9,14,"order.contents")),o.Wb(2),o.Fc("items",t.items))},directives:function(){return[r.sb,F.p,Yt]},pipes:function(){return[P.d,F.f]},styles:[""],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",String)],_t.prototype,"fulfillmentId",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Object)],_t.prototype,"order",void 0);let kt=class{constructor(){this.fulfilledCount=0,this.fulfillments=[]}ngOnChanges(e){this.line&&(this.fulfilledCount=this.getFulfilledCount(this.line),this.fulfillmentStatus=this.getFulfillmentStatus(this.fulfilledCount,this.line.items.length),this.fulfillments=this.getFulfillments(this.line))}getFulfilledCount(e){return e.items.reduce((e,t)=>e+(t.fulfillment?1:0),0)}getFulfillmentStatus(e,t){return e===t?"full":0<e&&e<t?"partial":"none"}getFulfillments(e){const t={};for(const n of e.items)n.fulfillment&&(void 0===t[n.fulfillment.id]?t[n.fulfillment.id]=1:t[n.fulfillment.id]++);const c=e.items.reduce((e,t)=>t.fulfillment?[...e,t.fulfillment]:e,[]);return Object.entries(t).map(([e,t])=>({count:t,fulfillment:c.find(t=>t.id===e)}))}};kt.\u0275fac=function(e){return new(e||kt)},kt.\u0275cmp=o.cc({type:kt,selectors:[["vdr-line-fulfillment"]],inputs:{line:"line",orderState:"orderState"},features:[o.Ub],decls:1,vars:1,consts:[["class","search-settings-menu",4,"ngIf"],[1,"search-settings-menu"],["type","button","vdrDropdownTrigger","",1,"icon-button"],["class","item-fulfilled","shape","check-circle",4,"ngIf"],["class","item-partially-fulfilled","shape","check-circle",4,"ngIf"],["class","item-not-fulfilled","shape","exclamation-circle",4,"ngIf"],["vdrPosition","bottom-right"],["class","dropdown-header",4,"ngIf"],["class","fulfillment-detail",4,"ngFor","ngForOf"],["shape","check-circle",1,"item-fulfilled"],["shape","check-circle",1,"item-partially-fulfilled"],["shape","exclamation-circle",1,"item-not-fulfilled"],[1,"dropdown-header"],[1,"fulfillment-detail"],[1,"fulfillment-title"],[3,"label"],[3,"label",4,"ngIf"]],template:function(e,t){1&e&&o.ad(0,G,10,7,"vdr-dropdown",0),2&e&&o.Fc("ngIf",t.fulfilledCount||"PartiallyFulfilled"===t.orderState)},directives:[F.p,r.S,r.V,r.U,F.o,W.o,W.t,r.sb],pipes:[P.d,F.f],styles:[".item-fulfilled[_ngcontent-%COMP%]{color:#308300}.item-partially-fulfilled[_ngcontent-%COMP%]{color:#ff9f07}.item-not-fulfilled[_ngcontent-%COMP%]{color:#c92100}.fulfillment-detail[_ngcontent-%COMP%]{margin:6px 12px}.fulfillment-detail[_ngcontent-%COMP%]:not(:last-of-type){border-bottom:1px dashed #bfc3cc}"],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Object)],kt.prototype,"line",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",String)],kt.prototype,"orderState",void 0);let Tt=class{getRefundedCount(){return this.line.items.filter(e=>null!=e.refundId&&!e.cancelled).length}};Tt.\u0275fac=function(e){return new(e||Tt)},Tt.\u0275cmp=o.cc({type:Tt,selectors:[["vdr-line-refunds"]],inputs:{line:"line"},decls:1,vars:1,consts:[[3,"title",4,"ngIf"],[3,"title"],["shape","redo","dir","down",1,"is-solid"]],template:function(e,t){1&e&&o.ad(0,Z,3,6,"span",0),2&e&&o.Fc("ngIf",t.getRefundedCount())},directives:[F.p,W.o,M.b],pipes:[P.d],styles:["[_nghost-%COMP%]{color:#c92100}"],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Object)],Tt.prototype,"line",void 0);let Dt=class{constructor(e){this.formBuilder=e,this.customFieldsConfig=[],this.customFieldValues={},this.updateClick=new o.u,this.editable=!1}ngOnInit(){this.customFieldForm=this.formBuilder.group({});for(const e of this.customFieldsConfig)this.customFieldForm.addControl(e.name,this.formBuilder.control(this.customFieldValues[e.name]))}onUpdateClick(){this.updateClick.emit(this.customFieldForm.value),this.customFieldForm.markAsPristine(),this.editable=!1}};Dt.\u0275fac=function(e){return new(e||Dt)(o.ic(d.e))},Dt.\u0275cmp=o.cc({type:Dt,selectors:[["vdr-order-custom-fields-card"]],inputs:{customFieldsConfig:"customFieldsConfig",customFieldValues:"customFieldValues"},outputs:{updateClick:"updateClick"},decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text","custom-field-form"],[4,"ngFor","ngForOf"],[1,"card-footer"],["class","btn btn-sm btn-secondary",3,"click",4,"ngIf"],["class","btn btn-sm btn-primary",3,"disabled","click",4,"ngIf"],["entityName","Order",3,"customFieldsFormGroup","compact","readonly","customField"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","pencil"],[1,"btn","btn-sm","btn-primary",3,"disabled","click"],["shape","check"]],template:function(e,t){1&e&&o.ad(0,ee,10,8,"div",0),2&e&&o.Fc("ngIf",t.customFieldsConfig.length)},directives:[F.p,F.o,r.H,W.o],pipes:[P.d],styles:["vdr-custom-field-control[_ngcontent-%COMP%]{margin-bottom:6px;display:block}.custom-field-form[_ngcontent-%COMP%]     .clr-control-label{color:#97979a}.custom-field-form.editable[_ngcontent-%COMP%]     .clr-control-label{color:inherit}"],changeDetection:0}),Dt.ctorParameters=()=>[{type:d.e}],Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Array)],Dt.prototype,"customFieldsConfig",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Object)],Dt.prototype,"customFieldValues",void 0),Object(n.c)([Object(o.O)(),Object(n.f)("design:type",Object)],Dt.prototype,"updateClick",void 0),Dt=Object(n.c)([Object(n.f)("design:paramtypes",[d.e])],Dt);let Nt=class{constructor(e){this.serverConfigService=e,this.states=[]}ngOnInit(){this.states=this.serverConfigService.getOrderProcessStates()}};Nt.\u0275fac=function(e){return new(e||Nt)(o.ic(r.Gb))},Nt.\u0275cmp=o.cc({type:Nt,selectors:[["vdr-order-process-graph-dialog"]],decls:2,vars:2,consts:[["vdrDialogTitle",""],[3,"states","initialState"]],template:function(e,t){1&e&&(o.ad(0,te,2,3,"ng-template",0),o.jc(1,"vdr-order-process-graph",1)),2&e&&(o.Wb(1),o.Fc("states",t.states)("initialState",t.activeState))},directives:function(){return[r.Q,Kt]},pipes:function(){return[P.d]},styles:[""],changeDetection:0}),Nt.ctorParameters=()=>[{type:r.Gb}],Nt=Object(n.c)([Object(n.f)("design:paramtypes",[r.Gb])],Nt);let $t=class{constructor(e){this.i18nService=e,this.lineQuantities={},this.refundShipping=!1,this.adjustment=0,this.reasons=[Object(i.a)("order.refund-reason-customer-request"),Object(i.a)("order.refund-reason-not-available")],this.reasons=this.reasons.map(e=>this.i18nService.translate(e))}get refundTotal(){return this.order.lines.reduce((e,t)=>e+t.unitPriceWithTax*(this.lineQuantities[t.id].quantity||0),0)+(this.refundShipping?this.order.shipping:0)+this.adjustment}lineCanBeRefunded(e){return 0<e.items.filter(e=>null==e.refundId&&!e.cancelled).length}ngOnInit(){this.lineQuantities=this.order.lines.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.id]:{quantity:0,cancel:!1}}),{}),this.settledPayments=(this.order.payments||[]).filter(e=>"Settled"===e.state),this.settledPayments.length&&(this.selectedPayment=this.settledPayments[0])}select(){const e=this.selectedPayment;if(e){const t=Object.entries(this.lineQuantities).map(([e,t])=>({orderLineId:e,quantity:t.quantity})).filter(e=>0<e.quantity),c=Object.entries(this.lineQuantities).filter(([e,t])=>t.cancel).map(([e,t])=>({orderLineId:e,quantity:t.quantity}));this.resolveWith({lines:t,cancel:c,reason:this.reason,shipping:this.refundShipping?this.order.shipping:0,adjustment:this.adjustment,paymentId:e.id})}}cancel(){this.resolveWith()}};$t.\u0275fac=function(e){return new(e||$t)(o.ic(r.kb))},$t.\u0275cmp=o.cc({type:$t,selectors:[["vdr-refund-order-dialog"]],decls:60,vars:61,consts:[["vdrDialogTitle",""],[1,"fulfillment-wrapper"],[1,"order-lines"],[1,"table"],["class","order-line",4,"ngFor","ngForOf"],[1,"refund-details"],[1,"clr-control-label"],["bindLabel","name","autofocus","","bindValue","id",3,"items","placeholder","addTag","ngModel","ngModelChange"],["clrSelect","","name","options",3,"ngModel","ngModelChange"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],["clrInput","",3,"currencyCode","ngModel","ngModelChange"],[1,"totals"],[1,"order-total"],[1,"refund-total"],["class","refund-total-error",4,"ngIf"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[3,"line"],[1,"align-middle","fulfil"],["type","number","min","0",3,"ngModel","max","ngModelChange",4,"ngIf"],[1,"align-middle"],[1,"cancel-checkbox-wrapper"],["type","checkbox","clrCheckbox","",3,"disabled","ngModel","ngModelChange",4,"ngIf"],["type","number","min","0",3,"ngModel","max","ngModelChange"],["type","checkbox","clrCheckbox","",3,"disabled","ngModel","ngModelChange"],[3,"ngValue","disabled"],[1,"refund-total-error"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(o.ad(0,ce,2,3,"ng-template",0),o.oc(1,"div",1),o.oc(2,"div",2),o.oc(3,"table",3),o.oc(4,"thead"),o.oc(5,"tr"),o.jc(6,"th"),o.oc(7,"th"),o.cd(8),o.zc(9,"translate"),o.nc(),o.oc(10,"th"),o.cd(11),o.zc(12,"translate"),o.nc(),o.oc(13,"th"),o.cd(14),o.zc(15,"translate"),o.nc(),o.oc(16,"th"),o.cd(17),o.zc(18,"translate"),o.nc(),o.oc(19,"th"),o.cd(20),o.zc(21,"translate"),o.nc(),o.oc(22,"th"),o.cd(23),o.zc(24,"translate"),o.nc(),o.nc(),o.nc(),o.ad(25,ie,19,14,"tr",4),o.nc(),o.nc(),o.oc(26,"div",5),o.oc(27,"label",6),o.cd(28),o.zc(29,"translate"),o.nc(),o.oc(30,"ng-select",7),o.wc("ngModelChange",(function(e){return t.reason=e})),o.zc(31,"translate"),o.nc(),o.oc(32,"clr-select-container"),o.oc(33,"label"),o.cd(34),o.zc(35,"translate"),o.nc(),o.oc(36,"select",8),o.wc("ngModelChange",(function(e){return t.selectedPayment=e})),o.ad(37,re,3,8,"option",9),o.nc(),o.nc(),o.oc(38,"clr-checkbox-wrapper"),o.oc(39,"input",10),o.wc("ngModelChange",(function(e){return t.refundShipping=e})),o.nc(),o.oc(40,"label"),o.cd(41),o.zc(42,"translate"),o.zc(43,"currency"),o.nc(),o.nc(),o.oc(44,"clr-input-container"),o.oc(45,"label"),o.cd(46),o.zc(47,"translate"),o.nc(),o.oc(48,"vdr-currency-input",11),o.wc("ngModelChange",(function(e){return t.adjustment=e})),o.nc(),o.nc(),o.oc(49,"div",12),o.oc(50,"div",13),o.cd(51),o.zc(52,"translate"),o.zc(53,"currency"),o.nc(),o.oc(54,"div",14),o.cd(55),o.zc(56,"translate"),o.zc(57,"currency"),o.nc(),o.ad(58,ae,5,13,"div",15),o.nc(),o.nc(),o.nc(),o.ad(59,se,7,13,"ng-template",16)),2&e&&(o.Wb(8),o.dd(o.Ac(9,26,"order.product-name")),o.Wb(3),o.dd(o.Ac(12,28,"order.product-sku")),o.Wb(3),o.dd(o.Ac(15,30,"order.quantity")),o.Wb(3),o.dd(o.Ac(18,32,"order.unit-price")),o.Wb(3),o.dd(o.Ac(21,34,"order.refund")),o.Wb(3),o.dd(o.Ac(24,36,"order.return-to-stock")),o.Wb(2),o.Fc("ngForOf",t.order.lines),o.Wb(3),o.dd(o.Ac(29,38,"order.refund-reason")),o.Wb(2),o.Fc("items",t.reasons)("placeholder",o.Ac(31,40,"order.refund-reason-required"))("addTag",!0)("ngModel",t.reason),o.Wb(4),o.dd(o.Ac(35,42,"order.payment-to-refund")),o.Wb(2),o.Fc("ngModel",t.selectedPayment),o.Wb(1),o.Fc("ngForOf",t.settledPayments),o.Wb(2),o.Fc("ngModel",t.refundShipping),o.Wb(2),o.fd(" ",o.Ac(42,44,"order.refund-shipping")," (",o.Bc(43,46,t.order.shipping/100,t.order.currencyCode),") "),o.Wb(5),o.dd(o.Ac(47,49,"order.refund-adjustment")),o.Wb(2),o.Fc("currencyCode",t.order.currencyCode)("ngModel",t.adjustment),o.Wb(3),o.fd(" ",o.Ac(52,51,"order.payment-amount"),": ",o.Bc(53,53,t.selectedPayment.amount/100,t.order.currencyCode)," "),o.Wb(4),o.fd(" ",o.Ac(56,56,"order.refund-total"),": ",o.Bc(57,58,t.refundTotal/100,t.order.currencyCode)," "),o.Wb(3),o.Fc("ngIf",t.refundTotal<0||t.selectedPayment.amount<t.refundTotal))},directives:[r.Q,F.o,W.t,j.a,d.p,d.s,W.A,r.db,d.A,W.z,W.k,d.a,W.i,W.s,r.F,W.r,F.p,r.P,Tt,d.v,d.b,d.u,d.D],pipes:[P.d,F.d,r.q],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}.fulfillment-wrapper[_ngcontent-%COMP%]{flex:1}@media screen and (min-width:768px){.fulfillment-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}.fulfillment-wrapper[_ngcontent-%COMP%]   .refund-details[_ngcontent-%COMP%]{margin-top:0;margin-left:24px;width:250px}}.fulfillment-wrapper[_ngcontent-%COMP%]   .refund-details[_ngcontent-%COMP%]   clr-select-container[_ngcontent-%COMP%]{margin:12px 0}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.fulfillment-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:#bfc3cc}.cancel-checkbox-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}clr-checkbox-wrapper[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px;display:block}.totals[_ngcontent-%COMP%]{margin-top:48px}.totals[_ngcontent-%COMP%]   .refund-total[_ngcontent-%COMP%]{font-size:18px}.totals[_ngcontent-%COMP%]   .refund-total-error[_ngcontent-%COMP%]{color:#c92100}"],changeDetection:0}),$t.ctorParameters=()=>[{type:r.kb}],$t=Object(n.c)([Object(n.f)("design:paramtypes",[r.kb])],$t);let Rt=class{constructor(){this.transactionId=""}submit(){this.resolveWith(this.transactionId)}cancel(){this.resolveWith()}};Rt.\u0275fac=function(e){return new(e||Rt)},Rt.\u0275cmp=o.cc({type:Rt,selectors:[["vdr-settle-refund-dialog"]],decls:10,vars:10,consts:[["vdrDialogTitle",""],[1,"instruction"],["clrInput","","name","transactionId",3,"ngModel","ngModelChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(o.ad(0,ue,2,3,"ng-template",0),o.oc(1,"p",1),o.cd(2),o.zc(3,"translate"),o.nc(),o.oc(4,"clr-input-container"),o.oc(5,"label"),o.cd(6),o.zc(7,"translate"),o.nc(),o.oc(8,"input",2),o.wc("ngModelChange",(function(e){return t.transactionId=e})),o.nc(),o.nc(),o.ad(9,fe,6,7,"ng-template",3)),2&e&&(o.Wb(2),o.ed(" ",o.Bc(3,3,"order.settle-refund-manual-instructions",o.Kc(8,pe,t.refund.method)),"\n"),o.Wb(4),o.dd(o.Ac(7,6,"order.transaction-id")),o.Wb(2),o.Fc("ngModel",t.transactionId))},directives:[r.Q,W.s,W.t,r.db,d.b,W.r,d.p,d.s,r.P],pipes:[P.d],styles:["[_nghost-%COMP%]{padding-bottom:32px}.instruction[_ngcontent-%COMP%]{margin-top:0;margin-bottom:24px}"],changeDetection:0});let Lt=class extends r.u{constructor(e,t,c,n,o,i,r){super(t,e,c,o),this.changeDetector=n,this.dataService=o,this.notificationService=i,this.modalService=r,this.detailForm=new d.i({}),this.fetchHistory=new s.a,this.orderLineCustomFieldsVisible=!1,this.defaultStates=["AddingItems","ArrangingPayment","PaymentAuthorized","PaymentSettled","PartiallyFulfilled","Fulfilled","Cancelled"]}get visibleOrderLineCustomFields(){return this.orderLineCustomFieldsVisible?this.orderLineCustomFields:[]}get showElided(){return!this.orderLineCustomFieldsVisible&&0<this.orderLineCustomFields.length}ngOnInit(){this.init(),this.customFields=this.getCustomFieldConfig("Order"),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.orderLineCustomFieldsVisible=this.orderLineCustomFields.length<2,this.history$=this.fetchHistory.pipe(Object(b.a)(null),Object(g.a)(()=>this.dataService.order.getOrderHistory(this.id,{sort:{createdAt:r.Ib.DESC}}).mapStream(e=>{var t;return null===(t=e.order)||void 0===t?void 0:t.history.items}))),this.nextStates$=this.entity$.pipe(Object(h.a)(e=>!this.defaultStates.includes(e.state)?e.nextStates:e.nextStates.filter(e=>!this.defaultStates.includes(e))))}ngOnDestroy(){this.destroy()}toggleOrderLineCustomFields(){this.orderLineCustomFieldsVisible=!this.orderLineCustomFieldsVisible}getLinePromotions(e){return e.adjustments.filter(e=>e.type===r.g.PROMOTION)}getPromotionLink(e){return["/marketing","promotions",e.adjustmentSource.split(":")[1]]}openStateDiagram(){this.entity$.pipe(Object(y.a)(1),Object(g.a)(e=>this.modalService.fromComponent(Nt,{closable:!0,locals:{activeState:e.state}}))).subscribe()}transitionToState(e){this.dataService.order.transitionToState(this.id,e).subscribe(t=>{this.notificationService.success(Object(i.a)("order.transitioned-to-state-success"),{state:e}),this.fetchHistory.next()})}updateCustomFields(e){this.dataService.order.updateOrderCustomFields({id:this.id,customFields:e}).subscribe(()=>{this.notificationService.success(Object(i.a)("common.notify-update-success"),{entity:"Order"})})}getCouponCodeForAdjustment(e,t){const c=t.adjustmentSource.split(":")[1],n=e.promotions.find(e=>e.id===c);if(n)return n.couponCode||void 0}getOrderAddressLines(e){return e?Object.values(e).filter(e=>"OrderAddress"!==e).filter(e=>!!e):[]}settlePayment(e){this.dataService.order.settlePayment(e.id).subscribe(({settlePayment:e})=>{e&&("Settled"===e.state?this.notificationService.success(Object(i.a)("order.settle-payment-success")):this.notificationService.error(Object(i.a)("order.settle-payment-error")),this.dataService.order.getOrder(this.id).single$.subscribe(),this.fetchHistory.next())})}fulfillOrder(){this.entity$.pipe(Object(y.a)(1),Object(g.a)(e=>this.modalService.fromComponent(St,{size:"xl",locals:{order:e}})),Object(g.a)(e=>e?this.dataService.order.createFullfillment(e):Object(u.a)(void 0)),Object(g.a)(e=>this.refetchOrder(e))).subscribe(e=>{e&&this.notificationService.success(Object(i.a)("order.create-fulfillment-success"))})}cancelOrRefund(e){"PaymentAuthorized"===e.state||!0===e.active?this.cancelOrder(e):this.refundOrder(e)}settleRefund(e){this.modalService.fromComponent(Rt,{size:"md",locals:{refund:e}}).pipe(Object(g.a)(t=>t?this.dataService.order.settleRefund({transactionId:t,id:e.id},this.id):Object(u.a)(void 0))).subscribe(e=>{e&&this.notificationService.success(Object(i.a)("order.settle-refund-success"))})}addNote(e){const{note:t,isPublic:c}=e;this.dataService.order.addNoteToOrder({id:this.id,note:t,isPublic:c}).pipe(Object(g.a)(e=>this.refetchOrder(e))).subscribe(e=>{this.notificationService.success(Object(i.a)("common.notify-create-success"),{entity:"Note"})})}updateNote(e){this.modalService.fromComponent(r.X,{closable:!0,locals:{displayPrivacyControls:!0,note:e.data.note,noteIsPrivate:!e.isPublic}}).pipe(Object(g.a)(t=>t?this.dataService.order.updateOrderNote({noteId:e.id,isPublic:!t.isPrivate,note:t.note}):f.a)).subscribe(e=>{this.fetchHistory.next(),this.notificationService.success(Object(i.a)("common.notify-update-success"),{entity:"Note"})})}deleteNote(e){return this.modalService.dialog({title:Object(i.a)("common.confirm-delete-note"),body:e.data.note,buttons:[{type:"secondary",label:Object(i.a)("common.cancel")},{type:"danger",label:Object(i.a)("common.delete"),returnValue:!0}]}).pipe(Object(g.a)(t=>t?this.dataService.order.deleteOrderNote(e.id):f.a)).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success(Object(i.a)("common.notify-delete-success"),{entity:"Note"})})}cancelOrder(e){this.modalService.fromComponent(xt,{size:"xl",locals:{order:e}}).pipe(Object(g.a)(e=>e?this.dataService.order.cancelOrder(e):Object(u.a)(void 0)),Object(g.a)(e=>this.refetchOrder(e))).subscribe(e=>{e&&this.notificationService.success(Object(i.a)("order.cancelled-order-success"))})}refundOrder(e){this.modalService.fromComponent($t,{size:"xl",locals:{order:e}}).pipe(Object(g.a)(e=>e?this.dataService.order.refundOrder(Object(l.omit)(e,["cancel"])).pipe(Object(g.a)(t=>e.cancel.length?this.dataService.order.cancelOrder({orderId:this.id,lines:e.cancel,reason:e.reason}):Object(u.a)(t))):Object(u.a)(void 0)),Object(g.a)(e=>this.refetchOrder(e))).subscribe(e=>{e&&this.notificationService.success(Object(i.a)("order.refund-order-success"))})}refetchOrder(e){return this.fetchHistory.next(),e?this.dataService.order.getOrder(this.id).single$:Object(u.a)(void 0)}setFormValues(e){}};Lt.\u0275fac=function(e){return new(e||Lt)(o.ic(a.e),o.ic(a.a),o.ic(r.Gb),o.ic(o.k),o.ic(r.K),o.ic(r.yb),o.ic(r.xb))},Lt.\u0275cmp=o.cc({type:Lt,selectors:[["vdr-order-detail"]],features:[o.Tb],decls:4,vars:6,consts:[[4,"ngIf"],[1,"flex","clr-align-items-center"],[3,"entity"],[3,"state"],[1,"icon-button",3,"title","click"],["shape","list"],["locationId","order-detail"],[1,"btn","btn-primary",3,"disabled","click"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","class","btn","vdrDropdownItem","",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["type","button","vdrDropdownItem","",1,"btn",3,"click"],["shape","error-standard",1,"is-error"],[4,"ngIf","ngIfElse"],["cancelOnly",""],[1,"dropdown-divider"],["shape","step-forward-2"],[1,"clr-row"],[1,"clr-col-lg-8"],[1,"order-lines","table"],["class","order-line",3,"is-cancelled",4,"ngFor","ngForOf"],[1,"sub-total"],[1,"left","clr-align-middle"],[1,"clr-align-middle"],[1,"net-price",3,"title"],["class","order-ajustment",4,"ngFor","ngForOf"],[1,"shipping"],[1,"total"],[3,"order","history","addNote","updateNote","deleteNote"],[1,"clr-col-lg-4","order-cards"],[3,"customFieldsConfig","customFieldValues","updateClick"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text"],[3,"customer"],[3,"address"],[1,"order-line-custom-field"],[1,"custom-field-header-button",3,"title","click"],["shape","ellipsis-horizontal",1,"custom-field-ellipsis"],[1,"order-line"],[1,"align-middle","thumb"],[3,"src",4,"ngIf"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","unit-price"],[1,"align-middle","quantity"],[3,"line"],[3,"line","orderState"],[1,"align-middle","total"],[3,"src"],[1,"order-line-custom-field","align-middle"],[3,"ngSwitch"],[3,"ngSwitchCase"],["ngSwitchDefault",""],[3,"title"],[3,"ngIf"],["shape","check"],["shape","times"],["vdrDropdownTrigger","",1,"promotions-label"],["class","line-promotion",4,"ngFor","ngForOf"],[1,"line-promotion"],[1,"promotion-name",3,"routerLink"],[1,"promotion-amount"],[1,"order-ajustment"],[3,"routerLink"],[3,"currencyCode","payment","settlePayment","settleRefund",4,"ngFor","ngForOf"],[3,"currencyCode","payment","settlePayment","settleRefund"],["class","fulfillment-detail",4,"ngFor","ngForOf"],[1,"fulfillment-detail"],[3,"fulfillmentId","order"]],template:function(e,t){1&e&&(o.ad(0,Oe,21,15,"vdr-action-bar",0),o.zc(1,"async"),o.ad(2,Ue,86,84,"div",0),o.zc(3,"async")),2&e&&(o.Fc("ngIf",o.Ac(1,2,t.entity$)),o.Wb(2),o.Fc("ngIf",o.Ac(3,4,t.entity$)))},directives:function(){return[F.p,r.c,r.e,r.Z,r.Bb,W.o,r.f,r.d,r.S,r.V,r.U,F.o,r.T,Et,Dt,r.J,r.fb,Tt,kt,F.r,F.s,F.t,a.h,r.B,qt,_t]},pipes:function(){return[F.b,P.d,F.d,r.I,r.q,F.f]},styles:[".shipping-address[_ngcontent-%COMP%]{list-style-type:none;line-height:1.3em}.order-lines[_ngcontent-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:#f2f3f5}.order-lines[_ngcontent-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed #bfc3cc}.order-lines[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;border-top:1px dashed #bfc3cc}.custom-field-header-button[_ngcontent-%COMP%]{background:0 0;margin:0;padding:0;border:none;cursor:pointer;color:#137fac}.order-line-custom-field[_ngcontent-%COMP%]{background-color:#fafafa}.order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:#bfc3cc}.net-price[_ngcontent-%COMP%]{font-size:11px;color:#97979a}.promotions-label[_ngcontent-%COMP%]{-webkit-text-decoration:underline dotted #bfc3cc;text-decoration:underline dotted #bfc3cc;font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}.line-promotion[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:6px 12px}.line-promotion[_ngcontent-%COMP%]   .promotion-amount[_ngcontent-%COMP%]{margin-left:12px}.order-cards[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-top:6px;color:#525456}.fulfillment-detail[_ngcontent-%COMP%]:not(:last-of-type){border-bottom:1px dashed #bfc3cc;margin-bottom:12px}"],changeDetection:0}),Lt.ctorParameters=()=>[{type:a.e},{type:a.a},{type:r.Gb},{type:o.k},{type:r.K},{type:r.yb},{type:r.xb}],Lt=Object(n.c)([Object(n.f)("design:paramtypes",[a.e,a.a,r.Gb,o.k,r.K,r.yb,r.xb])],Lt);let Et=class{constructor(){this.addNote=new o.u,this.updateNote=new o.u,this.deleteNote=new o.u,this.note="",this.noteIsPrivate=!0,this.type=r.jb}getDisplayType(e){if(e.type===r.jb.ORDER_STATE_TRANSITION){if("Fulfilled"===e.data.to)return"success";if("Cancelled"===e.data.to)return"error"}return e.type===r.jb.ORDER_PAYMENT_TRANSITION&&"Declined"===e.data.to?"error":e.type===r.jb.ORDER_CANCELLATION?"error":e.type===r.jb.ORDER_REFUND_TRANSITION?"warning":"default"}getTimelineIcon(e){if(e.type===r.jb.ORDER_STATE_TRANSITION){if("Fulfilled"===e.data.to)return["success-standard","is-solid"];if("Cancelled"===e.data.to)return"ban"}return e.type===r.jb.ORDER_PAYMENT_TRANSITION&&"Settled"===e.data.to?"credit-card":e.type===r.jb.ORDER_NOTE?"note":e.type===r.jb.ORDER_FULLFILLMENT?"truck":void 0}isFeatured(e){switch(e.type){case r.jb.ORDER_STATE_TRANSITION:return"Fulfilled"===e.data.to||"Cancelled"===e.data.to||"Settled"===e.data.to;case r.jb.ORDER_PAYMENT_TRANSITION:return"Settled"===e.data.to;case r.jb.ORDER_FULLFILLMENT:case r.jb.ORDER_NOTE:return!0;default:return!1}}getFullfillment(e){if(e.type===r.jb.ORDER_FULLFILLMENT&&this.order.fulfillments)return this.order.fulfillments.find(t=>t.id===e.data.fulfillmentId)}getPayment(e){if(e.type===r.jb.ORDER_PAYMENT_TRANSITION&&this.order.payments)return this.order.payments.find(t=>t.id===e.data.paymentId)}getCancelledItems(e){const t=new Map,c=e.data.orderItemIds;for(const n of this.order.lines)for(const e of n.items)if(c.includes(e.id)){const e=t.get(n.productVariant.name);null!=e?t.set(n.productVariant.name,e+1):t.set(n.productVariant.name,1)}return Array.from(t.entries()).map(([e,t])=>({name:e,quantity:t}))}getName(e){const{administrator:t}=e;if(t)return`${t.firstName} ${t.lastName}`;{const e=this.order.customer;if(e)return`${e.firstName} ${e.lastName}`}return""}addNoteToOrder(){this.addNote.emit({note:this.note,isPublic:!this.noteIsPrivate}),this.note="",this.noteIsPrivate=!0}};Et.\u0275fac=function(e){return new(e||Et)},Et.\u0275cmp=o.cc({type:Et,selectors:[["vdr-order-history"]],inputs:{order:"order",history:"history"},outputs:{addNote:"addNote",updateNote:"updateNote",deleteNote:"deleteNote"},decls:20,vars:16,consts:[[1,"entry-list"],["iconShape","note","displayType","muted"],[1,"note-entry"],["name","note",1,"note",3,"ngModel","ngModelChange"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"visibility-select"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],["class","private",4,"ngIf"],["class","public",4,"ngIf"],[3,"displayType","iconShape","createdAt","name","featured",4,"ngFor","ngForOf"],[3,"isLast"],[1,"private"],[1,"public"],[3,"displayType","iconShape","createdAt","name","featured"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","title",4,"ngIf"],[3,"ngIf"],[1,"title"],[4,"ngIf","ngIfElse"],["regularPaymentTransition",""],[4,"ngIf"],[3,"payment","currencyCode"],[3,"label"],[3,"items"],[3,"fulfillmentId","order"],[1,"flex"],[1,"note-text"],["class","note-visibility public",4,"ngIf"],["class","note-visibility private",4,"ngIf"],[1,"flex-spacer"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","edit"],[1,"dropdown-divider"],["shape","trash",1,"is-danger"],[1,"note-visibility","public"],[1,"note-visibility","private"],[3,"routerLink"],[1,"cancelled-coupon-code"]],template:function(e,t){1&e&&(o.oc(0,"h4"),o.cd(1),o.zc(2,"translate"),o.nc(),o.oc(3,"div",0),o.oc(4,"vdr-timeline-entry",1),o.oc(5,"div",2),o.oc(6,"textarea",3),o.wc("ngModelChange",(function(e){return t.note=e})),o.nc(),o.oc(7,"button",4),o.wc("click",(function(){return t.addNoteToOrder()})),o.cd(8),o.zc(9,"translate"),o.nc(),o.nc(),o.oc(10,"div",5),o.oc(11,"clr-checkbox-wrapper"),o.oc(12,"input",6),o.wc("ngModelChange",(function(e){return t.noteIsPrivate=e})),o.nc(),o.oc(13,"label"),o.cd(14),o.zc(15,"translate"),o.nc(),o.nc(),o.ad(16,Ke,3,3,"span",7),o.ad(17,He,3,3,"span",8),o.nc(),o.nc(),o.ad(18,gt,10,14,"vdr-timeline-entry",9),o.jc(19,"vdr-timeline-entry",10),o.nc()),2&e&&(o.Wb(1),o.dd(o.Ac(2,10,"order.order-history")),o.Wb(5),o.Fc("ngModel",t.note),o.Wb(1),o.Fc("disabled",!t.note),o.Wb(1),o.ed(" ",o.Ac(9,12,"common.add-note")," "),o.Wb(4),o.Fc("ngModel",t.noteIsPrivate),o.Wb(2),o.dd(o.Ac(15,14,"order.note-is-private")),o.Wb(2),o.Fc("ngIf",t.noteIsPrivate),o.Wb(1),o.Fc("ngIf",!t.noteIsPrivate),o.Wb(1),o.Fc("ngForOf",t.history),o.Wb(1),o.Fc("isLast",!0))},directives:function(){return[r.Nb,r.db,d.b,d.p,d.s,W.k,d.a,W.i,W.t,F.p,F.o,F.r,F.s,r.ib,Ht,r.sb,Yt,_t,r.S,r.V,W.o,r.U,r.T,r.B,a.h]},pipes:function(){return[P.d,r.gb]},styles:["[_nghost-%COMP%]{margin-top:48px;display:block}.entry-list[_ngcontent-%COMP%]{margin-top:24px;margin-left:24px;margin-right:12px}.note-entry[_ngcontent-%COMP%]{display:flex;align-items:center}.note-entry[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{flex:1}.note-entry[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}.visibility-select[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline}.visibility-select[_ngcontent-%COMP%]   .public[_ngcontent-%COMP%]{color:#ff9f07}.visibility-select[_ngcontent-%COMP%]   .private[_ngcontent-%COMP%]{color:#308300}textarea.note[_ngcontent-%COMP%]{flex:1;height:36px;border-radius:3px;margin-right:6px}.note-text[_ngcontent-%COMP%]{color:#202223;white-space:pre-wrap}.cancelled-coupon-code[_ngcontent-%COMP%]{text-decoration:line-through}.note-visibility[_ngcontent-%COMP%]{text-transform:lowercase}.note-visibility.public[_ngcontent-%COMP%]{color:#ff9f07}.note-visibility.private[_ngcontent-%COMP%]{color:#308300}"],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Object)],Et.prototype,"order",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Array)],Et.prototype,"history",void 0),Object(n.c)([Object(o.O)(),Object(n.f)("design:type",Object)],Et.prototype,"addNote",void 0),Object(n.c)([Object(o.O)(),Object(n.f)("design:type",Object)],Et.prototype,"updateNote",void 0),Object(n.c)([Object(o.O)(),Object(n.f)("design:type",Object)],Et.prototype,"deleteNote",void 0);let Bt=class extends r.w{constructor(e,t,c){super(t,c),this.dataService=e,this.searchTerm=new d.f(""),this.stateFilter=new d.f("all"),super.setQueryFn((...e)=>this.dataService.order.getOrders(...e),e=>e.orders,(e,t)=>{const c=this.stateFilter.value,n="all"===c?null:{eq:c};return{options:{skip:e,take:t,filter:{code:{contains:this.searchTerm.value},state:n},sort:{updatedAt:r.Ib.DESC}}}})}ngOnInit(){super.ngOnInit(),Object(p.a)(this.searchTerm.valueChanges,this.stateFilter.valueChanges).pipe(Object(O.a)(250),Object(v.a)(this.destroy$)).subscribe(()=>this.refresh())}};Bt.\u0275fac=function(e){return new(e||Bt)(o.ic(r.K),o.ic(a.e),o.ic(a.a))},Bt.\u0275cmp=o.cc({type:Bt,selectors:[["vdr-order-list"]],features:[o.Tb],decls:54,vars:56,consts:[[1,"search-form"],["clrSelect","","name","state",3,"formControl"],["value","all"],["value","AddingItems"],["value","ArrangingPayment"],["value","PaymentAuthorized"],["value","PaymentSettled"],["value","PartiallyFulfilled"],["value","Fulfilled"],["value","Cancelled"],["type","text","name","searchTerm",1,"clr-input","search-input",3,"formControl","placeholder"],["locationId","order-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"left","align-middle"],[3,"customer"],[3,"state"],[1,"right","align-middle"],["iconShape","shopping-cart",3,"label","linkTo"]],template:function(e,t){1&e&&(o.oc(0,"vdr-action-bar"),o.oc(1,"vdr-ab-left"),o.oc(2,"div",0),o.oc(3,"select",1),o.oc(4,"option",2),o.cd(5),o.zc(6,"translate"),o.nc(),o.oc(7,"option",3),o.cd(8),o.zc(9,"translate"),o.nc(),o.oc(10,"option",4),o.cd(11),o.zc(12,"translate"),o.nc(),o.oc(13,"option",5),o.cd(14),o.zc(15,"translate"),o.nc(),o.oc(16,"option",6),o.cd(17),o.zc(18,"translate"),o.nc(),o.oc(19,"option",7),o.cd(20),o.zc(21,"translate"),o.nc(),o.oc(22,"option",8),o.cd(23),o.zc(24,"translate"),o.nc(),o.oc(25,"option",9),o.cd(26),o.zc(27,"translate"),o.nc(),o.nc(),o.jc(28,"input",10),o.zc(29,"translate"),o.nc(),o.nc(),o.oc(30,"vdr-ab-right"),o.jc(31,"vdr-action-bar-items",11),o.nc(),o.nc(),o.oc(32,"vdr-data-table",12),o.wc("pageChange",(function(e){return t.setPageNumber(e)}))("itemsPerPageChange",(function(e){return t.setItemsPerPage(e)})),o.zc(33,"async"),o.zc(34,"async"),o.zc(35,"async"),o.zc(36,"async"),o.oc(37,"vdr-dt-column"),o.cd(38),o.zc(39,"translate"),o.nc(),o.oc(40,"vdr-dt-column"),o.cd(41),o.zc(42,"translate"),o.nc(),o.oc(43,"vdr-dt-column"),o.cd(44),o.zc(45,"translate"),o.nc(),o.oc(46,"vdr-dt-column"),o.cd(47),o.zc(48,"translate"),o.nc(),o.oc(49,"vdr-dt-column"),o.cd(50),o.zc(51,"translate"),o.nc(),o.jc(52,"vdr-dt-column"),o.ad(53,yt,15,17,"ng-template"),o.nc()),2&e&&(o.Wb(3),o.Fc("formControl",t.stateFilter),o.Wb(2),o.dd(o.Ac(6,20,"order.state-all-orders")),o.Wb(3),o.dd(o.Ac(9,22,"order.state-adding-items")),o.Wb(3),o.dd(o.Ac(12,24,"order.state-arranging-payment")),o.Wb(3),o.dd(o.Ac(15,26,"order.state-payment-authorized")),o.Wb(3),o.dd(o.Ac(18,28,"order.state-payment-settled")),o.Wb(3),o.ed(" ",o.Ac(21,30,"order.state-partially-fulfilled")," "),o.Wb(3),o.dd(o.Ac(24,32,"order.state-fulfilled")),o.Wb(3),o.dd(o.Ac(27,34,"order.state-cancelled")),o.Wb(2),o.Fc("formControl",t.searchTerm)("placeholder",o.Ac(29,36,"order.search-by-order-code")),o.Wb(4),o.Fc("items",o.Ac(33,38,t.items$))("itemsPerPage",o.Ac(34,40,t.itemsPerPage$))("totalItems",o.Ac(35,42,t.totalItems$))("currentPage",o.Ac(36,44,t.currentPage$)),o.Wb(6),o.dd(o.Ac(39,46,"common.code")),o.Wb(3),o.dd(o.Ac(42,48,"order.customer")),o.Wb(3),o.dd(o.Ac(45,50,"order.state")),o.Wb(3),o.dd(o.Ac(48,52,"order.total")),o.Wb(3),o.dd(o.Ac(51,54,"common.updated-at")))},directives:[r.c,r.e,r.db,d.A,W.z,d.p,d.g,d.u,d.D,d.b,r.f,r.d,r.M,r.L,r.J,r.Bb,r.Lb],pipes:[P.d,F.b,F.d,F.f],styles:[".search-form[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin-bottom:6px}.search-input[_ngcontent-%COMP%]{margin-left:6px;margin-top:6px;min-width:300px}"],changeDetection:0}),Bt.ctorParameters=()=>[{type:r.K},{type:a.e},{type:a.a}],Bt=Object(n.c)([Object(n.f)("design:paramtypes",[r.K,a.e,a.a])],Bt);let qt=class{constructor(){this.settlePayment=new o.u,this.settleRefund=new o.u}refundHasMetadata(e){return!!e&&Object.keys(e).length<0}};qt.\u0275fac=function(e){return new(e||qt)},qt.\u0275cmp=o.cc({type:qt,selectors:[["vdr-order-payment-detail"]],inputs:{payment:"payment",currencyCode:"currencyCode"},outputs:{settlePayment:"settlePayment",settleRefund:"settleRefund"},decls:11,vars:9,consts:[[1,"card"],[1,"card-header","payment-header"],[1,"payment-state"],[3,"state"],[1,"card-block"],[3,"payment","currencyCode"],[4,"ngFor","ngForOf"],["class","card-footer",4,"ngIf"],["shape","redo","dir","down",1,"refund-icon"],[1,"clr-flex-fill"],[3,"label"],[3,"label",4,"ngIf"],[3,"value"],[1,"card-footer"],[1,"btn","btn-sm","btn-primary",3,"click"]],template:function(e,t){1&e&&(o.oc(0,"div",0),o.oc(1,"div",1),o.oc(2,"div"),o.cd(3),o.zc(4,"translate"),o.nc(),o.oc(5,"div",2),o.jc(6,"vdr-payment-state-label",3),o.nc(),o.nc(),o.oc(7,"div",4),o.jc(8,"vdr-payment-detail",5),o.nc(),o.ad(9,Wt,20,23,"ng-container",6),o.ad(10,jt,4,3,"div",7),o.nc()),2&e&&(o.Wb(3),o.fd("",o.Ac(4,7,"order.payment")," #",t.payment.transactionId,""),o.Wb(3),o.Fc("state",t.payment.state),o.Wb(2),o.Fc("payment",t.payment)("currencyCode",t.currencyCode),o.Wb(1),o.Fc("ngForOf",t.payment.refunds),o.Wb(1),o.Fc("ngIf","Authorized"===t.payment.state))},directives:function(){return[Gt,Ht,F.o,F.p,W.o,M.b,Zt,r.sb,r.zb]},pipes:function(){return[P.d,F.f,F.d]},styles:[".payment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.refund-icon[_ngcontent-%COMP%]{margin-right:6px;color:#97979a}"],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Object)],qt.prototype,"payment",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",String)],qt.prototype,"currencyCode",void 0),Object(n.c)([Object(o.O)(),Object(n.f)("design:type",Object)],qt.prototype,"settlePayment",void 0),Object(n.c)([Object(o.O)(),Object(n.f)("design:type",Object)],qt.prototype,"settleRefund",void 0);const Vt=72;let Qt=class{constructor(e){this.elementRef=e,this.active$=new m.a(!1),this.activeTarget$=new m.a(!1),this.isCancellable=!1,this.cancelledState="Cancelled"}ngOnChanges(e){this.isCancellable=!!this.node.to.find(e=>"Cancelled"===e.name),e.active&&this.active$.next(this.active)}getPos(e="top"){var t,c;this.elementRef.nativeElement.getBoundingClientRect();const n=null!==(c=null===(t=this.elementRef.nativeElement.querySelector(".node"))||void 0===t?void 0:t.getBoundingClientRect().height)&&void 0!==c?c:0;return{x:10,y:this.index*Vt+("bottom"===e?n:0)}}getStyle(){const e=this.getPos();return{"top.px":e.y,"left.px":e.x}}};Qt.\u0275fac=function(e){return new(e||Qt)(o.ic(o.s))},Qt.\u0275cmp=o.cc({type:Qt,selectors:[["vdr-order-process-node"]],inputs:{node:"node",index:"index",active:"active"},features:[o.Ub],decls:8,vars:15,consts:[[1,"node-wrapper",3,"ngStyle"],[1,"node"],["class","cancelled-wrapper",4,"ngIf"],[1,"cancelled-wrapper"],[1,"cancelled-edge"],["shape","dot-circle"],[1,"cancelled-node"]],template:function(e,t){1&e&&(o.oc(0,"div",0),o.zc(1,"async"),o.oc(2,"div",1),o.zc(3,"async"),o.cd(4),o.zc(5,"translate"),o.zc(6,"orderStateI18nToken"),o.nc(),o.ad(7,Pt,7,5,"div",2),o.nc()),2&e&&(o.Zb("active",o.Ac(1,7,t.active$)),o.Fc("ngStyle",t.getStyle()),o.Wb(2),o.Zb("active-target",o.Ac(3,9,t.activeTarget$)),o.Wb(2),o.ed(" ",o.Ac(5,11,o.Ac(6,13,t.node.name))," "),o.Wb(3),o.Fc("ngIf",t.isCancellable))},directives:[F.q,F.p,W.o],pipes:[F.b,P.d,r.Ab],styles:["[_nghost-%COMP%]{display:block}.node-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:1;display:flex;align-items:center}.node[_ngcontent-%COMP%]{display:inline-block;border:2px solid #bfc3cc;border-radius:3px;padding:3px 6px;z-index:1;background-color:#fafafa;opacity:.7;transition:opacity .2s,background-color .2s,color .2s;cursor:default}.node.active-target[_ngcontent-%COMP%]{border-color:#13b7f3;opacity:.9}.cancelled-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;color:#bfc3cc;transition:color .2s,opacity .2s;opacity:.7}.cancelled-edge[_ngcontent-%COMP%]{width:48px;height:2px;background-color:#bfc3cc;transition:background-color .2s}clr-icon[_ngcontent-%COMP%]{margin-left:-1px}.cancelled-node[_ngcontent-%COMP%]{margin-left:6px}.active[_ngcontent-%COMP%]   .node[_ngcontent-%COMP%]{opacity:1;background-color:#137fac;border-color:#137fac;color:#e3f6fc}.active[_ngcontent-%COMP%]   .cancelled-wrapper[_ngcontent-%COMP%]{opacity:1;color:#c92100}.active[_ngcontent-%COMP%]   .cancelled-edge[_ngcontent-%COMP%]{background-color:#c92100}"],changeDetection:0}),Qt.ctorParameters=()=>[{type:o.s}],Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Object)],Qt.prototype,"node",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Number)],Qt.prototype,"index",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Boolean)],Qt.prototype,"active",void 0),Qt=Object(n.c)([Object(n.f)("design:paramtypes",[o.s])],Qt);let Ut=class{ngOnInit(){this.active$=this.from.active$.asObservable().pipe(Object(C.a)(e=>this.to.activeTarget$.next(e)))}getStyle(){const e=this.from.index<this.to.index?"down":"up",t=this.from.getPos("down"===e?"bottom":"top"),c=this.to.getPos("down"===e?"top":"bottom"),n=Math.abs(t.x-c.x),o=Math.abs(t.y-c.y),i=Math.sqrt(Math.pow(n,2)+Math.pow(o,2));return Object.assign({"top.px":t.y,"left.px":t.x+("down"===e?10:40)+12*this.index,"height.px":i,"width.px":1},"up"===e?{transform:"rotateZ(180deg)","transform-origin":"top"}:{})}};Ut.\u0275fac=function(e){return new(e||Ut)},Ut.\u0275cmp=o.cc({type:Ut,selectors:[["vdr-order-process-edge"]],inputs:{from:"from",to:"to",index:"index"},decls:3,vars:7,consts:[[1,"edge",3,"ngStyle"],["shape","arrow","flip","vertical",1,"arrow"]],template:function(e,t){1&e&&(o.oc(0,"div",0),o.zc(1,"async"),o.jc(2,"clr-icon",1),o.nc()),2&e&&(o.Zb("active",o.Ac(1,5,t.active$)),o.Fc("ngStyle",t.getStyle()),o.Xb("data-from",t.from.node.name)("data-to",t.to.node.name))},directives:[F.q,W.o],pipes:[F.b],styles:[".edge[_ngcontent-%COMP%]{position:absolute;border:1px solid #bfc3cc;background-color:#bfc3cc;opacity:.3;transition:border .2s,opacity .2s,background-color .2s}.edge.active[_ngcontent-%COMP%]{border-color:#13b7f3;background-color:#13b7f3;opacity:1}.edge.active[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:#13b7f3}.edge[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{position:absolute;bottom:-4px;left:-8px;color:#bfc3cc}"],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Qt)],Ut.prototype,"from",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Qt)],Ut.prototype,"to",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Number)],Ut.prototype,"index",void 0);let Kt=class{constructor(e){this.changeDetector=e,this.setActiveState$=new m.a(void 0),this.nodes=[],this.edges=[]}get outerHeight(){return this.nodes.length*Vt}ngOnInit(){this.setActiveState$.next(this.initialState),this.activeState$=this.setActiveState$.pipe(Object(O.a)(150))}ngOnChanges(e){this.populateNodes()}ngAfterViewInit(){setTimeout(()=>this.populateEdges())}onMouseOver(e){this.setActiveState$.next(e)}onMouseOut(){this.setActiveState$.next(this.initialState)}getNodeFor(e){if(this.nodeComponents)return this.nodeComponents.find(t=>t.node.name===e)}populateNodes(){var e,t;const c=new Map;for(const n of this.states)c.set(n.name,{name:n.name,to:[]});for(const[n,o]of c.entries()){const i=null!==(t=null===(e=this.states.find(e=>e.name===n))||void 0===e?void 0:e.to)&&void 0!==t?t:[];for(const e of i){const t=c.get(e);t&&o.to.push(t)}}this.nodes=[...c.values()].filter(e=>"Cancelled"!==e.name)}populateEdges(){for(const e of this.nodes){const t=this.getNodeFor(e.name);let c=0;for(const n of e.to){const e=this.getNodeFor(n.name);t&&e&&t!==e&&(this.edges.push({to:e,from:t,index:c}),c++)}}this.edges=[...this.edges],this.changeDetector.markForCheck()}};Kt.\u0275fac=function(e){return new(e||Kt)(o.ic(o.k))},Kt.\u0275cmp=o.cc({type:Kt,selectors:[["vdr-order-process-graph"]],viewQuery:function(e,t){var c;(1&e&&o.id(Qt,!0),2&e)&&(o.Pc(c=o.xc())&&(t.nodeComponents=c))},hostVars:2,hostBindings:function(e,t){2&e&&o.Zc("height",t.outerHeight,"px")},inputs:{states:"states",initialState:"initialState"},features:[o.Ub],decls:2,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"node","index","active","mouseenter","mouseleave"],[3,"from","to","index"]],template:function(e,t){1&e&&(o.ad(0,Mt,3,5,"ng-container",0),o.ad(1,It,2,3,"ng-container",0)),2&e&&(o.Fc("ngForOf",t.nodes),o.Wb(1),o.Fc("ngForOf",t.edges))},directives:[F.o,Qt,Ut],pipes:[F.b],styles:["[_nghost-%COMP%]{display:block;border:1px #ff69b4;margin:20px;padding:12px;position:relative}.state-row[_ngcontent-%COMP%]{display:flex}"],changeDetection:0}),Kt.ctorParameters=()=>[{type:o.k}],Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Array)],Kt.prototype,"states",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",String)],Kt.prototype,"initialState",void 0),Object(n.c)([Object(o.gb)(Qt),Object(n.f)("design:type",o.S)],Kt.prototype,"nodeComponents",void 0),Object(n.c)([Object(o.w)("style.height.px"),Object(n.f)("design:type",Number),Object(n.f)("design:paramtypes",[])],Kt.prototype,"outerHeight",null),Kt=Object(n.c)([Object(n.f)("design:paramtypes",[o.k])],Kt);let Ht=class{};Ht.\u0275fac=function(e){return new(e||Ht)},Ht.\u0275cmp=o.cc({type:Ht,selectors:[["vdr-payment-detail"]],inputs:{payment:"payment",currencyCode:"currencyCode"},decls:13,vars:19,consts:[[3,"label"],[3,"value"]],template:function(e,t){1&e&&(o.oc(0,"vdr-labeled-data",0),o.zc(1,"translate"),o.cd(2),o.nc(),o.oc(3,"vdr-labeled-data",0),o.zc(4,"translate"),o.cd(5),o.zc(6,"currency"),o.nc(),o.oc(7,"vdr-labeled-data",0),o.zc(8,"translate"),o.cd(9),o.nc(),o.oc(10,"vdr-labeled-data",0),o.zc(11,"translate"),o.jc(12,"vdr-object-tree",1),o.nc()),2&e&&(o.Fc("label",o.Ac(1,8,"order.payment-method")),o.Wb(2),o.ed(" ",t.payment.method,"\n"),o.Wb(1),o.Fc("label",o.Ac(4,10,"order.amount")),o.Wb(2),o.ed(" ",o.Bc(6,12,t.payment.amount/100,t.currencyCode),"\n"),o.Wb(2),o.Fc("label",o.Ac(8,15,"order.transaction-id")),o.Wb(2),o.ed(" ",t.payment.transactionId,"\n"),o.Wb(1),o.Fc("label",o.Ac(11,17,"order.payment-metadata")),o.Wb(2),o.Fc("value",t.payment.metadata))},directives:[r.sb,r.zb],pipes:[P.d,F.d],styles:[""],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Object)],Ht.prototype,"payment",void 0),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",String)],Ht.prototype,"currencyCode",void 0);let Gt=class{get chipColorType(){switch(this.state){case"Authorized":return"warning";case"Settled":return"success";case"Declined":return"error"}}};Gt.\u0275fac=function(e){return new(e||Gt)},Gt.\u0275cmp=o.cc({type:Gt,selectors:[["vdr-payment-state-label"]],inputs:{state:"state"},decls:4,vars:6,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(e,t){1&e&&(o.oc(0,"vdr-chip",0),o.zc(1,"translate"),o.ad(2,At,1,0,"clr-icon",1),o.cd(3),o.nc()),2&e&&(o.Fc("title",o.Ac(1,4,"order.payment-state"))("colorType",t.chipColorType),o.Wb(2),o.Fc("ngIf","Settled"===t.state),o.Wb(1),o.ed(" ",t.state,"\n"))},directives:[r.B,F.p,W.o],pipes:[P.d],styles:["[_nghost-%COMP%]{font-size:14px}"],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",String)],Gt.prototype,"state",void 0);let Zt=class{get chipColorType(){switch(this.state){case"Pending":return"warning";case"Settled":return"success";case"Failed":return"error"}}};Zt.\u0275fac=function(e){return new(e||Zt)},Zt.\u0275cmp=o.cc({type:Zt,selectors:[["vdr-refund-state-label"]],inputs:{state:"state"},decls:4,vars:6,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(e,t){1&e&&(o.oc(0,"vdr-chip",0),o.zc(1,"translate"),o.ad(2,wt,1,0,"clr-icon",1),o.cd(3),o.nc()),2&e&&(o.Fc("title",o.Ac(1,4,"order.payment-state"))("colorType",t.chipColorType),o.Wb(2),o.Fc("ngIf","Settled"===t.state),o.Wb(1),o.ed(" ",t.state,"\n"))},directives:[r.B,F.p,W.o],pipes:[P.d],styles:["[_nghost-%COMP%]{font-size:14px}"],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",String)],Zt.prototype,"state",void 0);let Yt=class{};Yt.\u0275fac=function(e){return new(e||Yt)},Yt.\u0275cmp=o.cc({type:Yt,selectors:[["vdr-simple-item-list"]],inputs:{items:"items"},decls:3,vars:1,consts:[[1,"items-list"],[3,"title",4,"ngFor","ngForOf"],[3,"title"],[1,"quantity"],["shape","times","size","12"]],template:function(e,t){1&e&&(o.oc(0,"div",0),o.oc(1,"ul"),o.ad(2,zt,5,3,"li",1),o.nc(),o.nc()),2&e&&(o.Wb(2),o.Fc("ngForOf",t.items))},directives:[F.o,W.o],styles:[".items-list[_ngcontent-%COMP%]{font-size:12px}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:6px;list-style-type:none;margin-left:2px}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{line-height:14px;text-overflow:ellipsis;overflow:hidden}.items-list[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{min-width:16px;display:inline-block}"],changeDetection:0}),Object(n.c)([Object(o.D)(),Object(n.f)("design:type",Array)],Yt.prototype,"items",void 0);let Xt=class extends r.v{constructor(e,t){super(e,{__typename:"Order",id:"",code:"",createdAt:"",updatedAt:"",total:0},e=>t.order.getOrder(e).mapStream(e=>e.order))}};Xt.\u0275fac=function(e){return new(e||Xt)(o.sc(a.e),o.sc(r.K))},Xt.ctorParameters=()=>[{type:a.e},{type:r.K}],Xt.\u0275prov=Object(o.ec)({factory:function(){return new Xt(Object(o.sc)(a.e),Object(o.sc)(r.K))},token:Xt,providedIn:"root"}),Xt=Object(n.c)([Object(n.f)("design:paramtypes",[a.e,r.K])],Xt);const Jt={breadcrumb:Object(i.a)("breadcrumb.orders")},ec={breadcrumb:cc},tc=[{path:"",component:Bt,data:Jt},{path:":id",component:Lt,resolve:Object(r.Rb)(Xt),canDeactivate:[r.x],data:ec}];function cc(e,t){return Object(r.Tb)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.orders",getName:e=>e.code,route:""})}let nc=class{};nc.\u0275mod=o.gc({type:nc}),nc.\u0275inj=o.fc({factory:function(e){return new(e||nc)},imports:[[r.Hb,a.i.forChild(tc)]]})}}]);