(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{H88a:function(e,t,c){"use strict";c.r(t);var r=c("D57K"),s=c("EM62"),n=c("ixhn"),o=c("C05f"),i=c("ZTXN"),a=c("P4Xx"),d=c("GoAz"),l=c("6Oco"),m=c("HM3f"),u=c("ROBh"),p=c("TLy2"),b=c("YtkY"),g=c("wqq/"),f=c("g6G6");var h=c("jIqt"),y=c("J+dc"),v=c("cJ9h"),O=c("5uDM"),C=c("xVbo"),D=c("Ohay"),U=c("8j5Y"),j=c("7SLS"),x=c("mWib"),S=c("kuMc"),w=c("nIj0"),I=c("sEIs"),P=c("OxKu"),k=c("hG4v"),N=c("8hOy"),M=c("2kYt"),T=c("s2Ay"),A=c("Kej3"),E=c("jY47");c.d(t,"AddCustomerToGroupDialogComponent",(function(){return Xe})),c.d(t,"AddressCardComponent",(function(){return Je})),c.d(t,"CustomerDetailComponent",(function(){return tt})),c.d(t,"CustomerGroupDetailDialogComponent",(function(){return ct})),c.d(t,"CustomerGroupListComponent",(function(){return rt})),c.d(t,"CustomerGroupMemberListComponent",(function(){return st})),c.d(t,"CustomerHistoryComponent",(function(){return nt})),c.d(t,"CustomerListComponent",(function(){return ot})),c.d(t,"CustomerModule",(function(){return bt})),c.d(t,"CustomerResolver",(function(){return at})),c.d(t,"CustomerStatusLabelComponent",(function(){return it})),c.d(t,"SelectCustomerGroupDialogComponent",(function(){return et})),c.d(t,"customerBreadcrumb",(function(){return pt})),c.d(t,"customerRoutes",(function(){return ut})),c.d(t,"\u02750",(function(){return dt})),c.d(t,"\u02751",(function(){return lt})),c.d(t,"\u02752",(function(){return mt}));const F=function(e){return{groupName:e}};function $(e,t){if(1&e&&(s.ad(0),s.xc(1,"translate")),2&e){const e=s.wc();s.cd(" ",s.zc(1,1,"customer.add-customers-to-group-with-name",s.Ic(4,F,e.group.name)),"\n")}}const R=function(e){return{count:e}};function _(e,t){if(1&e){const e=s.nc();s.mc(0,"button",3),s.uc("click",(function(){return s.Rc(e),s.wc().cancel()})),s.ad(1),s.xc(2,"translate"),s.lc(),s.mc(3,"button",4),s.uc("click",(function(){return s.Rc(e),s.wc().add()})),s.ad(4),s.xc(5,"translate"),s.lc()}if(2&e){const e=s.wc();s.Ub(1),s.bd(s.yc(2,3,"common.cancel")),s.Ub(2),s.Dc("disabled",!e.selectedCustomerIds.length),s.Ub(1),s.cd(" ",s.zc(5,5,"customer.add-customers-to-group-with-count",s.Ic(8,R,e.selectedCustomerIds.length))," ")}}function G(e,t){if(1&e&&(s.mc(0,"span",17),s.ad(1),s.lc()),2&e){const e=s.wc().ngIf;s.Ub(1),s.cd("",e.streetLine1,",")}}function Y(e,t){1&e&&(s.mc(0,"vdr-chip",18),s.hc(1,"clr-icon",19),s.ad(2),s.xc(3,"translate"),s.lc()),2&e&&(s.Ub(2),s.cd(" ",s.yc(3,1,"customer.default-shipping-address")," "))}function L(e,t){1&e&&(s.mc(0,"vdr-chip",18),s.hc(1,"clr-icon",20),s.ad(2),s.xc(3,"translate"),s.lc()),2&e&&(s.Ub(2),s.cd(" ",s.yc(3,1,"customer.default-billing-address")," "))}function B(e,t){if(1&e&&s.hc(0,"vdr-formatted-address",21),2&e){const e=s.wc().ngIf;s.Dc("address",e)}}function K(e,t){if(1&e&&(s.mc(0,"option",32),s.ad(1),s.lc()),2&e){const e=t.$implicit;s.Dc("value",e.code),s.Ub(1),s.cd(" ",e.name," ")}}function V(e,t){if(1&e&&(s.mc(0,"form",22),s.mc(1,"clr-input-container"),s.mc(2,"label"),s.ad(3),s.xc(4,"translate"),s.lc(),s.hc(5,"input",23),s.lc(),s.mc(6,"clr-input-container"),s.mc(7,"label"),s.ad(8),s.xc(9,"translate"),s.lc(),s.hc(10,"input",24),s.lc(),s.mc(11,"clr-input-container"),s.mc(12,"label"),s.ad(13),s.xc(14,"translate"),s.lc(),s.hc(15,"input",25),s.lc(),s.mc(16,"clr-input-container"),s.mc(17,"label"),s.ad(18),s.xc(19,"translate"),s.lc(),s.hc(20,"input",26),s.lc(),s.mc(21,"clr-input-container"),s.mc(22,"label"),s.ad(23),s.xc(24,"translate"),s.lc(),s.hc(25,"input",27),s.lc(),s.mc(26,"clr-input-container"),s.mc(27,"label"),s.ad(28),s.xc(29,"translate"),s.lc(),s.hc(30,"input",28),s.lc(),s.mc(31,"clr-input-container"),s.mc(32,"label"),s.ad(33),s.xc(34,"translate"),s.lc(),s.mc(35,"select",29),s.Yc(36,K,2,2,"option",30),s.lc(),s.lc(),s.mc(37,"clr-input-container"),s.mc(38,"label"),s.ad(39),s.xc(40,"translate"),s.lc(),s.hc(41,"input",31),s.lc(),s.lc()),2&e){const e=s.wc(2);s.Dc("formGroup",e.addressForm),s.Ub(3),s.bd(s.yc(4,10,"customer.full-name")),s.Ub(5),s.bd(s.yc(9,12,"customer.street-line-1")),s.Ub(5),s.bd(s.yc(14,14,"customer.street-line-2")),s.Ub(5),s.bd(s.yc(19,16,"customer.city")),s.Ub(5),s.bd(s.yc(24,18,"customer.province")),s.Ub(5),s.bd(s.yc(29,20,"customer.postal-code")),s.Ub(5),s.bd(s.yc(34,22,"customer.country")),s.Ub(3),s.Dc("ngForOf",e.availableCountries),s.Ub(3),s.bd(s.yc(40,24,"customer.phone-number"))}}function H(e,t){if(1&e){const e=s.nc();s.mc(0,"button",33),s.uc("click",(function(){return s.Rc(e),s.wc(2).editing=!1})),s.ad(1),s.xc(2,"translate"),s.lc()}2&e&&(s.Ub(1),s.cd(" ",s.yc(2,1,"common.done")," "))}function q(e,t){if(1&e){const e=s.nc();s.mc(0,"button",33),s.uc("click",(function(){return s.Rc(e),s.wc(2).editing=!0})),s.ad(1),s.xc(2,"translate"),s.lc()}2&e&&(s.Ub(1),s.cd(" ",s.yc(2,1,"common.edit")," "))}function z(e,t){if(1&e){const e=s.nc();s.mc(0,"div",1),s.mc(1,"div",2),s.mc(2,"div",3),s.Yc(3,G,2,1,"span",4),s.ad(4),s.lc(),s.mc(5,"div",5),s.Yc(6,Y,4,3,"vdr-chip",6),s.Yc(7,L,4,3,"vdr-chip",6),s.lc(),s.lc(),s.mc(8,"div",7),s.mc(9,"div",8),s.Yc(10,B,1,1,"vdr-formatted-address",9),s.Yc(11,V,42,26,"form",10),s.lc(),s.lc(),s.mc(12,"div",11),s.hc(13,"vdr-entity-info",12),s.Yc(14,H,3,3,"button",13),s.Yc(15,q,3,3,"button",13),s.mc(16,"vdr-dropdown"),s.mc(17,"button",14),s.ad(18),s.xc(19,"translate"),s.hc(20,"clr-icon",15),s.lc(),s.mc(21,"vdr-dropdown-menu"),s.mc(22,"button",16),s.uc("click",(function(){return s.Rc(e),s.wc().setAsDefaultShippingAddress()})),s.ad(23),s.xc(24,"translate"),s.lc(),s.mc(25,"button",16),s.uc("click",(function(){return s.Rc(e),s.wc().setAsDefaultBillingAddress()})),s.ad(26),s.xc(27,"translate"),s.lc(),s.lc(),s.lc(),s.lc(),s.lc()}if(2&e){const e=t.ngIf,c=s.wc();s.Ub(3),s.Dc("ngIf",e.streetLine1),s.Ub(1),s.cd(" ",e.countryCode," "),s.Ub(2),s.Dc("ngIf",c.isDefaultShipping),s.Ub(1),s.Dc("ngIf",c.isDefaultBilling),s.Ub(3),s.Dc("ngIf",!c.editing),s.Ub(1),s.Dc("ngIf",c.editing),s.Ub(2),s.Dc("entity",e),s.Ub(1),s.Dc("ngIf",c.editing),s.Ub(1),s.Dc("ngIf",!c.editing),s.Ub(3),s.cd(" ",s.yc(19,14,"common.more")," "),s.Ub(4),s.Dc("disabled",c.isDefaultShipping||c.editing),s.Ub(1),s.cd(" ",s.yc(24,16,"customer.set-as-default-shipping-address")," "),s.Ub(2),s.Dc("disabled",c.isDefaultBilling||c.editing),s.Ub(1),s.cd(" ",s.yc(27,18,"customer.set-as-default-billing-address")," ")}}function W(e,t){1&e&&(s.ad(0),s.xc(1,"translate")),2&e&&s.cd(" ",s.yc(1,1,"customer.add-customer-to-group"),"\n")}function Q(e,t){if(1&e&&(s.mc(0,"span",5),s.uc("click",(function(){const e=t.item;return(0,t.clear)(e)})),s.ad(1," \xd7 "),s.lc(),s.mc(2,"vdr-chip",6),s.ad(3),s.lc()),2&e){const e=t.item;s.Ub(2),s.Dc("colorFrom",e.id),s.Ub(1),s.bd(e.name)}}function Z(e,t){if(1&e&&(s.mc(0,"vdr-chip",6),s.ad(1),s.lc()),2&e){const e=t.item;s.Dc("colorFrom",e.id),s.Ub(1),s.bd(e.name)}}function X(e,t){if(1&e){const e=s.nc();s.mc(0,"button",7),s.uc("click",(function(){return s.Rc(e),s.wc().cancel()})),s.ad(1),s.xc(2,"translate"),s.lc(),s.mc(3,"button",8),s.uc("click",(function(){return s.Rc(e),s.wc().add()})),s.ad(4),s.xc(5,"translate"),s.lc()}if(2&e){const e=s.wc();s.Ub(1),s.bd(s.yc(2,3,"common.cancel")),s.Ub(2),s.Dc("disabled",!e.selectedGroupIds.length),s.Ub(1),s.cd(" ",s.zc(5,5,"customer.add-customer-to-groups-with-count",s.Ic(8,R,e.selectedGroupIds.length))," ")}}function J(e,t){if(1&e){const e=s.nc();s.mc(0,"button",21),s.uc("click",(function(){return s.Rc(e),s.wc().create()})),s.ad(1),s.xc(2,"translate"),s.lc()}if(2&e){const e=s.wc();s.Dc("disabled",!(e.addressDefaultsUpdated||e.detailForm.valid&&e.detailForm.dirty)),s.Ub(1),s.cd(" ",s.yc(2,2,"common.create")," ")}}function ee(e,t){if(1&e){const e=s.nc();s.mc(0,"button",21),s.uc("click",(function(){return s.Rc(e),s.wc().save()})),s.ad(1),s.xc(2,"translate"),s.lc()}if(2&e){const e=s.wc();s.Dc("disabled",!(e.addressDefaultsUpdated||e.detailForm.valid&&e.detailForm.dirty)),s.Ub(1),s.cd(" ",s.yc(2,2,"common.update")," ")}}function te(e,t){1&e&&(s.mc(0,"vdr-form-field",22),s.xc(1,"translate"),s.hc(2,"input",23),s.lc()),2&e&&s.Dc("label",s.yc(1,1,"customer.password"))}const ce=function(){return["customer","customFields"]};function re(e,t){if(1&e&&s.hc(0,"vdr-custom-field-control",27),2&e){const e=s.wc().$implicit,t=s.wc(2);s.Dc("customFieldsFormGroup",t.detailForm.get(s.Hc(2,ce)))("customField",e)}}function se(e,t){if(1&e&&(s.kc(0),s.Yc(1,re,1,3,"vdr-custom-field-control",26),s.jc()),2&e){const e=t.$implicit,c=s.wc(2);s.Ub(1),s.Dc("ngIf",c.customFieldIsSet(e.name))}}function ne(e,t){if(1&e&&(s.mc(0,"section",24),s.mc(1,"label"),s.ad(2),s.xc(3,"translate"),s.lc(),s.Yc(4,se,2,1,"ng-container",25),s.lc()),2&e){const e=s.wc();s.Ub(2),s.bd(s.yc(3,2,"common.custom-fields")),s.Ub(2),s.Dc("ngForOf",e.customFields)}}function oe(e,t){if(1&e){const e=s.nc();s.mc(0,"vdr-chip",35),s.uc("iconClick",(function(){s.Rc(e);const c=t.$implicit;return s.wc(3).removeFromGroup(c)})),s.ad(1),s.lc()}if(2&e){const e=t.$implicit;s.Dc("colorFrom",e.id),s.Ub(1),s.bd(e.name)}}function ie(e,t){if(1&e&&(s.kc(0),s.Yc(1,oe,2,2,"vdr-chip",34),s.jc()),2&e){const e=s.wc().ngIf;s.Ub(1),s.Dc("ngForOf",e)}}function ae(e,t){1&e&&(s.ad(0),s.xc(1,"translate")),2&e&&s.cd(" ",s.yc(1,1,"customer.not-a-member-of-any-groups")," ")}function de(e,t){if(1&e){const e=s.nc();s.mc(0,"div",28),s.mc(1,"label",29),s.ad(2),s.xc(3,"translate"),s.lc(),s.Yc(4,ie,2,1,"ng-container",30),s.Yc(5,ae,2,3,"ng-template",null,31,s.Zc),s.mc(7,"div"),s.mc(8,"button",32),s.uc("click",(function(){return s.Rc(e),s.wc().addToGroup()})),s.hc(9,"clr-icon",33),s.ad(10),s.xc(11,"translate"),s.lc(),s.lc(),s.lc()}if(2&e){const e=t.ngIf,c=s.Oc(6);s.Ub(2),s.bd(s.yc(3,4,"customer.customer-groups")),s.Ub(2),s.Dc("ngIf",e.length)("ngIfElse",c),s.Ub(6),s.cd(" ",s.yc(11,6,"customer.add-customer-to-group")," ")}}function le(e,t){if(1&e){const e=s.nc();s.mc(0,"vdr-address-card",42),s.uc("setAsDefaultBilling",(function(t){return s.Rc(e),s.wc(2).setDefaultBillingAddressId(t)}))("setAsDefaultShipping",(function(t){return s.Rc(e),s.wc(2).setDefaultShippingAddressId(t)})),s.xc(1,"async"),s.lc()}if(2&e){const e=t.$implicit,c=s.wc(2);s.Dc("availableCountries",s.yc(1,4,c.availableCountries$))("isDefaultBilling",c.defaultBillingAddressId===e.value.id)("isDefaultShipping",c.defaultShippingAddressId===e.value.id)("addressForm",e)}}const me=function(e){return["/orders/",e]};function ue(e,t){if(1&e&&(s.mc(0,"td",43),s.ad(1),s.lc(),s.mc(2,"td",43),s.ad(3),s.lc(),s.mc(4,"td",43),s.ad(5),s.xc(6,"currency"),s.lc(),s.mc(7,"td",43),s.ad(8),s.xc(9,"date"),s.lc(),s.mc(10,"td",44),s.hc(11,"vdr-table-row-action",45),s.xc(12,"translate"),s.lc()),2&e){const e=t.item;s.Ub(1),s.bd(e.code),s.Ub(2),s.bd(e.state),s.Ub(2),s.bd(s.zc(6,6,e.total/100,e.currencyCode)),s.Ub(3),s.bd(s.zc(9,9,e.updatedAt,"medium")),s.Ub(3),s.Dc("label",s.yc(12,12,"common.open"))("linkTo",s.Ic(14,me,e.id))}}function pe(e,t){if(1&e){const e=s.nc();s.mc(0,"div",36),s.mc(1,"div",37),s.mc(2,"h3"),s.ad(3),s.xc(4,"translate"),s.lc(),s.Yc(5,le,2,6,"vdr-address-card",38),s.mc(6,"button",39),s.uc("click",(function(){return s.Rc(e),s.wc().addAddress()})),s.hc(7,"clr-icon",33),s.ad(8),s.xc(9,"translate"),s.lc(),s.lc(),s.mc(10,"div",40),s.mc(11,"h3"),s.ad(12),s.xc(13,"translate"),s.lc(),s.mc(14,"vdr-data-table",41),s.uc("itemsPerPageChange",(function(t){return s.Rc(e),s.wc().setOrderItemsPerPage(t)}))("pageChange",(function(t){return s.Rc(e),s.wc().setOrderCurrentPage(t)})),s.xc(15,"async"),s.xc(16,"async"),s.xc(17,"translate"),s.mc(18,"vdr-dt-column"),s.ad(19),s.xc(20,"translate"),s.lc(),s.mc(21,"vdr-dt-column"),s.ad(22),s.xc(23,"translate"),s.lc(),s.mc(24,"vdr-dt-column"),s.ad(25),s.xc(26,"translate"),s.lc(),s.mc(27,"vdr-dt-column"),s.ad(28),s.xc(29,"translate"),s.lc(),s.hc(30,"vdr-dt-column"),s.Yc(31,ue,13,16,"ng-template"),s.lc(),s.lc(),s.lc()}if(2&e){const e=s.wc();s.Ub(3),s.bd(s.yc(4,13,"customer.addresses")),s.Ub(2),s.Dc("ngForOf",e.getAddressFormControls()),s.Ub(3),s.cd(" ",s.yc(9,15,"customer.create-new-address")," "),s.Ub(4),s.bd(s.yc(13,17,"customer.orders")),s.Ub(2),s.Dc("items",s.yc(15,19,e.orders$))("itemsPerPage",e.ordersPerPage)("totalItems",s.yc(16,21,e.ordersCount$))("currentPage",e.currentOrdersPage)("emptyStateLabel",s.yc(17,23,"customer.no-orders-placed")),s.Ub(5),s.bd(s.yc(20,25,"common.code")),s.Ub(3),s.bd(s.yc(23,27,"order.state")),s.Ub(3),s.bd(s.yc(26,29,"order.total")),s.Ub(3),s.bd(s.yc(29,31,"common.updated-at"))}}function be(e,t){if(1&e){const e=s.nc();s.mc(0,"div",36),s.mc(1,"div",46),s.mc(2,"vdr-customer-history",47),s.uc("addNote",(function(t){return s.Rc(e),s.wc().addNoteToCustomer(t)}))("updateNote",(function(t){return s.Rc(e),s.wc().updateNote(t)}))("deleteNote",(function(t){return s.Rc(e),s.wc().deleteNote(t)})),s.xc(3,"async"),s.xc(4,"async"),s.lc(),s.lc(),s.lc()}if(2&e){const e=s.wc();s.Ub(2),s.Dc("customer",s.yc(3,2,e.entity$))("history",s.yc(4,4,e.history$))}}function ge(e,t){1&e&&(s.mc(0,"span"),s.ad(1),s.xc(2,"translate"),s.lc()),2&e&&(s.Ub(1),s.bd(s.yc(2,1,"customer.update-customer-group")))}function fe(e,t){1&e&&(s.mc(0,"span"),s.ad(1),s.xc(2,"translate"),s.lc()),2&e&&(s.Ub(1),s.bd(s.yc(2,1,"customer.create-customer-group")))}function he(e,t){if(1&e&&(s.Yc(0,ge,3,3,"span",4),s.Yc(1,fe,3,3,"span",4)),2&e){const e=s.wc();s.Dc("ngIf",e.group.id),s.Ub(1),s.Dc("ngIf",!e.group.id)}}function ye(e,t){1&e&&(s.mc(0,"span"),s.ad(1),s.xc(2,"translate"),s.lc()),2&e&&(s.Ub(1),s.bd(s.yc(2,1,"customer.update-customer-group")))}function ve(e,t){1&e&&(s.mc(0,"span"),s.ad(1),s.xc(2,"translate"),s.lc()),2&e&&(s.Ub(1),s.bd(s.yc(2,1,"customer.create-customer-group")))}function Oe(e,t){if(1&e){const e=s.nc();s.mc(0,"button",5),s.uc("click",(function(){return s.Rc(e),s.wc().cancel()})),s.ad(1),s.xc(2,"translate"),s.lc(),s.mc(3,"button",6),s.uc("click",(function(){return s.Rc(e),s.wc().save()})),s.Yc(4,ye,3,3,"span",4),s.Yc(5,ve,3,3,"span",4),s.lc()}if(2&e){const e=s.wc();s.Ub(1),s.bd(s.yc(2,4,"common.cancel")),s.Ub(2),s.Dc("disabled",!e.group.name),s.Ub(1),s.Dc("ngIf",e.group.id),s.Ub(1),s.Dc("ngIf",!e.group.id)}}function Ce(e,t){if(1&e){const e=s.nc();s.mc(0,"button",7),s.uc("click",(function(){return s.Rc(e),s.wc().create()})),s.hc(1,"clr-icon",8),s.ad(2),s.xc(3,"translate"),s.lc()}2&e&&(s.Ub(2),s.cd(" ",s.yc(3,1,"customer.create-new-customer-group")," "))}const De=function(e){return{contents:e}},Ue=function(e){return["./",e]};function je(e,t){if(1&e){const e=s.nc();s.mc(0,"tr"),s.xc(1,"async"),s.mc(2,"td",11),s.hc(3,"vdr-entity-info",12),s.lc(),s.mc(4,"td",11),s.mc(5,"vdr-chip",13),s.ad(6),s.lc(),s.lc(),s.mc(7,"td",14),s.mc(8,"a",15),s.hc(9,"clr-icon",16),s.ad(10),s.xc(11,"translate"),s.lc(),s.lc(),s.mc(12,"td",17),s.mc(13,"button",18),s.uc("click",(function(){s.Rc(e);const c=t.$implicit;return s.wc(2).update(c)})),s.hc(14,"clr-icon",19),s.ad(15),s.xc(16,"translate"),s.lc(),s.lc(),s.mc(17,"td",17),s.mc(18,"vdr-dropdown"),s.mc(19,"button",20),s.ad(20),s.xc(21,"translate"),s.hc(22,"clr-icon",21),s.lc(),s.mc(23,"vdr-dropdown-menu",22),s.mc(24,"button",23),s.uc("click",(function(){s.Rc(e);const c=t.$implicit;return s.wc(2).delete(c.id)})),s.xc(25,"hasPermission"),s.hc(26,"clr-icon",24),s.ad(27),s.xc(28,"translate"),s.lc(),s.lc(),s.lc(),s.lc(),s.lc()}if(2&e){const e=t.$implicit,r=s.wc(2);var c;const n=e.id===(null==(c=s.yc(1,11,r.activeGroup$))?null:c.id);s.Xb("active",n),s.Ub(3),s.Dc("entity",e),s.Ub(2),s.Dc("colorFrom",e.id),s.Ub(1),s.bd(e.name),s.Ub(2),s.Dc("routerLink",s.Ic(25,Ue,s.Ic(23,De,e.id))),s.Ub(2),s.cd(" ",s.yc(11,13,"customer.view-group-members")," "),s.Ub(5),s.cd(" ",s.yc(16,15,"common.edit")," "),s.Ub(5),s.cd(" ",s.yc(21,17,"common.actions")," "),s.Ub(4),s.Dc("disabled",!s.yc(25,19,"DeleteSettings")),s.Ub(3),s.cd(" ",s.yc(28,21,"common.delete")," ")}}function xe(e,t){if(1&e&&(s.mc(0,"table",9),s.mc(1,"tbody"),s.Yc(2,je,29,27,"tr",10),s.xc(3,"async"),s.lc(),s.lc()),2&e){const e=s.wc();s.Ub(2),s.Dc("ngForOf",s.yc(3,1,e.groups$))}}function Se(e,t){1&e&&s.hc(0,"vdr-empty-placeholder")}function we(e,t){if(1&e){const e=s.nc();s.kc(0),s.mc(1,"div",25),s.mc(2,"div",26),s.ad(3),s.xc(4,"async"),s.lc(),s.hc(5,"div",27),s.mc(6,"button",28),s.uc("click",(function(){return s.Rc(e),s.wc().closeMembers()})),s.hc(7,"clr-icon",29),s.lc(),s.lc(),s.mc(8,"div",30),s.mc(9,"vdr-dropdown"),s.mc(10,"button",31),s.ad(11),s.xc(12,"translate"),s.hc(13,"clr-icon",21),s.lc(),s.mc(14,"vdr-dropdown-menu",22),s.mc(15,"button",32),s.uc("click",(function(){s.Rc(e);const c=t.ngIf,r=s.wc();return r.removeFromGroup(c,r.selectedCustomerIds)})),s.xc(16,"hasPermission"),s.hc(17,"clr-icon",24),s.ad(18),s.xc(19,"translate"),s.lc(),s.lc(),s.lc(),s.mc(20,"button",33),s.uc("click",(function(){s.Rc(e);const c=t.ngIf;return s.wc().addToGroup(c)})),s.ad(21),s.xc(22,"translate"),s.lc(),s.lc(),s.mc(23,"vdr-customer-group-member-list",34),s.uc("selectionChange",(function(t){return s.Rc(e),s.wc().selectedCustomerIds=t}))("fetchParamsChange",(function(t){return s.Rc(e),s.wc().fetchGroupMembers$.next(t)})),s.xc(24,"async"),s.xc(25,"async"),s.lc(),s.jc()}if(2&e){const e=t.ngIf,c=s.wc();s.Ub(3),s.dd(" ",e.name," (",s.yc(4,11,c.membersTotal$),") "),s.Ub(7),s.Dc("disabled",0===c.selectedCustomerIds.length),s.Ub(1),s.cd(" ",s.yc(12,13,"common.with-selected")," "),s.Ub(4),s.Dc("disabled",!s.yc(16,15,"DeleteSettings")),s.Ub(3),s.cd(" ",s.yc(19,17,"customer.remove-from-group")," "),s.Ub(3),s.cd(" ",s.zc(22,19,"customer.add-customers-to-group",s.Ic(26,F,e.name))," "),s.Ub(2),s.Dc("members",s.yc(24,22,c.members$))("route",c.route)("totalItems",s.yc(25,24,c.membersTotal$))("selectedMemberIds",c.selectedCustomerIds)}}const Ie=function(e){return["/customer","customers",e]};function Pe(e,t){if(1&e&&(s.mc(0,"td",3),s.ad(1),s.lc(),s.mc(2,"td",3),s.ad(3),s.lc(),s.mc(4,"td",4),s.hc(5,"vdr-table-row-action",5),s.xc(6,"translate"),s.lc()),2&e){const e=t.item;s.Ub(1),s.ed(" ",e.title," ",e.firstName," ",e.lastName," "),s.Ub(2),s.bd(e.emailAddress),s.Ub(2),s.Dc("label",s.yc(6,6,"common.edit"))("linkTo",s.Ic(8,Ie,e.id))}}function ke(e,t){1&e&&(s.kc(0),s.ad(1),s.xc(2,"translate"),s.jc()),2&e&&(s.Ub(1),s.cd(" ",s.yc(2,1,"customer.history-customer-registered")," "))}function Ne(e,t){1&e&&(s.kc(0),s.mc(1,"div",10),s.ad(2),s.xc(3,"translate"),s.lc(),s.jc()),2&e&&(s.Ub(2),s.cd(" ",s.yc(3,1,"customer.history-customer-verified")," "))}function Me(e,t){if(1&e&&(s.kc(0),s.mc(1,"div",11),s.ad(2),s.xc(3,"translate"),s.mc(4,"vdr-history-entry-detail"),s.hc(5,"vdr-object-tree",12),s.lc(),s.lc(),s.jc()),2&e){const e=s.wc().$implicit;s.Ub(2),s.cd(" ",s.yc(3,2,"customer.history-customer-detail-updated")," "),s.Ub(3),s.Dc("value",e.data.input)}}function Te(e,t){if(1&e&&(s.kc(0),s.ad(1),s.xc(2,"translate"),s.jc()),2&e){const e=s.wc().$implicit;s.Ub(1),s.cd(" ",s.zc(2,1,"customer.history-customer-added-to-group",s.Ic(4,F,e.data.groupName))," ")}}function Ae(e,t){if(1&e&&(s.kc(0),s.ad(1),s.xc(2,"translate"),s.jc()),2&e){const e=s.wc().$implicit;s.Ub(1),s.cd(" ",s.zc(2,1,"customer.history-customer-removed-from-group",s.Ic(4,F,e.data.groupName))," ")}}function Ee(e,t){if(1&e&&(s.kc(0),s.ad(1),s.xc(2,"translate"),s.mc(3,"div",11),s.mc(4,"div",13),s.ad(5),s.lc(),s.lc(),s.jc()),2&e){const e=s.wc().$implicit;s.Ub(1),s.cd(" ",s.yc(2,2,"customer.history-customer-address-created")," "),s.Ub(4),s.bd(e.data.address)}}function Fe(e,t){if(1&e&&(s.kc(0),s.ad(1),s.xc(2,"translate"),s.mc(3,"div",11),s.mc(4,"div",13),s.ad(5),s.lc(),s.mc(6,"vdr-history-entry-detail"),s.hc(7,"vdr-object-tree",12),s.lc(),s.lc(),s.jc()),2&e){const e=s.wc().$implicit;s.Ub(1),s.cd(" ",s.yc(2,3,"customer.history-customer-address-updated")," "),s.Ub(4),s.bd(e.data.address),s.Ub(2),s.Dc("value",e.data.input)}}function $e(e,t){if(1&e&&(s.kc(0),s.ad(1),s.xc(2,"translate"),s.mc(3,"div",13),s.ad(4),s.lc(),s.jc()),2&e){const e=s.wc().$implicit;s.Ub(1),s.cd(" ",s.yc(2,2,"customer.history-customer-address-deleted")," "),s.Ub(3),s.bd(e.data.address)}}function Re(e,t){1&e&&(s.kc(0),s.ad(1),s.xc(2,"translate"),s.jc()),2&e&&(s.Ub(1),s.cd(" ",s.yc(2,1,"customer.history-customer-password-updated")," "))}function _e(e,t){1&e&&(s.kc(0),s.ad(1),s.xc(2,"translate"),s.jc()),2&e&&(s.Ub(1),s.cd(" ",s.yc(2,1,"customer.history-customer-password-reset-requested")," "))}function Ge(e,t){1&e&&(s.kc(0),s.ad(1),s.xc(2,"translate"),s.jc()),2&e&&(s.Ub(1),s.cd(" ",s.yc(2,1,"customer.history-customer-password-reset-verified")," "))}function Ye(e,t){if(1&e&&(s.kc(0),s.mc(1,"div",11),s.ad(2),s.xc(3,"translate"),s.mc(4,"vdr-history-entry-detail"),s.mc(5,"vdr-labeled-data",14),s.xc(6,"translate"),s.ad(7),s.lc(),s.mc(8,"vdr-labeled-data",14),s.xc(9,"translate"),s.ad(10),s.lc(),s.lc(),s.lc(),s.jc()),2&e){const e=s.wc().$implicit;s.Ub(2),s.cd(" ",s.yc(3,5,"customer.history-customer-email-update-requested")," "),s.Ub(3),s.Dc("label",s.yc(6,7,"customer.old-email-address")),s.Ub(2),s.bd(e.data.oldEmailAddress),s.Ub(1),s.Dc("label",s.yc(9,9,"customer.new-email-address")),s.Ub(2),s.bd(e.data.newEmailAddress)}}function Le(e,t){if(1&e&&(s.kc(0),s.mc(1,"div",11),s.ad(2),s.xc(3,"translate"),s.mc(4,"vdr-history-entry-detail"),s.mc(5,"vdr-labeled-data",14),s.xc(6,"translate"),s.ad(7),s.lc(),s.mc(8,"vdr-labeled-data",14),s.xc(9,"translate"),s.ad(10),s.lc(),s.lc(),s.lc(),s.jc()),2&e){const e=s.wc().$implicit;s.Ub(2),s.cd(" ",s.yc(3,5,"customer.history-customer-email-update-verified")," "),s.Ub(3),s.Dc("label",s.yc(6,7,"customer.old-email-address")),s.Ub(2),s.bd(e.data.oldEmailAddress),s.Ub(1),s.Dc("label",s.yc(9,9,"customer.new-email-address")),s.Ub(2),s.bd(e.data.newEmailAddress)}}function Be(e,t){if(1&e){const e=s.nc();s.kc(0),s.mc(1,"div",11),s.mc(2,"div",15),s.ad(3),s.lc(),s.hc(4,"div",16),s.mc(5,"vdr-dropdown"),s.mc(6,"button",17),s.hc(7,"clr-icon",18),s.lc(),s.mc(8,"vdr-dropdown-menu",19),s.mc(9,"button",20),s.uc("click",(function(){s.Rc(e);const t=s.wc().$implicit;return s.wc().updateNote.emit(t)})),s.xc(10,"hasPermission"),s.hc(11,"clr-icon",21),s.ad(12),s.xc(13,"translate"),s.lc(),s.hc(14,"div",22),s.mc(15,"button",20),s.uc("click",(function(){s.Rc(e);const t=s.wc().$implicit;return s.wc().deleteNote.emit(t)})),s.xc(16,"hasPermission"),s.hc(17,"clr-icon",23),s.ad(18),s.xc(19,"translate"),s.lc(),s.lc(),s.lc(),s.lc(),s.jc()}if(2&e){const e=s.wc().$implicit;s.Ub(3),s.cd(" ",e.data.note," "),s.Ub(6),s.Dc("disabled",!s.yc(10,5,"UpdateOrder")),s.Ub(3),s.cd(" ",s.yc(13,7,"common.edit")," "),s.Ub(3),s.Dc("disabled",!s.yc(16,9,"UpdateOrder")),s.Ub(3),s.cd(" ",s.yc(19,11,"common.delete")," ")}}function Ke(e,t){if(1&e&&(s.mc(0,"vdr-timeline-entry",7),s.kc(1,8),s.Yc(2,ke,3,3,"ng-container",9),s.Yc(3,Ne,4,3,"ng-container",9),s.Yc(4,Me,6,4,"ng-container",9),s.Yc(5,Te,3,6,"ng-container",9),s.Yc(6,Ae,3,6,"ng-container",9),s.Yc(7,Ee,6,4,"ng-container",9),s.Yc(8,Fe,8,5,"ng-container",9),s.Yc(9,$e,5,4,"ng-container",9),s.Yc(10,Re,3,3,"ng-container",9),s.Yc(11,_e,3,3,"ng-container",9),s.Yc(12,Ge,3,3,"ng-container",9),s.Yc(13,Ye,11,11,"ng-container",9),s.Yc(14,Le,11,11,"ng-container",9),s.Yc(15,Be,20,13,"ng-container",9),s.jc(),s.lc()),2&e){const e=t.$implicit,c=s.wc();s.Dc("displayType",c.getDisplayType(e))("iconShape",c.getTimelineIcon(e))("createdAt",e.createdAt)("name",c.getName(e)),s.Ub(1),s.Dc("ngSwitch",e.type),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_REGISTERED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_VERIFIED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_DETAIL_UPDATED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_ADDED_TO_GROUP),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_REMOVED_FROM_GROUP),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_ADDRESS_CREATED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_ADDRESS_UPDATED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_ADDRESS_DELETED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_PASSWORD_UPDATED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_PASSWORD_RESET_REQUESTED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_PASSWORD_RESET_VERIFIED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_EMAIL_UPDATE_REQUESTED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_EMAIL_UPDATE_VERIFIED),s.Ub(1),s.Dc("ngSwitchCase",c.type.CUSTOMER_NOTE)}}const Ve=function(){return["./create"]};function He(e,t){1&e&&(s.mc(0,"a",5),s.hc(1,"clr-icon",6),s.ad(2),s.xc(3,"translate"),s.lc()),2&e&&(s.Dc("routerLink",s.Hc(4,Ve)),s.Ub(2),s.cd(" ",s.yc(3,2,"customer.create-new-customer")," "))}function qe(e,t){if(1&e){const e=s.nc();s.mc(0,"td",7),s.ad(1),s.lc(),s.mc(2,"td",7),s.ad(3),s.lc(),s.mc(4,"td",7),s.hc(5,"vdr-customer-status-label",8),s.lc(),s.mc(6,"td",9),s.hc(7,"vdr-table-row-action",10),s.xc(8,"translate"),s.lc(),s.mc(9,"td"),s.mc(10,"vdr-dropdown"),s.mc(11,"button",11),s.ad(12),s.xc(13,"translate"),s.hc(14,"clr-icon",12),s.lc(),s.mc(15,"vdr-dropdown-menu",13),s.mc(16,"button",14),s.uc("click",(function(){s.Rc(e);const c=t.item;return s.wc().deleteCustomer(c)})),s.xc(17,"hasPermission"),s.hc(18,"clr-icon",15),s.ad(19),s.xc(20,"translate"),s.lc(),s.lc(),s.lc(),s.lc()}if(2&e){const e=t.item;s.Ub(1),s.ed(" ",e.title," ",e.firstName," ",e.lastName," "),s.Ub(2),s.bd(e.emailAddress),s.Ub(2),s.Dc("customer",e),s.Ub(2),s.Dc("label",s.yc(8,10,"common.edit"))("linkTo",s.Ic(18,Ue,e.id)),s.Ub(5),s.cd(" ",s.yc(13,12,"common.actions")," "),s.Ub(4),s.Dc("disabled",!s.yc(17,14,"DeleteCustomer")),s.Ub(3),s.cd(" ",s.yc(20,16,"common.delete")," ")}}function ze(e,t){1&e&&(s.kc(0),s.hc(1,"clr-icon",1),s.ad(2),s.xc(3,"translate"),s.jc()),2&e&&(s.Ub(2),s.cd(" ",s.yc(3,1,"customer.verified")," "))}function We(e,t){1&e&&(s.kc(0),s.hc(1,"clr-icon",2),s.ad(2),s.xc(3,"translate"),s.jc()),2&e&&(s.Ub(2),s.cd(" ",s.yc(3,1,"customer.registered")," "))}function Qe(e,t){if(1&e&&(s.mc(0,"vdr-chip"),s.Yc(1,ze,4,3,"ng-container",0),s.Yc(2,We,4,3,"ng-container",0),s.lc()),2&e){const e=s.wc();s.Ub(1),s.Dc("ngIf",null==e.customer.user?null:e.customer.user.verified),s.Ub(1),s.Dc("ngIf",!(null!=e.customer.user&&e.customer.user.verified))}}function Ze(e,t){1&e&&(s.mc(0,"vdr-chip"),s.ad(1),s.xc(2,"translate"),s.lc()),2&e&&(s.Ub(1),s.bd(s.yc(2,1,"customer.guest")))}let Xe=class{constructor(e){this.dataService=e,this.selectedCustomerIds=[],this.fetchGroupMembers$=new o.a({skip:0,take:10,filterTerm:""})}ngOnInit(){const e=this.fetchGroupMembers$.pipe(Object(p.a)(({skip:e,take:t,filterTerm:c})=>this.dataService.customer.getCustomerList(t,e,c).mapStream(e=>e.customers)));this.customers$=e.pipe(Object(b.a)(e=>e.items)),this.customersTotal$=e.pipe(Object(b.a)(e=>e.totalItems))}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedCustomerIds)}};Xe.\u0275fac=function(e){return new(e||Xe)(s.gc(n.K))},Xe.\u0275cmp=s.ac({type:Xe,selectors:[["vdr-add-customer-to-group-dialog"]],decls:5,vars:8,consts:[["vdrDialogTitle",""],[3,"members","totalItems","route","selectedMemberIds","fetchParamsChange","selectionChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Yc(0,$,2,6,"ng-template",0),s.mc(1,"vdr-customer-group-member-list",1),s.uc("fetchParamsChange",(function(e){return t.fetchGroupMembers$.next(e)}))("selectionChange",(function(e){return t.selectedCustomerIds=e})),s.xc(2,"async"),s.xc(3,"async"),s.lc(),s.Yc(4,_,6,10,"ng-template",2)),2&e&&(s.Ub(1),s.Dc("members",s.yc(2,4,t.customers$))("totalItems",s.yc(3,6,t.customersTotal$))("route",t.route)("selectedMemberIds",t.selectedCustomerIds))},directives:function(){return[n.Q,st,n.P]},pipes:function(){return[M.b,T.d]},styles:[""],changeDetection:0}),Xe.ctorParameters=()=>[{type:n.K}],Xe=Object(r.c)([Object(r.f)("design:paramtypes",[n.K])],Xe);let Je=class{constructor(){this.editing=!1,this.availableCountries=[],this.setAsDefaultShipping=new s.u,this.setAsDefaultBilling=new s.u}ngOnInit(){this.addressForm.get("streetLine1").value||(this.editing=!0)}getCountryName(e){if(!this.availableCountries)return"";const t=this.availableCountries.find(t=>t.code===e);return t?t.name:""}setAsDefaultBillingAddress(){this.setAsDefaultBilling.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}setAsDefaultShippingAddress(){this.setAsDefaultShipping.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}};Je.\u0275fac=function(e){return new(e||Je)},Je.\u0275cmp=s.ac({type:Je,selectors:[["vdr-address-card"]],inputs:{availableCountries:"availableCountries",addressForm:"addressForm",isDefaultBilling:"isDefaultBilling",isDefaultShipping:"isDefaultShipping"},outputs:{setAsDefaultShipping:"setAsDefaultShipping",setAsDefaultBilling:"setAsDefaultBilling"},decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"address-title"],["class","street-line",4,"ngIf"],[1,"default-controls"],["class","is-default p8",4,"ngIf"],[1,"card-block"],[1,"card-text"],[3,"address",4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"card-footer"],[3,"entity"],["class","btn btn-sm btn-link",3,"click",4,"ngIf"],["type","button","vdrDropdownTrigger","",1,"btn","btn-sm","btn-link"],["shape","caret down"],["vdrDropdownItem","",1,"button",3,"disabled","click"],[1,"street-line"],[1,"is-default","p8"],["shape","truck"],["shape","credit-card"],[3,"address"],[3,"formGroup"],["formControlName","fullName","type","text","clrInput",""],["formControlName","streetLine1","type","text","clrInput",""],["formControlName","streetLine2","type","text","clrInput",""],["formControlName","city","type","text","clrInput",""],["formControlName","province","type","text","clrInput",""],["formControlName","postalCode","type","text","clrInput",""],["name","countryCode","formControlName","countryCode","clrInput","","clrSelect",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","phoneNumber","type","text","clrInput",""],[3,"value"],[1,"btn","btn-sm","btn-link",3,"click"]],template:function(e,t){1&e&&s.Yc(0,z,28,20,"div",0),2&e&&s.Dc("ngIf",t.addressForm.value)},directives:[M.p,n.Z,n.S,n.V,A.o,n.U,n.T,n.B,n.fb,w.E,w.q,w.j,A.s,A.t,n.db,w.b,w.p,w.h,A.r,w.A,A.z,M.o,w.u,w.D],pipes:[T.d],styles:["[_nghost-%COMP%]{display:block;max-width:360px}clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}.defaul-controls[_ngcontent-%COMP%]{display:flex}.is-default[_ngcontent-%COMP%]{margin:0;color:#308300}"],changeDetection:0}),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",w.i)],Je.prototype,"addressForm",void 0),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",Array)],Je.prototype,"availableCountries",void 0),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",String)],Je.prototype,"isDefaultBilling",void 0),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",String)],Je.prototype,"isDefaultShipping",void 0),Object(r.c)([Object(s.O)(),Object(r.f)("design:type",Object)],Je.prototype,"setAsDefaultShipping",void 0),Object(r.c)([Object(s.O)(),Object(r.f)("design:type",Object)],Je.prototype,"setAsDefaultBilling",void 0);let et=class{constructor(e){this.dataService=e,this.selectedGroupIds=[]}ngOnInit(){this.groups$=this.dataService.customer.getCustomerGroupList().mapStream(e=>e.customerGroups.items)}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedGroupIds)}};et.\u0275fac=function(e){return new(e||et)(s.gc(n.K))},et.\u0275cmp=s.ac({type:et,selectors:[["vdr-select-customer-group-dialog"]],decls:6,vars:8,consts:[["vdrDialogTitle",""],["appendTo","body","bindValue","id",3,"items","addTag","multiple","ngModel","clearable","searchable","ngModelChange"],["ng-label-tmp",""],["ng-option-tmp",""],["vdrDialogButtons",""],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[3,"colorFrom"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Yc(0,W,2,3,"ng-template",0),s.mc(1,"ng-select",1),s.uc("ngModelChange",(function(e){return t.selectedGroupIds=e})),s.xc(2,"async"),s.Yc(3,Q,4,2,"ng-template",2),s.Yc(4,Z,2,2,"ng-template",3),s.lc(),s.Yc(5,X,6,10,"ng-template",4)),2&e&&(s.Ub(1),s.Dc("items",s.yc(2,6,t.groups$))("addTag",!1)("multiple",!0)("ngModel",t.selectedGroupIds)("clearable",!0)("searchable",!1))},directives:[n.Q,E.a,w.p,w.s,E.e,E.d,n.P,n.B],pipes:[M.b,T.d],styles:[""],changeDetection:0}),et.ctorParameters=()=>[{type:n.K}],et=Object(r.c)([Object(r.f)("design:paramtypes",[n.K])],et);let tt=class extends n.u{constructor(e,t,c,r,s,n,o,a){super(e,t,c,n),this.changeDetector=r,this.formBuilder=s,this.dataService=n,this.modalService=o,this.notificationService=a,this.fetchHistory=new i.a,this.addressDefaultsUpdated=!1,this.ordersPerPage=10,this.currentOrdersPage=1,this.orderListUpdates$=new i.a,this.customFields=this.getCustomFieldConfig("Customer"),this.detailForm=this.formBuilder.group({customer:this.formBuilder.group({title:"",firstName:["",w.C.required],lastName:["",w.C.required],phoneNumber:"",emailAddress:"",password:"",customFields:this.formBuilder.group(this.customFields.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:""}),{}))}),addresses:new w.c([])})}ngOnInit(){this.init(),this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(e=>e.countries.items).pipe(Object(g.a)(1));const e=this.entity$.pipe(function(...e){return t=>t.lift.call(Object(f.a)(t,...e))}(this.orderListUpdates$));this.orders$=e.pipe(Object(b.a)(e=>e.orders.items)),this.ordersCount$=this.entity$.pipe(Object(b.a)(e=>e.orders.totalItems)),this.history$=this.fetchHistory.pipe(Object(h.a)(null),Object(p.a)(()=>this.dataService.customer.getCustomerHistory(this.id,{sort:{createdAt:n.Hb.DESC}}).mapStream(e=>{var t;return null===(t=e.customer)||void 0===t?void 0:t.history.items})))}ngOnDestroy(){this.destroy(),this.orderListUpdates$.complete()}customFieldIsSet(e){return!!this.detailForm.get(["customer","customFields",e])}getAddressFormControls(){return this.detailForm.get(["addresses"]).controls}setDefaultBillingAddressId(e){this.defaultBillingAddressId=e,this.addressDefaultsUpdated=!0}setDefaultShippingAddressId(e){this.defaultShippingAddressId=e,this.addressDefaultsUpdated=!0}addAddress(){const e=this.detailForm.get("addresses"),t=this.formBuilder.group({fullName:"",company:"",streetLine1:["",w.C.required],streetLine2:"",city:"",province:"",postalCode:"",countryCode:["",w.C.required],phoneNumber:"",defaultShippingAddress:!1,defaultBillingAddress:!1});e.push(t)}setOrderItemsPerPage(e){this.ordersPerPage=+e,this.fetchOrdersList()}setOrderCurrentPage(e){this.currentOrdersPage=+e,this.fetchOrdersList()}create(){const e=this.detailForm.get("customer");if(!e)return;const t=e.value,c={title:t.title,emailAddress:t.emailAddress,firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phoneNumber};this.dataService.customer.createCustomer(c,t.password).subscribe(e=>{this.notificationService.success(Object(P.a)("common.notify-create-success"),{entity:"Customer"}),t.password||this.notificationService.notify({message:Object(P.a)("customer.email-verification-sent"),translationVars:{emailAddress:t.emailAddress},type:"info",duration:1e4}),this.detailForm.markAsPristine(),this.addressDefaultsUpdated=!1,this.changeDetector.markForCheck(),this.router.navigate(["../",e.createCustomer.id],{relativeTo:this.route})},e=>{this.notificationService.error(Object(P.a)("common.notify-create-error"),{entity:"Customer"})})}save(){this.entity$.pipe(Object(y.a)(1),Object(v.a)(({id:e})=>{const t=[],c=this.detailForm.get("customer");if(c&&c.dirty){const r=c.value,s={id:e,title:r.title,emailAddress:r.emailAddress,firstName:r.firstName,lastName:r.lastName,phoneNumber:r.phoneNumber};t.push(this.dataService.customer.updateCustomer(s))}const r=this.detailForm.get("addresses");if(r&&r.dirty||this.addressDefaultsUpdated)for(const s of r.controls)if(s.dirty||this.addressDefaultsUpdated){const c=s.value,r={fullName:c.fullName,company:c.company,streetLine1:c.streetLine1,streetLine2:c.streetLine2,city:c.city,province:c.province,postalCode:c.postalCode,countryCode:c.countryCode,phoneNumber:c.phoneNumber,defaultShippingAddress:this.defaultShippingAddressId===c.id,defaultBillingAddress:this.defaultBillingAddressId===c.id};c.id?t.push(this.dataService.customer.updateCustomerAddress(Object.assign(Object.assign({},r),{id:c.id}))):t.push(this.dataService.customer.createCustomerAddress(e,r))}return Object(a.a)(t)})).subscribe(e=>{this.notificationService.success(Object(P.a)("common.notify-update-success"),{entity:"Customer"}),this.detailForm.markAsPristine(),this.addressDefaultsUpdated=!1,this.changeDetector.markForCheck(),this.fetchHistory.next()},e=>{this.notificationService.error(Object(P.a)("common.notify-update-error"),{entity:"Customer"})})}addToGroup(){this.modalService.fromComponent(et,{size:"md"}).pipe(Object(p.a)(e=>e?Object(d.a)(e):l.a),Object(O.a)(e=>this.dataService.customer.addCustomersToGroup(e,[this.id]))).subscribe({next:e=>{this.notificationService.success(Object(P.a)("customer.add-customers-to-group-success"),{customerCount:1,groupName:e.addCustomersToGroup.name})},complete:()=>{this.dataService.customer.getCustomer(this.id,{take:0}).single$.subscribe(),this.fetchHistory.next()}})}removeFromGroup(e){this.modalService.dialog({title:Object(P.a)("customer.confirm-remove-customer-from-group"),buttons:[{type:"secondary",label:Object(P.a)("common.cancel")},{type:"danger",label:Object(P.a)("common.delete"),returnValue:!0}]}).pipe(Object(p.a)(t=>t?this.dataService.customer.removeCustomersFromGroup(e.id,[this.id]):l.a),Object(p.a)(()=>this.dataService.customer.getCustomer(this.id,{take:0}).single$)).subscribe(t=>{this.notificationService.success(Object(P.a)("customer.remove-customers-from-group-success"),{customerCount:1,groupName:e.name}),this.fetchHistory.next()})}addNoteToCustomer({note:e}){this.dataService.customer.addNoteToCustomer(this.id,e).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success(Object(P.a)("common.notify-create-success"),{entity:"Note"})})}updateNote(e){this.modalService.fromComponent(n.X,{closable:!0,locals:{displayPrivacyControls:!1,note:e.data.note}}).pipe(Object(p.a)(t=>t?this.dataService.customer.updateCustomerNote({noteId:e.id,note:t.note}):l.a)).subscribe(e=>{this.fetchHistory.next(),this.notificationService.success(Object(P.a)("common.notify-update-success"),{entity:"Note"})})}deleteNote(e){return this.modalService.dialog({title:Object(P.a)("common.confirm-delete-note"),body:e.data.note,buttons:[{type:"secondary",label:Object(P.a)("common.cancel")},{type:"danger",label:Object(P.a)("common.delete"),returnValue:!0}]}).pipe(Object(p.a)(t=>t?this.dataService.customer.deleteCustomerNote(e.id):l.a)).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success(Object(P.a)("common.notify-delete-success"),{entity:"Note"})})}setFormValues(e){const t=this.detailForm.get("customer");if(t&&t.patchValue({title:e.title,firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phoneNumber,emailAddress:e.emailAddress}),e.addresses){const t=new w.c([]);for(const c of e.addresses)t.push(this.formBuilder.group(Object.assign(Object.assign({},c),{countryCode:c.country.code}))),c.defaultShippingAddress&&(this.defaultShippingAddressId=c.id),c.defaultBillingAddress&&(this.defaultBillingAddressId=c.id);this.detailForm.setControl("addresses",t)}if(this.customFields.length){const t=this.detailForm.get(["customer","customFields"]);for(const c of this.customFields){const r=c.name,s=e.customFields[r],n=t.get(r);n&&n.patchValue(s)}}this.changeDetector.markForCheck()}fetchOrdersList(){this.dataService.customer.getCustomer(this.id,{take:this.ordersPerPage,skip:(this.currentOrdersPage-1)*this.ordersPerPage}).single$.pipe(Object(b.a)(e=>e.customer),Object(C.a)(k.notNullOrUndefined)).subscribe(e=>this.orderListUpdates$.next(e))}};tt.\u0275fac=function(e){return new(e||tt)(s.gc(I.a),s.gc(I.e),s.gc(n.Fb),s.gc(s.k),s.gc(w.e),s.gc(n.K),s.gc(n.xb),s.gc(n.yb))},tt.\u0275cmp=s.ac({type:tt,selectors:[["vdr-customer-detail"]],features:[s.Rb],decls:43,vars:54,consts:[[1,"flex","clr-align-items-center"],[3,"entity"],[3,"customer"],["locationId","customer-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","title",3,"label","readOnlyToggle"],["id","title","type","text","formControlName","title"],["for","firstName",3,"label","readOnlyToggle"],["id","firstName","type","text","formControlName","firstName"],["for","lastName",3,"label","readOnlyToggle"],["id","lastName","type","text","formControlName","lastName"],["for","phoneNumber",3,"label","readOnlyToggle"],["id","phoneNumber","type","text","formControlName","phoneNumber"],["for","emailAddress",3,"label","readOnlyToggle"],["id","emailAddress","type","text","formControlName","emailAddress"],["for","password",3,"label",4,"ngIf"],["formGroupName","customFields",4,"ngIf"],["class","groups",4,"ngIf"],["class","clr-row",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["for","password",3,"label"],["id","password","type","password","formControlName","password"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","Customer",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Customer",3,"customFieldsFormGroup","customField"],[1,"groups"],[1,"clr-control-label"],[4,"ngIf","ngIfElse"],["noGroups",""],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["icon","times",3,"colorFrom","iconClick",4,"ngFor","ngForOf"],["icon","times",3,"colorFrom","iconClick"],[1,"clr-row"],[1,"clr-col-md-4"],[3,"availableCountries","isDefaultBilling","isDefaultShipping","addressForm","setAsDefaultBilling","setAsDefaultShipping",4,"ngFor","ngForOf"],[1,"btn","btn-secondary",3,"click"],[1,"clr-col-md-8"],[3,"items","itemsPerPage","totalItems","currentPage","emptyStateLabel","itemsPerPageChange","pageChange"],[3,"availableCountries","isDefaultBilling","isDefaultShipping","addressForm","setAsDefaultBilling","setAsDefaultShipping"],[1,"left"],[1,"right"],["iconShape","shopping-cart",3,"label","linkTo"],[1,"clr-col-md-6"],[3,"customer","history","addNote","updateNote","deleteNote"]],template:function(e,t){if(1&e&&(s.mc(0,"vdr-action-bar"),s.mc(1,"vdr-ab-left"),s.mc(2,"div",0),s.hc(3,"vdr-entity-info",1),s.xc(4,"async"),s.hc(5,"vdr-customer-status-label",2),s.xc(6,"async"),s.lc(),s.lc(),s.mc(7,"vdr-ab-right"),s.hc(8,"vdr-action-bar-items",3),s.Yc(9,J,3,4,"button",4),s.xc(10,"async"),s.Yc(11,ee,3,4,"ng-template",null,5,s.Zc),s.lc(),s.lc(),s.mc(13,"form",6),s.mc(14,"vdr-form-field",7),s.xc(15,"translate"),s.xc(16,"async"),s.hc(17,"input",8),s.lc(),s.mc(18,"vdr-form-field",9),s.xc(19,"translate"),s.xc(20,"async"),s.hc(21,"input",10),s.lc(),s.mc(22,"vdr-form-field",11),s.xc(23,"translate"),s.xc(24,"async"),s.hc(25,"input",12),s.lc(),s.mc(26,"vdr-form-field",13),s.xc(27,"translate"),s.xc(28,"async"),s.hc(29,"input",14),s.lc(),s.mc(30,"vdr-form-field",15),s.xc(31,"translate"),s.xc(32,"async"),s.hc(33,"input",16),s.lc(),s.Yc(34,te,3,3,"vdr-form-field",17),s.xc(35,"async"),s.Yc(36,ne,5,4,"section",18),s.lc(),s.Yc(37,de,12,8,"div",19),s.xc(38,"async"),s.Yc(39,pe,32,33,"div",20),s.xc(40,"async"),s.Yc(41,be,5,6,"div",20),s.xc(42,"async")),2&e){const e=s.Oc(12);var c;const r=null==(c=s.yc(38,48,t.entity$))?null:c.groups;s.Ub(3),s.Dc("entity",s.yc(4,20,t.entity$)),s.Ub(2),s.Dc("customer",s.yc(6,22,t.entity$)),s.Ub(4),s.Dc("ngIf",s.yc(10,24,t.isNew$))("ngIfElse",e),s.Ub(4),s.Dc("formGroup",t.detailForm.get("customer")),s.Ub(1),s.Dc("label",s.yc(15,26,"customer.title"))("readOnlyToggle",!s.yc(16,28,t.isNew$)),s.Ub(4),s.Dc("label",s.yc(19,30,"customer.first-name"))("readOnlyToggle",!s.yc(20,32,t.isNew$)),s.Ub(4),s.Dc("label",s.yc(23,34,"customer.last-name"))("readOnlyToggle",!s.yc(24,36,t.isNew$)),s.Ub(4),s.Dc("label",s.yc(27,38,"customer.phone-number"))("readOnlyToggle",!s.yc(28,40,t.isNew$)),s.Ub(4),s.Dc("label",s.yc(31,42,"customer.email-address"))("readOnlyToggle",!s.yc(32,44,t.isNew$)),s.Ub(4),s.Dc("ngIf",s.yc(35,46,t.isNew$)),s.Ub(2),s.Dc("ngIf",t.customFields.length),s.Ub(1),s.Dc("ngIf",r),s.Ub(2),s.Dc("ngIf",!s.yc(40,50,t.isNew$)),s.Ub(2),s.Dc("ngIf",!s.yc(42,52,t.isNew$))}},directives:function(){return[n.c,n.e,n.Z,it,n.f,n.d,M.p,w.E,w.q,w.j,n.cb,n.db,w.b,w.p,w.h,w.k,A.t,M.o,n.H,A.o,n.B,n.M,n.L,Je,n.Kb,nt]},pipes:function(){return[M.b,T.d,M.d,M.f]},styles:[""],changeDetection:0}),tt.ctorParameters=()=>[{type:I.a},{type:I.e},{type:n.Fb},{type:s.k},{type:w.e},{type:n.K},{type:n.xb},{type:n.yb}],tt=Object(r.c)([Object(r.f)("design:paramtypes",[I.a,I.e,n.Fb,s.k,w.e,n.K,n.xb,n.yb])],tt);let ct=class{cancel(){this.resolveWith()}save(){this.resolveWith(this.group.name)}};ct.\u0275fac=function(e){return new(e||ct)},ct.\u0275cmp=s.ac({type:ct,selectors:[["vdr-customer-group-detail-dialog"]],decls:6,vars:7,consts:[["vdrDialogTitle",""],["for","name",3,"label"],["id","name","type","text",3,"ngModel","readonly","ngModelChange"],["vdrDialogButtons",""],[4,"ngIf"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Yc(0,he,2,2,"ng-template",0),s.mc(1,"vdr-form-field",1),s.xc(2,"translate"),s.mc(3,"input",2),s.uc("ngModelChange",(function(e){return t.group.name=e})),s.xc(4,"hasPermission"),s.lc(),s.lc(),s.Yc(5,Oe,6,6,"ng-template",3)),2&e&&(s.Ub(1),s.Dc("label",s.yc(2,3,"common.name")),s.Ub(2),s.Dc("ngModel",t.group.name)("readonly",!s.yc(4,5,"UpdateCustomer")))},directives:[n.Q,n.cb,n.db,w.b,w.p,w.s,n.P,M.p],pipes:[T.d,n.gb],styles:[""],changeDetection:0});let rt=class{constructor(e,t,c,r,s){this.dataService=e,this.notificationService=t,this.modalService=c,this.route=r,this.router=s,this.selectedCustomerIds=[],this.fetchGroupMembers$=new o.a({skip:0,take:0,filterTerm:""}),this.refreshActiveGroupMembers$=new o.a(void 0)}ngOnInit(){this.groups$=this.dataService.customer.getCustomerGroupList().mapStream(e=>e.customerGroups.items);const e=this.route.paramMap.pipe(Object(b.a)(e=>e.get("contents")),Object(D.a)(),Object(U.a)(()=>this.selectedCustomerIds=[]));this.listIsEmpty$=this.groups$.pipe(Object(b.a)(e=>0===e.length)),this.activeGroup$=Object(m.a)(this.groups$,e).pipe(Object(b.a)(([e,t])=>{if(t)return e.find(e=>e.id===t)}));const t=Object(m.a)(this.activeGroup$,this.fetchGroupMembers$,this.refreshActiveGroupMembers$).pipe(Object(p.a)(([e,{skip:t,take:c,filterTerm:r}])=>e?this.dataService.customer.getCustomerGroupWithCustomers(e.id,{skip:t,take:c,filter:{emailAddress:{contains:r}}}).mapStream(e=>{var t;return null===(t=e.customerGroup)||void 0===t?void 0:t.customers}):Object(u.a)(void 0)));this.members$=t.pipe(Object(b.a)(e=>{var t;return null!==(t=null==e?void 0:e.items)&&void 0!==t?t:[]})),this.membersTotal$=t.pipe(Object(b.a)(e=>{var t;return null!==(t=null==e?void 0:e.totalItems)&&void 0!==t?t:0}))}create(){this.modalService.fromComponent(ct,{locals:{group:{name:""}}}).pipe(Object(p.a)(e=>e?this.dataService.customer.createCustomerGroup({name:e,customerIds:[]}):l.a),Object(p.a)(()=>this.dataService.customer.getCustomerGroupList().single$)).subscribe(()=>{this.notificationService.success(Object(P.a)("common.notify-create-success"),{entity:"CustomerGroup"})},e=>{this.notificationService.error(Object(P.a)("common.notify-create-error"),{entity:"CustomerGroup"})})}delete(e){this.modalService.dialog({title:Object(P.a)("customer.confirm-delete-customer-group"),buttons:[{type:"secondary",label:Object(P.a)("common.cancel")},{type:"danger",label:Object(P.a)("common.delete"),returnValue:!0}]}).pipe(Object(p.a)(t=>t?this.dataService.customer.deleteCustomerGroup(e):l.a),Object(p.a)(e=>e.deleteCustomerGroup.result===n.O.DELETED?this.dataService.customer.getCustomerGroupList().mapSingle(()=>({errorMessage:!1})):Object(u.a)({errorMessage:e.deleteCustomerGroup.message}))).subscribe(e=>{"string"==typeof e.errorMessage?this.notificationService.error(e.errorMessage):this.notificationService.success(Object(P.a)("common.notify-delete-success"),{entity:"CustomerGroup"})},e=>{this.notificationService.error(Object(P.a)("common.notify-delete-error"),{entity:"CustomerGroup"})})}update(e){this.modalService.fromComponent(ct,{locals:{group:e}}).pipe(Object(p.a)(t=>t?this.dataService.customer.updateCustomerGroup({id:e.id,name:t}):l.a)).subscribe(()=>{this.notificationService.success(Object(P.a)("common.notify-update-success"),{entity:"CustomerGroup"})},e=>{this.notificationService.error(Object(P.a)("common.notify-update-error"),{entity:"CustomerGroup"})})}closeMembers(){const e=Object.assign({},this.route.snapshot.params);delete e.contents,this.router.navigate(["./",e],{relativeTo:this.route,queryParamsHandling:"preserve"})}addToGroup(e){this.modalService.fromComponent(Xe,{locals:{group:e,route:this.route},size:"md",verticalAlign:"top"}).pipe(Object(p.a)(t=>t?this.dataService.customer.addCustomersToGroup(e.id,t).pipe(Object(j.a)(t)):l.a)).subscribe({next:t=>{this.notificationService.success(Object(P.a)("customer.add-customers-to-group-success"),{customerCount:t.length,groupName:e.name}),this.refreshActiveGroupMembers$.next(),this.selectedCustomerIds=[]}})}removeFromGroup(e,t){this.dataService.customer.removeCustomersFromGroup(e.id,t).subscribe({complete:()=>{this.notificationService.success(Object(P.a)("customer.remove-customers-from-group-success"),{customerCount:t.length,groupName:e.name}),this.refreshActiveGroupMembers$.next(),this.selectedCustomerIds=[]}})}};rt.\u0275fac=function(e){return new(e||rt)(s.gc(n.K),s.gc(n.yb),s.gc(n.xb),s.gc(I.a),s.gc(I.e))},rt.\u0275cmp=s.ac({type:rt,selectors:[["vdr-customer-group-list"]],decls:14,vars:12,consts:[["locationId","customer-group-list"],["class","btn btn-primary",3,"click",4,"vdrIfPermissions"],[1,"group-wrapper"],["class","table group-list",4,"ngIf","ngIfElse"],["emptyPlaceholder",""],[1,"group-members"],[4,"ngIf"],[1,"btn","btn-primary",3,"click"],["shape","plus"],[1,"table","group-list"],[3,"active",4,"ngFor","ngForOf"],[1,"left","align-middle"],[3,"entity"],[3,"colorFrom"],[1,"text-right","align-middle"],["queryParamsHandling","preserve",1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","view-list"],[1,"align-middle"],[1,"btn","btn-link","btn-sm",3,"click"],["shape","edit"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","trash",1,"is-danger"],[1,"flex"],[1,"header-title-row"],[1,"flex-spacer"],["type","button",1,"close-button",3,"click"],["shape","close"],[1,"controls"],["type","button","vdrDropdownTrigger","",1,"btn","btn-secondary","btn-sm",3,"disabled"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],[1,"btn","btn-secondary","btn-sm",3,"click"],[3,"members","route","totalItems","selectedMemberIds","selectionChange","fetchParamsChange"]],template:function(e,t){if(1&e&&(s.mc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.mc(2,"vdr-ab-right"),s.hc(3,"vdr-action-bar-items",0),s.Yc(4,Ce,4,3,"button",1),s.lc(),s.lc(),s.mc(5,"div",2),s.Yc(6,xe,4,3,"table",3),s.xc(7,"async"),s.Yc(8,Se,1,0,"ng-template",null,4,s.Zc),s.mc(10,"div",5),s.xc(11,"async"),s.Yc(12,we,26,28,"ng-container",6),s.xc(13,"async"),s.lc(),s.lc()),2&e){const e=s.Oc(9);s.Ub(4),s.Dc("vdrIfPermissions","CreateCustomer"),s.Ub(2),s.Dc("ngIf",!s.yc(7,6,t.listIsEmpty$))("ngIfElse",e),s.Ub(4),s.Xb("expanded",s.yc(11,8,t.activeGroup$)),s.Ub(2),s.Dc("ngIf",s.yc(13,10,t.activeGroup$))}},directives:function(){return[n.c,n.e,n.f,n.d,n.ob,M.p,A.o,M.o,n.Z,n.B,I.h,n.S,n.V,n.U,n.T,n.Y,st]},pipes:function(){return[M.b,T.d,n.gb]},styles:[".group-wrapper[_ngcontent-%COMP%]{display:flex;height:calc(100% - 50px)}.group-wrapper[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]{flex:1;overflow:auto;margin-top:0}.group-wrapper[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]{background-color:#f2f3f5}.group-members[_ngcontent-%COMP%]{height:100%;width:0;opacity:0;visibility:hidden;overflow:auto;transition:width .3s,opacity .2s .3s,visibility .3s}.group-members.expanded[_ngcontent-%COMP%]{width:40vw;visibility:visible;opacity:1;padding-left:12px}.group-members[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{margin:0;background:0 0;border:none;cursor:pointer}.group-members[_ngcontent-%COMP%]     table.table{margin-top:0}.group-members[_ngcontent-%COMP%]     table.table th{top:0}.group-members[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between}vdr-empty-placeholder[_ngcontent-%COMP%]{flex:1}"],changeDetection:0}),rt.ctorParameters=()=>[{type:n.K},{type:n.yb},{type:n.xb},{type:I.a},{type:I.e}],rt=Object(r.c)([Object(r.f)("design:paramtypes",[n.K,n.yb,n.xb,I.a,I.e])],rt);let st=class{constructor(e,t){this.router=e,this.dataService=t,this.selectedMemberIds=[],this.selectionChange=new s.u,this.fetchParamsChange=new s.u,this.filterTermControl=new w.f(""),this.refresh$=new o.a(!0),this.destroy$=new i.a,this.isMemberSelected=e=>-1<this.selectedMemberIds.indexOf(e.id)}ngOnInit(){this.membersCurrentPage$=this.route.paramMap.pipe(Object(b.a)(e=>e.get("membersPage")),Object(b.a)(e=>e?+e:1),Object(h.a)(1),Object(D.a)()),this.membersItemsPerPage$=this.route.paramMap.pipe(Object(b.a)(e=>e.get("membersPerPage")),Object(b.a)(e=>e?+e:10),Object(h.a)(10),Object(D.a)());const e=this.filterTermControl.valueChanges.pipe(Object(x.a)(250),Object(U.a)(()=>this.setContentsPageNumber(1)),Object(h.a)(""));Object(m.a)(this.membersCurrentPage$,this.membersItemsPerPage$,e,this.refresh$).pipe(Object(S.a)(this.destroy$)).subscribe(([e,t,c])=>{const r=t,s=(e-1)*t;this.fetchParamsChange.emit({filterTerm:c,skip:s,take:r})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setContentsPageNumber(e){this.setParam("membersPage",e)}setContentsItemsPerPage(e){this.setParam("membersPerPage",e)}refresh(){this.refresh$.next(!0)}setParam(e,t){this.router.navigate(["./",Object.assign(Object.assign({},this.route.snapshot.params),{[e]:t})],{relativeTo:this.route,queryParamsHandling:"merge"})}areAllSelected(){return!!this.members&&this.selectedMemberIds.length===this.members.length}toggleSelectAll(){this.areAllSelected()?this.selectionChange.emit([]):this.selectionChange.emit(this.members.map(e=>e.id))}toggleSelectMember(e){this.selectedMemberIds.includes(e.id)?this.selectionChange.emit(this.selectedMemberIds.filter(t=>t!==e.id)):this.selectionChange.emit([...this.selectedMemberIds,e.id])}};st.\u0275fac=function(e){return new(e||st)(s.gc(I.e),s.gc(n.K))},st.\u0275cmp=s.ac({type:st,selectors:[["vdr-customer-group-member-list"]],inputs:{selectedMemberIds:"selectedMemberIds",members:"members",totalItems:"totalItems",route:"route"},outputs:{selectionChange:"selectionChange",fetchParamsChange:"fetchParamsChange"},decls:14,vars:24,consts:[["type","text","name","searchTerm",1,"clr-input","search-input",3,"formControl","placeholder"],[3,"items","itemsPerPage","totalItems","currentPage","allSelected","isRowSelectedFn","pageChange","itemsPerPageChange","rowSelectChange","allSelectChange"],[3,"expand"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"]],template:function(e,t){1&e&&(s.hc(0,"input",0),s.xc(1,"translate"),s.mc(2,"vdr-data-table",1),s.uc("pageChange",(function(e){return t.setContentsPageNumber(e)}))("itemsPerPageChange",(function(e){return t.setContentsItemsPerPage(e)}))("rowSelectChange",(function(e){return t.toggleSelectMember(e)}))("allSelectChange",(function(){return t.toggleSelectAll()})),s.xc(3,"async"),s.xc(4,"async"),s.xc(5,"hasPermission"),s.mc(6,"vdr-dt-column",2),s.ad(7),s.xc(8,"translate"),s.lc(),s.mc(9,"vdr-dt-column",2),s.ad(10),s.xc(11,"translate"),s.lc(),s.hc(12,"vdr-dt-column"),s.Yc(13,Pe,7,10,"ng-template"),s.lc()),2&e&&(s.Dc("formControl",t.filterTermControl)("placeholder",s.yc(1,12,"customer.search-customers-by-email")),s.Ub(2),s.Dc("items",t.members)("itemsPerPage",s.yc(3,14,t.membersItemsPerPage$))("totalItems",t.totalItems)("currentPage",s.yc(4,16,t.membersCurrentPage$))("allSelected",t.areAllSelected())("isRowSelectedFn",s.yc(5,18,"UpdateCustomer")&&t.isMemberSelected),s.Ub(4),s.Dc("expand",!0),s.Ub(1),s.bd(s.yc(8,20,"customer.name")),s.Ub(2),s.Dc("expand",!0),s.Ub(1),s.bd(s.yc(11,22,"customer.email-address")))},directives:[n.db,w.b,w.p,w.g,n.M,n.L,n.Kb],pipes:[T.d,M.b,n.gb],styles:[""],changeDetection:0}),st.ctorParameters=()=>[{type:I.e},{type:n.K}],Object(r.c)([Object(s.D)(),Object(r.f)("design:type",Array)],st.prototype,"members",void 0),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",Number)],st.prototype,"totalItems",void 0),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",I.a)],st.prototype,"route",void 0),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",Array)],st.prototype,"selectedMemberIds",void 0),Object(r.c)([Object(s.O)(),Object(r.f)("design:type",Object)],st.prototype,"selectionChange",void 0),Object(r.c)([Object(s.O)(),Object(r.f)("design:type",Object)],st.prototype,"fetchParamsChange",void 0),st=Object(r.c)([Object(r.f)("design:paramtypes",[I.e,n.K])],st);let nt=class{constructor(){this.addNote=new s.u,this.updateNote=new s.u,this.deleteNote=new s.u,this.note="",this.type=n.jb}getDisplayType(e){switch(e.type){case n.jb.CUSTOMER_VERIFIED:case n.jb.CUSTOMER_EMAIL_UPDATE_VERIFIED:case n.jb.CUSTOMER_PASSWORD_RESET_VERIFIED:return"success";case n.jb.CUSTOMER_REGISTERED:return"muted";case n.jb.CUSTOMER_REMOVED_FROM_GROUP:return"error";default:return"default"}}getTimelineIcon(e){switch(e.type){case n.jb.CUSTOMER_REGISTERED:return"user";case n.jb.CUSTOMER_VERIFIED:return["assign-user","is-solid"];case n.jb.CUSTOMER_NOTE:return"note";case n.jb.CUSTOMER_ADDED_TO_GROUP:case n.jb.CUSTOMER_REMOVED_FROM_GROUP:return"users"}}isFeatured(e){switch(e.type){case n.jb.CUSTOMER_REGISTERED:case n.jb.CUSTOMER_VERIFIED:return!0;default:return!1}}getName(e){const{administrator:t}=e;return t?`${t.firstName} ${t.lastName}`:`${this.customer.firstName} ${this.customer.lastName}`}addNoteToCustomer(){this.addNote.emit({note:this.note}),this.note=""}};nt.\u0275fac=function(e){return new(e||nt)},nt.\u0275cmp=s.ac({type:nt,selectors:[["vdr-customer-history"]],inputs:{customer:"customer",history:"history"},outputs:{addNote:"addNote",updateNote:"updateNote",deleteNote:"deleteNote"},decls:12,vars:10,consts:[[1,"entry-list"],["iconShape","note","displayType","muted"],[1,"note-entry"],["name","note",1,"note",3,"ngModel","ngModelChange"],[1,"btn","btn-secondary",3,"disabled","click"],[3,"displayType","iconShape","createdAt","name",4,"ngFor","ngForOf"],[3,"isLast"],[3,"displayType","iconShape","createdAt","name"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"title"],[1,"flex"],[3,"value"],[1,"address-string"],[3,"label"],[1,"note-text"],[1,"flex-spacer"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","edit"],[1,"dropdown-divider"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(s.mc(0,"h4"),s.ad(1),s.xc(2,"translate"),s.lc(),s.mc(3,"div",0),s.mc(4,"vdr-timeline-entry",1),s.mc(5,"div",2),s.mc(6,"textarea",3),s.uc("ngModelChange",(function(e){return t.note=e})),s.lc(),s.mc(7,"button",4),s.uc("click",(function(){return t.addNoteToCustomer()})),s.ad(8),s.xc(9,"translate"),s.lc(),s.lc(),s.lc(),s.Yc(10,Ke,16,19,"vdr-timeline-entry",5),s.hc(11,"vdr-timeline-entry",6),s.lc()),2&e&&(s.Ub(1),s.bd(s.yc(2,6,"customer.customer-history")),s.Ub(5),s.Dc("ngModel",t.note),s.Ub(1),s.Dc("disabled",!t.note),s.Ub(1),s.cd(" ",s.yc(9,8,"order.add-note")," "),s.Ub(2),s.Dc("ngForOf",t.history),s.Ub(1),s.Dc("isLast",!0))},directives:[n.Mb,n.db,w.b,w.p,w.s,M.o,M.r,M.s,n.ib,n.zb,n.sb,n.S,n.V,A.o,n.U,n.T],pipes:[T.d,n.gb],styles:[".entry-list[_ngcontent-%COMP%]{margin-top:24px;margin-left:24px;margin-right:12px}.note-entry[_ngcontent-%COMP%]{display:flex;align-items:center}.note-entry[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{flex:1}.note-entry[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}textarea.note[_ngcontent-%COMP%]{flex:1;height:36px;border-radius:3px;margin-right:6px}.note-text[_ngcontent-%COMP%]{color:#202223;white-space:pre-wrap}.address-string[_ngcontent-%COMP%]{font-size:smaller;color:#525456}"],changeDetection:0}),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",Object)],nt.prototype,"customer",void 0),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",Array)],nt.prototype,"history",void 0),Object(r.c)([Object(s.O)(),Object(r.f)("design:type",Object)],nt.prototype,"addNote",void 0),Object(r.c)([Object(s.O)(),Object(r.f)("design:type",Object)],nt.prototype,"updateNote",void 0),Object(r.c)([Object(s.O)(),Object(r.f)("design:type",Object)],nt.prototype,"deleteNote",void 0);let ot=class extends n.w{constructor(e,t,c,r,s){super(t,c),this.dataService=e,this.modalService=r,this.notificationService=s,this.searchTerm=new w.f(""),super.setQueryFn((...e)=>this.dataService.customer.getCustomerList(...e),e=>e.customers,(e,t)=>({options:{skip:e,take:t,filter:{emailAddress:{contains:this.searchTerm.value}},sort:{createdAt:N.SortOrder.DESC}}}))}ngOnInit(){super.ngOnInit(),this.searchTerm.valueChanges.pipe(Object(x.a)(250),Object(S.a)(this.destroy$)).subscribe(()=>this.refresh())}deleteCustomer(e){return this.modalService.dialog({title:Object(P.a)("catalog.confirm-delete-customer"),body:`${e.firstName} ${e.lastName}`,buttons:[{type:"secondary",label:Object(P.a)("common.cancel")},{type:"danger",label:Object(P.a)("common.delete"),returnValue:!0}]}).pipe(Object(p.a)(t=>t?this.dataService.customer.deleteCustomer(e.id):l.a)).subscribe(()=>{this.notificationService.success(Object(P.a)("common.notify-delete-success"),{entity:"Customer"}),this.refresh()},e=>{this.notificationService.error(Object(P.a)("common.notify-delete-error"),{entity:"Customer"})})}};ot.\u0275fac=function(e){return new(e||ot)(s.gc(n.K),s.gc(I.e),s.gc(I.a),s.gc(n.xb),s.gc(n.yb))},ot.\u0275cmp=s.ac({type:ot,selectors:[["vdr-customer-list"]],features:[s.Rb],decls:24,vars:28,consts:[["type","text","name","searchTerm",1,"clr-input","search-input",3,"formControl","placeholder"],["locationId","customer-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"expand"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[3,"customer"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(s.mc(0,"vdr-action-bar"),s.mc(1,"vdr-ab-left"),s.hc(2,"input",0),s.xc(3,"translate"),s.lc(),s.mc(4,"vdr-ab-right"),s.hc(5,"vdr-action-bar-items",1),s.Yc(6,He,4,5,"a",2),s.lc(),s.lc(),s.mc(7,"vdr-data-table",3),s.uc("pageChange",(function(e){return t.setPageNumber(e)}))("itemsPerPageChange",(function(e){return t.setItemsPerPage(e)})),s.xc(8,"async"),s.xc(9,"async"),s.xc(10,"async"),s.xc(11,"async"),s.mc(12,"vdr-dt-column",4),s.ad(13),s.xc(14,"translate"),s.lc(),s.mc(15,"vdr-dt-column",4),s.ad(16),s.xc(17,"translate"),s.lc(),s.mc(18,"vdr-dt-column"),s.ad(19),s.xc(20,"translate"),s.lc(),s.hc(21,"vdr-dt-column"),s.hc(22,"vdr-dt-column"),s.Yc(23,qe,21,20,"ng-template"),s.lc()),2&e&&(s.Ub(2),s.Dc("formControl",t.searchTerm)("placeholder",s.yc(3,12,"customer.search-customers-by-email")),s.Ub(4),s.Dc("vdrIfPermissions","CreateCustomer"),s.Ub(1),s.Dc("items",s.yc(8,14,t.items$))("itemsPerPage",s.yc(9,16,t.itemsPerPage$))("totalItems",s.yc(10,18,t.totalItems$))("currentPage",s.yc(11,20,t.currentPage$)),s.Ub(5),s.Dc("expand",!0),s.Ub(1),s.bd(s.yc(14,22,"customer.name")),s.Ub(2),s.Dc("expand",!0),s.Ub(1),s.bd(s.yc(17,24,"customer.email-address")),s.Ub(3),s.bd(s.yc(20,26,"customer.customer-type")))},directives:function(){return[n.c,n.e,n.db,w.b,w.p,w.g,n.f,n.d,n.ob,n.M,n.L,I.h,A.o,it,n.Kb,n.S,n.V,n.U,n.T]},pipes:function(){return[T.d,M.b,n.gb]},styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]}),ot.ctorParameters=()=>[{type:n.K},{type:I.e},{type:I.a},{type:n.xb},{type:n.yb}],ot=Object(r.c)([Object(r.f)("design:paramtypes",[n.K,I.e,I.a,n.xb,n.yb])],ot);let it=class{};it.\u0275fac=function(e){return new(e||it)},it.\u0275cmp=s.ac({type:it,selectors:[["vdr-customer-status-label"]],inputs:{customer:"customer"},decls:2,vars:2,consts:[[4,"ngIf"],["shape","check-circle",1,"verified-user-icon"],["shape","check-circle",1,"registered-user-icon"]],template:function(e,t){1&e&&(s.Yc(0,Qe,3,2,"vdr-chip",0),s.Yc(1,Ze,3,3,"vdr-chip",0)),2&e&&(s.Dc("ngIf",null==t.customer.user?null:t.customer.user.id),s.Ub(1),s.Dc("ngIf",!(null!=t.customer.user&&t.customer.user.id)))},directives:[M.p,n.B,A.o],pipes:[T.d],styles:[".registered-user-icon[_ngcontent-%COMP%]{color:#bfc3cc}.verified-user-icon[_ngcontent-%COMP%]{color:#308300}"],changeDetection:0}),Object(r.c)([Object(s.D)(),Object(r.f)("design:type",Object)],it.prototype,"customer",void 0);let at=class extends n.v{constructor(e,t){super(e,{__typename:"Customer",id:"",createdAt:"",updatedAt:"",title:"",firstName:"",lastName:"",emailAddress:"",phoneNumber:null,addresses:null,user:null},e=>t.customer.getCustomer(e).mapStream(e=>e.customer))}};at.\u0275fac=function(e){return new(e||at)(s.qc(I.e),s.qc(n.K))},at.ctorParameters=()=>[{type:I.e},{type:n.K}],at.\u0275prov=Object(s.cc)({factory:function(){return new at(Object(s.qc)(I.e),Object(s.qc)(n.K))},token:at,providedIn:"root"}),at=Object(r.c)([Object(r.f)("design:paramtypes",[I.e,n.K])],at);const dt={breadcrumb:Object(P.a)("breadcrumb.customers")},lt={breadcrumb:pt},mt={breadcrumb:Object(P.a)("breadcrumb.customer-groups")},ut=[{path:"customers",component:ot,pathMatch:"",data:dt},{path:"customers/:id",component:tt,resolve:Object(n.Qb)(at),canDeactivate:[n.x],data:lt},{path:"groups",component:rt,data:mt}];function pt(e,t){return Object(n.Sb)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.customers",getName:e=>`${e.firstName} ${e.lastName}`,route:"customers"})}let bt=class{};bt.\u0275mod=s.ec({type:bt}),bt.\u0275inj=s.dc({factory:function(e){return new(e||bt)},imports:[[n.Gb,I.i.forChild(ut)]]})}}]);
//# sourceMappingURL=12-es2015.297aba85f55284487838.js.map