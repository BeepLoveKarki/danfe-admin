!function(){function t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var c=0,a=function(){};return{s:a,n:function(){return c>=t.length?{done:!0}:{done:!1,value:t[c++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],c=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(c=(i=o.next()).done)&&(n.push(i.value),!e||n.length!==e);c=!0);}catch(s){a=!0,r=s}finally{try{c||null==o.return||o.return()}finally{if(a)throw r}}return n}(t,e)||r(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var c=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(c){var a=Object.getOwnPropertyDescriptor(c,e);return a.get?a.get.call(n):a.value}})(t,e,n||t)}function a(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,c=new Array(e);n<e;n++)c[n]=t[n];return c}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,c=p(t);if(e){var a=p(this).constructor;n=Reflect.construct(c,arguments,a)}else n=c.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var c=e[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,c.key,c)}}function h(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{FGij:function(r,i,s){"use strict";s.r(i),s.d(i,"ApplyFacetDialogComponent",(function(){return Yc})),s.d(i,"AssetDetailComponent",(function(){return Tc})),s.d(i,"AssetListComponent",(function(){return Xc})),s.d(i,"AssetResolver",(function(){return ta})),s.d(i,"AssignProductsToChannelDialogComponent",(function(){return Zc})),s.d(i,"CatalogModule",(function(){return Da})),s.d(i,"CollectionContentsComponent",(function(){return Gc})),s.d(i,"CollectionDetailComponent",(function(){return Nc})),s.d(i,"CollectionListComponent",(function(){return Lc})),s.d(i,"CollectionResolver",(function(){return ea})),s.d(i,"CollectionTreeComponent",(function(){return Oa})),s.d(i,"CollectionTreeNodeComponent",(function(){return ka})),s.d(i,"FacetDetailComponent",(function(){return Uc})),s.d(i,"FacetListComponent",(function(){return Ec})),s.d(i,"FacetResolver",(function(){return na})),s.d(i,"GenerateProductVariantsComponent",(function(){return Pa})),s.d(i,"OPTION_VALUE_INPUT_VALUE_ACCESSOR",(function(){return Fa})),s.d(i,"OptionValueInputComponent",(function(){return Ia})),s.d(i,"ProductAssetsComponent",(function(){return Va})),s.d(i,"ProductDetailComponent",(function(){return Wc})),s.d(i,"ProductDetailService",(function(){return Bc})),s.d(i,"ProductListComponent",(function(){return Hc})),s.d(i,"ProductResolver",(function(){return ca})),s.d(i,"ProductSearchInputComponent",(function(){return Jc})),s.d(i,"ProductSearchSelectionModel",(function(){return Kc})),s.d(i,"ProductSearchSelectionModelFactory",(function(){return qc})),s.d(i,"ProductVariantsEditorComponent",(function(){return Qc})),s.d(i,"ProductVariantsListComponent",(function(){return Ra})),s.d(i,"ProductVariantsResolver",(function(){return aa})),s.d(i,"ProductVariantsTableComponent",(function(){return ja})),s.d(i,"UpdateProductOptionDialogComponent",(function(){return Ma})),s.d(i,"VariantPriceDetailComponent",(function(){return wa})),s.d(i,"arrayToTree",(function(){return Ca})),s.d(i,"assetBreadcrumb",(function(){return ya})),s.d(i,"catalogRoutes",(function(){return ga})),s.d(i,"collectionBreadcrumb",(function(){return ba})),s.d(i,"facetBreadcrumb",(function(){return va})),s.d(i,"productBreadcrumb",(function(){return ha})),s.d(i,"productVariantEditorBreadcrumb",(function(){return ma})),s.d(i,"\u02750",(function(){return ra})),s.d(i,"\u02751",(function(){return ia})),s.d(i,"\u02752",(function(){return oa})),s.d(i,"\u02753",(function(){return sa})),s.d(i,"\u02754",(function(){return la})),s.d(i,"\u02755",(function(){return ua})),s.d(i,"\u02756",(function(){return da})),s.d(i,"\u02757",(function(){return pa})),s.d(i,"\u02758",(function(){return fa}));var u=s("EM62"),g=s("sEIs"),m=s("ixhn"),v=s("OxKu"),b=s("YtkY"),y=s("mWib"),C=s("kuMc"),O=s("ruxD"),k=s("TLy2"),P=s("jIqt"),F=s("Ohay"),I=s("8j5Y"),V=s("J+dc"),x=s("cJ9h"),M=s("wqq/"),R=s("7SLS"),j=s("pBDD"),w=s("mW0F");function D(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){var n;"function"==typeof e[e.length-1]&&(n=e.pop());var c=e;return t.lift(new S(c,n))}}var S=function(){function t(e,n){f(this,t),this.observables=e,this.project=n}return h(t,[{key:"call",value:function(t,e){return e.subscribe(new _(t,this.observables,this.project))}}]),t}(),_=function(t){o(n,t);var e=l(n);function n(t,c,a){var r;f(this,n),(r=e.call(this,t)).observables=c,r.project=a,r.toRespond=[];var i=c.length;r.values=new Array(i);for(var o=0;o<i;o++)r.toRespond.push(o);for(var s=0;s<i;s++){var l=c[s];r.add(Object(w.a)(d(r),l,void 0,s))}return r}return h(n,[{key:"notifyNext",value:function(t,e,n){this.values[n]=e;var c=this.toRespond;if(c.length>0){var a=c.indexOf(n);-1!==a&&c.splice(a,1)}}},{key:"notifyComplete",value:function(){}},{key:"_next",value:function(t){if(0===this.toRespond.length){var e=[t].concat(a(this.values));this.project?this._tryProject(e):this.destination.next(e)}}},{key:"_tryProject",value:function(t){var e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}]),n}(j.a),A=s("Efrr"),$=s("5uGe"),T=s("ryP2");function X(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A.a,c=(e=t)instanceof Date&&!isNaN(+e)?+t-n.now():Math.abs(t);return function(t){return t.lift(new G(c,n))}}var G=function(){function t(e,n){f(this,t),this.delay=e,this.scheduler=n}return h(t,[{key:"call",value:function(t,e){return e.subscribe(new N(t,this.delay,this.scheduler))}}]),t}(),N=function(t){o(n,t);var e=l(n);function n(t,c,a){var r;return f(this,n),(r=e.call(this,t)).delay=c,r.scheduler=a,r.queue=[],r.active=!1,r.errored=!1,r}return h(n,[{key:"_schedule",value:function(t){this.active=!0,this.destination.add(t.schedule(n.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))}},{key:"scheduleNotification",value:function(t){if(!0!==this.errored){var e=this.scheduler,n=new L(e.now()+this.delay,t);this.queue.push(n),!1===this.active&&this._schedule(e)}}},{key:"_next",value:function(t){this.scheduleNotification(T.a.createNext(t))}},{key:"_error",value:function(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleNotification(T.a.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(t){for(var e=t.source,n=e.queue,c=t.scheduler,a=t.destination;n.length>0&&n[0].time-c.now()<=0;)n.shift().notification.observe(a);if(n.length>0){var r=Math.max(0,n[0].time-c.now());this.schedule(t,r)}else this.unsubscribe(),e.active=!1}}]),n}($.a),L=function t(e,n){f(this,t),this.time=e,this.notification=n},U=s("xVbo"),E=s("nIj0"),B=s("8hOy"),Y=s("HM3f"),Z=s("6Oco"),W=s("C05f"),K=s("ZTXN"),q=s("ROBh"),z=s("P4Xx"),J=s("47ST"),H=s("GoAz"),Q=s("g6G6"),tt=s("hbhS"),et=s("hG4v"),nt=s("2kYt"),ct=s("Ui7s"),at=s("qzMg"),rt=s("D57K"),it=s("iysP"),ot=s("oqI+"),st=s("qvOF"),lt=s("s2Ay"),ut=s("iNDR"),dt=s("Kej3");function pt(t,e){if(1&t){var n=u.jc();u.ic(0,"button",4),u.pc("click",(function(){return u.Mc(n),u.rc().save()})),u.Xc(1),u.sc(2,"translate"),u.hc()}if(2&t){var c=u.rc();u.yc("disabled",c.detailForm.invalid||c.detailForm.pristine),u.Rb(1),u.Zc(" ",u.tc(2,2,"common.update")," ")}}var ft=function(){return{}};function gt(t,e){1&t&&u.ec(0)}var ht=function(){return{tab:"variants"}},mt=function(t,e){return["/catalog/products",t,e]};function vt(t,e){if(1&t&&(u.ic(0,"td",5),u.Xc(1),u.hc(),u.ic(2,"td",6),u.dc(3,"vdr-table-row-action",7),u.sc(4,"translate"),u.hc()),2&t){var n=e.item;u.Rb(1),u.Yc(n.name),u.Rb(2),u.yc("label",u.tc(4,3,"common.edit"))("linkTo",u.Ec(6,mt,n.productId,u.Cc(5,ht)))}}var bt=function(t){return{$implicit:t}},yt=["collectionContents"];function Ct(t,e){if(1&t){var n=u.jc();u.ic(0,"button",6),u.pc("click",(function(){return u.Mc(n),u.rc().create()})),u.Xc(1),u.sc(2,"translate"),u.hc()}if(2&t){var c=u.rc();u.yc("disabled",c.detailForm.invalid||c.detailForm.pristine),u.Rb(1),u.Zc(" ",u.tc(2,2,"common.create")," ")}}function Ot(t,e){if(1&t){var n=u.jc();u.ic(0,"button",6),u.pc("click",(function(){return u.Mc(n),u.rc(2).save()})),u.Xc(1),u.sc(2,"translate"),u.hc()}if(2&t){var c=u.rc(2);u.yc("disabled",(c.detailForm.invalid||c.detailForm.pristine)&&!c.assetsChanged()),u.Rb(1),u.Zc(" ",u.tc(2,2,"common.update")," ")}}function kt(t,e){1&t&&u.Vc(0,Ot,3,4,"button",7),2&t&&u.yc("vdrIfPermissions","UpdateCatalog")}function Pt(t,e){1&t&&(u.gc(0),u.Xc(1),u.sc(2,"translate"),u.fc()),2&t&&(u.Rb(1),u.Yc(u.tc(2,1,"catalog.public")))}function Ft(t,e){1&t&&(u.Xc(0),u.sc(1,"translate")),2&t&&u.Yc(u.tc(1,1,"catalog.private"))}var It=function(){return["customFields"]};function Vt(t,e){if(1&t&&u.dc(0,"vdr-custom-field-control",31),2&t){var n=u.rc().$implicit,c=u.rc(3);u.yc("customFieldsFormGroup",c.detailForm.get(u.Cc(2,It)))("customField",n)}}function xt(t,e){if(1&t&&(u.gc(0),u.Vc(1,Vt,1,3,"vdr-custom-field-control",30),u.fc()),2&t){var n=e.$implicit,c=u.rc(3);u.Rb(1),u.yc("ngIf",c.customFieldIsSet(n.name))}}function Mt(t,e){if(1&t&&(u.ic(0,"section",29),u.ic(1,"label"),u.Xc(2),u.sc(3,"translate"),u.hc(),u.Vc(4,xt,2,1,"ng-container",25),u.hc()),2&t){var n=u.rc(2);u.Rb(2),u.Yc(u.tc(3,2,"common.custom-fields")),u.Rb(2),u.yc("ngForOf",n.customFields)}}function Rt(t,e){if(1&t){var n=u.jc();u.gc(0),u.ic(1,"vdr-configurable-input",32),u.pc("remove",(function(t){return u.Mc(n),u.rc(2).removeFilter(t)})),u.sc(2,"hasPermission"),u.hc(),u.fc()}if(2&t){var c=e.$implicit,a=e.index,r=u.rc(2);u.Rb(1),u.yc("operation",c)("operationDefinition",r.getFilterDefinition(c))("formControlName",a)("readonly",!u.tc(2,4,"UpdateCatalog"))}}function jt(t,e){if(1&t){var n=u.jc();u.ic(0,"button",37),u.pc("click",(function(){u.Mc(n);var t=e.$implicit;return u.rc(3).addFilter(t)})),u.Xc(1),u.hc()}if(2&t){var c=e.$implicit;u.Rb(1),u.Zc(" ",c.description," ")}}function wt(t,e){if(1&t&&(u.ic(0,"div"),u.ic(1,"vdr-dropdown"),u.ic(2,"button",33),u.dc(3,"clr-icon",34),u.Xc(4),u.sc(5,"translate"),u.hc(),u.ic(6,"vdr-dropdown-menu",35),u.Vc(7,jt,2,1,"button",36),u.hc(),u.hc(),u.hc()),2&t){var n=u.rc(2);u.Rb(4),u.Zc(" ",u.tc(5,2,"marketing.add-condition")," "),u.Rb(3),u.yc("ngForOf",n.allFilters)}}var Dt=function(t){return{count:t}};function St(t,e){if(1&t&&(u.ic(0,"div",38),u.Xc(1),u.sc(2,"translate"),u.sc(3,"translate"),u.hc()),2&t){var n=e.$implicit;u.Rb(1),u.ad(" ",u.tc(2,2,"catalog.collection-contents")," (",u.uc(3,4,"common.results-count",u.Dc(7,Dt,n)),") ")}}var _t=function(t){return{pattern:t}};function At(t,e){if(1&t){var n=u.jc();u.ic(0,"form",8),u.ic(1,"div",9),u.ic(2,"div",10),u.ic(3,"vdr-form-field",11),u.sc(4,"translate"),u.ic(5,"clr-toggle-wrapper"),u.dc(6,"input",12),u.sc(7,"hasPermission"),u.ic(8,"label",13),u.Vc(9,Pt,3,3,"ng-container",14),u.Vc(10,Ft,2,3,"ng-template",null,15,u.Wc),u.hc(),u.hc(),u.hc(),u.ic(12,"vdr-form-field",16),u.sc(13,"translate"),u.ic(14,"input",17),u.pc("input",(function(t){return u.Mc(n),u.rc().updateSlug(t.target.value)})),u.sc(15,"hasPermission"),u.hc(),u.hc(),u.ic(16,"vdr-form-field",18),u.sc(17,"translate"),u.sc(18,"translate"),u.dc(19,"input",19),u.sc(20,"hasPermission"),u.hc(),u.dc(21,"vdr-rich-text-editor",20),u.sc(22,"hasPermission"),u.sc(23,"translate"),u.Vc(24,Mt,5,4,"section",21),u.hc(),u.ic(25,"div",22),u.ic(26,"vdr-product-assets",23),u.pc("change",(function(t){return u.Mc(n),u.rc().assetChanges=t})),u.hc(),u.hc(),u.hc(),u.ic(27,"div",24),u.ic(28,"div",10),u.ic(29,"label"),u.Xc(30),u.sc(31,"translate"),u.hc(),u.Vc(32,Rt,3,6,"ng-container",25),u.Vc(33,wt,8,4,"div",26),u.hc(),u.ic(34,"div",10),u.ic(35,"vdr-collection-contents",27,28),u.Vc(37,St,4,9,"ng-template"),u.hc(),u.hc(),u.hc(),u.hc()}if(2&t){var c=e.ngIf,a=u.Jc(11),r=u.rc();u.yc("formGroup",r.detailForm),u.Rb(3),u.yc("label",u.tc(4,19,"catalog.visibility")),u.Rb(3),u.yc("vdrDisabled",!u.tc(7,21,"UpdateCatalog")),u.Rb(3),u.yc("ngIf",r.detailForm.value.visible)("ngIfElse",a),u.Rb(3),u.yc("label",u.tc(13,23,"common.name")),u.Rb(2),u.yc("readonly",!u.tc(15,25,"UpdateCatalog")),u.Rb(2),u.yc("label",u.tc(17,27,"catalog.slug"))("errors",u.Dc(39,_t,u.tc(18,29,"catalog.slug-pattern-error"))),u.Rb(3),u.yc("readonly",!u.tc(20,31,"UpdateCatalog")),u.Rb(2),u.yc("readonly",!u.tc(22,33,"UpdateCatalog"))("label",u.tc(23,35,"common.description")),u.Rb(3),u.yc("ngIf",r.customFields.length),u.Rb(2),u.yc("assets",c.assets)("featuredAsset",c.featuredAsset),u.Rb(4),u.Yc(u.tc(31,37,"catalog.filters")),u.Rb(2),u.yc("ngForOf",r.filters),u.Rb(1),u.yc("vdrIfPermissions","UpdateCatalog"),u.Rb(2),u.yc("collectionId",r.id)}}var $t=function(){return["./create"]};function Tt(t,e){1&t&&(u.ic(0,"a",8),u.dc(1,"clr-icon",9),u.Xc(2),u.sc(3,"translate"),u.hc()),2&t&&(u.yc("routerLink",u.Cc(4,$t)),u.Rb(2),u.Zc(" ",u.tc(3,2,"catalog.create-new-collection")," "))}function Xt(t,e){if(1&t){var n=u.jc();u.ic(0,"div",10),u.Xc(1),u.sc(2,"async"),u.sc(3,"translate"),u.hc(),u.ic(4,"button",11),u.pc("click",(function(){return u.Mc(n),u.rc().closeContents()})),u.dc(5,"clr-icon",12),u.hc()}if(2&t){var c=e.$implicit,a=u.rc();u.Rb(1),u.ad(" ",u.tc(2,2,a.activeCollectionTitle$)," (",u.uc(3,4,"common.results-count",u.Dc(7,Dt,c)),") ")}}function Gt(t,e){if(1&t){var n=u.jc();u.ic(0,"button",6),u.pc("click",(function(){return u.Mc(n),u.rc().create()})),u.Xc(1),u.sc(2,"translate"),u.hc()}if(2&t){var c=u.rc();u.yc("disabled",c.detailForm.invalid||c.detailForm.pristine),u.Rb(1),u.Zc(" ",u.tc(2,2,"common.create")," ")}}function Nt(t,e){if(1&t){var n=u.jc();u.ic(0,"button",6),u.pc("click",(function(){return u.Mc(n),u.rc(2).save()})),u.Xc(1),u.sc(2,"translate"),u.hc()}if(2&t){var c=u.rc(2);u.yc("disabled",c.detailForm.invalid||c.detailForm.pristine),u.Rb(1),u.Zc(" ",u.tc(2,2,"common.update")," ")}}function Lt(t,e){1&t&&u.Vc(0,Nt,3,4,"button",7),2&t&&u.yc("vdrIfPermissions","UpdateCatalog")}function Ut(t,e){1&t&&(u.gc(0),u.Xc(1),u.sc(2,"translate"),u.fc()),2&t&&(u.Rb(1),u.Yc(u.tc(2,1,"catalog.public")))}function Et(t,e){1&t&&(u.Xc(0),u.sc(1,"translate")),2&t&&u.Yc(u.tc(1,1,"catalog.private"))}var Bt=function(){return["facet","customFields"]};function Yt(t,e){if(1&t&&u.dc(0,"vdr-custom-field-control",24),2&t){var n=u.rc().$implicit,c=u.rc(3);u.yc("customFieldsFormGroup",c.detailForm.get(u.Cc(2,Bt)))("customField",n)}}function Zt(t,e){if(1&t&&(u.gc(0),u.Vc(1,Yt,1,3,"vdr-custom-field-control",23),u.fc()),2&t){var n=e.$implicit,c=u.rc(3);u.Rb(1),u.yc("ngIf",c.customFieldIsSet(n.name))}}function Wt(t,e){if(1&t&&(u.ic(0,"section",21),u.ic(1,"label"),u.Xc(2),u.sc(3,"translate"),u.hc(),u.Vc(4,Zt,2,1,"ng-container",22),u.hc()),2&t){var n=u.rc(2);u.Rb(2),u.Yc(u.tc(3,2,"common.custom-fields")),u.Rb(2),u.yc("ngForOf",n.customFields)}}function Kt(t,e){if(1&t&&(u.gc(0),u.ic(1,"th"),u.Xc(2),u.hc(),u.fc()),2&t){var n=e.$implicit;u.Rb(2),u.Yc(n.name)}}var qt=function(t){return["values",t,"customFields"]};function zt(t,e){if(1&t&&u.dc(0,"vdr-custom-field-control",40),2&t){var n=u.rc().$implicit,c=u.rc().index,a=u.rc(4);u.yc("showLabel",!1)("customFieldsFormGroup",a.detailForm.get(u.Dc(3,qt,c)))("customField",n)}}function Jt(t,e){if(1&t&&(u.gc(0),u.ic(1,"td",31),u.Vc(2,zt,1,5,"vdr-custom-field-control",39),u.hc(),u.fc()),2&t){var n=e.$implicit,c=u.rc().index,a=u.rc(4);u.Rb(2),u.yc("ngIf",a.customValueFieldIsSet(c,n.name))}}function Ht(t,e){if(1&t){var n=u.jc();u.ic(0,"tr",30),u.ic(1,"td",31),u.dc(2,"vdr-entity-info",0),u.hc(),u.ic(3,"td",31),u.ic(4,"input",32),u.pc("input",(function(t){u.Mc(n);var c=e.index,a=u.rc(3).ngIf;return u.rc().updateValueCode(null==a.values[c]?null:a.values[c].code,t.target.value,c)})),u.sc(5,"hasPermission"),u.hc(),u.hc(),u.ic(6,"td",31),u.dc(7,"input",33),u.hc(),u.Vc(8,Jt,3,1,"ng-container",22),u.ic(9,"td",31),u.ic(10,"vdr-dropdown"),u.ic(11,"button",34),u.Xc(12),u.sc(13,"translate"),u.dc(14,"clr-icon",35),u.hc(),u.ic(15,"vdr-dropdown-menu",36),u.ic(16,"button",37),u.pc("click",(function(){u.Mc(n);var t=e.index,c=u.rc(3).ngIf;return u.rc().deleteFacetValue(null==c.values[t]?null:c.values[t].id,t)})),u.sc(17,"hasPermission"),u.dc(18,"clr-icon",38),u.Xc(19),u.sc(20,"translate"),u.hc(),u.hc(),u.hc(),u.hc(),u.hc()}if(2&t){var c=e.$implicit,a=e.index,r=u.rc(4);u.yc("formGroupName",a),u.Rb(2),u.yc("entity",c),u.Rb(2),u.yc("readonly",!u.tc(5,7,"UpdateCatalog")),u.Rb(4),u.yc("ngForOf",r.customValueFields),u.Rb(4),u.Zc(" ",u.tc(13,9,"common.actions")," "),u.Rb(4),u.yc("disabled",!u.tc(17,11,"UpdateCatalog")),u.Rb(3),u.Zc(" ",u.tc(20,13,"common.delete")," ")}}function Qt(t,e){if(1&t&&(u.ic(0,"table",28),u.ic(1,"thead"),u.ic(2,"tr"),u.dc(3,"th"),u.ic(4,"th"),u.Xc(5),u.sc(6,"translate"),u.hc(),u.ic(7,"th"),u.Xc(8),u.sc(9,"translate"),u.hc(),u.Vc(10,Kt,3,1,"ng-container",22),u.dc(11,"th"),u.hc(),u.hc(),u.ic(12,"tbody"),u.Vc(13,Ht,21,15,"tr",29),u.hc(),u.hc()),2&t){var n=u.rc(3);u.Rb(5),u.Yc(u.tc(6,4,"common.name")),u.Rb(3),u.Yc(u.tc(9,6,"common.code")),u.Rb(2),u.yc("ngForOf",n.customValueFields),u.Rb(3),u.yc("ngForOf",n.values)}}function te(t,e){if(1&t){var n=u.jc();u.ic(0,"button",41),u.pc("click",(function(){return u.Mc(n),u.rc(3).addFacetValue()})),u.dc(1,"clr-icon",42),u.Xc(2),u.sc(3,"translate"),u.hc()}2&t&&(u.Rb(2),u.Zc(" ",u.tc(3,1,"catalog.add-facet-value")," "))}function ee(t,e){if(1&t&&(u.ic(0,"section",25),u.ic(1,"label"),u.Xc(2),u.sc(3,"translate"),u.hc(),u.Vc(4,Qt,14,8,"table",26),u.ic(5,"div"),u.Vc(6,te,4,3,"button",27),u.hc(),u.hc()),2&t){var n=u.rc(2);u.Rb(2),u.Yc(u.tc(3,3,"catalog.facet-values")),u.Rb(2),u.yc("ngIf",0<n.getValuesFormArray().length),u.Rb(2),u.yc("vdrIfPermissions","CreateCatalog")}}function ne(t,e){if(1&t){var n=u.jc();u.ic(0,"form",8),u.ic(1,"section",9),u.ic(2,"vdr-form-field",10),u.sc(3,"translate"),u.ic(4,"clr-toggle-wrapper"),u.dc(5,"input",11),u.sc(6,"hasPermission"),u.ic(7,"label",12),u.Vc(8,Ut,3,3,"ng-container",13),u.Vc(9,Et,2,3,"ng-template",null,14,u.Wc),u.hc(),u.hc(),u.hc(),u.ic(11,"vdr-form-field",15),u.sc(12,"translate"),u.ic(13,"input",16),u.pc("input",(function(t){u.Mc(n);var c=e.ngIf;return u.rc().updateCode(c.code,t.target.value)})),u.sc(14,"hasPermission"),u.hc(),u.hc(),u.ic(15,"vdr-form-field",17),u.sc(16,"translate"),u.sc(17,"hasPermission"),u.dc(18,"input",18),u.sc(19,"hasPermission"),u.hc(),u.Vc(20,Wt,5,4,"section",19),u.hc(),u.Vc(21,ee,7,5,"section",20),u.sc(22,"async"),u.hc()}if(2&t){var c=u.Jc(10),a=u.rc();u.yc("formGroup",a.detailForm),u.Rb(2),u.yc("label",u.tc(3,12,"catalog.visibility")),u.Rb(3),u.yc("vdrDisabled",!u.tc(6,14,"UpdateCatalog")),u.Rb(3),u.yc("ngIf",a.detailForm.value.facet.visible)("ngIfElse",c),u.Rb(3),u.yc("label",u.tc(12,16,"common.name")),u.Rb(2),u.yc("readonly",!u.tc(14,18,"UpdateCatalog")),u.Rb(2),u.yc("label",u.tc(16,20,"common.code"))("readOnlyToggle",u.tc(17,22,"UpdateCatalog")),u.Rb(3),u.yc("readonly",!u.tc(19,24,"UpdateCatalog")),u.Rb(2),u.yc("ngIf",a.customFields.length),u.Rb(1),u.yc("ngIf",!u.tc(22,26,a.isNew$))}}var ce=".visible-toggle[_ngcontent-%COMP%]{margin-top:-3px!important}";function ae(t,e){1&t&&(u.ic(0,"a",4),u.dc(1,"clr-icon",5),u.Xc(2),u.sc(3,"translate"),u.hc()),2&t&&(u.yc("routerLink",u.Cc(4,$t)),u.Rb(2),u.Zc(" ",u.tc(3,2,"catalog.create-new-facet")," "))}function re(t,e){if(1&t&&u.dc(0,"vdr-facet-value-chip",18),2&t){var n=e.$implicit;u.yc("facetValue",n)("removable",!1)("displayFacetName",!1)}}function ie(t,e){if(1&t&&(u.gc(0),u.dc(1,"clr-icon",5),u.Xc(2),u.fc()),2&t){var n=u.rc(2).item,c=u.rc();u.Rb(2),u.Zc(" ",n.values.length-c.initialLimit," ")}}function oe(t,e){1&t&&u.dc(0,"clr-icon",21)}function se(t,e){if(1&t){var n=u.jc();u.ic(0,"button",19),u.pc("click",(function(){u.Mc(n);var t=u.rc().item;return u.rc().toggleDisplayLimit(t)})),u.Vc(1,ie,3,1,"ng-container",9),u.Vc(2,oe,1,0,"ng-template",null,20,u.Wc),u.hc()}if(2&t){var c=u.Jc(3),a=u.rc().item,r=u.rc();u.Rb(1),u.yc("ngIf",(r.displayLimit[a.id]||0)<a.values.length)("ngIfElse",c)}}function le(t,e){1&t&&(u.gc(0),u.Xc(1),u.sc(2,"translate"),u.fc()),2&t&&(u.Rb(1),u.Yc(u.tc(2,1,"catalog.public")))}function ue(t,e){1&t&&(u.Xc(0),u.sc(1,"translate")),2&t&&u.Yc(u.tc(1,1,"catalog.private"))}var de=function(t){return["./",t]};function pe(t,e){if(1&t){var n=u.jc();u.ic(0,"td",6),u.Xc(1),u.hc(),u.ic(2,"td",6),u.Xc(3),u.hc(),u.ic(4,"td",6),u.Vc(5,re,1,3,"vdr-facet-value-chip",7),u.sc(6,"slice"),u.Vc(7,se,4,2,"button",8),u.hc(),u.ic(8,"td",6),u.ic(9,"vdr-chip"),u.Vc(10,le,3,3,"ng-container",9),u.Vc(11,ue,2,3,"ng-template",null,10,u.Wc),u.hc(),u.hc(),u.ic(13,"td",11),u.dc(14,"vdr-table-row-action",12),u.sc(15,"translate"),u.hc(),u.ic(16,"td",11),u.ic(17,"vdr-dropdown"),u.ic(18,"button",13),u.Xc(19),u.sc(20,"translate"),u.dc(21,"clr-icon",14),u.hc(),u.ic(22,"vdr-dropdown-menu",15),u.ic(23,"button",16),u.pc("click",(function(){u.Mc(n);var t=e.item;return u.rc().deleteFacet(t.id)})),u.sc(24,"hasPermission"),u.dc(25,"clr-icon",17),u.Xc(26),u.sc(27,"translate"),u.hc(),u.hc(),u.hc(),u.hc()}if(2&t){var c=e.item,a=u.Jc(12),r=u.rc();u.Ub("private",c.isPrivate),u.Rb(1),u.Yc(c.code),u.Rb(1),u.Ub("private",c.isPrivate),u.Rb(1),u.Yc(c.name),u.Rb(1),u.Ub("private",c.isPrivate),u.Rb(1),u.yc("ngForOf",u.vc(6,23,c.values,0,r.displayLimit[c.id]||3)),u.Rb(2),u.yc("ngIf",c.values.length>r.initialLimit),u.Rb(1),u.Ub("private",c.isPrivate),u.Rb(2),u.yc("ngIf",!c.isPrivate)("ngIfElse",a),u.Rb(3),u.Ub("private",c.isPrivate),u.Rb(1),u.yc("label",u.tc(15,27,"common.edit"))("linkTo",u.Dc(35,de,c.id)),u.Rb(2),u.Ub("private",c.isPrivate),u.Rb(3),u.Zc(" ",u.tc(20,29,"common.actions")," "),u.Rb(4),u.yc("disabled",!u.tc(24,31,"DeleteCatalog")),u.Rb(3),u.Zc(" ",u.tc(27,33,"common.delete")," ")}}function fe(t,e){1&t&&(u.Xc(0),u.sc(1,"translate")),2&t&&u.Yc(u.tc(1,1,"catalog.add-facets"))}function ge(t,e){if(1&t){var n=u.jc();u.ic(0,"button",3),u.pc("click",(function(){return u.Mc(n),u.rc().cancel()})),u.Xc(1),u.sc(2,"translate"),u.hc(),u.ic(3,"button",4),u.pc("click",(function(){return u.Mc(n),u.rc().selectValues()})),u.Xc(4),u.sc(5,"translate"),u.hc()}if(2&t){var c=u.rc();u.Rb(1),u.Yc(u.tc(2,3,"common.cancel")),u.Rb(2),u.yc("disabled",0===c.selectedValues.length),u.Rb(1),u.Zc(" ",u.tc(5,5,"catalog.add-facets")," ")}}function he(t,e){1&t&&(u.Xc(0),u.sc(1,"translate")),2&t&&u.Yc(u.tc(1,1,"catalog.assign-products-to-channel"))}var me=function(t){return{channel:t}};function ve(t,e){if(1&t&&(u.Xc(0),u.sc(1,"translate")),2&t){var n=u.rc();u.Zc(" ",u.uc(1,1,"catalog.price-in-channel",u.Dc(4,me,null==n.selectedChannel?null:n.selectedChannel.code))," ")}}function be(t,e){1&t&&(u.Xc(0),u.sc(1,"translate")),2&t&&u.Zc(" ",u.tc(1,1,"catalog.no-channel-selected")," ")}function ye(t,e){if(1&t&&(u.Xc(0),u.sc(1,"currency")),2&t){var n=u.rc().$implicit,c=u.rc();u.Zc(" ",u.uc(1,1,n.pricePreview/100,null==c.selectedChannel?null:c.selectedChannel.currencyCode)," ")}}function Ce(t,e){1&t&&u.Xc(0," - ")}function Oe(t,e){if(1&t&&(u.ic(0,"tr"),u.ic(1,"td"),u.Xc(2),u.hc(),u.ic(3,"td"),u.Xc(4),u.sc(5,"currency"),u.hc(),u.ic(6,"td"),u.Vc(7,ye,2,4,"ng-template",8),u.Vc(8,Ce,1,0,"ng-template",null,12,u.Wc),u.hc(),u.hc()),2&t){var n=e.$implicit,c=u.Jc(9),a=u.rc();u.Rb(2),u.Yc(n.name),u.Rb(2),u.Yc(u.uc(5,4,n.price/100,null==a.currentChannel?null:a.currentChannel.currencyCode)),u.Rb(3),u.yc("ngIf",a.selectedChannel)("ngIfElse",c)}}var ke=function(t){return{channelCode:t}};function Pe(t,e){if(1&t&&(u.Xc(0),u.sc(1,"translate")),2&t){var n=u.rc(2);u.Zc(" ",u.uc(1,1,"catalog.assign-to-named-channel",u.Dc(4,ke,null==n.selectedChannel?null:n.selectedChannel.code))," ")}}function Fe(t,e){1&t&&(u.Xc(0),u.sc(1,"translate")),2&t&&u.Zc(" ",u.tc(1,1,"catalog.no-channel-selected")," ")}function Ie(t,e){if(1&t){var n=u.jc();u.ic(0,"button",13),u.pc("click",(function(){return u.Mc(n),u.rc().cancel()})),u.Xc(1),u.sc(2,"translate"),u.hc(),u.ic(3,"button",14),u.pc("click",(function(){return u.Mc(n),u.rc().assign()})),u.Vc(4,Pe,2,6,"ng-template",8),u.Vc(5,Fe,2,3,"ng-template",null,9,u.Wc),u.hc()}if(2&t){var c=u.Jc(6),a=u.rc();u.Rb(1),u.Yc(u.tc(2,4,"common.cancel")),u.Rb(2),u.yc("disabled",!a.selectedChannel),u.Rb(1),u.yc("ngIf",a.selectedChannel)("ngIfElse",c)}}var Ve=function(){return["product","enabled"]};function xe(t,e){if(1&t&&(u.ic(0,"clr-toggle-wrapper"),u.dc(1,"input",8),u.ic(2,"label"),u.Xc(3),u.sc(4,"translate"),u.hc(),u.hc()),2&t){var n=u.rc();u.Rb(1),u.yc("formControl",n.detailForm.get(u.Cc(4,Ve))),u.Rb(2),u.Yc(u.tc(4,2,"common.enabled"))}}function Me(t,e){if(1&t){var n=u.jc();u.ic(0,"button",9),u.pc("click",(function(){return u.Mc(n),u.rc().create()})),u.Xc(1),u.sc(2,"translate"),u.hc()}if(2&t){var c=u.rc();u.yc("disabled",c.detailForm.invalid||c.detailForm.pristine||!c.variantsToCreateAreValid()),u.Rb(1),u.Zc(" ",u.tc(2,2,"common.create")," ")}}function Re(t,e){if(1&t){var n=u.jc();u.ic(0,"button",9),u.pc("click",(function(){return u.Mc(n),u.rc(2).save()})),u.Xc(1),u.sc(2,"translate"),u.hc()}if(2&t){var c=u.rc(2);u.yc("disabled",(c.detailForm.invalid||c.detailForm.pristine)&&!c.assetsChanged()&&!c.variantAssetsChanged()),u.Rb(1),u.Zc(" ",u.tc(2,2,"common.update")," ")}}function je(t,e){1&t&&u.Vc(0,Re,3,4,"button",10),2&t&&u.yc("vdrIfPermissions","UpdateCatalog")}function we(t,e){if(1&t){var n=u.jc();u.ic(0,"vdr-chip",38),u.pc("iconClick",(function(){u.Mc(n);var t=u.rc().$implicit;return u.rc(5).removeFromChannel(t.id)})),u.dc(1,"vdr-channel-badge",39),u.Xc(2),u.sc(3,"channelCodeToLabel"),u.hc()}if(2&t){var c=u.rc().$implicit;u.Rb(1),u.yc("channelCode",c.code),u.Rb(1),u.Zc(" ",u.tc(3,2,c.code)," ")}}function De(t,e){if(1&t&&(u.gc(0),u.Vc(1,we,4,4,"vdr-chip",37),u.fc()),2&t){var n=e.$implicit,c=u.rc(5);u.Rb(1),u.yc("ngIf",!c.isDefaultChannel(n.code))}}function Se(t,e){if(1&t){var n=u.jc();u.ic(0,"vdr-form-item",31),u.sc(1,"translate"),u.ic(2,"div",32),u.ic(3,"div",33),u.Vc(4,De,2,1,"ng-container",34),u.sc(5,"async"),u.hc(),u.ic(6,"button",35),u.pc("click",(function(){return u.Mc(n),u.rc(4).assignToChannel()})),u.dc(7,"clr-icon",36),u.Xc(8),u.sc(9,"translate"),u.hc(),u.hc(),u.hc()}if(2&t){var c=u.rc(4);u.yc("label",u.tc(1,3,"common.channels")),u.Rb(4),u.yc("ngForOf",u.tc(5,5,c.productChannels$)),u.Rb(4),u.Zc(" ",u.tc(9,7,"catalog.assign-to-channel")," ")}}function _e(t,e){1&t&&(u.gc(0),u.Vc(1,Se,10,9,"vdr-form-item",30),u.fc())}var Ae=function(){return["product","customFields"]};function $e(t,e){if(1&t&&(u.dc(0,"vdr-custom-field-control",42),u.sc(1,"hasPermission")),2&t){var n=u.rc().$implicit,c=u.rc(4);u.yc("customFieldsFormGroup",c.detailForm.get(u.Cc(5,Ae)))("customField",n)("readonly",!u.tc(1,3,"UpdateCatalog"))}}function Te(t,e){if(1&t&&(u.gc(0),u.Vc(1,$e,2,6,"vdr-custom-field-control",41),u.fc()),2&t){var n=e.$implicit,c=u.rc(4);u.Rb(1),u.yc("ngIf",c.customFieldIsSet(n.name))}}function Xe(t,e){if(1&t&&(u.ic(0,"section",40),u.ic(1,"label"),u.Xc(2),u.sc(3,"translate"),u.hc(),u.Vc(4,Te,2,1,"ng-container",34),u.hc()),2&t){var n=u.rc(3);u.Rb(2),u.Yc(u.tc(3,2,"common.custom-fields")),u.Rb(2),u.yc("ngForOf",n.customFields)}}function Ge(t,e){if(1&t){var n=u.jc();u.ic(0,"vdr-facet-value-chip",43),u.pc("remove",(function(){u.Mc(n);var t=e.$implicit;return u.rc(3).removeProductFacetValue(t.id)})),u.sc(1,"hasPermission"),u.hc()}if(2&t){var c=e.$implicit;u.yc("facetValue",c)("removable",u.tc(1,2,"UpdateCatalog"))}}function Ne(t,e){if(1&t){var n=u.jc();u.ic(0,"button",44),u.pc("click",(function(){return u.Mc(n),u.rc(3).selectProductFacetValue()})),u.dc(1,"clr-icon",45),u.Xc(2),u.sc(3,"translate"),u.hc()}2&t&&(u.Rb(2),u.Zc(" ",u.tc(3,1,"catalog.add-facets")," "))}function Le(t,e){if(1&t){var n=u.jc();u.ic(0,"div"),u.ic(1,"h4"),u.Xc(2),u.sc(3,"translate"),u.hc(),u.ic(4,"vdr-generate-product-variants",46),u.pc("variantsChange",(function(t){return u.Mc(n),u.rc(3).createVariantsConfig=t})),u.hc(),u.hc()}2&t&&(u.Rb(2),u.Yc(u.tc(3,1,"catalog.product-variants")))}function Ue(t,e){if(1&t){var n=u.jc();u.ic(0,"clr-tab-content"),u.ic(1,"div",15),u.ic(2,"div",16),u.ic(3,"section",17),u.Vc(4,_e,2,0,"ng-container",18),u.ic(5,"vdr-form-field",19),u.sc(6,"translate"),u.ic(7,"input",20),u.pc("input",(function(t){return u.Mc(n),u.rc(2).updateSlug(t.target.value)})),u.sc(8,"hasPermission"),u.hc(),u.hc(),u.ic(9,"vdr-form-field",21),u.sc(10,"translate"),u.sc(11,"translate"),u.dc(12,"input",22),u.sc(13,"hasPermission"),u.hc(),u.dc(14,"vdr-rich-text-editor",23),u.sc(15,"hasPermission"),u.sc(16,"translate"),u.Vc(17,Xe,5,4,"section",24),u.ic(18,"div",25),u.Vc(19,Ge,2,4,"vdr-facet-value-chip",26),u.sc(20,"async"),u.Vc(21,Ne,4,3,"button",27),u.hc(),u.hc(),u.hc(),u.ic(22,"div",28),u.ic(23,"vdr-product-assets",29),u.pc("change",(function(t){return u.Mc(n),u.rc(2).assetChanges=t})),u.hc(),u.hc(),u.hc(),u.Vc(24,Le,5,3,"div",14),u.sc(25,"async"),u.hc()}if(2&t){var c=u.rc().ngIf,a=u.rc();u.Rb(5),u.yc("label",u.tc(6,13,"catalog.product-name")),u.Rb(2),u.yc("readonly",!u.tc(8,15,"UpdateCatalog")),u.Rb(2),u.yc("label",u.tc(10,17,"catalog.slug"))("errors",u.Dc(31,_t,u.tc(11,19,"catalog.slug-pattern-error"))),u.Rb(3),u.yc("readonly",!u.tc(13,21,"UpdateCatalog")),u.Rb(2),u.yc("readonly",!u.tc(15,23,"UpdateCatalog"))("label",u.tc(16,25,"common.description")),u.Rb(3),u.yc("ngIf",a.customFields.length),u.Rb(2),u.yc("ngForOf",u.tc(20,27,a.facetValues$)),u.Rb(2),u.yc("vdrIfPermissions","UpdateCatalog"),u.Rb(2),u.yc("assets",c.assets)("featuredAsset",c.featuredAsset),u.Rb(1),u.yc("ngIf",u.tc(25,29,a.isNew$))}}var Ee=function(){return["./","manage-variants"]};function Be(t,e){1&t&&(u.ic(0,"a",62),u.dc(1,"clr-icon",63),u.Xc(2),u.sc(3,"translate"),u.hc()),2&t&&(u.yc("routerLink",u.Cc(4,Ee)),u.Rb(2),u.Zc(" ",u.tc(3,2,"catalog.manage-variants")," "))}function Ye(t,e){if(1&t&&(u.dc(0,"vdr-product-variants-table",64),u.sc(1,"async")),2&t){var n=u.rc(3).ngIf,c=u.rc();u.yc("variants",u.tc(1,3,c.variants$))("optionGroups",n.optionGroups)("productVariantsFormArray",c.detailForm.get("variants"))}}function Ze(t,e){if(1&t){var n=u.jc();u.ic(0,"vdr-product-variants-list",65),u.pc("assetChange",(function(t){return u.Mc(n),u.rc(4).variantAssetChange(t)}))("updateProductOption",(function(t){return u.Mc(n),u.rc(4).updateProductOption(t)}))("selectionChange",(function(t){return u.Mc(n),u.rc(4).selectedVariantIds=t}))("selectFacetValueClick",(function(t){return u.Mc(n),u.rc(4).selectVariantFacetValue(t)})),u.sc(1,"async"),u.sc(2,"async"),u.sc(3,"async"),u.sc(4,"async"),u.hc()}if(2&t){var c=u.rc(3).ngIf,a=u.rc();u.yc("variants",u.tc(1,8,a.variants$))("facets",u.tc(2,10,a.facets$))("optionGroups",c.optionGroups)("productVariantsFormArray",a.detailForm.get("variants"))("taxCategories",u.tc(3,12,a.taxCategories$))("customFields",a.customVariantFields)("customOptionFields",a.customOptionFields)("activeLanguage",u.tc(4,14,a.languageCode$))}}function We(t,e){if(1&t){var n=u.jc();u.ic(0,"clr-tab-content"),u.ic(1,"section",47),u.ic(2,"div",48),u.ic(3,"div",49),u.ic(4,"button",50),u.pc("click",(function(){return u.Mc(n),u.rc(3).variantDisplayMode="card"})),u.dc(5,"clr-icon",51),u.Xc(6),u.sc(7,"translate"),u.hc(),u.ic(8,"button",52),u.pc("click",(function(){return u.Mc(n),u.rc(3).variantDisplayMode="table"})),u.dc(9,"clr-icon",53),u.Xc(10),u.sc(11,"translate"),u.hc(),u.hc(),u.ic(12,"div",54),u.dc(13,"input",55),u.sc(14,"translate"),u.ic(15,"button",56),u.pc("click",(function(){return u.Mc(n),u.rc(3).filterInput.setValue("")})),u.dc(16,"clr-icon",57),u.hc(),u.hc(),u.dc(17,"div",58),u.Vc(18,Be,4,5,"a",59),u.hc(),u.Vc(19,Ye,2,5,"vdr-product-variants-table",60),u.Vc(20,Ze,5,16,"vdr-product-variants-list",61),u.hc(),u.hc()}if(2&t){var c=u.rc(3);u.Rb(4),u.Ub("btn-primary","card"===c.variantDisplayMode),u.Rb(2),u.Zc(" ",u.tc(7,11,"catalog.display-variant-cards")," "),u.Rb(2),u.Ub("btn-primary","table"===c.variantDisplayMode),u.Rb(2),u.Zc(" ",u.tc(11,13,"catalog.display-variant-table")," "),u.Rb(3),u.yc("formControl",c.filterInput)("placeholder",u.tc(14,15,"catalog.filter-by-name-or-sku")),u.Rb(5),u.yc("vdrIfPermissions","UpdateCatalog"),u.Rb(1),u.yc("ngIf","table"===c.variantDisplayMode),u.Rb(1),u.yc("ngIf","card"===c.variantDisplayMode)}}function Ke(t,e){if(1&t){var n=u.jc();u.ic(0,"clr-tab"),u.ic(1,"button",12),u.pc("click",(function(){return u.Mc(n),u.rc(2).navigateToTab("variants")})),u.Xc(2),u.sc(3,"translate"),u.hc(),u.Vc(4,We,21,17,"clr-tab-content",13),u.sc(5,"async"),u.hc()}if(2&t){var c=u.rc(2);u.Rb(2),u.Zc(" ",u.tc(3,2,"catalog.product-variants")," "),u.Rb(2),u.yc("clrIfActive","variants"===u.tc(5,4,c.activeTab$))}}function qe(t,e){if(1&t){var n=u.jc();u.ic(0,"form",11),u.pc("keydown.enter",(function(t){return u.Mc(n),t.preventDefault()})),u.ic(1,"clr-tabs"),u.ic(2,"clr-tab"),u.ic(3,"button",12),u.pc("click",(function(){return u.Mc(n),u.rc().navigateToTab("details")})),u.Xc(4),u.sc(5,"translate"),u.hc(),u.Vc(6,Ue,26,33,"clr-tab-content",13),u.sc(7,"async"),u.hc(),u.Vc(8,Ke,6,6,"clr-tab",14),u.sc(9,"async"),u.hc(),u.hc()}if(2&t){var c=u.rc();u.yc("formGroup",c.detailForm),u.Rb(4),u.Zc(" ",u.tc(5,4,"catalog.product-details")," "),u.Rb(2),u.yc("clrIfActive","details"===u.tc(7,6,c.activeTab$)),u.Rb(2),u.yc("ngIf",!u.tc(9,8,c.isNew$))}}var ze=["selectComponent"];function Je(t,e){if(1&t){var n=u.jc();u.ic(0,"div",6),u.pc("click",(function(){return u.Mc(n),u.rc(2),u.Jc(1).selectTag()})),u.Xc(1),u.sc(2,"translate"),u.hc()}if(2&t){var c=u.rc(2),a=u.Jc(1);u.Ub("selected",c.isSearchHeaderSelected()),u.Rb(1),u.ad(" ",u.tc(2,4,"catalog.search-for-term"),": ",a.searchTerm," ")}}function He(t,e){if(1&t&&u.Vc(0,Je,3,6,"div",5),2&t){u.rc();var n=u.Jc(1);u.yc("ngIf",n.searchTerm)}}function Qe(t,e){if(1&t){var n=u.jc();u.gc(0),u.ic(1,"vdr-facet-value-chip",8),u.pc("remove",(function(){u.Mc(n);var t=u.rc(),e=t.item;return(0,t.clear)(e)})),u.hc(),u.fc()}if(2&t){var c=u.rc().item;u.Rb(1),u.yc("facetValue",c.facetValue)("removable",!0)}}function tn(t,e){if(1&t){var n=u.jc();u.gc(0),u.ic(1,"vdr-chip",9),u.pc("iconClick",(function(){u.Mc(n);var t=u.rc(),e=t.item;return(0,t.clear)(e)})),u.Xc(2),u.hc(),u.fc()}if(2&t){var c=u.rc().item;u.Rb(1),u.yc("icon","times"),u.Rb(1),u.Zc('"',c.label,'"')}}function en(t,e){if(1&t&&(u.Vc(0,Qe,2,2,"ng-container",7),u.Vc(1,tn,3,2,"ng-container",7)),2&t){var n=e.item;u.yc("ngIf",n.facetValue),u.Rb(1),u.yc("ngIf",!n.facetValue)}}function nn(t,e){if(1&t&&(u.gc(0),u.dc(1,"vdr-facet-value-chip",10),u.fc()),2&t){var n=u.rc().item;u.Rb(1),u.yc("facetValue",n.facetValue)("removable",!1)}}function cn(t,e){if(1&t&&u.Vc(0,nn,2,2,"ng-container",7),2&t){var n=e.item;u.yc("ngIf",n.facetValue)}}var an=["productSearchInputComponent"];function rn(t,e){1&t&&(u.ic(0,"a",13),u.dc(1,"clr-icon",14),u.ic(2,"span",15),u.Xc(3),u.sc(4,"translate"),u.hc(),u.hc()),2&t&&(u.yc("routerLink",u.Cc(4,$t)),u.Rb(3),u.Yc(u.tc(4,2,"catalog.create-new-product")))}function on(t,e){if(1&t&&(u.dc(0,"img",28),u.sc(1,"assetPreview")),2&t){var n=e.ngIf;u.yc("src",u.uc(1,1,n,"tiny"),u.Oc)}}function sn(t,e){1&t&&(u.ic(0,"div",29),u.dc(1,"clr-icon",30),u.hc())}function ln(t,e){1&t&&(u.ic(0,"vdr-chip"),u.Xc(1),u.sc(2,"translate"),u.hc()),2&t&&(u.Rb(1),u.Yc(u.tc(2,1,"common.disabled")))}function un(t,e){if(1&t){var n=u.jc();u.ic(0,"td",16),u.ic(1,"div",17),u.Vc(2,on,2,4,"img",18),u.Vc(3,sn,2,0,"ng-template",null,19,u.Wc),u.hc(),u.hc(),u.ic(5,"td",16),u.Xc(6),u.hc(),u.ic(7,"td",20),u.Vc(8,ln,3,3,"vdr-chip",21),u.hc(),u.ic(9,"td",22),u.dc(10,"vdr-table-row-action",23),u.sc(11,"translate"),u.hc(),u.ic(12,"td",22),u.ic(13,"vdr-dropdown"),u.ic(14,"button",24),u.Xc(15),u.sc(16,"translate"),u.dc(17,"clr-icon",25),u.hc(),u.ic(18,"vdr-dropdown-menu",7),u.ic(19,"button",26),u.pc("click",(function(){u.Mc(n);var t=e.item;return u.rc().deleteProduct(t.productId)})),u.sc(20,"hasPermission"),u.dc(21,"clr-icon",27),u.Xc(22),u.sc(23,"translate"),u.hc(),u.hc(),u.hc(),u.hc()}if(2&t){var c=e.item,a=u.Jc(4),r=u.rc();u.Ub("disabled",!c.enabled),u.Rb(2),u.yc("ngIf",r.groupByProduct?c.productAsset:c.productVariantAsset||c.productAsset)("ngIfElse",a),u.Rb(3),u.Ub("disabled",!c.enabled),u.Rb(1),u.Zc(" ",r.groupByProduct?c.productName:c.productVariantName," "),u.Rb(1),u.Ub("disabled",!c.enabled),u.Rb(1),u.yc("ngIf",!c.enabled),u.Rb(1),u.Ub("disabled",!c.enabled),u.Rb(1),u.yc("label",u.tc(11,19,"common.edit"))("linkTo",u.Dc(27,de,c.productId)),u.Rb(2),u.Ub("disabled",!c.enabled),u.Rb(3),u.Zc(" ",u.tc(16,21,"common.actions")," "),u.Rb(4),u.yc("disabled",!u.tc(20,23,"DeleteCatalog")),u.Rb(3),u.Zc(" ",u.tc(23,25,"common.delete")," ")}}function dn(t,e){if(1&t){var n=u.jc();u.ic(0,"div",6),u.ic(1,"div",7),u.ic(2,"label"),u.Xc(3),u.sc(4,"translate"),u.hc(),u.ic(5,"input",8),u.pc("ngModelChange",(function(t){return u.Mc(n),e.$implicit.name=t})),u.hc(),u.hc(),u.ic(6,"div",9),u.ic(7,"label"),u.Xc(8),u.sc(9,"translate"),u.hc(),u.ic(10,"vdr-option-value-input",10,11),u.pc("ngModelChange",(function(t){return u.Mc(n),e.$implicit.values=t}))("ngModelChange",(function(){return u.Mc(n),u.rc().generateVariants()})),u.hc(),u.hc(),u.hc()}if(2&t){var c=e.$implicit;u.Rb(3),u.Yc(u.tc(4,7,"catalog.option")),u.Rb(2),u.yc("ngModel",c.name)("readonly",!c.isNew),u.Rb(3),u.Yc(u.tc(9,9,"catalog.option-values")),u.Rb(2),u.yc("ngModel",c.values)("groupName",c.name)("disabled",""===c.name)}}function pn(t,e){if(1&t){var n=u.jc();u.ic(0,"button",12),u.pc("click",(function(){return u.Mc(n),u.rc().addOption()})),u.dc(1,"clr-icon",13),u.Xc(2),u.sc(3,"translate"),u.hc()}2&t&&(u.Rb(2),u.Zc(" ",u.tc(3,1,"catalog.add-option"),"\n"))}function fn(t,e){if(1&t){var n=u.jc();u.ic(0,"input",16),u.pc("ngModelChange",(function(t){u.Mc(n);var e=u.rc().$implicit;return u.rc().variantFormValues[e.id].enabled=t}))("ngModelChange",(function(){return u.Mc(n),u.rc(2).formValueChanged=!0})),u.hc()}if(2&t){var c=u.rc().$implicit,a=u.rc();u.yc("ngModel",a.variantFormValues[c.id].enabled)}}function gn(t,e){if(1&t){var n=u.jc();u.ic(0,"clr-input-container"),u.ic(1,"input",17),u.pc("ngModelChange",(function(t){u.Mc(n);var e=u.rc().$implicit;return u.rc().variantFormValues[e.id].sku=t}))("ngModelChange",(function(){u.Mc(n);var t=u.rc().$implicit,e=u.rc();return e.onFormChanged(e.variantFormValues[t.id])})),u.sc(2,"translate"),u.hc(),u.hc()}if(2&t){var c=u.rc().$implicit,a=u.rc();u.Rb(1),u.yc("ngModel",a.variantFormValues[c.id].sku)("placeholder",u.tc(2,2,"catalog.sku"))}}function hn(t,e){if(1&t&&(u.ic(0,"span"),u.Xc(1),u.hc()),2&t){var n=u.rc().$implicit,c=u.rc();u.Rb(1),u.Yc(c.variantFormValues[n.id].sku)}}function mn(t,e){if(1&t){var n=u.jc();u.ic(0,"clr-input-container"),u.ic(1,"vdr-currency-input",18),u.pc("ngModelChange",(function(t){u.Mc(n);var e=u.rc().$implicit;return u.rc().variantFormValues[e.id].price=t}))("ngModelChange",(function(){u.Mc(n);var t=u.rc().$implicit,e=u.rc();return e.onFormChanged(e.variantFormValues[t.id])})),u.hc(),u.hc()}if(2&t){var c=u.rc().$implicit,a=u.rc();u.Rb(1),u.yc("ngModel",a.variantFormValues[c.id].price)("currencyCode",a.currencyCode)}}function vn(t,e){if(1&t&&(u.ic(0,"span"),u.Xc(1),u.sc(2,"currency"),u.hc()),2&t){var n=u.rc().$implicit,c=u.rc();u.Rb(1),u.Yc(u.uc(2,1,c.variantFormValues[n.id].price/100,c.currencyCode))}}function bn(t,e){if(1&t){var n=u.jc();u.ic(0,"clr-input-container"),u.ic(1,"input",19),u.pc("ngModelChange",(function(t){u.Mc(n);var e=u.rc().$implicit;return u.rc().variantFormValues[e.id].stock=t}))("ngModelChange",(function(){u.Mc(n);var t=u.rc().$implicit,e=u.rc();return e.onFormChanged(e.variantFormValues[t.id])})),u.hc(),u.hc()}if(2&t){var c=u.rc().$implicit,a=u.rc();u.Rb(1),u.yc("ngModel",a.variantFormValues[c.id].stock)}}function yn(t,e){if(1&t&&(u.ic(0,"span"),u.Xc(1),u.hc()),2&t){var n=u.rc().$implicit,c=u.rc();u.Rb(1),u.Yc(c.variantFormValues[n.id].stock)}}function Cn(t,e){if(1&t){var n=u.jc();u.ic(0,"vdr-dropdown"),u.ic(1,"button",20),u.dc(2,"clr-icon",21),u.hc(),u.ic(3,"vdr-dropdown-menu",22),u.ic(4,"button",23),u.pc("click",(function(){u.Mc(n);var t=e.ngIf;return u.rc(2).deleteVariant(t)})),u.dc(5,"clr-icon",24),u.Xc(6),u.sc(7,"translate"),u.hc(),u.hc(),u.hc()}2&t&&(u.Rb(6),u.Zc(" ",u.tc(7,1,"common.delete")," "))}function On(t,e){if(1&t&&(u.ic(0,"tr"),u.ic(1,"td"),u.Vc(2,fn,1,1,"input",14),u.hc(),u.ic(3,"td"),u.Xc(4),u.hc(),u.ic(5,"td"),u.Vc(6,gn,3,4,"clr-input-container",15),u.Vc(7,hn,2,1,"span",15),u.hc(),u.ic(8,"td"),u.Vc(9,mn,2,2,"clr-input-container",15),u.Vc(10,vn,3,4,"span",15),u.hc(),u.ic(11,"td"),u.Vc(12,bn,2,1,"clr-input-container",15),u.Vc(13,yn,2,1,"span",15),u.hc(),u.ic(14,"td"),u.Vc(15,Cn,8,3,"vdr-dropdown",15),u.hc(),u.hc()),2&t){var n=e.$implicit,c=u.rc();u.Ub("disabled",!c.variantFormValues[n.id].enabled||c.variantFormValues[n.id].existing),u.Rb(2),u.yc("ngIf",!c.variantFormValues[n.id].existing),u.Rb(2),u.Zc(" ",c.getVariantName(n)," "),u.Rb(2),u.yc("ngIf",!c.variantFormValues[n.id].existing),u.Rb(1),u.yc("ngIf",c.variantFormValues[n.id].existing),u.Rb(2),u.yc("ngIf",!c.variantFormValues[n.id].existing),u.Rb(1),u.yc("ngIf",c.variantFormValues[n.id].existing),u.Rb(2),u.yc("ngIf",!c.variantFormValues[n.id].existing),u.Rb(1),u.yc("ngIf",c.variantFormValues[n.id].existing),u.Rb(2),u.yc("ngIf",c.variantFormValues[n.id].productVariantId)}}function kn(t,e){if(1&t&&u.dc(0,"vdr-collection-tree-node",1),2&t){var n=u.rc();u.yc("expandAll",n.expandAll)("collectionTree",n.collectionTree)("activeCollectionId",n.activeCollectionId)}}function Pn(t,e){1&t&&u.dc(0,"clr-icon",31)}function Fn(t,e){1&t&&u.dc(0,"clr-icon",32)}function In(t,e){if(1&t){var n=u.jc();u.ic(0,"button",28),u.pc("click",(function(){u.Mc(n);var t=u.rc().$implicit;return t.expanded=!t.expanded})),u.Vc(1,Pn,1,0,"clr-icon",29),u.Vc(2,Fn,1,0,"clr-icon",30),u.hc()}if(2&t){var c=u.rc().$implicit,a=u.rc();u.yc("disabled",a.expandAll),u.Rb(1),u.yc("ngIf",!c.expanded&&!a.expandAll),u.Rb(1),u.yc("ngIf",c.expanded||a.expandAll)}}function Vn(t,e){1&t&&u.dc(0,"div",33)}function xn(t,e){1&t&&(u.ic(0,"vdr-chip"),u.Xc(1),u.sc(2,"translate"),u.hc()),2&t&&(u.Rb(1),u.Yc(u.tc(2,1,"catalog.private")))}function Mn(t,e){1&t&&(u.ic(0,"div",34),u.dc(1,"clr-icon",35),u.hc())}var Rn=function(t){return{parentId:t}},jn=function(t){return["./","create",t]};function wn(t,e){if(1&t&&(u.ic(0,"a",36),u.dc(1,"clr-icon",37),u.Xc(2),u.sc(3,"translate"),u.hc()),2&t){var n=u.rc().$implicit;u.yc("routerLink",u.Dc(6,jn,u.Dc(4,Rn,n.id))),u.Rb(2),u.Zc(" ",u.tc(3,2,"catalog.create-new-collection")," ")}}function Dn(t,e){if(1&t){var n=u.jc();u.ic(0,"button",20),u.pc("click",(function(){u.Mc(n);var t=e.$implicit,c=u.rc().$implicit;return u.rc().move(c,t.id)})),u.sc(1,"async"),u.dc(2,"clr-icon",38),u.Xc(3),u.hc()}if(2&t){var c=e.$implicit,a=u.rc(2);u.yc("disabled",!u.tc(1,2,a.hasUpdatePermission$)),u.Rb(3),u.Zc(" ",c.path," ")}}function Sn(t,e){if(1&t&&u.dc(0,"vdr-collection-tree-node",39),2&t){var n=u.rc().$implicit,c=u.rc();u.yc("expandAll",c.expandAll)("collectionTree",n)("activeCollectionId",c.activeCollectionId)}}var _n=function(t){return{contents:t}},An=function(t){return["/catalog/collections/",t]};function $n(t,e){if(1&t){var n=u.jc();u.ic(0,"div",3),u.ic(1,"div",4),u.ic(2,"div",5),u.Vc(3,In,3,3,"button",6),u.Vc(4,Vn,1,0,"ng-template",null,7,u.Wc),u.Xc(6),u.hc(),u.dc(7,"div",8),u.Vc(8,xn,3,3,"vdr-chip",9),u.ic(9,"a",10),u.dc(10,"clr-icon",11),u.Xc(11),u.sc(12,"translate"),u.hc(),u.ic(13,"a",12),u.dc(14,"clr-icon",13),u.Xc(15),u.sc(16,"translate"),u.hc(),u.Vc(17,Mn,2,0,"div",14),u.ic(18,"vdr-dropdown"),u.ic(19,"button",15),u.dc(20,"clr-icon",16),u.hc(),u.ic(21,"vdr-dropdown-menu",17),u.Vc(22,wn,4,8,"a",18),u.dc(23,"div",19),u.ic(24,"button",20),u.pc("click",(function(){u.Mc(n);var t=e.$implicit,c=e.index;return u.rc().moveUp(t,c)})),u.sc(25,"async"),u.dc(26,"clr-icon",21),u.Xc(27),u.sc(28,"translate"),u.hc(),u.ic(29,"button",20),u.pc("click",(function(){u.Mc(n);var t=e.$implicit,c=e.index;return u.rc().moveDown(t,c)})),u.sc(30,"async"),u.dc(31,"clr-icon",22),u.Xc(32),u.sc(33,"translate"),u.hc(),u.ic(34,"h4",23),u.Xc(35),u.sc(36,"translate"),u.hc(),u.Vc(37,Dn,4,4,"button",24),u.dc(38,"div",19),u.ic(39,"button",25),u.pc("click",(function(){u.Mc(n);var t=e.$implicit;return u.rc().delete(t.id)})),u.sc(40,"async"),u.dc(41,"clr-icon",26),u.Xc(42),u.sc(43,"translate"),u.hc(),u.hc(),u.hc(),u.hc(),u.Vc(44,Sn,1,3,"vdr-collection-tree-node",27),u.hc()}if(2&t){var c=e.$implicit,a=e.index,r=u.Jc(5),i=u.rc();u.Ub("private",c.isPrivate),u.yc("cdkDragData",c),u.Rb(1),u.Ub("active",c.id===i.activeCollectionId),u.yc("ngClass","depth-"+i.depth),u.Rb(2),u.yc("ngIf",null==c.children?null:c.children.length)("ngIfElse",r),u.Rb(3),u.Zc(" ",c.name," "),u.Rb(2),u.yc("ngIf",c.isPrivate),u.Rb(1),u.yc("routerLink",u.Dc(45,de,u.Dc(43,_n,c.id))),u.Rb(2),u.Zc(" ",u.tc(12,25,"catalog.view-contents")," "),u.Rb(2),u.yc("routerLink",u.Dc(47,An,c.id)),u.Rb(2),u.Zc(" ",u.tc(16,27,"common.edit")," "),u.Rb(2),u.yc("vdrIfPermissions","UpdateCatalog"),u.Rb(5),u.yc("vdrIfPermissions","CreateCatalog"),u.Rb(2),u.yc("disabled",0===a||!u.tc(25,29,i.hasUpdatePermission$)),u.Rb(3),u.Zc(" ",u.tc(28,31,"catalog.move-up")," "),u.Rb(2),u.yc("disabled",a===i.collectionTree.children.length-1||!u.tc(30,33,i.hasUpdatePermission$)),u.Rb(3),u.Zc(" ",u.tc(33,35,"catalog.move-down")," "),u.Rb(3),u.Yc(u.tc(36,37,"catalog.move-to")),u.Rb(2),u.yc("ngForOf",i.getMoveListItems(c)),u.Rb(2),u.yc("disabled",!u.tc(40,39,i.hasDeletePermission$)),u.Rb(3),u.Zc(" ",u.tc(43,41,"common.delete")," "),u.Rb(2),u.yc("ngIf",c.expanded||i.expandAll)}}function Tn(t,e){if(1&t){var n=u.jc();u.ic(0,"div",7),u.ic(1,"div",8),u.ic(2,"label"),u.Xc(3),u.sc(4,"translate"),u.hc(),u.ic(5,"input",9),u.pc("ngModelChange",(function(t){return u.Mc(n),e.$implicit.name=t}))("keydown.enter",(function(t){u.Mc(n);var e=u.Jc(11);return u.rc().handleEnter(t,e)})),u.hc(),u.hc(),u.ic(6,"div",10),u.ic(7,"label"),u.Xc(8),u.sc(9,"translate"),u.hc(),u.ic(10,"vdr-option-value-input",11,12),u.pc("ngModelChange",(function(t){return u.Mc(n),e.$implicit.values=t}))("ngModelChange",(function(){return u.Mc(n),u.rc().generateVariants()})),u.hc(),u.hc(),u.ic(12,"div",13),u.ic(13,"button",14),u.pc("click",(function(){u.Mc(n);var t=e.$implicit;return u.rc().removeOption(t.name)})),u.sc(14,"translate"),u.dc(15,"clr-icon",15),u.hc(),u.hc(),u.hc()}if(2&t){var c=e.$implicit;u.Rb(3),u.Yc(u.tc(4,7,"catalog.option")),u.Rb(2),u.yc("ngModel",c.name),u.Rb(3),u.Yc(u.tc(9,9,"catalog.option-values")),u.Rb(2),u.yc("ngModel",c.values)("groupName",c.name)("disabled",""===c.name),u.Rb(3),u.yc("title",u.tc(14,11,"catalog.remove-option"))}}function Xn(t,e){1&t&&(u.ic(0,"th"),u.Xc(1),u.sc(2,"translate"),u.hc()),2&t&&(u.Rb(1),u.Yc(u.tc(2,1,"common.create")))}function Gn(t,e){1&t&&(u.ic(0,"th"),u.Xc(1),u.sc(2,"translate"),u.hc()),2&t&&(u.Rb(1),u.Yc(u.tc(2,1,"catalog.variant")))}function Nn(t,e){if(1&t){var n=u.jc();u.ic(0,"td"),u.ic(1,"input",19),u.pc("change",(function(){return u.Mc(n),u.rc(2).onFormChange()}))("ngModelChange",(function(t){u.Mc(n);var e=u.rc().$implicit;return u.rc().variantFormValues[e.id].enabled=t})),u.hc(),u.hc()}if(2&t){var c=u.rc().$implicit,a=u.rc();u.Rb(1),u.yc("ngModel",a.variantFormValues[c.id].enabled)}}function Ln(t,e){if(1&t&&(u.ic(0,"td"),u.Xc(1),u.hc()),2&t){var n=u.rc().$implicit;u.Rb(1),u.Zc(" ",n.values.join(" ")," ")}}function Un(t,e){if(1&t){var n=u.jc();u.ic(0,"tr"),u.Vc(1,Nn,2,1,"td",5),u.Vc(2,Ln,2,1,"td",5),u.ic(3,"td"),u.ic(4,"clr-input-container"),u.ic(5,"input",16),u.pc("change",(function(){return u.Mc(n),u.rc().onFormChange()}))("ngModelChange",(function(t){u.Mc(n);var c=e.$implicit;return u.rc().variantFormValues[c.id].sku=t})),u.sc(6,"translate"),u.hc(),u.hc(),u.hc(),u.ic(7,"td"),u.ic(8,"clr-input-container"),u.ic(9,"vdr-currency-input",17),u.pc("ngModelChange",(function(t){u.Mc(n);var c=e.$implicit;return u.rc().variantFormValues[c.id].price=t}))("ngModelChange",(function(){return u.Mc(n),u.rc().onFormChange()})),u.hc(),u.hc(),u.hc(),u.ic(10,"td"),u.ic(11,"clr-input-container"),u.ic(12,"input",18),u.pc("ngModelChange",(function(t){u.Mc(n);var c=e.$implicit;return u.rc().variantFormValues[c.id].stock=t}))("change",(function(){return u.Mc(n),u.rc().onFormChange()})),u.hc(),u.hc(),u.hc(),u.hc()}if(2&t){var c=e.$implicit,a=u.rc();u.Ub("disabled",!a.variantFormValues[c.id].enabled),u.Rb(1),u.yc("ngIf",1<a.variants.length),u.Rb(1),u.yc("ngIf",1<a.variants.length),u.Rb(3),u.yc("ngModel",a.variantFormValues[c.id].sku)("placeholder",u.tc(6,9,"catalog.sku")),u.Rb(4),u.yc("ngModel",a.variantFormValues[c.id].price)("currencyCode",a.currencyCode),u.Rb(3),u.yc("ngModel",a.variantFormValues[c.id].stock)}}var En=["textArea"];function Bn(t,e){if(1&t){var n=u.jc();u.ic(0,"vdr-chip",6),u.pc("iconClick",(function(){u.Mc(n);var t=e.$implicit;return u.rc(2).removeOption(t)})),u.Xc(1),u.hc()}if(2&t){var c=e.$implicit,a=e.last,r=u.rc(2);u.Ub("selected",a&&r.lastSelected)("locked",c.locked),u.yc("icon",c.locked?"lock":"times")("colorFrom",r.groupName),u.Rb(1),u.Zc(" ",c.name," ")}}function Yn(t,e){if(1&t&&(u.ic(0,"div",4),u.Vc(1,Bn,2,7,"vdr-chip",5),u.hc()),2&t){var n=u.rc();u.Rb(1),u.yc("ngForOf",n.options)}}var Zn=["dlg"],Wn=["dl"];function Kn(t,e){if(1&t){var n=u.jc();u.ic(0,"img",11),u.pc("click",(function(){u.Mc(n);var t=u.rc(2);return t.previewAsset(t.featuredAsset)})),u.sc(1,"assetPreview"),u.hc()}if(2&t){var c=u.rc(2);u.yc("src",u.uc(1,1,c.featuredAsset,"small"),u.Oc)}}function qn(t,e){1&t&&(u.ic(0,"div",12),u.dc(1,"clr-icon",13),u.ic(2,"div"),u.Xc(3),u.sc(4,"translate"),u.hc(),u.hc()),2&t&&(u.Rb(3),u.Yc(u.tc(4,1,"catalog.no-featured-asset")))}function zn(t,e){1&t&&u.ec(0)}function Jn(t,e){if(1&t){var n=u.jc();u.ic(0,"div",14),u.ic(1,"button",15),u.pc("click",(function(){return u.Mc(n),u.rc(2).selectAssets()})),u.dc(2,"clr-icon",16),u.Xc(3),u.sc(4,"translate"),u.hc(),u.hc()}2&t&&(u.Rb(3),u.Zc(" ",u.tc(4,1,"asset.add-asset")," "))}function Hn(t,e){if(1&t&&(u.ic(0,"div",3),u.ic(1,"div",4),u.ic(2,"div",5),u.Vc(3,Kn,2,4,"img",6),u.Vc(4,qn,5,3,"div",7),u.hc(),u.hc(),u.ic(5,"div",8),u.Vc(6,zn,1,0,"ng-container",9),u.hc(),u.Vc(7,Jn,5,3,"div",10),u.hc()),2&t){var n=u.rc(),c=u.Jc(4);u.Rb(3),u.yc("ngIf",n.featuredAsset),u.Rb(1),u.yc("ngIf",!n.featuredAsset),u.Rb(2),u.yc("ngTemplateOutlet",c),u.Rb(1),u.yc("vdrIfPermissions","UpdateCatalog")}}function Qn(t,e){if(1&t){var n=u.jc();u.ic(0,"img",11),u.pc("click",(function(){u.Mc(n);var t=u.rc(2);return t.previewAsset(t.featuredAsset)})),u.sc(1,"assetPreview"),u.hc()}if(2&t){var c=u.rc(2);u.yc("src",u.uc(1,1,c.featuredAsset,"thumb"),u.Oc)}}function tc(t,e){1&t&&(u.ic(0,"div",12),u.dc(1,"clr-icon",19),u.hc())}function ec(t,e){1&t&&u.ec(0)}function nc(t,e){if(1&t){var n=u.jc();u.ic(0,"button",20),u.pc("click",(function(){return u.Mc(n),u.rc(2).selectAssets()})),u.sc(1,"translate"),u.dc(2,"clr-icon",16),u.Xc(3),u.sc(4,"translate"),u.hc()}2&t&&(u.yc("title",u.tc(1,2,"asset.add-asset")),u.Rb(3),u.Zc(" ",u.tc(4,4,"asset.add-asset")," "))}function cc(t,e){if(1&t&&(u.ic(0,"div",17),u.Vc(1,Qn,2,4,"img",6),u.Vc(2,tc,2,0,"div",7),u.hc(),u.Vc(3,ec,1,0,"ng-container",9),u.Vc(4,nc,5,6,"button",18)),2&t){var n=u.rc(),c=u.Jc(4);u.Rb(1),u.yc("ngIf",n.featuredAsset),u.Rb(1),u.yc("ngIf",!n.featuredAsset),u.Rb(1),u.yc("ngTemplateOutlet",c),u.Rb(1),u.yc("vdrIfPermissions","UpdateCatalog")}}function ac(t,e){if(1&t){var n=u.jc();u.ic(0,"div",23),u.pc("cdkDropListDropped",(function(){return u.Mc(n),u.rc(2).dropListDropped()})),u.sc(1,"hasPermission"),u.ic(2,"vdr-dropdown",26),u.pc("cdkDragMoved",(function(t){return u.Mc(n),u.rc(2).dragMoved(t)})),u.ic(3,"div",27),u.dc(4,"img",28),u.sc(5,"assetPreview"),u.hc(),u.ic(6,"vdr-dropdown-menu",29),u.ic(7,"button",30),u.pc("click",(function(){u.Mc(n);var t=e.$implicit;return u.rc(2).previewAsset(t)})),u.Xc(8),u.sc(9,"translate"),u.hc(),u.ic(10,"button",31),u.pc("click",(function(){u.Mc(n);var t=e.$implicit;return u.rc(2).setAsFeatured(t)})),u.sc(11,"hasPermission"),u.Xc(12),u.sc(13,"translate"),u.hc(),u.dc(14,"div",32),u.ic(15,"button",33),u.pc("click",(function(){u.Mc(n);var t=e.$implicit;return u.rc(2).removeAsset(t)})),u.sc(16,"hasPermission"),u.Xc(17),u.sc(18,"translate"),u.hc(),u.hc(),u.hc(),u.hc()}if(2&t){var c=e.$implicit,a=u.rc(2);u.yc("cdkDropListDisabled",!u.tc(1,10,"UpdateCatalog"))("cdkDropListEnterPredicate",a.dropListEnterPredicate),u.Rb(3),u.Ub("featured",a.isFeatured(c)),u.Rb(1),u.yc("src",u.uc(5,12,c,"tiny"),u.Oc),u.Rb(4),u.Zc(" ",u.tc(9,15,"asset.preview")," "),u.Rb(2),u.yc("disabled",a.isFeatured(c)||!u.tc(11,17,"UpdateCatalog")),u.Rb(2),u.Zc(" ",u.tc(13,19,"asset.set-as-featured-asset")," "),u.Rb(3),u.yc("disabled",!u.tc(16,21,"UpdateCatalog")),u.Rb(2),u.Zc(" ",u.tc(18,23,"asset.remove-asset")," ")}}function rc(t,e){if(1&t){var n=u.jc();u.ic(0,"div",21,22),u.ic(2,"div",23,24),u.pc("cdkDropListDropped",(function(){return u.Mc(n),u.rc().dropListDropped()})),u.sc(4,"hasPermission"),u.hc(),u.Vc(5,ac,19,25,"div",25),u.hc()}if(2&t){var c=u.rc();u.Ub("compact",c.compact),u.Rb(2),u.yc("cdkDropListDisabled",!u.tc(4,5,"UpdateCatalog"))("cdkDropListEnterPredicate",c.dropListEnterPredicate),u.Rb(3),u.yc("ngForOf",c.assets)}}function ic(t,e){1&t&&(u.Xc(0),u.sc(1,"translate")),2&t&&u.Yc(u.tc(1,1,"catalog.update-product-option"))}function oc(t,e){if(1&t&&(u.dc(0,"vdr-custom-field-control",11),u.sc(1,"hasPermission")),2&t){var n=u.rc().$implicit,c=u.rc(2);u.yc("customFieldsFormGroup",c.customFieldsForm)("customField",n)("readonly",!u.tc(1,3,"UpdateCatalog"))}}function sc(t,e){if(1&t&&(u.gc(0),u.Vc(1,oc,2,5,"vdr-custom-field-control",10),u.fc()),2&t){var n=e.$implicit,c=u.rc(2);u.Rb(1),u.yc("ngIf",c.customFieldsForm.get(n.name))}}function lc(t,e){if(1&t&&(u.ic(0,"section"),u.ic(1,"label"),u.Xc(2),u.sc(3,"translate"),u.hc(),u.Vc(4,sc,2,1,"ng-container",9),u.hc()),2&t){var n=u.rc();u.Rb(2),u.Yc(u.tc(3,2,"common.custom-fields")),u.Rb(2),u.yc("ngForOf",n.customFields)}}function uc(t,e){if(1&t){var n=u.jc();u.ic(0,"button",12),u.pc("click",(function(){return u.Mc(n),u.rc().cancel()})),u.Xc(1),u.sc(2,"translate"),u.hc(),u.ic(3,"button",13),u.pc("click",(function(){return u.Mc(n),u.rc().update()})),u.Xc(4),u.sc(5,"translate"),u.hc()}if(2&t){var c=u.rc(),a=u.Jc(4),r=u.Jc(8);u.Rb(1),u.Yc(u.tc(2,3,"common.cancel")),u.Rb(2),u.yc("disabled",a.invalid||r.invalid||a.pristine&&r.pristine&&c.customFieldsForm.pristine),u.Rb(1),u.Zc(" ",u.tc(5,5,"catalog.update-product-option")," ")}}function dc(t,e){1&t&&(u.ic(0,"clr-toggle-wrapper"),u.dc(1,"input",46),u.ic(2,"label"),u.Xc(3),u.sc(4,"translate"),u.hc(),u.hc()),2&t&&(u.Rb(3),u.Yc(u.tc(4,1,"common.enabled")))}function pc(t,e){if(1&t&&(u.ic(0,"option",49),u.Xc(1),u.hc()),2&t){var n=e.$implicit;u.yc("value",n.id),u.Rb(1),u.Zc(" ",n.name," ")}}function fc(t,e){if(1&t&&(u.ic(0,"clr-select-container"),u.ic(1,"label"),u.Xc(2),u.sc(3,"translate"),u.hc(),u.ic(4,"select",47),u.Vc(5,pc,2,2,"option",48),u.hc(),u.hc()),2&t){var n=u.rc(3);u.Rb(2),u.Yc(u.tc(3,2,"catalog.tax-category")),u.Rb(3),u.yc("ngForOf",n.taxCategories)}}function gc(t,e){if(1&t&&(u.ic(0,"label",31),u.Xc(1),u.sc(2,"translate"),u.hc(),u.ic(3,"div",50),u.Xc(4),u.hc()),2&t){var n=u.rc().ngIf,c=u.rc(2);u.Rb(1),u.Yc(u.tc(2,2,"catalog.tax-category")),u.Rb(3),u.Zc(" ",c.getTaxCategoryName(n)," ")}}function hc(t,e){if(1&t&&(u.ic(0,"clr-select-container"),u.ic(1,"label"),u.Xc(2),u.sc(3,"translate"),u.dc(4,"vdr-help-tooltip",29),u.sc(5,"translate"),u.hc(),u.ic(6,"select",51),u.ic(7,"option",49),u.Xc(8),u.sc(9,"translate"),u.hc(),u.ic(10,"option",49),u.Xc(11),u.sc(12,"translate"),u.hc(),u.ic(13,"option",49),u.Xc(14),u.sc(15,"translate"),u.hc(),u.hc(),u.hc()),2&t){var n=u.rc(3);u.Rb(2),u.Zc("",u.tc(3,8,"catalog.track-inventory")," "),u.Rb(2),u.yc("content",u.tc(5,10,"catalog.track-inventory-tooltip")),u.Rb(3),u.yc("value",n.GlobalFlag.TRUE),u.Rb(1),u.Zc(" ",u.tc(9,12,"catalog.track-inventory-true")," "),u.Rb(2),u.yc("value",n.GlobalFlag.FALSE),u.Rb(1),u.Zc(" ",u.tc(12,14,"catalog.track-inventory-false")," "),u.Rb(2),u.yc("value",n.GlobalFlag.INHERIT),u.Rb(1),u.Zc(" ",u.tc(15,16,"catalog.track-inventory-inherit")," ")}}function mc(t,e){if(1&t&&(u.dc(0,"vdr-custom-field-control",55),u.sc(1,"hasPermission")),2&t){var n=u.rc().$implicit,c=u.rc(2).ngIf;u.yc("compact",!0)("customFieldsFormGroup",c.get("customFields"))("readonly",!u.tc(1,4,"UpdateCatalog"))("customField",n)}}var vc=function(t){return["customFields",t]};function bc(t,e){if(1&t&&(u.gc(0),u.Vc(1,mc,2,6,"vdr-custom-field-control",54),u.fc()),2&t){var n=e.$implicit,c=u.rc(2).ngIf;u.Rb(1),u.yc("ngIf",c.get(u.Dc(1,vc,n.name)))}}function yc(t,e){if(1&t&&(u.ic(0,"section",52),u.Vc(1,bc,2,3,"ng-container",53),u.hc()),2&t){var n=u.rc(3);u.Rb(1),u.yc("ngForOf",n.customFields)}}function Cc(t,e){if(1&t){var n=u.jc();u.ic(0,"vdr-chip",58),u.pc("iconClick",(function(){u.Mc(n);var t=e.$implicit;return u.rc(4).editOption(t)})),u.sc(1,"hasPermission"),u.ic(2,"span",59),u.Xc(3),u.hc(),u.Xc(4),u.hc()}if(2&t){var c=e.$implicit,a=u.rc(4);u.yc("colorFrom",a.optionGroupName(c.groupId))("invert",!0)("icon",u.tc(1,5,"UpdateCatalog")&&"pencil"),u.Rb(3),u.Yc(a.optionGroupName(c.groupId)),u.Rb(1),u.Zc(" ",a.optionName(c)," ")}}function Oc(t,e){if(1&t&&(u.ic(0,"div"),u.ic(1,"div",56),u.Vc(2,Cc,5,7,"vdr-chip",57),u.sc(3,"sort"),u.hc(),u.hc()),2&t){var n=u.rc(2).$implicit;u.Rb(2),u.yc("ngForOf",u.uc(3,1,n.options,"groupId"))}}function kc(t,e){if(1&t){var n=u.jc();u.ic(0,"vdr-facet-value-chip",60),u.pc("remove",(function(){u.Mc(n);var t=e.$implicit,c=u.rc(2).$implicit;return u.rc().removeFacetValue(c,t.id)})),u.sc(1,"hasPermission"),u.hc()}if(2&t){var c=e.$implicit;u.yc("facetValue",c)("removable",u.tc(1,2,"UpdateCatalog"))}}function Pc(t,e){if(1&t){var n=u.jc();u.ic(0,"vdr-facet-value-chip",60),u.pc("remove",(function(){u.Mc(n);var t=e.$implicit,c=u.rc(2).$implicit;return u.rc().removeFacetValue(c,t.id)})),u.sc(1,"hasPermission"),u.hc()}if(2&t){var c=e.$implicit;u.yc("facetValue",c)("removable",u.tc(1,2,"UpdateCatalog"))}}function Fc(t,e){if(1&t){var n=u.jc();u.ic(0,"button",61),u.pc("click",(function(){u.Mc(n);var t=u.rc(2).$implicit;return u.rc().selectFacetValueClick.emit([t.id])})),u.dc(1,"clr-icon",62),u.Xc(2),u.sc(3,"translate"),u.hc()}2&t&&(u.Rb(2),u.Zc(" ",u.tc(3,1,"catalog.add-facets")," "))}function Ic(t,e){if(1&t){var n=u.jc();u.gc(0,7),u.ic(1,"div",8),u.ic(2,"div",9),u.ic(3,"vdr-title-input",10),u.sc(4,"hasPermission"),u.ic(5,"clr-input-container"),u.dc(6,"input",11),u.sc(7,"hasPermission"),u.sc(8,"translate"),u.hc(),u.hc(),u.ic(9,"vdr-title-input",12),u.sc(10,"hasPermission"),u.ic(11,"clr-input-container"),u.dc(12,"input",13),u.sc(13,"hasPermission"),u.sc(14,"translate"),u.hc(),u.hc(),u.hc(),u.ic(15,"div",14),u.Vc(16,dc,5,3,"clr-toggle-wrapper",15),u.hc(),u.hc(),u.ic(17,"div",16),u.ic(18,"div",17),u.ic(19,"div",18),u.ic(20,"vdr-product-assets",19),u.pc("change",(function(t){u.Mc(n);var e=u.rc().$implicit;return u.rc().onAssetChange(e.id,t)})),u.hc(),u.hc(),u.ic(21,"div",20),u.ic(22,"div",21),u.ic(23,"div",22),u.ic(24,"div",23),u.Vc(25,fc,6,4,"clr-select-container",24),u.Vc(26,gc,5,4,"ng-template",null,25,u.Wc),u.hc(),u.ic(28,"div",26),u.ic(29,"clr-input-container"),u.ic(30,"label"),u.Xc(31),u.sc(32,"translate"),u.hc(),u.dc(33,"vdr-currency-input",27),u.sc(34,"hasPermission"),u.hc(),u.hc(),u.dc(35,"vdr-variant-price-detail",28),u.hc(),u.ic(36,"div",22),u.Vc(37,hc,16,18,"clr-select-container",15),u.ic(38,"clr-input-container"),u.ic(39,"label"),u.Xc(40),u.sc(41,"translate"),u.dc(42,"vdr-help-tooltip",29),u.sc(43,"translate"),u.hc(),u.dc(44,"input",30),u.sc(45,"hasPermission"),u.hc(),u.ic(46,"div"),u.ic(47,"label",31),u.Xc(48),u.sc(49,"translate"),u.dc(50,"vdr-help-tooltip",29),u.sc(51,"translate"),u.hc(),u.ic(52,"div",32),u.Xc(53),u.hc(),u.hc(),u.ic(54,"div"),u.ic(55,"label",31),u.Xc(56),u.sc(57,"translate"),u.dc(58,"vdr-help-tooltip",29),u.sc(59,"translate"),u.hc(),u.ic(60,"div",32),u.Xc(61),u.hc(),u.hc(),u.hc(),u.ic(62,"div",22),u.ic(63,"div",33),u.ic(64,"label",31),u.Xc(65),u.sc(66,"translate"),u.dc(67,"vdr-help-tooltip",29),u.sc(68,"translate"),u.hc(),u.ic(69,"div",34),u.ic(70,"clr-input-container"),u.dc(71,"input",35),u.sc(72,"hasPermission"),u.hc(),u.ic(73,"clr-toggle-wrapper"),u.dc(74,"input",36),u.sc(75,"hasPermission"),u.ic(76,"label"),u.Xc(77),u.sc(78,"translate"),u.hc(),u.hc(),u.hc(),u.hc(),u.hc(),u.hc(),u.ic(79,"div",37),u.ic(80,"div",22),u.Vc(81,yc,2,1,"section",38),u.hc(),u.hc(),u.hc(),u.hc(),u.hc(),u.ic(82,"div",16),u.ic(83,"div",39),u.dc(84,"vdr-entity-info",40),u.Vc(85,Oc,4,4,"div",41),u.dc(86,"div",42),u.ic(87,"div",43),u.Vc(88,kc,2,4,"vdr-facet-value-chip",44),u.Vc(89,Pc,2,4,"vdr-facet-value-chip",44),u.Vc(90,Fc,4,3,"button",45),u.hc(),u.hc(),u.hc(),u.fc()}if(2&t){var c,a=e.ngIf,r=u.Jc(27),i=u.rc().$implicit,o=u.rc();u.yc("formGroup",a),u.Rb(3),u.yc("readonly",!u.tc(4,53,"UpdateCatalog")),u.Rb(3),u.yc("readonly",!u.tc(7,55,"UpdateCatalog"))("placeholder",u.tc(8,57,"catalog.sku")),u.Rb(3),u.yc("readonly",!u.tc(10,59,"UpdateCatalog")),u.Rb(3),u.yc("readonly",!u.tc(13,61,"UpdateCatalog"))("placeholder",u.tc(14,63,"common.name")),u.Rb(4),u.yc("vdrIfPermissions","UpdateCatalog"),u.Rb(4),u.yc("compact",!0)("assets",i.assets)("featuredAsset",i.featuredAsset),u.Rb(5),u.yc("vdrIfPermissions","UpdateCatalog")("vdrIfPermissionsElse",r),u.Rb(6),u.Yc(u.tc(32,65,"catalog.price")),u.Rb(2),u.yc("currencyCode",i.currencyCode)("readonly",!u.tc(34,67,"UpdateCatalog")),u.Rb(2),u.yc("price",a.get("price").value)("currencyCode",i.currencyCode)("priceIncludesTax",i.priceIncludesTax)("taxCategoryId",a.get("taxCategoryId").value),u.Rb(2),u.yc("vdrIfPermissions","UpdateCatalog"),u.Rb(3),u.Zc("",u.tc(41,69,"catalog.stock-on-hand")," "),u.Rb(2),u.yc("content",u.tc(43,71,"catalog.stock-on-hand-tooltip")),u.Rb(2),u.Ub("inventory-untracked",o.inventoryIsNotTracked(a)),u.yc("readonly",!u.tc(45,73,"UpdateCatalog"))("vdrDisabled",o.inventoryIsNotTracked(a)),u.Rb(2),u.Ub("inventory-untracked",o.inventoryIsNotTracked(a)),u.Rb(2),u.Zc("",u.tc(49,75,"catalog.stock-allocated")," "),u.Rb(2),u.yc("content",u.tc(51,77,"catalog.stock-allocated-tooltip")),u.Rb(3),u.Zc(" ",i.stockAllocated," "),u.Rb(1),u.Ub("inventory-untracked",o.inventoryIsNotTracked(a)),u.Rb(2),u.Zc("",u.tc(57,79,"catalog.stock-saleable")," "),u.Rb(2),u.yc("content",u.tc(59,81,"catalog.stock-saleable-tooltip")),u.Rb(3),u.Zc(" ",o.getSaleableStockLevel(i)," "),u.Rb(2),u.Ub("inventory-untracked",o.inventoryIsNotTracked(a)),u.Rb(2),u.Yc(u.tc(66,83,"catalog.out-of-stock-threshold")),u.Rb(2),u.yc("content",u.tc(68,85,"catalog.out-of-stock-threshold-tooltip")),u.Rb(4),u.yc("formControl",a.get("outOfStockThreshold"))("readonly",!u.tc(72,87,"UpdateCatalog"))("vdrDisabled",!1!==(null==(c=a.get("useGlobalOutOfStockThreshold"))?null:c.value)||o.inventoryIsNotTracked(a)),u.Rb(3),u.yc("vdrDisabled",!u.tc(75,89,"UpdateCatalog")||o.inventoryIsNotTracked(a)),u.Rb(3),u.ad("",u.tc(78,91,"catalog.use-global-value")," (",o.globalOutOfStockThreshold,")"),u.Rb(4),u.yc("ngIf",o.customFields.length),u.Rb(3),u.yc("entity",i),u.Rb(1),u.yc("ngIf",i.options.length),u.Rb(3),u.yc("ngForOf",o.existingFacetValues(i)),u.Rb(1),u.yc("ngForOf",o.pendingFacetValues(i)),u.Rb(1),u.yc("vdrIfPermissions","UpdateCatalog")}}function Vc(t,e){if(1&t&&(u.ic(0,"div",5),u.Vc(1,Ic,91,93,"ng-container",6),u.hc()),2&t){var n=e.$implicit,c=u.rc(),a=null,r=null;u.Ub("disabled",!(null!=(a=c.formGroupMap.get(n.id))&&null!=(r=a.get("enabled"))&&r.value)),u.Rb(1),u.yc("ngIf",c.formGroupMap.get(n.id))}}function xc(t,e){if(1&t&&(u.gc(0),u.ic(1,"vdr-dt-column"),u.Xc(2),u.hc(),u.fc()),2&t){var n=e.$implicit;u.Rb(2),u.Yc(n.name)}}function Mc(t,e){if(1&t&&(u.dc(0,"img",16),u.sc(1,"assetPreview")),2&t){var n=u.rc(2).item;u.yc("src",u.uc(1,1,n.featuredAsset,"tiny"),u.Oc)}}function Rc(t,e){1&t&&(u.ic(0,"div",17),u.dc(1,"clr-icon",18),u.hc())}function jc(t,e){if(1&t&&(u.gc(0),u.ic(1,"td",4),u.sc(2,"stringToColor"),u.Xc(3),u.hc(),u.fc()),2&t){var n=e.$implicit,c=u.rc().ngIf,a=u.rc(2);u.Rb(1),u.Sc("color",u.tc(2,5,a.optionGroupName(n.groupId))),u.Ub("disabled",!c.get("enabled").value),u.Rb(2),u.Zc(" ",n.name," ")}}function wc(t,e){if(1&t&&(u.gc(0,3),u.ic(1,"td",4),u.ic(2,"div",5),u.ic(3,"div",6),u.Vc(4,Mc,2,4,"img",7),u.Vc(5,Rc,2,0,"div",8),u.hc(),u.hc(),u.hc(),u.ic(6,"td",4),u.ic(7,"clr-input-container"),u.dc(8,"input",9),u.sc(9,"hasPermission"),u.sc(10,"translate"),u.hc(),u.hc(),u.ic(11,"td",4),u.ic(12,"clr-input-container"),u.dc(13,"input",10),u.sc(14,"hasPermission"),u.sc(15,"translate"),u.hc(),u.hc(),u.Vc(16,jc,4,7,"ng-container",1),u.sc(17,"sort"),u.ic(18,"td",11),u.ic(19,"clr-input-container"),u.dc(20,"vdr-currency-input",12),u.sc(21,"hasPermission"),u.hc(),u.hc(),u.ic(22,"td",13),u.ic(23,"clr-input-container"),u.dc(24,"input",14),u.sc(25,"hasPermission"),u.hc(),u.hc(),u.ic(26,"td",13),u.ic(27,"clr-toggle-wrapper"),u.dc(28,"input",15),u.sc(29,"hasPermission"),u.hc(),u.hc(),u.fc()),2&t){var n=e.ngIf,c=u.rc().item;u.yc("formGroup",n),u.Rb(1),u.Ub("disabled",!n.get("enabled").value),u.Rb(3),u.yc("ngIf",c.featuredAsset),u.Rb(1),u.yc("ngIf",!c.featuredAsset),u.Rb(1),u.Ub("disabled",!n.get("enabled").value),u.Rb(2),u.yc("readonly",!u.tc(9,24,"UpdateCatalog"))("placeholder",u.tc(10,26,"common.name")),u.Rb(3),u.Ub("disabled",!n.get("enabled").value),u.Rb(2),u.yc("readonly",!u.tc(14,28,"UpdateCatalog"))("placeholder",u.tc(15,30,"catalog.sku")),u.Rb(3),u.yc("ngForOf",u.uc(17,32,c.options,"groupId")),u.Rb(2),u.Ub("disabled",!n.get("enabled").value),u.Rb(2),u.yc("currencyCode",c.currencyCode)("readonly",!u.tc(21,35,"UpdateCatalog")),u.Rb(2),u.Ub("disabled",!n.get("enabled").value),u.Rb(2),u.yc("readonly",!u.tc(25,37,"UpdateCatalog")),u.Rb(2),u.Ub("disabled",!n.get("enabled").value),u.Rb(2),u.yc("vdrDisabled",!u.tc(29,39,"UpdateCatalog"))}}function Dc(t,e){if(1&t&&u.Vc(0,wc,30,41,"ng-container",2),2&t){var n=e.item,c=u.rc();u.yc("ngIf",c.formGroupMap.get(n.id))}}var Sc=function(t){return{rate:t}};function _c(t,e){if(1&t&&(u.ic(0,"div",2),u.Xc(1),u.sc(2,"translate"),u.sc(3,"async"),u.hc()),2&t){var n=u.rc();u.Rb(1),u.Zc(" ",u.uc(2,1,"catalog.price-includes-tax-at",u.Dc(6,Sc,u.tc(3,4,n.taxRate$))),"\n")}}var Ac=function(t,e){return{price:t,rate:e}};function $c(t,e){if(1&t&&(u.ic(0,"div",2),u.Xc(1),u.sc(2,"translate"),u.sc(3,"currency"),u.sc(4,"async"),u.sc(5,"async"),u.hc()),2&t){var n=u.rc();u.Rb(1),u.Zc(" ",u.uc(2,1,"catalog.price-with-tax-in-default-zone",u.Ec(11,Ac,u.uc(3,4,u.tc(4,7,n.grossPrice$),n.currencyCode),u.tc(5,9,n.taxRate$))),"\n")}}var Tc=function(t){o(n,t);var e=l(n);function n(t,c,a,r,i,o){var s;return f(this,n),(s=e.call(this,c,t,a,i)).notificationService=r,s.dataService=i,s.formBuilder=o,s.detailForm=new E.i({}),s}return h(n,[{key:"ngOnInit",value:function(){this.detailForm=new E.i({name:new E.f("")}),this.init()}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"onAssetChange",value:function(t){this.detailForm.get("name").setValue(t.name),this.detailForm.get("name").markAsDirty()}},{key:"save",value:function(){var t=this;this.dataService.product.updateAsset({id:this.id,name:this.detailForm.value.name}).subscribe((function(){t.notificationService.success(Object(v.a)("common.notify-update-success"),{entity:"Asset"})}),(function(e){t.notificationService.error(Object(v.a)("common.notify-update-error"),{entity:"Asset"})}))}},{key:"setFormValues",value:function(t,e){this.detailForm.get("name").setValue(t.name)}}]),n}(m.u);Tc.\u0275fac=function(t){return new(t||Tc)(u.cc(g.e),u.cc(g.a),u.cc(m.Jb),u.cc(m.Bb),u.cc(m.K),u.cc(E.e))},Tc.\u0275cmp=u.Wb({type:Tc,selectors:[["vdr-asset-detail"]],features:[u.Ob],decls:9,vars:8,consts:[[3,"entity"],["locationId","asset-detail"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"asset","editable","assetChange"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(t,e){1&t&&(u.ic(0,"vdr-action-bar"),u.ic(1,"vdr-ab-left"),u.dc(2,"vdr-entity-info",0),u.sc(3,"async"),u.hc(),u.ic(4,"vdr-ab-right"),u.dc(5,"vdr-action-bar-items",1),u.Vc(6,pt,3,4,"button",2),u.hc(),u.hc(),u.ic(7,"vdr-asset-preview",3),u.pc("assetChange",(function(t){return e.onAssetChange(t)})),u.sc(8,"async"),u.hc()),2&t&&(u.Rb(2),u.yc("entity",u.tc(3,4,e.entity$)),u.Rb(4),u.yc("vdrIfPermissions","UpdateCatalog"),u.Rb(1),u.yc("asset",u.tc(8,6,e.entity$))("editable",!0))},directives:[m.c,m.e,m.ab,m.f,m.d,m.rb,m.o],pipes:[nt.b,lt.d],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"],changeDetection:0}),Tc.ctorParameters=function(){return[{type:g.e},{type:g.a},{type:m.Jb},{type:m.Bb},{type:m.K},{type:E.e}]};var Xc=function(t){o(r,t);var a=l(r);function r(t,e,n,i,o){var s,l;return f(this,r),(l=a.call(this,i,o)).notificationService=t,l.modalService=e,l.dataService=n,l.searchTerm=new E.f(""),l.uploading=!1,c((s=d(l),p(r.prototype)),"setQueryFn",s).call(s,(function(){var t;return(t=l.dataService.product).getAssetList.apply(t,arguments)}),(function(t){return t.assets}),(function(t,e){return{options:{skip:t,take:e,filter:{name:{contains:l.searchTerm.value}},sort:{createdAt:B.SortOrder.DESC}}}})),l}return h(r,[{key:"ngOnInit",value:function(){var t=this;c(p(r.prototype),"ngOnInit",this).call(this),this.paginationConfig$=Object(Y.a)(this.itemsPerPage$,this.currentPage$,this.totalItems$).pipe(Object(b.a)((function(t){var e=n(t,3);return{itemsPerPage:e[0],currentPage:e[1],totalItems:e[2]}}))),this.searchTerm.valueChanges.pipe(Object(y.a)(250),Object(C.a)(this.destroy$)).subscribe((function(){return t.refresh()}))}},{key:"filesSelected",value:function(t){var n=this;t.length&&(this.uploading=!0,this.dataService.product.createAssets(t).pipe(Object(O.a)((function(){return n.uploading=!1}))).subscribe((function(t){var a,i=0,o=e(t.createAssets);try{for(o.s();!(a=o.n()).done;){var s=a.value;switch(s.__typename){case"Asset":i++;break;case"MimeTypeError":n.notificationService.error(s.message)}}}catch(l){o.e(l)}finally{o.f()}0<i&&(c(p(r.prototype),"refresh",n).call(n),n.notificationService.success(Object(v.a)("asset.notify-create-assets-success"),{count:i}))})))}},{key:"deleteAssets",value:function(t){var e=this;this.showModalAndDelete(t.map((function(t){return t.id}))).pipe(Object(k.a)((function(n){return n.result===m.O.DELETED?[!0]:e.showModalAndDelete(t.map((function(t){return t.id})),n.message||"").pipe(Object(b.a)((function(t){return t.result===m.O.DELETED})))}))).subscribe((function(){e.notificationService.success(Object(v.a)("common.notify-delete-success"),{entity:"Assets"}),e.refresh()}),(function(t){e.notificationService.error(Object(v.a)("common.notify-delete-error"),{entity:"Assets"})}))}},{key:"showModalAndDelete",value:function(t,e){var n=this;return this.modalService.dialog({title:Object(v.a)("catalog.confirm-delete-assets"),translationVars:{count:t.length},body:e,buttons:[{type:"secondary",label:Object(v.a)("common.cancel")},{type:"danger",label:Object(v.a)("common.delete"),returnValue:!0}]}).pipe(Object(k.a)((function(c){return c?n.dataService.product.deleteAssets(t,!!e):Z.a})),Object(b.a)((function(t){return t.deleteAssets})))}}]),r}(m.w);Xc.\u0275fac=function(t){return new(t||Xc)(u.cc(m.Bb),u.cc(m.Ab),u.cc(m.K),u.cc(g.e),u.cc(g.a))},Xc.\u0275cmp=u.Wb({type:Xc,selectors:[["vdr-asset-list"]],features:[u.Ob],decls:19,vars:30,consts:[["type","text","name","searchTerm",1,"clr-input","search-input",3,"formControl","placeholder"],["locationId","asset-list"],["dropZoneTarget",".content-area",3,"uploading","selectFiles"],[3,"assets","multiSelect","canDelete","deleteAssets"],[1,"paging-controls"],[3,"itemsPerPage","itemsPerPageChange"],[3,"currentPage","itemsPerPage","totalItems","pageChange"]],template:function(t,e){1&t&&(u.ic(0,"vdr-action-bar"),u.ic(1,"vdr-ab-left"),u.dc(2,"input",0),u.sc(3,"translate"),u.hc(),u.ic(4,"vdr-ab-right"),u.dc(5,"vdr-action-bar-items",1),u.ic(6,"vdr-asset-file-input",2),u.pc("selectFiles",(function(t){return e.filesSelected(t)})),u.hc(),u.hc(),u.hc(),u.ic(7,"vdr-asset-gallery",3),u.pc("deleteAssets",(function(t){return e.deleteAssets(t)})),u.sc(8,"paginate"),u.sc(9,"async"),u.sc(10,"async"),u.sc(11,"hasPermission"),u.hc(),u.ic(12,"div",4),u.ic(13,"vdr-items-per-page-controls",5),u.pc("itemsPerPageChange",(function(t){return e.setItemsPerPage(t)})),u.sc(14,"async"),u.hc(),u.ic(15,"vdr-pagination-controls",6),u.pc("pageChange",(function(t){return e.setPageNumber(t)})),u.sc(16,"async"),u.sc(17,"async"),u.sc(18,"async"),u.hc(),u.hc()),2&t&&(u.Rb(2),u.yc("formControl",e.searchTerm)("placeholder",u.tc(3,10,"asset.search-asset-name")),u.Rb(4),u.yc("uploading",e.uploading),u.Rb(1),u.yc("assets",u.uc(8,12,u.tc(9,15,e.items$),u.tc(10,17,e.paginationConfig$)||u.Cc(29,ft)))("multiSelect",!0)("canDelete",u.tc(11,19,"DeleteCatalog")),u.Rb(6),u.yc("itemsPerPage",u.tc(14,21,e.itemsPerPage$)),u.Rb(2),u.yc("currentPage",u.tc(16,23,e.currentPage$))("itemsPerPage",u.tc(17,25,e.itemsPerPage$))("totalItems",u.tc(18,27,e.totalItems$)))},directives:[m.c,m.e,m.eb,E.b,E.p,E.g,m.f,m.d,m.l,m.m,m.sb,m.Eb],pipes:[lt.d,ut.b,nt.b,m.ib],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}vdr-asset-gallery[_ngcontent-%COMP%]{flex:1}.paging-controls[_ngcontent-%COMP%]{border-top:1px solid #f2f3f5;display:flex;justify-content:space-between;padding-top:6px}.search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]}),Xc.ctorParameters=function(){return[{type:m.Bb},{type:m.Ab},{type:m.K},{type:g.e},{type:g.a}]};var Gc=function(){function e(t,n,c){f(this,e),this.route=t,this.router=n,this.dataService=c,this.filterTermControl=new E.f(""),this.collectionIdChange$=new W.a(""),this.refresh$=new W.a(!0),this.destroy$=new K.a}return h(e,[{key:"ngOnInit",value:function(){var t=this;this.contentsCurrentPage$=this.route.paramMap.pipe(Object(b.a)((function(t){return t.get("contentsPage")})),Object(b.a)((function(t){return t?+t:1})),Object(P.a)(1),Object(F.a)()),this.contentsItemsPerPage$=this.route.paramMap.pipe(Object(b.a)((function(t){return t.get("contentsPerPage")})),Object(b.a)((function(t){return t?+t:10})),Object(P.a)(10),Object(F.a)());var e=this.filterTermControl.valueChanges.pipe(Object(y.a)(250),Object(I.a)((function(){return t.setContentsPageNumber(1)})),Object(P.a)("")),c=Object(Y.a)(this.collectionIdChange$,this.contentsCurrentPage$,this.contentsItemsPerPage$,e,this.refresh$).pipe(Object(C.a)(this.destroy$),Object(k.a)((function(e){var c=n(e,4),a=c[0],r=c[1],i=c[2],o=c[3],s=i,l=(r-1)*i;return a?t.dataService.collection.getCollectionContents(a,s,l,o).mapSingle((function(t){return t.collection})):Object(q.a)(null)})));this.contents$=c.pipe(Object(b.a)((function(t){return t?t.productVariants.items:[]}))),this.contentsTotalItems$=c.pipe(Object(b.a)((function(t){return t?t.productVariants.totalItems:0})))}},{key:"ngOnChanges",value:function(t){"collectionId"in t&&this.collectionIdChange$.next(t.collectionId.currentValue)}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete()}},{key:"setContentsPageNumber",value:function(t){this.setParam("contentsPage",t)}},{key:"setContentsItemsPerPage",value:function(t){this.setParam("contentsPerPage",t)}},{key:"refresh",value:function(){this.refresh$.next(!0)}},{key:"setParam",value:function(e,n){this.router.navigate(["./",Object.assign(Object.assign({},this.route.snapshot.params),t({},e,n))],{relativeTo:this.route,queryParamsHandling:"merge"})}}]),e}();Gc.\u0275fac=function(t){return new(t||Gc)(u.cc(g.a),u.cc(g.e),u.cc(m.K))},Gc.\u0275cmp=u.Wb({type:Gc,selectors:[["vdr-collection-contents"]],contentQueries:function(t,e,n){var c;1&t&&u.Qc(n,u.ab,!0),2&t&&u.Ic(c=u.qc())&&(e.headerTemplate=c.first)},inputs:{collectionId:"collectionId"},features:[u.Pb],decls:12,vars:22,consts:[[1,"contents-header"],[1,"header-title-row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","text",1,"clr-input",3,"placeholder","formControl"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"]],template:function(t,e){1&t&&(u.ic(0,"div",0),u.ic(1,"div",1),u.Vc(2,gt,1,0,"ng-container",2),u.sc(3,"async"),u.hc(),u.dc(4,"input",3),u.sc(5,"translate"),u.hc(),u.ic(6,"vdr-data-table",4),u.pc("pageChange",(function(t){return e.setContentsPageNumber(t)}))("itemsPerPageChange",(function(t){return e.setContentsItemsPerPage(t)})),u.sc(7,"async"),u.sc(8,"async"),u.sc(9,"async"),u.sc(10,"async"),u.Vc(11,vt,5,9,"ng-template"),u.hc()),2&t&&(u.Rb(2),u.yc("ngTemplateOutlet",e.headerTemplate)("ngTemplateOutletContext",u.Dc(20,bt,u.tc(3,8,e.contentsTotalItems$))),u.Rb(2),u.yc("placeholder",u.tc(5,10,"catalog.filter-by-name"))("formControl",e.filterTermControl),u.Rb(2),u.yc("items",u.tc(7,12,e.contents$))("itemsPerPage",u.tc(8,14,e.contentsItemsPerPage$))("totalItems",u.tc(9,16,e.contentsTotalItems$))("currentPage",u.tc(10,18,e.contentsCurrentPage$)))},directives:[nt.u,m.eb,E.b,E.p,E.g,m.M,m.Pb],pipes:[nt.b,lt.d],styles:[".contents-header[_ngcontent-%COMP%]{background-color:#fafafa;border-bottom:1px solid #bfc3cc;padding:6px;position:-webkit-sticky;position:sticky;top:0;z-index:1}.contents-header[_ngcontent-%COMP%]   .header-title-row[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:space-between}.contents-header[_ngcontent-%COMP%]   .clr-input[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     table{margin-top:-1px}"],changeDetection:0}),Gc.ctorParameters=function(){return[{type:g.a},{type:g.e},{type:m.K}]},Gc.propDecorators={collectionId:[{type:u.D}],headerTemplate:[{type:u.o,args:[u.ab,{static:!0}]}]};var Nc=function(a){o(i,a);var r=l(i);function i(e,n,c,a,o,s,l,u){var d;return f(this,i),(d=r.call(this,n,e,c,o)).changeDetector=a,d.dataService=o,d.formBuilder=s,d.notificationService=l,d.modalService=u,d.assetChanges={},d.filters=[],d.allFilters=[],d.customFields=d.getCustomFieldConfig("Collection"),d.detailForm=d.formBuilder.group({name:["",E.C.required],slug:"",description:"",visible:!1,filters:d.formBuilder.array([]),customFields:d.formBuilder.group(d.customFields.reduce((function(e,n){return Object.assign(Object.assign({},e),t({},n.name,""))}),{}))}),d}return h(i,[{key:"ngOnInit",value:function(){var t=this;this.init(),this.dataService.collection.getCollectionFilters().single$.subscribe((function(e){t.allFilters=e.collectionFilters}))}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"getFilterDefinition",value:function(t){return this.allFilters.find((function(e){return e.code===t.code}))}},{key:"customFieldIsSet",value:function(t){return!!this.detailForm.get(["customFields",t])}},{key:"assetsChanged",value:function(){return!!Object.values(this.assetChanges).length}},{key:"updateSlug",value:function(t){var e=this;Object(Y.a)(this.entity$,this.languageCode$).pipe(Object(V.a)(1)).subscribe((function(c){var a=n(c,2),r=a[0],i=a[1],o=e.detailForm.get(["slug"]),s=r.translations.find((function(t){return t.languageCode===i})),l=!s||!s.slug;o&&o.pristine&&l&&o.setValue(Object(tt.normalizeString)(""+t,"-"))}))}},{key:"addFilter",value:function(e){var n=this.detailForm.get("filters");if(-1===n.value.findIndex((function(t){return t.code===e.code}))){var c=e.args.reduce((function(e,n){return Object.assign(Object.assign({},e),t({},n.name,Object(m.ac)(n.value)))}),{});n.push(this.formBuilder.control({code:e.code,args:c})),this.filters.push({code:e.code,args:e.args.map((function(t){return{name:t.name,value:Object(m.ac)(t.value)}}))})}}},{key:"removeFilter",value:function(t){var e=this.detailForm.get("filters"),n=e.value.findIndex((function(e){return e.code===t.code}));-1!==n&&(e.removeAt(n),this.filters.splice(n,1))}},{key:"create",value:function(){var t=this;this.detailForm.dirty&&Object(Y.a)(this.entity$,this.languageCode$).pipe(Object(V.a)(1),Object(x.a)((function(e){var c=n(e,2),a=c[0],r=c[1],i=t.getUpdatedCollection(a,t.detailForm,r),o=t.route.snapshot.paramMap.get("parentId");return o&&(i.parentId=o),t.dataService.collection.createCollection(i)}))).subscribe((function(e){t.notificationService.success(Object(v.a)("common.notify-create-success"),{entity:"Collection"}),t.assetChanges={},t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.router.navigate(["../",e.createCollection.id],{relativeTo:t.route})}),(function(e){t.notificationService.error(Object(v.a)("common.notify-create-error"),{entity:"Collection"})}))}},{key:"save",value:function(){var t=this;Object(Y.a)(this.entity$,this.languageCode$).pipe(Object(V.a)(1),Object(x.a)((function(e){var c=n(e,2),a=c[0],r=c[1],i=t.getUpdatedCollection(a,t.detailForm,r);return t.dataService.collection.updateCollection(i)}))).subscribe((function(){t.assetChanges={},t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success(Object(v.a)("common.notify-update-success"),{entity:"Collection"}),t.contentsComponent.refresh()}),(function(e){t.notificationService.error(Object(v.a)("common.notify-update-error"),{entity:"Collection"})}))}},{key:"canDeactivate",value:function(){return c(p(i.prototype),"canDeactivate",this).call(this)&&!this.assetChanges.assetIds&&!this.assetChanges.featuredAssetId}},{key:"setFormValues",value:function(t,n){var c=this,a=t.translations.find((function(t){return t.languageCode===n}));if(this.detailForm.patchValue({name:a?a.name:"",slug:a?a.slug:"",description:a?a.description:"",visible:!t.isPrivate}),t.filters.forEach((function(t){return c.addFilter(t)})),this.customFields.length){var r,i=this.detailForm.get(["customFields"]),o=e(this.customFields);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=s.name,u="localeString"===s.type?a.customFields[l]:t.customFields[l],d=i.get(l);d&&d.patchValue(u)}}catch(p){o.e(p)}finally{o.f()}}}},{key:"getUpdatedCollection",value:function(t,e,n){var c=Object(m.Wb)({translatable:t,updatedFields:e.value,customFieldConfig:this.customFields,languageCode:n,defaultTranslation:{languageCode:n,name:t.name||"",slug:t.slug||"",description:t.description||""}});return Object.assign(Object.assign(Object.assign({},c),this.assetChanges),{isPrivate:!e.value.visible,filters:this.mapOperationsToInputs(this.filters,this.detailForm.value.filters)})}},{key:"mapOperationsToInputs",value:function(t,e){return t.map((function(t,n){return{code:t.code,arguments:Object.values(e[n].args).map((function(e,n){return{name:t.args[n].name,value:Object(m.Yb)(e)}}))}}))}}]),i}(m.u);Nc.\u0275fac=function(t){return new(t||Nc)(u.cc(g.e),u.cc(g.a),u.cc(m.Jb),u.cc(u.k),u.cc(m.K),u.cc(E.e),u.cc(m.Bb),u.cc(m.Ab))},Nc.\u0275cmp=u.Wb({type:Nc,selectors:[["vdr-collection-detail"]],viewQuery:function(t,e){var n;1&t&&u.cd(yt,!0),2&t&&u.Ic(n=u.qc())&&(e.contentsComponent=n.first)},features:[u.Ob],decls:16,vars:19,consts:[[3,"entity"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","collection-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],[1,"clr-row"],[1,"clr-col"],["for","visibility",3,"label"],["type","checkbox","clrToggle","","formControlName","visible","id","visibility",3,"vdrDisabled"],[1,"visible-toggle"],[4,"ngIf","ngIfElse"],["private",""],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","slug",3,"label","errors"],["id","slug","type","text","formControlName","slug","pattern","[a-z0-9_-]+",3,"readonly"],["formControlName","description",3,"readonly","label"],["formGroupName","customFields",4,"ngIf"],[1,"clr-col-md-auto"],[3,"assets","featuredAsset","change"],["formArrayName","filters",1,"clr-row"],[4,"ngFor","ngForOf"],[4,"vdrIfPermissions"],[3,"collectionId"],["collectionContents",""],["formGroupName","customFields"],["entityName","Collection",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Collection",3,"customFieldsFormGroup","customField"],[3,"operation","operationDefinition","formControlName","readonly","remove"],["vdrDropdownTrigger","",1,"btn","btn-outline"],["shape","plus"],["vdrPosition","bottom-left"],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["type","button","vdrDropdownItem","",3,"click"],[1,"contents-title"]],template:function(t,e){if(1&t&&(u.ic(0,"vdr-action-bar"),u.ic(1,"vdr-ab-left"),u.dc(2,"vdr-entity-info",0),u.sc(3,"async"),u.ic(4,"vdr-language-selector",1),u.pc("languageCodeChange",(function(t){return e.setLanguage(t)})),u.sc(5,"async"),u.sc(6,"async"),u.sc(7,"async"),u.hc(),u.hc(),u.ic(8,"vdr-ab-right"),u.dc(9,"vdr-action-bar-items",2),u.Vc(10,Ct,3,4,"button",3),u.sc(11,"async"),u.Vc(12,kt,1,1,"ng-template",null,4,u.Wc),u.hc(),u.hc(),u.Vc(14,At,38,41,"form",5),u.sc(15,"async")),2&t){var n=u.Jc(13);u.Rb(2),u.yc("entity",u.tc(3,7,e.entity$)),u.Rb(2),u.yc("disabled",u.tc(5,9,e.isNew$))("availableLanguageCodes",u.tc(6,11,e.availableLanguages$))("currentLanguageCode",u.tc(7,13,e.languageCode$)),u.Rb(6),u.yc("ngIf",u.tc(11,15,e.isNew$))("ngIfElse",n),u.Rb(4),u.yc("ngIf",u.tc(15,17,e.entity$))}},directives:function(){return[m.c,m.e,m.ab,m.xb,m.f,m.d,nt.p,m.rb,E.E,E.q,E.j,m.db,dt.k,m.eb,E.a,dt.i,E.p,E.h,m.R,dt.u,E.b,E.w,m.Hb,Va,E.d,nt.o,Gc,E.k,m.H,m.C,m.S,m.V,dt.o,m.U,m.T]},pipes:function(){return[nt.b,lt.d,m.ib]},styles:[ce],changeDetection:0}),Nc.ctorParameters=function(){return[{type:g.e},{type:g.a},{type:m.Jb},{type:u.k},{type:m.K},{type:E.e},{type:m.Bb},{type:m.Ab}]},Nc.propDecorators={contentsComponent:[{type:u.eb,args:["collectionContents"]}]};var Lc=function(){function t(e,n,c,a,r){f(this,t),this.dataService=e,this.notificationService=n,this.modalService=c,this.router=a,this.route=r,this.expandAll=!1}return h(t,[{key:"ngOnInit",value:function(){this.queryResult=this.dataService.collection.getCollections(99999,0).refetchOnChannelChange(),this.items$=this.queryResult.mapStream((function(t){return t.collections.items})).pipe(Object(M.a)(1)),this.activeCollectionId$=this.route.paramMap.pipe(Object(b.a)((function(t){return t.get("contents")})),Object(F.a)()),this.activeCollectionTitle$=Object(Y.a)(this.activeCollectionId$,this.items$).pipe(Object(b.a)((function(t){var e=n(t,2),c=e[0],a=e[1];if(c){var r=a.find((function(t){return t.id===c}));return r?r.name:""}return""})))}},{key:"onRearrange",value:function(t){var e=this;this.dataService.collection.moveCollection([t]).subscribe({next:function(){e.notificationService.success(Object(v.a)("common.notify-saved-changes")),e.refresh()},error:function(t){e.notificationService.error(Object(v.a)("common.notify-save-changes-error"))}})}},{key:"deleteCollection",value:function(t){var e=this;this.items$.pipe(Object(V.a)(1),Object(b.a)((function(e){return-1<e.findIndex((function(e){return e.parent&&e.parent.id===t}))})),Object(k.a)((function(t){return e.modalService.dialog({title:Object(v.a)("catalog.confirm-delete-collection"),body:t?Object(v.a)("catalog.confirm-delete-collection-and-children-body"):void 0,buttons:[{type:"secondary",label:Object(v.a)("common.cancel")},{type:"danger",label:Object(v.a)("common.delete"),returnValue:!0}]})})),Object(k.a)((function(n){return n?e.dataService.collection.deleteCollection(t):Z.a}))).subscribe((function(){e.notificationService.success(Object(v.a)("common.notify-delete-success"),{entity:"Collection"}),e.refresh()}),(function(t){e.notificationService.error(Object(v.a)("common.notify-delete-error"),{entity:"Collection"})}))}},{key:"closeContents",value:function(){var t=Object.assign({},this.route.snapshot.params);delete t.contents,this.router.navigate(["./",t],{relativeTo:this.route,queryParamsHandling:"preserve"})}},{key:"refresh",value:function(){this.queryResult.ref.refetch()}}]),t}();Lc.\u0275fac=function(t){return new(t||Lc)(u.cc(m.K),u.cc(m.Bb),u.cc(m.Ab),u.cc(g.e),u.cc(g.a))},Lc.\u0275cmp=u.Wb({type:Lc,selectors:[["vdr-collection-list"]],decls:19,vars:19,consts:[[1,"expand-all-toggle"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],["locationId","collection-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[1,"collection-wrapper"],[3,"collections","activeCollectionId","expandAll","rearrange","deleteCollection"],[1,"collection-contents"],[3,"collectionId"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"collection-title"],["type","button",1,"close-button",3,"click"],["shape","close"]],template:function(t,e){1&t&&(u.ic(0,"vdr-action-bar"),u.ic(1,"vdr-ab-left"),u.ic(2,"clr-checkbox-wrapper",0),u.ic(3,"input",1),u.pc("ngModelChange",(function(t){return e.expandAll=t})),u.hc(),u.ic(4,"label"),u.Xc(5),u.sc(6,"translate"),u.hc(),u.hc(),u.hc(),u.ic(7,"vdr-ab-right"),u.dc(8,"vdr-action-bar-items",2),u.Vc(9,Tt,4,5,"a",3),u.hc(),u.hc(),u.ic(10,"div",4),u.ic(11,"vdr-collection-tree",5),u.pc("rearrange",(function(t){return e.onRearrange(t)}))("deleteCollection",(function(t){return e.deleteCollection(t)})),u.sc(12,"async"),u.sc(13,"async"),u.hc(),u.ic(14,"div",6),u.sc(15,"async"),u.ic(16,"vdr-collection-contents",7),u.sc(17,"async"),u.Vc(18,Xt,6,9,"ng-template"),u.hc(),u.hc(),u.hc()),2&t&&(u.Rb(3),u.yc("ngModel",e.expandAll),u.Rb(2),u.Yc(u.tc(6,9,"catalog.expand-all-collections")),u.Rb(4),u.yc("vdrIfPermissions","CreateCatalog"),u.Rb(2),u.yc("collections",u.tc(12,11,e.items$))("activeCollectionId",u.tc(13,13,e.activeCollectionId$))("expandAll",e.expandAll),u.Rb(3),u.Ub("expanded",u.tc(15,15,e.activeCollectionId$)),u.Rb(2),u.yc("collectionId",u.tc(17,17,e.activeCollectionId$)))},directives:function(){return[m.c,m.e,dt.k,m.eb,E.a,dt.i,E.p,E.s,dt.u,m.f,m.d,m.rb,Oa,Gc,g.h,dt.o]},pipes:function(){return[lt.d,nt.b]},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}.expand-all-toggle[_ngcontent-%COMP%]{display:block;margin-top:14px}.collection-wrapper[_ngcontent-%COMP%]{display:flex;height:calc(100% - 50px)}.collection-wrapper[_ngcontent-%COMP%]   vdr-collection-tree[_ngcontent-%COMP%]{flex:1;height:100%;overflow:auto}.collection-wrapper[_ngcontent-%COMP%]   .collection-contents[_ngcontent-%COMP%]{height:100%;opacity:0;overflow:auto;transition:width .3s,opacity .2s .3s,visibility 0s .3s;visibility:hidden;width:0}.collection-wrapper[_ngcontent-%COMP%]   .collection-contents.expanded[_ngcontent-%COMP%]{opacity:1;padding-left:12px;visibility:visible;width:30vw}.collection-wrapper[_ngcontent-%COMP%]   .collection-contents[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;margin:0}.paging-controls[_ngcontent-%COMP%]{border-top:1px solid #f2f3f5;display:flex;justify-content:space-between;padding-top:6px}"],changeDetection:0}),Lc.ctorParameters=function(){return[{type:m.K},{type:m.Bb},{type:m.Ab},{type:g.e},{type:g.a}]};var Uc=function(c){o(i,c);var r=l(i);function i(e,n,c,a,o,s,l,u){var d;return f(this,i),(d=r.call(this,n,e,c,o)).changeDetector=a,d.dataService=o,d.formBuilder=s,d.notificationService=l,d.modalService=u,d.customFields=d.getCustomFieldConfig("Facet"),d.customValueFields=d.getCustomFieldConfig("FacetValue"),d.detailForm=d.formBuilder.group({facet:d.formBuilder.group({code:["",E.C.required],name:"",visible:!0,customFields:d.formBuilder.group(d.customFields.reduce((function(e,n){return Object.assign(Object.assign({},e),t({},n.name,""))}),{}))}),values:d.formBuilder.array([])}),d}return h(i,[{key:"ngOnInit",value:function(){this.init()}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"updateCode",value:function(t,e){if(!t){var n=this.detailForm.get(["facet","code"]);n&&n.pristine&&n.setValue(Object(tt.normalizeString)(e,"-"))}}},{key:"updateValueCode",value:function(t,e,n){if(!t){var c=this.detailForm.get(["values",n,"code"]);c&&c.pristine&&c.setValue(Object(tt.normalizeString)(e,"-"))}}},{key:"customFieldIsSet",value:function(t){return!!this.detailForm.get(["facet","customFields",t])}},{key:"customValueFieldIsSet",value:function(t,e){return!!this.detailForm.get(["values",t,"customFields",e])}},{key:"getValuesFormArray",value:function(){return this.detailForm.get("values")}},{key:"addFacetValue",value:function(){var t=this.detailForm.get("values");t&&(t.insert(t.length,this.formBuilder.group({name:["",E.C.required],code:""})),this.values.push({name:"",code:""}))}},{key:"create",value:function(){var t=this,e=this.detailForm.get("facet");e&&e.dirty&&Object(Y.a)(this.entity$,this.languageCode$).pipe(Object(V.a)(1),Object(x.a)((function(c){var a=n(c,2),r=a[0],i=a[1],o=t.getUpdatedFacet(r,e,i);return t.dataService.facet.createFacet(o)})),Object(k.a)((function(e){return t.dataService.facet.getAllFacets(!0).single$.pipe(Object(R.a)(e))}))).subscribe((function(e){t.notificationService.success(Object(v.a)("common.notify-create-success"),{entity:"Facet"}),t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.router.navigate(["../",e.createFacet.id],{relativeTo:t.route})}),(function(e){t.notificationService.error(Object(v.a)("common.notify-create-error"),{entity:"Facet"})}))}},{key:"save",value:function(){var t=this;Object(Y.a)(this.entity$,this.languageCode$).pipe(Object(V.a)(1),Object(x.a)((function(e){var c=n(e,2),a=c[0],r=c[1],i=t.detailForm.get("facet"),o=[];if(i&&i.dirty){var s=t.getUpdatedFacet(a,i,r);s&&o.push(t.dataService.facet.updateFacet(s))}var l=t.detailForm.get("values");if(l&&l.dirty){var u=l.controls.filter((function(t){return!t.value.id})).map((function(t){return{facetId:a.id,code:t.value.code,translations:[{name:t.value.name,languageCode:r}]}}));u.length&&o.push(t.dataService.facet.createFacetValues(u).pipe(Object(k.a)((function(){return t.dataService.facet.getFacet(t.id).single$}))));var d=t.getUpdatedFacetValues(a,l,r);d.length&&o.push(t.dataService.facet.updateFacetValues(d))}return Object(z.a)(o)})),Object(k.a)((function(){return t.dataService.facet.getAllFacets(!0).single$}))).subscribe((function(){t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success(Object(v.a)("common.notify-update-success"),{entity:"Facet"})}),(function(e){t.notificationService.error(Object(v.a)("common.notify-update-error"),{entity:"Facet"})}))}},{key:"deleteFacetValue",value:function(t,e){var n=this;if(!t){var c=this.detailForm.get("values");return c&&c.removeAt(e),void this.values.splice(e,1)}this.showModalAndDelete(t).pipe(Object(k.a)((function(e){return e.result===m.O.DELETED?[!0]:n.showModalAndDelete(t,e.message||"").pipe(Object(b.a)((function(t){return t.result===m.O.DELETED})))})),Object(k.a)((function(t){return t?n.dataService.facet.getFacet(n.id).single$:[]}))).subscribe((function(){n.notificationService.success(Object(v.a)("common.notify-delete-success"),{entity:"FacetValue"})}),(function(t){n.notificationService.error(Object(v.a)("common.notify-delete-error"),{entity:"FacetValue"})}))}},{key:"showModalAndDelete",value:function(t,e){var n=this;return this.modalService.dialog({title:Object(v.a)("catalog.confirm-delete-facet-value"),body:e,buttons:[{type:"secondary",label:Object(v.a)("common.cancel")},{type:"danger",label:Object(v.a)("common.delete"),returnValue:!0}]}).pipe(Object(k.a)((function(c){return c?n.dataService.facet.deleteFacetValues([t],!!e):Z.a})),Object(b.a)((function(t){return t.deleteFacetValues[0]})))}},{key:"setFormValues",value:function(t,n){var c,r=this,i=t.translations.find((function(t){return t.languageCode===n}));if(this.detailForm.patchValue({facet:{code:t.code,visible:!t.isPrivate,name:null!==(c=null==i?void 0:i.name)&&void 0!==c?c:""}}),this.customFields.length){var o,s=this.detailForm.get(["facet","customFields"]),l=e(this.customFields);try{for(l.s();!(o=l.n()).done;){var u=o.value,d=u.name,p="localeString"===u.type?i.customFields[d]:t.customFields[d],f=s.get(d);f&&f.patchValue(p)}}catch(h){l.e(h)}finally{l.f()}}var g=this.detailForm.get("values");g.clear(),this.values=a(t.values),t.values.forEach((function(t,c){var a=t.translations&&t.translations.find((function(t){return t.languageCode===n})),i={id:t.id,code:t.code,name:a?a.name:""};if(g.insert(c,r.formBuilder.group(i)),r.customValueFields.length){var o=r.detailForm.get(["values",c,"customFields"]);if(o||(o=new E.i({}),r.detailForm.get(["values",c]).addControl("customFields",o)),o){var s,l=e(r.customValueFields);try{for(l.s();!(s=l.n()).done;){var u=s.value,d=u.name,p="localeString"===u.type?a.customFields[d]:t.customFields[d],f=o.get(d);f?f.setValue(p):o.addControl(d,new E.f(p))}}catch(h){l.e(h)}finally{l.f()}}}}))}},{key:"getUpdatedFacet",value:function(t,e,n){var c=Object(m.Wb)({translatable:t,updatedFields:e.value,customFieldConfig:this.customFields,languageCode:n,defaultTranslation:{languageCode:n,name:t.name||""}});return c.isPrivate=!e.value.visible,c}},{key:"getUpdatedFacetValues",value:function(t,e,n){var c=this,a=t.values.filter((function(t,n){var c=e.get(n.toString());return c&&c.dirty&&c.value.id})),r=e.controls.filter((function(t){return t.dirty&&t.value.id})).map((function(t){return t.value}));if(a.length!==r.length)throw new Error(Object(v.a)("error.facet-value-form-values-do-not-match"));return a.map((function(t,e){return Object(m.Wb)({translatable:t,updatedFields:r[e],customFieldConfig:c.customValueFields,languageCode:n,defaultTranslation:{languageCode:n,name:""}})})).filter(et.notNullOrUndefined)}}]),i}(m.u);Uc.\u0275fac=function(t){return new(t||Uc)(u.cc(g.e),u.cc(g.a),u.cc(m.Jb),u.cc(u.k),u.cc(m.K),u.cc(E.e),u.cc(m.Bb),u.cc(m.Ab))},Uc.\u0275cmp=u.Wb({type:Uc,selectors:[["vdr-facet-detail"]],features:[u.Ob],decls:16,vars:19,consts:[[3,"entity"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","facet-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],["formGroupName","facet",1,"form-block"],["for","visibility",3,"label"],["type","checkbox","clrToggle","","formControlName","visible","id","visibility",3,"vdrDisabled"],[1,"visible-toggle"],[4,"ngIf","ngIfElse"],["private",""],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","code",3,"label","readOnlyToggle"],["id","code","type","text","formControlName","code",3,"readonly"],["formGroupName","customFields",4,"ngIf"],["class","form-block",4,"ngIf"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","Facet",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Facet",3,"customFieldsFormGroup","customField"],[1,"form-block"],["class","facet-values-list table","formArrayName","values",4,"ngIf"],["type","button","class","btn btn-secondary",3,"click",4,"vdrIfPermissions"],["formArrayName","values",1,"facet-values-list","table"],["class","facet-value",3,"formGroupName",4,"ngFor","ngForOf"],[1,"facet-value",3,"formGroupName"],[1,"align-middle"],["type","text","formControlName","name",3,"readonly","input"],["type","text","formControlName","code","readonly",""],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],["entityName","FacetValue",3,"showLabel","customFieldsFormGroup","customField",4,"ngIf"],["entityName","FacetValue",3,"showLabel","customFieldsFormGroup","customField"],["type","button",1,"btn","btn-secondary",3,"click"],["shape","add"]],template:function(t,e){if(1&t&&(u.ic(0,"vdr-action-bar"),u.ic(1,"vdr-ab-left"),u.dc(2,"vdr-entity-info",0),u.sc(3,"async"),u.ic(4,"vdr-language-selector",1),u.pc("languageCodeChange",(function(t){return e.setLanguage(t)})),u.sc(5,"async"),u.sc(6,"async"),u.sc(7,"async"),u.hc(),u.hc(),u.ic(8,"vdr-ab-right"),u.dc(9,"vdr-action-bar-items",2),u.Vc(10,Gt,3,4,"button",3),u.sc(11,"async"),u.Vc(12,Lt,1,1,"ng-template",null,4,u.Wc),u.hc(),u.hc(),u.Vc(14,ne,23,28,"form",5),u.sc(15,"async")),2&t){var n=u.Jc(13);u.Rb(2),u.yc("entity",u.tc(3,7,e.entity$)),u.Rb(2),u.yc("disabled",u.tc(5,9,e.isNew$))("availableLanguageCodes",u.tc(6,11,e.availableLanguages$))("currentLanguageCode",u.tc(7,13,e.languageCode$)),u.Rb(6),u.yc("ngIf",u.tc(11,15,e.isNew$))("ngIfElse",n),u.Rb(4),u.yc("ngIf",u.tc(15,17,e.entity$))}},directives:[m.c,m.e,m.ab,m.xb,m.f,m.d,nt.p,m.rb,E.E,E.q,E.j,E.k,m.db,dt.k,m.eb,E.a,dt.i,E.p,E.h,m.R,dt.u,E.b,nt.o,m.H,E.d,m.S,m.V,dt.o,m.U,m.T],pipes:[nt.b,lt.d,m.ib],styles:[ce],changeDetection:0}),Uc.ctorParameters=function(){return[{type:g.e},{type:g.a},{type:m.Jb},{type:u.k},{type:m.K},{type:E.e},{type:m.Bb},{type:m.Ab}]};var Ec=function(t){o(n,t);var e=l(n);function n(t,a,r,i,o){var s,l;return f(this,n),(l=e.call(this,i,o)).dataService=t,l.modalService=a,l.notificationService=r,l.initialLimit=3,l.displayLimit={},c((s=d(l),p(n.prototype)),"setQueryFn",s).call(s,(function(){var t;return(t=l.dataService.facet).getFacets.apply(t,arguments).refetchOnChannelChange()}),(function(t){return t.facets})),l}return h(n,[{key:"toggleDisplayLimit",value:function(t){this.displayLimit[t.id]===t.values.length?this.displayLimit[t.id]=this.initialLimit:this.displayLimit[t.id]=t.values.length}},{key:"deleteFacet",value:function(t){var e=this;this.showModalAndDelete(t).pipe(Object(k.a)((function(n){return n.result===m.O.DELETED?[!0]:e.showModalAndDelete(t,n.message||"").pipe(Object(b.a)((function(t){return t.result===m.O.DELETED})))})),Object(k.a)((function(){return e.dataService.facet.getAllFacets(!0).single$}))).subscribe((function(){e.notificationService.success(Object(v.a)("common.notify-delete-success"),{entity:"FacetValue"}),e.refresh()}),(function(t){e.notificationService.error(Object(v.a)("common.notify-delete-error"),{entity:"FacetValue"})}))}},{key:"showModalAndDelete",value:function(t,e){var n=this;return this.modalService.dialog({title:Object(v.a)("catalog.confirm-delete-facet"),body:e,buttons:[{type:"secondary",label:Object(v.a)("common.cancel")},{type:"danger",label:Object(v.a)("common.delete"),returnValue:!0}]}).pipe(Object(k.a)((function(c){return c?n.dataService.facet.deleteFacet(t,!!e):Z.a})),Object(b.a)((function(t){return t.deleteFacet})))}}]),n}(m.w);Ec.\u0275fac=function(t){return new(t||Ec)(u.cc(m.K),u.cc(m.Ab),u.cc(m.Bb),u.cc(g.e),u.cc(g.a))},Ec.\u0275cmp=u.Wb({type:Ec,selectors:[["vdr-facet-list"]],features:[u.Ob],decls:24,vars:26,consts:[["locationId","facet-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"expand"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[3,"facetValue","removable","displayFacetName",4,"ngFor","ngForOf"],["class","btn btn-sm btn-secondary btn-icon",3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],["private",""],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"facetValue","removable","displayFacetName"],[1,"btn","btn-sm","btn-secondary","btn-icon",3,"click"],["collapse",""],["shape","minus"]],template:function(t,e){1&t&&(u.ic(0,"vdr-action-bar"),u.ic(1,"vdr-ab-right"),u.dc(2,"vdr-action-bar-items",0),u.Vc(3,ae,4,5,"a",1),u.hc(),u.hc(),u.ic(4,"vdr-data-table",2),u.pc("pageChange",(function(t){return e.setPageNumber(t)}))("itemsPerPageChange",(function(t){return e.setItemsPerPage(t)})),u.sc(5,"async"),u.sc(6,"async"),u.sc(7,"async"),u.sc(8,"async"),u.ic(9,"vdr-dt-column"),u.Xc(10),u.sc(11,"translate"),u.hc(),u.ic(12,"vdr-dt-column"),u.Xc(13),u.sc(14,"translate"),u.hc(),u.ic(15,"vdr-dt-column",3),u.Xc(16),u.sc(17,"translate"),u.hc(),u.ic(18,"vdr-dt-column"),u.Xc(19),u.sc(20,"translate"),u.hc(),u.dc(21,"vdr-dt-column"),u.dc(22,"vdr-dt-column"),u.Vc(23,pe,28,37,"ng-template"),u.hc()),2&t&&(u.Rb(3),u.yc("vdrIfPermissions","CreateCatalog"),u.Rb(1),u.yc("items",u.tc(5,10,e.items$))("itemsPerPage",u.tc(6,12,e.itemsPerPage$))("totalItems",u.tc(7,14,e.totalItems$))("currentPage",u.tc(8,16,e.currentPage$)),u.Rb(6),u.Yc(u.tc(11,18,"common.code")),u.Rb(3),u.Yc(u.tc(14,20,"common.name")),u.Rb(2),u.yc("expand",!0),u.Rb(1),u.Yc(u.tc(17,22,"catalog.values")),u.Rb(3),u.Yc(u.tc(20,24,"catalog.visibility")))},directives:[m.c,m.f,m.d,m.rb,m.M,m.L,g.h,dt.o,nt.o,nt.p,m.B,m.Pb,m.S,m.V,m.U,m.T,m.bb],pipes:[nt.b,lt.d,nt.y,m.ib],styles:["td.private[_ngcontent-%COMP%]{background-color:#f2f3f5}"]}),Ec.ctorParameters=function(){return[{type:m.K},{type:m.Ab},{type:m.Bb},{type:g.e},{type:g.a}]};var Bc=function(){function t(e){f(this,t),this.dataService=e}return h(t,[{key:"getFacets",value:function(){return this.dataService.facet.getAllFacets().mapSingle((function(t){return t.facets.items}))}},{key:"getTaxCategories",value:function(){return this.dataService.settings.getTaxCategories().mapSingle((function(t){return t.taxCategories})).pipe(Object(M.a)(1))}},{key:"createProductWithVariants",value:function(t,e,c){var r=this,i=this.dataService.product.createProduct(t),o=e.groups.filter((function(t){return 0<t.values.length})),s=this.createProductOptionGroups(o,c);return Object(z.a)(i,s).pipe(Object(x.a)((function(t){var e=n(t,2),c=e[0].createProduct,a=e[1];return(a.length?Object(z.a)(a.map((function(t){return r.dataService.product.addOptionGroupToProduct({productId:c.id,optionGroupId:t.id})}))):Object(q.a)([])).pipe(Object(b.a)((function(){return{createProduct:c,optionGroups:a}})))})),Object(x.a)((function(t){var n=t.createProduct,i=t.optionGroups,o=e.variants.map((function(t){var e=i.length?t.optionValues.map((function(t,e){var n=i[e].options.find((function(e){return e.name===t}));if(!n)throw new Error('Could not find a matching ProductOption "'.concat(t,'" when creating variant'));return n.id})):[];return Object.assign(Object.assign({},t),{optionIds:e})})),s=i.map((function(t){return t.options})).reduce((function(t,e){return[].concat(a(t),a(e))}),[]);return r.createProductVariants(n,o,s,c)})))}},{key:"createProductOptionGroups",value:function(t,e){var n=this;return t.length?Object(z.a)(t.map((function(t){return n.dataService.product.createProductOptionGroups({code:Object(tt.normalizeString)(t.name,"-"),translations:[{languageCode:e,name:t.name}],options:t.values.map((function(t){return{code:Object(tt.normalizeString)(t,"-"),translations:[{languageCode:e,name:t}]}}))}).pipe(Object(b.a)((function(t){return t.createProductOptionGroup})))}))):Object(q.a)([])}},{key:"createProductVariants",value:function(t,e,n,c){var a=e.map((function(e){var a=n.length?"".concat(t.name," ").concat(e.optionIds.map((function(t){return n.find((function(e){return e.id===t}))})).filter(et.notNullOrUndefined).map((function(t){return t.name})).join(" ")):t.name;return{productId:t.id,price:e.price,sku:e.sku,stockOnHand:e.stock,translations:[{languageCode:c,name:a}],optionIds:e.optionIds}}));return this.dataService.product.createProductVariants(a).pipe(Object(b.a)((function(e){return{createProductVariants:e.createProductVariants,productId:t.id}})))}},{key:"updateProduct",value:function(t,e){var n=[];return t&&n.push(this.dataService.product.updateProduct(t)),e&&n.push(this.dataService.product.updateProductVariants(e)),Object(z.a)(n)}},{key:"updateProductOption",value:function(t){return this.dataService.product.updateProductOption(t)}},{key:"deleteProductVariant",value:function(t,e){var n=this;return this.dataService.product.deleteProductVariant(t).pipe(Object(k.a)((function(t){return t.deleteProductVariant.result===m.O.DELETED?n.dataService.product.getProduct(e).single$:Object(J.a)(t.deleteProductVariant.message)})))}}]),t}();Bc.\u0275fac=function(t){return new(t||Bc)(u.mc(m.K))},Bc.\u0275prov=Object(u.Yb)({factory:function(){return new Bc(Object(u.mc)(m.K))},token:Bc,providedIn:"root"}),Bc.ctorParameters=function(){return[{type:m.K}]};var Yc=function(){function t(e){f(this,t),this.changeDetector=e,this.selectedValues=[]}return h(t,[{key:"ngAfterViewInit",value:function(){var t=this;setTimeout((function(){return t.selector.focus()}),0)}},{key:"selectValues",value:function(){this.resolveWith(this.selectedValues)}},{key:"cancel",value:function(){this.resolveWith()}}]),t}();Yc.\u0275fac=function(t){return new(t||Yc)(u.cc(u.k))},Yc.\u0275cmp=u.Wb({type:Yc,selectors:[["vdr-apply-facet-dialog"]],viewQuery:function(t,e){var n;1&t&&u.cd(m.cb,!0),2&t&&u.Ic(n=u.qc())&&(e.selector=n.first)},decls:3,vars:1,consts:[["vdrDialogTitle",""],[3,"facets","selectedValuesChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,e){1&t&&(u.Vc(0,fe,2,3,"ng-template",0),u.ic(1,"vdr-facet-value-selector",1),u.pc("selectedValuesChange",(function(t){return e.selectedValues=t})),u.hc(),u.Vc(2,ge,6,7,"ng-template",2)),2&t&&(u.Rb(1),u.yc("facets",e.facets))},directives:[m.Q,m.cb,m.P],pipes:[lt.d],styles:[""],changeDetection:0}),Yc.ctorParameters=function(){return[{type:u.k}]},Yc.propDecorators={selector:[{type:u.eb,args:[m.cb]}]};var Zc=function(){function t(e,n){f(this,t),this.dataService=e,this.notificationService=n,this.priceFactorControl=new E.f(1),this.selectedChannelIdControl=new E.f}return h(t,[{key:"ngOnInit",value:function(){var t=this,e=this.dataService.client.userStatus().mapSingle((function(t){return t.userStatus.activeChannelId})),c=this.dataService.settings.getChannels().mapSingle((function(t){return t.channels}));Object(Y.a)(e,c).subscribe((function(e){var c=n(e,2),a=c[0],r=c[1];t.currentChannel=r.find((function(t){return t.id===a})),t.availableChannels=r})),this.selectedChannelIdControl.valueChanges.subscribe((function(e){t.selectChannel(e)})),this.variantsPreview$=Object(Y.a)(Object(H.a)(this.getTopVariants(10)),this.priceFactorControl.valueChanges.pipe(Object(P.a)(1))).pipe(Object(b.a)((function(t){var e=n(t,2),c=e[0],a=e[1];return c.map((function(t){return{id:t.id,name:t.name,price:t.price,pricePreview:t.price*+a}}))})))}},{key:"selectChannel",value:function(t){this.selectedChannel=this.availableChannels.find((function(e){return e.id===t[0]}))}},{key:"assign",value:function(){var t=this,e=this.selectedChannel;e&&this.dataService.product.assignProductsToChannel({channelId:e.id,productIds:this.productIds,priceFactor:+this.priceFactorControl.value}).subscribe((function(){t.notificationService.success(Object(v.a)("catalog.assign-product-to-channel-success"),{channel:e.code}),t.resolveWith(!0)}))}},{key:"cancel",value:function(){this.resolveWith()}},{key:"getTopVariants",value:function(t){return Object(rt.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,c,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],c=0;case 2:if(!(c<this.productIds.length&&n.length<t)){e.next=10;break}return e.next=5,this.dataService.product.getProduct(this.productIds[c]).mapSingle((function(t){var e=t.product;return e&&e.variants})).toPromise();case 5:r=e.sent,n.push.apply(n,a(r||[]));case 7:c++,e.next=2;break;case 10:return e.abrupt("return",n.slice(0,t));case 11:case"end":return e.stop()}}),e,this)})))}}]),t}();Zc.\u0275fac=function(t){return new(t||Zc)(u.cc(m.K),u.cc(m.Bb))},Zc.\u0275cmp=u.Wb({type:Zc,selectors:[["vdr-assign-products-to-channel-dialog"]],decls:36,vars:31,consts:[["vdrDialogTitle",""],[1,"flex"],["clrInput","",3,"multiple","includeDefaultChannel","formControl"],[1,"flex-spacer"],["clrInput","","type","number","min","0","max","99999",3,"formControl"],[1,"channel-price-preview"],[1,"clr-control-label"],[1,"table"],[3,"ngIf","ngIfElse"],["noSelection",""],[4,"ngFor","ngForOf"],["vdrDialogButtons",""],["noChannelSelected",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(u.Vc(0,he,2,3,"ng-template",0),u.ic(1,"div",1),u.ic(2,"clr-input-container"),u.ic(3,"label"),u.Xc(4),u.sc(5,"translate"),u.hc(),u.dc(6,"vdr-channel-assignment-control",2),u.hc(),u.dc(7,"div",3),u.ic(8,"clr-input-container"),u.ic(9,"label"),u.Xc(10),u.sc(11,"translate"),u.hc(),u.dc(12,"input",4),u.hc(),u.hc(),u.ic(13,"div",5),u.ic(14,"label",6),u.Xc(15),u.sc(16,"translate"),u.hc(),u.ic(17,"table",7),u.ic(18,"thead"),u.ic(19,"tr"),u.ic(20,"th"),u.Xc(21),u.sc(22,"translate"),u.hc(),u.ic(23,"th"),u.Xc(24),u.sc(25,"translate"),u.sc(26,"translate"),u.sc(27,"channelCodeToLabel"),u.hc(),u.ic(28,"th"),u.Vc(29,ve,2,6,"ng-template",8),u.Vc(30,be,2,3,"ng-template",null,9,u.Wc),u.hc(),u.hc(),u.hc(),u.ic(32,"tbody"),u.Vc(33,Oe,10,7,"tr",10),u.sc(34,"async"),u.hc(),u.hc(),u.hc(),u.Vc(35,Ie,7,6,"ng-template",11)),2&t){var n=u.Jc(31);u.Rb(4),u.Yc(u.tc(5,12,"common.channel")),u.Rb(2),u.yc("multiple",!1)("includeDefaultChannel",!1)("formControl",e.selectedChannelIdControl),u.Rb(4),u.Yc(u.tc(11,14,"catalog.price-conversion-factor")),u.Rb(2),u.yc("formControl",e.priceFactorControl),u.Rb(3),u.Yc(u.tc(16,16,"catalog.channel-price-preview")),u.Rb(6),u.Yc(u.tc(22,18,"common.name")),u.Rb(3),u.Zc(" ",u.uc(25,20,"catalog.price-in-channel",u.Dc(29,me,u.tc(26,23,u.tc(27,25,null==e.currentChannel?null:e.currentChannel.code))))," "),u.Rb(5),u.yc("ngIf",e.selectedChannel)("ngIfElse",n),u.Rb(4),u.yc("ngForOf",u.tc(34,27,e.variantsPreview$))}},directives:[m.Q,dt.t,dt.u,m.y,dt.s,E.p,E.g,m.eb,E.v,E.b,nt.p,nt.o,m.P],pipes:[lt.d,m.A,nt.b,nt.d],styles:["vdr-channel-assignment-control[_ngcontent-%COMP%]{min-width:200px}.channel-price-preview[_ngcontent-%COMP%]{margin-top:24px}.channel-price-preview[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]{margin-top:6px}"],changeDetection:0}),Zc.ctorParameters=function(){return[{type:m.K},{type:m.Bb}]};var Wc=function(r){o(s,r);var i=l(s);function s(e,n,c,a,r,o,l,u,d,p){var g;return f(this,s),(g=i.call(this,e,n,c,u)).productDetailService=a,g.formBuilder=r,g.modalService=o,g.notificationService=l,g.dataService=u,g.location=d,g.changeDetector=p,g.filterInput=new E.f(""),g.assetChanges={},g.variantAssetChanges={},g.selectedVariantIds=[],g.variantDisplayMode="card",g.createVariantsConfig={groups:[],variants:[]},g.customFields=g.getCustomFieldConfig("Product"),g.customVariantFields=g.getCustomFieldConfig("ProductVariant"),g.customOptionGroupFields=g.getCustomFieldConfig("ProductOptionGroup"),g.customOptionFields=g.getCustomFieldConfig("ProductOption"),g.detailForm=g.formBuilder.group({product:g.formBuilder.group({enabled:!0,name:["",E.C.required],slug:"",description:"",facetValueIds:[[]],customFields:g.formBuilder.group(g.customFields.reduce((function(e,n){return Object.assign(Object.assign({},e),t({},n.name,""))}),{}))}),variants:g.formBuilder.array([])}),g}return h(s,[{key:"ngOnInit",value:function(){this.init(),this.product$=this.entity$;var t=this.product$.pipe(Object(b.a)((function(t){return t.variants}))),e=this.filterInput.valueChanges.pipe(Object(P.a)(""),Object(y.a)(50),Object(M.a)());this.variants$=Object(Y.a)(t,e).pipe(Object(b.a)((function(t){var e=n(t,2),c=e[0],a=e[1];return a?c.filter((function(t){return a.toLocaleLowerCase(),t.name.toLocaleLowerCase().includes(a)||t.sku.toLocaleLowerCase().includes(a)})):c}))),this.taxCategories$=this.productDetailService.getTaxCategories().pipe(Object(C.a)(this.destroy$)),this.activeTab$=this.route.paramMap.pipe(Object(b.a)((function(t){return t.get("tab")}))),this.facets$=this.productDetailService.getFacets();var c=this.product$.pipe(Object(b.a)((function(t){return t.facetValues}))),r=this.facets$.pipe(Object(b.a)(m.Zb)),i=this.getProductFormGroup().valueChanges.pipe(Object(b.a)((function(t){return t.facetValueIds})),Object(F.a)()),o=Object(Y.a)(i,c,r).pipe(Object(b.a)((function(t){var e=n(t,3),c=e[0],r=e[1],i=e[2],o=[].concat(a(r),a(i));return c.map((function(t){return o.find((function(e){return e.id===t}))})).filter(et.notNullOrUndefined)})));this.facetValues$=Object(Q.a)(c,o),this.productChannels$=this.product$.pipe(Object(b.a)((function(t){return t.channels})))}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"navigateToTab",value:function(e){this.router.navigate(["./",Object.assign(Object.assign({},this.route.snapshot.params),{tab:e})],{queryParamsHandling:"merge",relativeTo:this.route,state:t({},m.ob,!0)})}},{key:"isDefaultChannel",value:function(t){return t===ct.DEFAULT_CHANNEL_CODE}},{key:"assignToChannel",value:function(){this.modalService.fromComponent(Zc,{size:"lg",locals:{productIds:[this.id]}}).subscribe()}},{key:"removeFromChannel",value:function(t){var e=this;this.modalService.dialog({title:Object(v.a)("catalog.remove-product-from-channel"),buttons:[{type:"secondary",label:Object(v.a)("common.cancel")},{type:"danger",label:Object(v.a)("catalog.remove-from-channel"),returnValue:!0}]}).pipe(Object(k.a)((function(n){return n?e.dataService.product.removeProductsFromChannel({channelId:t,productIds:[e.id]}):Z.a}))).subscribe((function(){e.notificationService.success(Object(v.a)("catalog.notify-remove-product-from-channel-success"))}),(function(t){e.notificationService.error(Object(v.a)("catalog.notify-remove-product-from-channel-error"))}))}},{key:"customFieldIsSet",value:function(t){return!!this.detailForm.get(["product","customFields",t])}},{key:"assetsChanged",value:function(){return!!Object.values(this.assetChanges).length}},{key:"variantAssetsChanged",value:function(){return!!Object.keys(this.variantAssetChanges).length}},{key:"variantAssetChange",value:function(t){this.variantAssetChanges[t.variantId]=t}},{key:"updateSlug",value:function(t){var e=this;Object(Y.a)(this.entity$,this.languageCode$).pipe(Object(V.a)(1)).subscribe((function(c){var a=n(c,2),r=a[0],i=a[1],o=e.detailForm.get(["product","slug"]),s=r.translations.find((function(t){return t.languageCode===i})),l=!s||!s.slug;o&&o.pristine&&l&&o.setValue(Object(tt.normalizeString)(""+t,"-"))}))}},{key:"selectProductFacetValue",value:function(){var t=this;this.displayFacetValueModal().subscribe((function(e){if(e){var n=t.getProductFormGroup(),c=n.value.facetValueIds;n.patchValue({facetValueIds:Object(at.unique)([].concat(a(c),a(e)))}),n.markAsDirty()}}))}},{key:"updateProductOption",value:function(t){var e=this;this.productDetailService.updateProductOption(t).subscribe((function(){e.notificationService.success(Object(v.a)("common.notify-update-success"),{entity:"ProductOption"})}),(function(t){e.notificationService.error(Object(v.a)("common.notify-update-error"),{entity:"ProductOption"})}))}},{key:"removeProductFacetValue",value:function(t){var e=this.getProductFormGroup(),n=e.value.facetValueIds;e.patchValue({facetValueIds:n.filter((function(e){return e!==t}))}),e.markAsDirty()}},{key:"selectVariantFacetValue",value:function(t){var c=this;this.displayFacetValueModal().pipe(D(this.variants$)).subscribe((function(r){var i=n(r,2),o=i[0],s=i[1];if(o){var l,u=e(t);try{var d=function(){var t=l.value,e=s.findIndex((function(e){return e.id===t})),n=s[e],r=n?n.facetValues.map((function(t){return t.id})):[],i=c.detailForm.get(["variants",e]);i&&(i.patchValue({facetValueIds:Object(at.unique)([].concat(a(r),a(o)))}),i.markAsDirty())};for(u.s();!(l=u.n()).done;)d()}catch(p){u.e(p)}finally{u.f()}c.changeDetector.markForCheck()}}))}},{key:"variantsToCreateAreValid",value:function(){return 0<this.createVariantsConfig.variants.length&&this.createVariantsConfig.variants.every((function(t){return""!==t.sku}))}},{key:"displayFacetValueModal",value:function(){var t=this;return this.productDetailService.getFacets().pipe(Object(x.a)((function(e){return t.modalService.fromComponent(Yc,{size:"md",closable:!0,locals:{facets:e}})})),Object(b.a)((function(t){return t&&t.map((function(t){return t.id}))})))}},{key:"create",value:function(){var t=this,e=this.getProductFormGroup();e.dirty&&Object(Y.a)(this.product$,this.languageCode$).pipe(Object(V.a)(1),Object(x.a)((function(c){var a=n(c,2),r=a[0],i=a[1],o=t.getUpdatedProduct(r,e,i);return t.productDetailService.createProductWithVariants(o,t.createVariantsConfig,i)}))).subscribe((function(e){e.createProductVariants;var n=e.productId;t.notificationService.success(Object(v.a)("common.notify-create-success"),{entity:"Product"}),t.assetChanges={},t.variantAssetChanges={},t.detailForm.markAsPristine(),t.router.navigate(["../",n],{relativeTo:t.route})}),(function(e){console.error(e),t.notificationService.error(Object(v.a)("common.notify-create-error"),{entity:"Product"})}))}},{key:"save",value:function(){var t=this;Object(Y.a)(this.product$,this.languageCode$).pipe(Object(V.a)(1),Object(x.a)((function(e){var c,a,r=n(e,2),i=r[0],o=r[1],s=t.getProductFormGroup();(s.dirty||t.assetsChanged())&&(c=t.getUpdatedProduct(i,s,o));var l=t.detailForm.get("variants");return(l&&l.dirty||t.variantAssetsChanged())&&(a=t.getUpdatedProductVariants(i,l,o)),t.productDetailService.updateProduct(c,a)}))).subscribe((function(e){t.updateSlugAfterSave(e),t.detailForm.markAsPristine(),t.assetChanges={},t.variantAssetChanges={},t.notificationService.success(Object(v.a)("common.notify-update-success"),{entity:"Product"}),t.changeDetector.markForCheck()}),(function(e){t.notificationService.error(Object(v.a)("common.notify-update-error"),{entity:"Product"})}))}},{key:"canDeactivate",value:function(){return c(p(s.prototype),"canDeactivate",this).call(this)&&!this.assetChanges.assetIds&&!this.assetChanges.featuredAssetId}},{key:"setFormValues",value:function(n,c){var a=this,r=n.translations.find((function(t){return t.languageCode===c}));if(this.detailForm.patchValue({product:{enabled:n.enabled,name:r?r.name:"",slug:r?r.slug:"",description:r?r.description:"",facetValueIds:n.facetValues.map((function(t){return t.id}))}}),this.customFields.length){var i,o=this.detailForm.get(["product","customFields"]),s=r&&r.customFields||{},l=n.customFields||{},u=e(this.customFields);try{for(u.s();!(i=u.n()).done;){var d=i.value,p=d.name,f="localeString"===d.type?s[p]:l[p],g=o.get(p);g&&g.patchValue(f)}}catch(m){u.e(m)}finally{u.f()}}var h=this.detailForm.get("variants");n.variants.forEach((function(n,r){var i=n.translations.find((function(t){return t.languageCode===c})),o=n.facetValues.map((function(t){return t.id})),s={id:n.id,enabled:n.enabled,sku:n.sku,name:i?i.name:"",price:n.price,priceIncludesTax:n.priceIncludesTax,priceWithTax:n.priceWithTax,taxCategoryId:n.taxCategory.id,stockOnHand:n.stockOnHand,useGlobalOutOfStockThreshold:n.useGlobalOutOfStockThreshold,outOfStockThreshold:n.outOfStockThreshold,trackInventory:n.trackInventory,facetValueIds:o},l=h.at(r);if(l?l.patchValue(s):(l=a.formBuilder.group(Object.assign(Object.assign({},s),{facetValueIds:a.formBuilder.control(o)})),h.insert(r,l)),a.customVariantFields.length){var u=l.get(["customFields"]);u||(u=a.formBuilder.group(a.customVariantFields.reduce((function(e,n){return Object.assign(Object.assign({},e),t({},n.name,""))}),{})),l.addControl("customFields",u));var d,p=e(a.customVariantFields);try{for(p.s();!(d=p.n()).done;){var f=d.value,g=f.name,v="localeString"===f.type?i.customFields[g]:n.customFields[g],b=u.get(g);b&&b.patchValue(v)}}catch(m){p.e(m)}finally{p.f()}}}))}},{key:"getUpdatedProduct",value:function(t,e,n){var c=Object(m.Wb)({translatable:t,updatedFields:e.value,customFieldConfig:this.customFields,languageCode:n,defaultTranslation:{languageCode:n,name:t.name||"",slug:t.slug||"",description:t.description||""}});return Object.assign(Object.assign(Object.assign({},c),this.assetChanges),{facetValueIds:e.value.facetValueIds})}},{key:"getUpdatedProductVariants",value:function(t,e,n){var c=this,a=t.variants.filter((function(t,n){var c=e.get(n.toString());return c&&c.dirty})),r=e.controls.filter((function(t){return t.dirty})).map((function(t){return t.value}));if(a.length!==r.length)throw new Error(Object(v.a)("error.product-variant-form-values-do-not-match"));return a.map((function(t,e){var a=r[e],i=Object(m.Wb)({translatable:t,updatedFields:a,customFieldConfig:c.customVariantFields,languageCode:n,defaultTranslation:{languageCode:n,name:""}});i.taxCategoryId=a.taxCategoryId,i.facetValueIds=a.facetValueIds;var o=c.variantAssetChanges[t.id];return o&&(i.featuredAssetId=o.featuredAssetId,i.assetIds=o.assetIds),i})).filter(et.notNullOrUndefined)}},{key:"getProductFormGroup",value:function(){return this.detailForm.get("product")}},{key:"updateSlugAfterSave",value:function(t){var e=t[0],n=this.detailForm.get(["product","slug"]);n&&e.hasOwnProperty("updateProduct")&&n.setValue(e.updateProduct.slug,{emitEvent:!1})}}]),s}(m.u);Wc.\u0275fac=function(t){return new(t||Wc)(u.cc(g.a),u.cc(g.e),u.cc(m.Jb),u.cc(Bc),u.cc(E.e),u.cc(m.Ab),u.cc(m.Bb),u.cc(m.K),u.cc(nt.l),u.cc(u.k))},Wc.\u0275cmp=u.Wb({type:Wc,selectors:[["vdr-product-detail"]],features:[u.Ob],decls:18,vars:20,consts:[[1,"flex","clr-flex-row"],[3,"entity"],[4,"vdrIfPermissions"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","product-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup","keydown.enter",4,"ngIf"],["type","checkbox","clrToggle","","name","enabled",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup","keydown.enter"],["clrTabLink","",3,"click"],[4,"clrIfActive"],[4,"ngIf"],[1,"clr-row"],[1,"clr-col"],["formGroupName","product",1,"form-block"],[4,"vdrIfMultichannel"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","slug",3,"label","errors"],["id","slug","type","text","formControlName","slug","pattern","[a-z0-9_-]+",3,"readonly"],["formControlName","description",3,"readonly","label"],["formGroupName","customFields",4,"ngIf"],[1,"facets"],[3,"facetValue","removable","remove",4,"ngFor","ngForOf"],["class","btn btn-sm btn-secondary",3,"click",4,"vdrIfPermissions"],[1,"clr-col-md-auto"],[3,"assets","featuredAsset","change"],[3,"label",4,"vdrIfDefaultChannelActive"],[3,"label"],[1,"flex"],[1,"product-channels"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm",3,"click"],["shape","layers"],["icon","times-circle",3,"iconClick",4,"ngIf"],["icon","times-circle",3,"iconClick"],[3,"channelCode"],["formGroupName","customFields"],["entityName","Product",3,"customFieldsFormGroup","customField","readonly",4,"ngIf"],["entityName","Product",3,"customFieldsFormGroup","customField","readonly"],[3,"facetValue","removable","remove"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],[3,"variantsChange"],[1,"form-block"],[1,"view-mode"],[1,"btn-group"],[1,"btn","btn-secondary-outline",3,"click"],["shape","list"],[1,"btn",3,"click"],["shape","table"],[1,"variant-filter"],[1,"clr-input",3,"formControl","placeholder"],[1,"icon-button",3,"click"],["shape","times"],[1,"flex-spacer"],["class","btn btn-secondary edit-variants-btn",3,"routerLink",4,"vdrIfPermissions"],[3,"variants","optionGroups","productVariantsFormArray",4,"ngIf"],[3,"variants","facets","optionGroups","productVariantsFormArray","taxCategories","customFields","customOptionFields","activeLanguage","assetChange","updateProductOption","selectionChange","selectFacetValueClick",4,"ngIf"],[1,"btn","btn-secondary","edit-variants-btn",3,"routerLink"],["shape","add-text"],[3,"variants","optionGroups","productVariantsFormArray"],[3,"variants","facets","optionGroups","productVariantsFormArray","taxCategories","customFields","customOptionFields","activeLanguage","assetChange","updateProductOption","selectionChange","selectFacetValueClick"]],template:function(t,e){if(1&t&&(u.ic(0,"vdr-action-bar"),u.ic(1,"vdr-ab-left"),u.ic(2,"div",0),u.dc(3,"vdr-entity-info",1),u.sc(4,"async"),u.Vc(5,xe,5,5,"clr-toggle-wrapper",2),u.hc(),u.ic(6,"vdr-language-selector",3),u.pc("languageCodeChange",(function(t){return e.setLanguage(t)})),u.sc(7,"async"),u.sc(8,"async"),u.sc(9,"async"),u.hc(),u.hc(),u.ic(10,"vdr-ab-right"),u.dc(11,"vdr-action-bar-items",4),u.Vc(12,Me,3,4,"button",5),u.sc(13,"async"),u.Vc(14,je,1,1,"ng-template",null,6,u.Wc),u.hc(),u.hc(),u.Vc(16,qe,10,10,"form",7),u.sc(17,"async")),2&t){var n=u.Jc(15);u.Rb(3),u.yc("entity",u.tc(4,8,e.entity$)),u.Rb(2),u.yc("vdrIfPermissions","UpdateCatalog"),u.Rb(1),u.yc("disabled",u.tc(7,10,e.isNew$))("availableLanguageCodes",u.tc(8,12,e.availableLanguages$))("currentLanguageCode",u.tc(9,14,e.languageCode$)),u.Rb(6),u.yc("ngIf",u.tc(13,16,e.isNew$))("ngIfElse",n),u.Rb(4),u.yc("ngIf",u.tc(17,18,e.product$))}},directives:function(){return[m.c,m.e,m.ab,m.rb,m.xb,m.f,m.d,nt.p,dt.k,m.eb,E.a,dt.i,E.p,E.g,dt.u,E.E,E.q,E.j,dt.G,dt.R,dt.D,dt.F,dt.P,dt.p,dt.E,E.k,m.qb,m.db,E.b,E.h,E.w,m.Hb,nt.o,Va,m.pb,m.fb,dt.o,m.B,m.z,m.H,m.bb,Pa,g.h,ja,Ra]},pipes:function(){return[nt.b,lt.d,m.ib,m.A]},styles:["[_nghost-%COMP%]     trix-toolbar{top:24px}vdr-action-bar[_ngcontent-%COMP%]   clr-toggle-wrapper[_ngcontent-%COMP%]{margin-top:12px}.variant-filter[_ngcontent-%COMP%]{display:flex;flex:1}.variant-filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:3px 0 0 3px!important;flex:1;max-width:none}.variant-filter[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]{border:1px solid #bfc3cc;border-left:none;border-radius:0 3px 3px 0}.group-name[_ngcontent-%COMP%]{padding-right:6px}.view-mode[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:flex-end}.edit-variants-btn[_ngcontent-%COMP%]{margin-top:0}"],changeDetection:0}),Wc.ctorParameters=function(){return[{type:g.a},{type:g.e},{type:m.Jb},{type:Bc},{type:E.e},{type:m.Ab},{type:m.Bb},{type:m.K},{type:nt.l},{type:u.k}]};var Kc=function(){function t(){f(this,t),this._selected=[]}return h(t,[{key:"select",value:function(t,e,n){if(t.selected=!0,n||!t.children)if(t.value.label){var c=function(t){return!!t.value.label};this._selected.filter(c).length>0?this._selected=this._selected.filter((function(t){return!c(t)})).concat(t):this._selected.push(t)}else this._selected.push(t)}},{key:"unselect",value:function(t,e){this._selected=this._selected.filter((function(e){return e!==t})),t.selected=!1}},{key:"clear",value:function(t){this._selected=t?this._selected.filter((function(t){return t.disabled})):[]}},{key:"_setChildrenSelectedState",value:function(t,e){t.forEach((function(t){return t.selected=e}))}},{key:"_removeChildren",value:function(t){this._selected=this._selected.filter((function(e){return e.parent!==t}))}},{key:"_removeParent",value:function(t){this._selected=this._selected.filter((function(e){return e!==t}))}},{key:"value",get:function(){return this._selected}}]),t}();function qc(){return new Kc}var zc=qc,Jc=function(){function t(){var e=this;f(this,t),this.searchTermChange=new u.u,this.facetValueChange=new u.u,this.lastTerm="",this.lastFacetValueIds=[],this.filterFacetResults=function(t,n){return!!e.isFacetValueItem(n)&&(n.facetValue.name.toLowerCase().startsWith(t.toLowerCase())||n.facetValue.facet.name.toLowerCase().startsWith(t.toLowerCase()))},this.groupByFacet=function(t){return e.isFacetValueItem(t)?t.facetValue.facet.name:""},this.isFacetValueItem=function(t){return"object"==typeof t&&!!t&&t.hasOwnProperty("facetValue")}}return h(t,[{key:"setSearchTerm",value:function(t){var e=this;if(t)this.selectComponent.select({label:t,value:{label:t}});else{var n=this.selectComponent.selectedItems.find((function(t){return!e.isFacetValueItem(t.value)}));n&&this.selectComponent.unselect(n)}}},{key:"setFacetValues",value:function(t){var e=this,n=this.selectComponent.items;this.selectComponent.selectedItems.forEach((function(n){e.isFacetValueItem(n.value)&&!t.includes(n.value.facetValue.id)&&e.selectComponent.unselect(n)})),t.map((function(t){return n.find((function(n){return e.isFacetValueItem(n)&&n.facetValue.id===t}))})).filter(et.notNullOrUndefined).forEach((function(t){e.selectComponent.selectedItems.find((function(n){var c=n.value;return!!e.isFacetValueItem(c)&&c.facetValue.id===t.facetValue.id}))||e.selectComponent.select({label:"",value:t})}))}},{key:"onSelectChange",value:function(t){var e=this;Array.isArray(t)||(t=[t]);var n=t.find((function(t){return!e.isFacetValueItem(t)})),c=n?n.label:"",a=t.filter(this.isFacetValueItem).map((function(t){return t.facetValue.id}));c!==this.lastTerm&&(this.searchTermChange.emit(c),this.lastTerm=c),this.lastFacetValueIds.join(",")!==a.join(",")&&(this.facetValueChange.emit(a),this.lastFacetValueIds=a)}},{key:"isSearchHeaderSelected",value:function(){return-1===this.selectComponent.itemsList.markedIndex}}]),t}();Jc.\u0275fac=function(t){return new(t||Jc)},Jc.\u0275cmp=u.Wb({type:Jc,selectors:[["vdr-product-search-input"]],viewQuery:function(t,e){var n;1&t&&u.Rc(ze,!0),2&t&&u.Ic(n=u.qc())&&(e.selectComponent=n.first)},inputs:{facetValueResults:"facetValueResults"},outputs:{searchTermChange:"searchTermChange",facetValueChange:"facetValueChange"},features:[u.Qb([{provide:it.c,useValue:zc}])],decls:6,vars:9,consts:[[3,"addTag","placeholder","items","searchFn","hideSelected","multiple","markFirst","change"],["selectComponent",""],["ng-header-tmp",""],["ng-label-tmp",""],["ng-option-tmp",""],["class","search-header",3,"selected","click",4,"ngIf"],[1,"search-header",3,"click"],[4,"ngIf"],[3,"facetValue","removable","remove"],[3,"icon","iconClick"],[3,"facetValue","removable"]],template:function(t,e){1&t&&(u.ic(0,"ng-select",0,1),u.pc("change",(function(t){return e.onSelectChange(t)})),u.sc(2,"translate"),u.Vc(3,He,1,1,"ng-template",2),u.Vc(4,en,2,2,"ng-template",3),u.Vc(5,cn,1,1,"ng-template",4),u.hc()),2&t&&u.yc("addTag",!0)("placeholder",u.tc(2,7,"catalog.search-product-name-or-code"))("items",e.facetValueResults)("searchFn",e.filterFacetResults)("hideSelected",!0)("multiple",!0)("markFirst",!1)},directives:[it.a,it.f,it.e,it.d,nt.p,m.bb,m.B],pipes:[lt.d],styles:["[_nghost-%COMP%]{display:block;margin-top:6px;width:100%}[_nghost-%COMP%]     .ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value{background:none;margin:0}[_nghost-%COMP%]     .ng-dropdown-panel-items div.ng-option:last-child{display:none}[_nghost-%COMP%]     .ng-dropdown-panel .ng-dropdown-header{border:none;padding:0}[_nghost-%COMP%]     .ng-select.ng-select-multiple .ng-select-container .ng-value-container{padding:0}[_nghost-%COMP%]     .ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{padding-left:8px}ng-select[_ngcontent-%COMP%]{margin-right:12px;min-width:300px;width:100%}.search-header[_ngcontent-%COMP%]{border-bottom:1px solid #f2f3f5;cursor:pointer;padding:8px 10px}.search-header.selected[_ngcontent-%COMP%], .search-header[_ngcontent-%COMP%]:hover{background-color:#f2f3f5}"],changeDetection:0}),Jc.propDecorators={facetValueResults:[{type:u.D}],searchTermChange:[{type:u.O}],facetValueChange:[{type:u.O}],selectComponent:[{type:u.eb,args:["selectComponent",{static:!0}]}]};var Hc=function(t){o(a,t);var e=l(a);function a(t,n,r,i,o,s){var l,u;return f(this,a),(u=e.call(this,o,s)).dataService=t,u.modalService=n,u.notificationService=r,u.jobQueueService=i,u.searchTerm="",u.facetValueIds=[],u.groupByProduct=!0,c((l=d(u),p(a.prototype)),"setQueryFn",l).call(l,(function(){for(var t,e=arguments.length,n=new Array(e),c=0;c<e;c++)n[c]=arguments[c];return(t=u.dataService.product).searchProducts.apply(t,[u.searchTerm].concat(n)).refetchOnChannelChange()}),(function(t){return t.search}),(function(t,e){return{input:{skip:t,take:e,term:u.searchTerm,facetValueIds:u.facetValueIds,facetValueOperator:m.zb.AND,groupByProduct:u.groupByProduct}}})),u}return h(a,[{key:"ngOnInit",value:function(){var t=this;c(p(a.prototype),"ngOnInit",this).call(this),this.facetValues$=this.result$.pipe(Object(b.a)((function(t){return t.search.facetValues}))),this.route.queryParamMap.pipe(Object(b.a)((function(t){return t.get("q")})),Object(C.a)(this.destroy$)).subscribe((function(e){t.productSearchInput.setSearchTerm(e)}));var e=this.route.queryParamMap.pipe(Object(b.a)((function(t){return t.getAll("fvids")})));e.pipe(Object(C.a)(this.destroy$)).subscribe((function(e){t.productSearchInput.setFacetValues(e)})),this.facetValues$.pipe(Object(V.a)(1),X(100),D(e)).subscribe((function(e){var c=n(e,2),a=(c[0],c[1]);t.productSearchInput.setFacetValues(a)}))}},{key:"setSearchTerm",value:function(t){this.searchTerm=t,this.setQueryParam({q:t||null,page:1}),this.refresh()}},{key:"setFacetValueIds",value:function(t){this.facetValueIds=t,this.setQueryParam({fvids:t,page:1}),this.refresh()}},{key:"rebuildSearchIndex",value:function(){var t=this;this.dataService.product.reindex().subscribe((function(e){var n=e.reindex;t.notificationService.info(Object(v.a)("catalog.reindexing")),t.jobQueueService.addJob(n.id,(function(e){if(e.state===m.ub.COMPLETED){var n=(new Intl.NumberFormat).format(e.duration||0);t.notificationService.success(Object(v.a)("catalog.reindex-successful"),{count:e.result.indexedItemCount,time:n}),t.refresh()}else t.notificationService.error(Object(v.a)("catalog.reindex-error"))}))}))}},{key:"deleteProduct",value:function(t){var e=this;this.modalService.dialog({title:Object(v.a)("catalog.confirm-delete-product"),buttons:[{type:"secondary",label:Object(v.a)("common.cancel")},{type:"danger",label:Object(v.a)("common.delete"),returnValue:!0}]}).pipe(Object(k.a)((function(n){return n?e.dataService.product.deleteProduct(t):Z.a})),X(500)).subscribe((function(){e.notificationService.success(Object(v.a)("common.notify-delete-success"),{entity:"Product"}),e.refresh()}),(function(t){e.notificationService.error(Object(v.a)("common.notify-delete-error"),{entity:"Product"})}))}}]),a}(m.w);Hc.\u0275fac=function(t){return new(t||Hc)(u.cc(m.K),u.cc(m.Ab),u.cc(m.Bb),u.cc(m.tb),u.cc(g.e),u.cc(g.a))},Hc.\u0275cmp=u.Wb({type:Hc,selectors:[["vdr-products-list"]],viewQuery:function(t,e){var n;1&t&&u.Rc(an,!0),2&t&&u.Ic(n=u.qc())&&(e.productSearchInput=n.first)},features:[u.Ob],decls:28,vars:27,consts:[[3,"grow"],[1,"search-form"],[3,"facetValueResults","searchTermChange","facetValueChange"],["productSearchInputComponent",""],[1,"search-settings-menu"],["type","button","vdrDropdownTrigger","",1,"icon-button"],["shape","cog"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"disabled","click"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],["locationId","product-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"full-label"],[1,"left","align-middle"],[1,"image-placeholder"],[3,"src",4,"ngIf","ngIfElse"],["imagePlaceholder",""],[1,"align-middle"],[4,"ngIf"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"src"],[1,"placeholder"],["shape","image","size","48"]],template:function(t,e){1&t&&(u.ic(0,"vdr-action-bar"),u.ic(1,"vdr-ab-left",0),u.ic(2,"div",1),u.ic(3,"vdr-product-search-input",2,3),u.pc("searchTermChange",(function(t){return e.setSearchTerm(t)}))("facetValueChange",(function(t){return e.setFacetValueIds(t)})),u.sc(5,"async"),u.hc(),u.ic(6,"vdr-dropdown",4),u.ic(7,"button",5),u.dc(8,"clr-icon",6),u.hc(),u.ic(9,"vdr-dropdown-menu",7),u.ic(10,"button",8),u.pc("click",(function(){return e.rebuildSearchIndex()})),u.sc(11,"hasPermission"),u.Xc(12),u.sc(13,"translate"),u.hc(),u.hc(),u.hc(),u.hc(),u.ic(14,"clr-checkbox-wrapper"),u.ic(15,"input",9),u.pc("ngModelChange",(function(t){return e.groupByProduct=t})),u.hc(),u.ic(16,"label"),u.Xc(17),u.sc(18,"translate"),u.hc(),u.hc(),u.hc(),u.ic(19,"vdr-ab-right"),u.dc(20,"vdr-action-bar-items",10),u.Vc(21,rn,5,5,"a",11),u.hc(),u.hc(),u.ic(22,"vdr-data-table",12),u.pc("pageChange",(function(t){return e.setPageNumber(t)}))("itemsPerPageChange",(function(t){return e.setItemsPerPage(t)})),u.sc(23,"async"),u.sc(24,"async"),u.sc(25,"async"),u.sc(26,"async"),u.Vc(27,un,24,29,"ng-template"),u.hc()),2&t&&(u.Rb(1),u.yc("grow",!0),u.Rb(2),u.yc("facetValueResults",u.tc(5,11,e.facetValues$)),u.Rb(7),u.yc("disabled",!u.tc(11,13,"UpdateCatalog")),u.Rb(2),u.Zc(" ",u.tc(13,15,"catalog.rebuild-search-index")," "),u.Rb(3),u.yc("ngModel",e.groupByProduct),u.Rb(2),u.Yc(u.tc(18,17,"catalog.group-by-product")),u.Rb(4),u.yc("vdrIfPermissions","CreateCatalog"),u.Rb(1),u.yc("items",u.tc(23,19,e.items$))("itemsPerPage",u.tc(24,21,e.itemsPerPage$))("totalItems",u.tc(25,23,e.totalItems$))("currentPage",u.tc(26,25,e.currentPage$)))},directives:[m.c,m.e,Jc,m.S,m.V,dt.o,m.U,m.T,dt.k,m.eb,E.a,dt.i,E.p,E.s,dt.u,m.f,m.d,m.rb,m.M,g.h,nt.p,m.Pb,m.B],pipes:[nt.b,m.ib,lt.d,m.q],styles:[".image-placeholder[_ngcontent-%COMP%]{background-color:#f2f3f5;height:50px;width:50px}.image-placeholder[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{color:#bfc3cc;text-align:center}.search-form[_ngcontent-%COMP%]{align-items:center;display:flex;margin-bottom:6px;width:100%}.search-input[_ngcontent-%COMP%]{min-width:300px}@media screen and (max-width:768px){.search-input[_ngcontent-%COMP%]{min-width:100px}}.search-settings-menu[_ngcontent-%COMP%]{margin:0 12px}td.disabled[_ngcontent-%COMP%]{background-color:#f2f3f5}"]}),Hc.ctorParameters=function(){return[{type:m.K},{type:m.Ab},{type:m.Bb},{type:m.tb},{type:g.e},{type:g.a}]},Hc.propDecorators={productSearchInput:[{type:u.eb,args:["productSearchInputComponent",{static:!0}]}]};var Qc=function(){function e(t,n,c,a,r){f(this,e),this.route=t,this.dataService=n,this.productDetailService=c,this.notificationService=a,this.modalService=r,this.formValueChanged=!1,this.variants=[],this.variantFormValues={}}return h(e,[{key:"ngOnInit",value:function(){var t=this;this.initOptionsAndVariants(),this.languageCode=this.route.snapshot.paramMap.get("lang")||Object(m.cc)(),this.dataService.settings.getActiveChannel().single$.subscribe((function(e){t.currencyCode=e.activeChannel.currencyCode}))}},{key:"onFormChanged",value:function(t){this.formValueChanged=!0,t.enabled=!0}},{key:"canDeactivate",value:function(){return!this.formValueChanged}},{key:"getVariantsToAdd",value:function(){return Object.values(this.variantFormValues).filter((function(t){return!t.existing&&t.enabled}))}},{key:"getVariantName",value:function(t){return 0===t.options.length?Object(v.a)("catalog.default-variant"):t.options.map((function(t){return t.name})).join(" ")}},{key:"addOption",value:function(){this.optionGroups.push({isNew:!0,name:"",values:[]})}},{key:"generateVariants",value:function(){var t=this,e=this.optionGroups.map((function(t){return t.values})),n=this.variants;this.variants=e.length?Object(et.generateAllCombinations)(e).map((function(e,n){return{isDefault:1===t.product.variants.length&&0===n,id:t.generateOptionsId(e),options:e}})):[{isDefault:!0,id:"__DEFAULT_VARIANT__",options:[]}],this.variants.forEach((function(e){if(!t.variantFormValues[e.id]){var c=t.getVariantPrototype(e,n);t.variantFormValues[e.id]={enabled:!1,existing:!1,options:e.options.map((function(t){return t.name})),price:c.price,sku:c.sku,stock:c.stock}}}))}},{key:"getVariantPrototype",value:function(t,e){if(t.isDefault)return this.variantFormValues.__DEFAULT_VARIANT__;var n=e.filter((function(e){return t.options.map((function(t){return t.name})).filter((function(t){return e.options.map((function(t){return t.name})).includes(t)}))}));return n.length?this.variantFormValues[this.generateOptionsId(n[0].options)]:{sku:"",price:0,stock:0}}},{key:"deleteVariant",value:function(t){var e=this;this.modalService.dialog({title:Object(v.a)("catalog.confirm-delete-product-variant"),buttons:[{type:"secondary",label:Object(v.a)("common.cancel")},{type:"danger",label:Object(v.a)("common.delete"),returnValue:!0}]}).pipe(Object(k.a)((function(n){return n?e.productDetailService.deleteProductVariant(t,e.product.id):Z.a})),Object(k.a)((function(){return e.reFetchProduct(null)}))).subscribe((function(){e.notificationService.success(Object(v.a)("common.notify-delete-success"),{entity:"ProductVariant"}),e.initOptionsAndVariants()}),(function(t){e.notificationService.error(Object(v.a)("common.notify-delete-error"),{entity:"ProductVariant"})}))}},{key:"save",value:function(){var t=this,e=this.optionGroups.filter((function(t){return t.isNew})).map((function(t){return{name:t.name,values:[]}}));this.confirmDeletionOfDefault().pipe(Object(x.a)((function(){return t.productDetailService.createProductOptionGroups(e,t.languageCode)})),Object(x.a)((function(e){return t.addOptionGroupsToProduct(e)})),Object(x.a)((function(e){return t.addNewOptionsToGroups(e)})),Object(x.a)((function(e){return t.fetchOptionGroups(e)})),Object(x.a)((function(e){return t.createNewProductVariants(e)})),Object(x.a)((function(e){return t.deleteDefaultVariant(e.createProductVariants)})),Object(x.a)((function(e){return t.reFetchProduct(e)}))).subscribe({next:function(e){t.formValueChanged=!1,t.notificationService.success(Object(v.a)("catalog.created-new-variants-success"),{count:e.length}),t.initOptionsAndVariants()}})}},{key:"confirmDeletionOfDefault",value:function(){return 1===this.product.variants.length?this.modalService.dialog({title:Object(v.a)("catalog.confirm-adding-options-delete-default-title"),body:Object(v.a)("catalog.confirm-adding-options-delete-default-body"),buttons:[{type:"secondary",label:Object(v.a)("common.cancel")},{type:"danger",label:Object(v.a)("catalog.delete-default-variant"),returnValue:!0}]}).pipe(Object(x.a)((function(t){return!0===t?Object(q.a)(!0):Z.a}))):Object(q.a)(!0)}},{key:"addOptionGroupsToProduct",value:function(t){var e=this;return t.length?Object(z.a)(t.map((function(t){return e.dataService.product.addOptionGroupToProduct({productId:e.product.id,optionGroupId:t.id})}))).pipe(Object(b.a)((function(){return t}))):Object(q.a)([])}},{key:"addNewOptionsToGroups",value:function(t){var e=this,n=this.optionGroups.map((function(n){var c=t.find((function(t){return t.name===n.name})),a=c?c.id:n.id;if(!a)throw new Error("Could not get a productOptionGroupId");return n.values.filter((function(t){return!t.locked})).map((function(t){return{productOptionGroupId:a,code:Object(tt.normalizeString)(t.name,"-"),translations:[{name:t.name,languageCode:e.languageCode}]}}))})).reduce((function(t,e){return[].concat(a(t),a(e))}),[]),c=[].concat(a(t.map((function(t){return t.id}))),a(this.optionGroups.map((function(t){return t.id})).filter(et.notNullOrUndefined)));return n.length?Object(z.a)(n.map((function(t){return e.dataService.product.addOptionToGroup(t)}))).pipe(Object(b.a)((function(){return c}))):Object(q.a)(c)}},{key:"fetchOptionGroups",value:function(t){var e=this;return Object(z.a)(t.map((function(t){return e.dataService.product.getProductOptionGroup(t).mapSingle((function(t){return t.productOptionGroup})).pipe(Object(U.a)(et.notNullOrUndefined))})))}},{key:"createNewProductVariants",value:function(t){var e=t.filter(et.notNullOrUndefined).map((function(t){return t.options})).reduce((function(t,e){return[].concat(a(t),a(e))}),[]),n=Object.values(this.variantFormValues).filter((function(t){return t.enabled&&!t.existing})).map((function(t){return{price:t.price,sku:t.sku,stock:t.stock,optionIds:t.options.map((function(t){return e.find((function(e){return e.name===t}))})).filter(et.notNullOrUndefined).map((function(t){return t.id}))}}));return this.productDetailService.createProductVariants(this.product,n,e,this.languageCode)}},{key:"deleteDefaultVariant",value:function(t){return 1===this.product.variants.length?this.dataService.product.deleteProductVariant(this.product.variants[0].id).pipe(Object(b.a)((function(){return t}))):Object(q.a)(t)}},{key:"reFetchProduct",value:function(t){var e=this.route.snapshot.paramMap.get("id");return e?this.dataService.product.getProduct(e).single$.pipe(Object(b.a)((function(){return t}))):Object(q.a)(t)}},{key:"initOptionsAndVariants",value:function(){var t=this;this.route.data.pipe(Object(k.a)((function(t){return t.entity})),Object(V.a)(1)).subscribe((function(e){t.product=e,t.optionGroups=e.optionGroups.map((function(t){return{id:t.id,isNew:!1,name:t.name,values:t.options.map((function(t){return{id:t.id,name:t.name,locked:!0}}))}})),t.variantFormValues=t.getExistingVariants(e.variants),t.generateVariants()}))}},{key:"getExistingVariants",value:function(e){var n=this;return e.reduce((function(e,c){var a=c.options.length?n.generateOptionsId(c.options):"__DEFAULT_VARIANT__";return Object.assign(Object.assign({},e),t({},a,{productVariantId:c.id,enabled:!0,existing:!0,options:c.options.map((function(t){return t.name})),sku:c.sku,price:c.price,stock:c.stockOnHand}))}),{})}},{key:"generateOptionsId",value:function(t){return t.map((function(t){return t.name})).sort().join("|")}}]),e}();Qc.\u0275fac=function(t){return new(t||Qc)(u.cc(g.a),u.cc(m.K),u.cc(Bc),u.cc(m.Bb),u.cc(m.Ab))},Qc.\u0275cmp=u.Wb({type:Qc,selectors:[["vdr-product-variants-editor"]],decls:28,vars:25,consts:[[1,"btn","btn-primary",3,"disabled","click"],["class","option-groups",4,"ngFor","ngForOf"],["class","btn btn-primary-outline btn-sm",3,"click",4,"ngIf"],[1,"variants-preview"],[1,"table"],[3,"disabled",4,"ngFor","ngForOf"],[1,"option-groups"],[1,"name"],["clrInput","","name","name",3,"ngModel","readonly","ngModelChange"],[1,"values"],[3,"ngModel","groupName","disabled","ngModelChange"],["optionValueInputComponent",""],[1,"btn","btn-primary-outline","btn-sm",3,"click"],["shape","plus"],["type","checkbox","name","enabled","clrCheckbox","",3,"ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","checkbox","name","enabled","clrCheckbox","",3,"ngModel","ngModelChange"],["clrInput","","type","text","name","sku","required","",3,"ngModel","placeholder","ngModelChange"],["clrInput","","name","price",3,"ngModel","currencyCode","ngModelChange"],["clrInput","","type","number","name","stock","min","0","step","1",3,"ngModel","ngModelChange"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click"],["shape","trash",1,"is-danger"]],template:function(t,e){1&t&&(u.ic(0,"vdr-action-bar"),u.ic(1,"vdr-ab-right"),u.ic(2,"button",0),u.pc("click",(function(){return e.save()})),u.Xc(3),u.sc(4,"translate"),u.hc(),u.hc(),u.hc(),u.Vc(5,dn,12,11,"div",1),u.Vc(6,pn,4,3,"button",2),u.ic(7,"div",3),u.ic(8,"table",4),u.ic(9,"thead"),u.ic(10,"tr"),u.ic(11,"th"),u.Xc(12),u.sc(13,"translate"),u.hc(),u.ic(14,"th"),u.Xc(15),u.sc(16,"translate"),u.hc(),u.ic(17,"th"),u.Xc(18),u.sc(19,"translate"),u.hc(),u.ic(20,"th"),u.Xc(21),u.sc(22,"translate"),u.hc(),u.ic(23,"th"),u.Xc(24),u.sc(25,"translate"),u.hc(),u.dc(26,"th"),u.hc(),u.hc(),u.Vc(27,On,16,11,"tr",5),u.hc(),u.hc()),2&t&&(u.Rb(2),u.yc("disabled",!e.formValueChanged||0===e.getVariantsToAdd().length),u.Rb(1),u.Zc(" ",u.uc(4,10,"common.add-new-variants",u.Dc(23,Dt,e.getVariantsToAdd().length))," "),u.Rb(2),u.yc("ngForOf",e.optionGroups),u.Rb(1),u.yc("ngIf",1===e.product.variants.length),u.Rb(6),u.Yc(u.tc(13,13,"common.create")),u.Rb(3),u.Yc(u.tc(16,15,"catalog.variant")),u.Rb(3),u.Yc(u.tc(19,17,"catalog.sku")),u.Rb(3),u.Yc(u.tc(22,19,"catalog.price")),u.Rb(3),u.Yc(u.tc(25,21,"catalog.stock-on-hand")),u.Rb(3),u.yc("ngForOf",e.variants))},directives:function(){return[m.c,m.f,nt.o,nt.p,dt.u,m.eb,E.b,dt.s,E.p,E.s,Ia,dt.o,E.a,dt.i,dt.t,E.z,m.F,E.v,m.S,m.V,m.U,m.T]},pipes:function(){return[lt.d,nt.d]},styles:[".option-groups[_ngcontent-%COMP%]{display:flex}.option-groups[_ngcontent-%COMP%]:first-of-type{margin-top:24px}.values[_ngcontent-%COMP%]{flex:1;margin:0 6px}.variants-preview[_ngcontent-%COMP%]   tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fafafa;color:#97979a}"]}),Qc.ctorParameters=function(){return[{type:g.a},{type:m.K},{type:Bc},{type:m.Bb},{type:m.Ab}]};var ta=function(t){o(n,t);var e=l(n);function n(t,c){return f(this,n),e.call(this,t,{__typename:"Asset",id:"",createdAt:"",updatedAt:"",name:"",type:m.r.IMAGE,fileSize:0,mimeType:"",width:0,height:0,source:"",preview:"",focalPoint:null},(function(t){return c.product.getAsset(t).mapStream((function(t){return t.asset}))}))}return n}(m.v);ta.\u0275fac=function(t){return new(t||ta)(u.mc(g.e),u.mc(m.K))},ta.\u0275prov=Object(u.Yb)({factory:function(){return new ta(Object(u.mc)(g.e),Object(u.mc)(m.K))},token:ta,providedIn:"root"}),ta.ctorParameters=function(){return[{type:g.e},{type:m.K}]};var ea=function(t){o(n,t);var e=l(n);function n(t,c){return f(this,n),e.call(this,t,{__typename:"Collection",id:"",createdAt:"",updatedAt:"",languageCode:Object(m.cc)(),name:"",slug:"",isPrivate:!1,description:"",featuredAsset:null,assets:[],translations:[],filters:[],parent:{},children:null},(function(t){return c.collection.getCollection(t).mapStream((function(t){return t.collection}))}))}return n}(m.v);ea.\u0275fac=function(t){return new(t||ea)(u.mc(g.e),u.mc(m.K))},ea.\u0275prov=Object(u.Yb)({factory:function(){return new ea(Object(u.mc)(g.e),Object(u.mc)(m.K))},token:ea,providedIn:"root"}),ea.ctorParameters=function(){return[{type:g.e},{type:m.K}]};var na=function(t){o(n,t);var e=l(n);function n(t,c){return f(this,n),e.call(this,t,{__typename:"Facet",id:"",createdAt:"",updatedAt:"",isPrivate:!1,languageCode:Object(m.cc)(),name:"",code:"",translations:[],values:[]},(function(t){return c.facet.getFacet(t).mapStream((function(t){return t.facet}))}))}return n}(m.v);na.\u0275fac=function(t){return new(t||na)(u.mc(g.e),u.mc(m.K))},na.\u0275prov=Object(u.Yb)({factory:function(){return new na(Object(u.mc)(g.e),Object(u.mc)(m.K))},token:na,providedIn:"root"}),na.ctorParameters=function(){return[{type:g.e},{type:m.K}]};var ca=function(t){o(n,t);var e=l(n);function n(t,c){return f(this,n),e.call(this,c,{__typename:"Product",id:"",createdAt:"",updatedAt:"",enabled:!0,languageCode:Object(m.cc)(),name:"",slug:"",featuredAsset:null,assets:[],description:"",translations:[],optionGroups:[],facetValues:[],variants:[],channels:[]},(function(e){return t.product.getProduct(e).refetchOnChannelChange().mapStream((function(t){return t.product}))}))}return n}(m.v);ca.\u0275fac=function(t){return new(t||ca)(u.mc(m.K),u.mc(g.e))},ca.\u0275prov=Object(u.Yb)({factory:function(){return new ca(Object(u.mc)(m.K),Object(u.mc)(g.e))},token:ca,providedIn:"root"}),ca.ctorParameters=function(){return[{type:m.K},{type:g.e}]};var aa=function(t){o(n,t);var e=l(n);function n(t,c){return f(this,n),e.call(this,t,{__typename:"Product",id:"",createdAt:"",updatedAt:"",name:"",optionGroups:[],variants:[]},(function(t){return c.product.getProductVariantsOptions(t).mapStream((function(t){return t.product}))}))}return n}(m.v);aa.\u0275fac=function(t){return new(t||aa)(u.mc(g.e),u.mc(m.K))},aa.\u0275prov=Object(u.Yb)({factory:function(){return new aa(Object(u.mc)(g.e),Object(u.mc)(m.K))},token:aa,providedIn:"root"}),aa.ctorParameters=function(){return[{type:g.e},{type:m.K}]};var ra={breadcrumb:Object(v.a)("breadcrumb.products")},ia={breadcrumb:ha},oa={breadcrumb:ma},sa={breadcrumb:Object(v.a)("breadcrumb.facets")},la={breadcrumb:va},ua={breadcrumb:Object(v.a)("breadcrumb.collections")},da={breadcrumb:ba},pa={breadcrumb:Object(v.a)("breadcrumb.assets")},fa={breadcrumb:ya},ga=[{path:"products",component:Hc,data:ra},{path:"products/:id",component:Wc,resolve:Object(m.Vb)(ca),canDeactivate:[m.x],data:ia},{path:"products/:id/manage-variants",component:Qc,resolve:Object(m.Vb)(aa),canDeactivate:[m.x],data:oa},{path:"facets",component:Ec,data:sa},{path:"facets/:id",component:Uc,resolve:Object(m.Vb)(na),canDeactivate:[m.x],data:la},{path:"collections",component:Lc,data:ua},{path:"collections/:id",component:Nc,resolve:Object(m.Vb)(ea),canDeactivate:[m.x],data:da},{path:"assets",component:Xc,data:pa},{path:"assets/:id",component:Tc,resolve:Object(m.Vb)(ta),data:fa}];function ha(t,e){return Object(m.Xb)({entity:t.entity,id:e.id,breadcrumbKey:"breadcrumb.products",getName:function(t){return t.name},route:"products"})}function ma(t,e){return t.entity.pipe(Object(b.a)((function(t){return[{label:Object(v.a)("breadcrumb.products"),link:["../","products"]},{label:""+t.name,link:["../","products",e.id,{tab:"variants"}]},{label:Object(v.a)("breadcrumb.manage-variants"),link:["manage-variants"]}]})))}function va(t,e){return Object(m.Xb)({entity:t.entity,id:e.id,breadcrumbKey:"breadcrumb.facets",getName:function(t){return t.name},route:"facets"})}function ba(t,e){return Object(m.Xb)({entity:t.entity,id:e.id,breadcrumbKey:"breadcrumb.collections",getName:function(t){return t.name},route:"collections"})}function ya(t,e){return Object(m.Xb)({entity:t.entity,id:e.id,breadcrumbKey:"breadcrumb.assets",getName:function(t){return t.name},route:"assets"})}function Ca(t,n){var c,a,r,i,o,s=[],l={},u=(r=n,i=new Map,r&&function t(e){i.set(e.id,e),e.children.forEach(t)}(r),i),d=e(t);try{for(d.s();!(o=d.n()).done;){var p=o.value;l[p.id]=Object.assign(Object.assign({},p),{children:[]})}}catch(b){d.e(b)}finally{d.f()}var f,g=e(t.map((function(t){return t.id})));try{for(g.s();!(f=g.n()).done;){var h=f.value;if(l.hasOwnProperty(h)){var m=l[h];m.expanded=null!==(a=null===(c=u.get(h))||void 0===c?void 0:c.expanded)&&void 0!==a&&a;var v=m.parent;if(!v)continue;l[v.id]?l[v.id]?l[v.id].children.push(m):l[v.id]={children:[m]}:s.push(m)}}}catch(b){g.e(b)}finally{g.f()}return{id:s.length?s[0].parent.id:void 0,children:s}}var Oa=function(){function t(){f(this,t),this.expandAll=!1,this.rearrange=new u.u,this.deleteCollection=new u.u}return h(t,[{key:"ngOnChanges",value:function(t){"collections"in t&&this.collections&&(this.collectionTree=Ca(this.collections,this.collectionTree))}},{key:"onDrop",value:function(t){var e=t.item.data,n=t.container.data.id;if(null==n)throw new Error("Could not determine the ID of the root Collection");this.rearrange.emit({collectionId:e.id,parentId:n,index:t.currentIndex})}},{key:"onMove",value:function(t){this.rearrange.emit(t)}},{key:"onDelete",value:function(t){this.deleteCollection.emit(t)}},{key:"isRootNode",value:function(t){return!t.hasOwnProperty("parent")}}]),t}();Oa.\u0275fac=function(t){return new(t||Oa)},Oa.\u0275cmp=u.Wb({type:Oa,selectors:[["vdr-collection-tree"]],inputs:{expandAll:"expandAll",collections:"collections",activeCollectionId:"activeCollectionId"},outputs:{rearrange:"rearrange",deleteCollection:"deleteCollection"},features:[u.Pb],decls:1,vars:1,consts:[["cdkDropListGroup","",3,"expandAll","collectionTree","activeCollectionId",4,"ngIf"],["cdkDropListGroup","",3,"expandAll","collectionTree","activeCollectionId"]],template:function(t,e){1&t&&u.Vc(0,kn,1,3,"vdr-collection-tree-node",0),2&t&&u.yc("ngIf",e.collectionTree)},directives:function(){return[nt.p,ka,ot.d]},styles:[""],changeDetection:0}),Oa.propDecorators={collections:[{type:u.D}],activeCollectionId:[{type:u.D}],expandAll:[{type:u.D}],rearrange:[{type:u.O}],deleteCollection:[{type:u.O}]};var ka=function(){function t(e,n,c){f(this,t),this.parent=e,this.root=n,this.dataService=c,this.depth=0,this.expandAll=!1,e&&(this.depth=e.depth+1)}return h(t,[{key:"ngOnInit",value:function(){this.parentName=this.collectionTree.name||"<root>";var t=this.dataService.client.userStatus().mapStream((function(t){return t.userStatus.permissions})).pipe(Object(M.a)(1));this.hasUpdatePermission$=t.pipe(Object(b.a)((function(t){return t.includes(m.Fb.UpdateCatalog)}))),this.hasDeletePermission$=t.pipe(Object(b.a)((function(t){return t.includes(m.Fb.DeleteCatalog)})))}},{key:"ngOnChanges",value:function(t){var e=t.expandAll;e&&!0===e.previousValue&&!1===e.currentValue&&this.collectionTree.children.forEach((function(t){return t.expanded=!1}))}},{key:"trackByFn",value:function(t,e){return e.id}},{key:"getMoveListItems",value:function(t){return function e(n,c,a){if(n.id!==t.id){var r=c.concat(n.name),i=t.parent&&t.parent.id;n.id!==i&&a.push({path:r.slice(1).join(" / ")||"root",id:n.id}),n.children.forEach((function(t){return e(t,r,a)}))}return a}(this.root.collectionTree,[],[])}},{key:"move",value:function(t,e){this.root.onMove({index:0,parentId:e,collectionId:t.id})}},{key:"moveUp",value:function(t,e){t.parent&&this.root.onMove({index:e-1,parentId:t.parent.id,collectionId:t.id})}},{key:"moveDown",value:function(t,e){t.parent&&this.root.onMove({index:e+1,parentId:t.parent.id,collectionId:t.id})}},{key:"drop",value:function(t){Object(ot.f)(this.collectionTree.children,t.previousIndex,t.currentIndex),this.root.onDrop(t)}},{key:"delete",value:function(t){this.root.onDelete(t)}}]),t}();ka.\u0275fac=function(t){return new(t||ka)(u.cc(ka,12),u.cc(Oa),u.cc(m.K))},ka.\u0275cmp=u.Wb({type:ka,selectors:[["vdr-collection-tree-node"]],inputs:{expandAll:"expandAll",collectionTree:"collectionTree",activeCollectionId:"activeCollectionId"},features:[u.Pb],decls:4,vars:6,consts:[["cdkDropList","",1,"tree-node",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped"],["dropList",""],["class","collection","cdkDrag","",3,"private","cdkDragData",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"collection",3,"cdkDragData"],[1,"collection-detail",3,"ngClass"],[1,"name"],["class","icon-button folder-button",3,"disabled","click",4,"ngIf","ngIfElse"],["folderSpacer",""],[1,"flex-spacer"],[4,"ngIf"],["queryParamsHandling","preserve",1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","view-list"],[1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","edit"],["class","drag-handle","cdkDragHandle","",4,"vdrIfPermissions"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["class","dropdown-item",3,"routerLink",4,"vdrIfPermissions"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",3,"disabled","click"],["shape","caret up"],["shape","caret down"],[1,"dropdown-header"],["type","button","vdrDropdownItem","",3,"disabled","click",4,"ngFor","ngForOf"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"expandAll","collectionTree","activeCollectionId",4,"ngIf"],[1,"icon-button","folder-button",3,"disabled","click"],["shape","folder",4,"ngIf"],["shape","folder-open",4,"ngIf"],["shape","folder"],["shape","folder-open"],[1,"folder-button-spacer"],["cdkDragHandle","",1,"drag-handle"],["shape","drag-handle","size","24"],[1,"dropdown-item",3,"routerLink"],["shape","plus"],["shape","child-arrow"],[3,"expandAll","collectionTree","activeCollectionId"]],template:function(t,e){1&t&&(u.ic(0,"div",0,1),u.pc("cdkDropListDropped",(function(t){return e.drop(t)})),u.sc(2,"async"),u.Vc(3,$n,45,49,"div",2),u.hc()),2&t&&(u.yc("cdkDropListData",e.collectionTree)("cdkDropListDisabled",!u.tc(2,4,e.hasUpdatePermission$)),u.Rb(3),u.yc("ngForOf",e.collectionTree.children)("ngForTrackBy",e.trackByFn))},directives:[ot.c,nt.o,dt.l,ot.a,nt.n,nt.p,g.h,dt.o,m.rb,m.S,m.V,m.U,m.T,m.B,ot.b,ka],pipes:[nt.b,lt.d],styles:["[_nghost-%COMP%]{display:block}.collection[_ngcontent-%COMP%]{background-color:#fff;border-left:2px solid transparent;color:rgba(0,0,0,.87);font-size:.65rem;margin-bottom:2px;transition:transform .25s cubic-bezier(0,0,.2,1);transition:border-left-color .2s}.collection.private[_ngcontent-%COMP%]{background-color:#f2f3f5}.collection[_ngcontent-%COMP%]   .collection-detail[_ngcontent-%COMP%]{align-items:center;border-bottom:1px solid #f2f3f5;display:flex;justify-content:space-between;padding:6px 12px}.collection[_ngcontent-%COMP%]   .collection-detail.active[_ngcontent-%COMP%]{background-color:#f2f3f5}.collection[_ngcontent-%COMP%]   .collection-detail.depth-1[_ngcontent-%COMP%]{padding-left:36px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-2[_ngcontent-%COMP%]{padding-left:60px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-3[_ngcontent-%COMP%]{padding-left:84px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-4[_ngcontent-%COMP%]{padding-left:108px}.collection[_ngcontent-%COMP%]   .collection-detail[_ngcontent-%COMP%]   .folder-button-spacer[_ngcontent-%COMP%]{display:inline-block;width:28px}.tree-node[_ngcontent-%COMP%]{background:#fff;display:block;overflow:hidden}.tree-node.cdk-drop-list-dragging[_ngcontent-%COMP%] > .collection[_ngcontent-%COMP%]{border-left-color:#9adbf3}.drag-placeholder[_ngcontent-%COMP%]{background-color:#bfc3cc;min-height:120px;transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-sizing:border-box}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%], .example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .tree-node[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0}),ka.ctorParameters=function(){return[{type:ka,decorators:[{type:u.Y},{type:u.N}]},{type:Oa},{type:m.K}]},ka.propDecorators={collectionTree:[{type:u.D}],activeCollectionId:[{type:u.D}],expandAll:[{type:u.D}]};var Pa=function(){function t(e){f(this,t),this.dataService=e,this.variantsChange=new u.u,this.optionGroups=[],this.variantFormValues={}}return h(t,[{key:"ngOnInit",value:function(){var t=this;this.dataService.settings.getActiveChannel().single$.subscribe((function(e){t.currencyCode=e.activeChannel.currencyCode})),this.generateVariants()}},{key:"addOption",value:function(){this.optionGroups.push({name:"",values:[]})}},{key:"removeOption",value:function(t){this.optionGroups=this.optionGroups.filter((function(e){return e.name!==t})),this.generateVariants()}},{key:"generateVariants",value:function(){var t=this,e=this.optionGroups.reduce((function(t,e){return t+e.values.length}),0)?this.optionGroups.map((function(t){return t.values.map((function(t){return t.name}))})):[["__DEFAULT_VARIANT__"]];this.variants=Object(et.generateAllCombinations)(e).map((function(t){return{id:t.join("|"),values:t}})),this.variants.forEach((function(e){t.variantFormValues[e.id]||(t.variantFormValues[e.id]={optionValues:e.values,enabled:!0,price:t.copyFromDefault(e.id,"price",0),sku:t.copyFromDefault(e.id,"sku",""),stock:t.copyFromDefault(e.id,"stock",0)})})),this.onFormChange()}},{key:"trackByFn",value:function(t,e){return e.values.join("|")}},{key:"handleEnter",value:function(t,e){t.preventDefault(),t.stopPropagation(),e.focus()}},{key:"onFormChange",value:function(){var t=this,e=this.variants.map((function(e){return t.variantFormValues[e.id]})).filter((function(t){return t.enabled}));this.variantsChange.emit({groups:this.optionGroups.map((function(t){return{name:t.name,values:t.values.map((function(t){return t.name}))}})),variants:e})}},{key:"copyFromDefault",value:function(t,e,n){return"__DEFAULT_VARIANT__"!==t?this.variantFormValues.__DEFAULT_VARIANT__[e]:n}}]),t}();Pa.\u0275fac=function(t){return new(t||Pa)(u.cc(m.K))},Pa.\u0275cmp=u.Wb({type:Pa,selectors:[["vdr-generate-product-variants"]],outputs:{variantsChange:"variantsChange"},decls:21,vars:17,consts:[["class","option-groups",4,"ngFor","ngForOf"],[1,"btn","btn-primary-outline","btn-sm",3,"click"],["shape","plus"],[1,"variants-preview"],[1,"table"],[4,"ngIf"],[3,"disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"option-groups"],[1,"name"],["placeholder","e.g. Size","clrInput","","name","name","required","",3,"ngModel","ngModelChange","keydown.enter"],[1,"values"],[3,"ngModel","groupName","disabled","ngModelChange"],["optionValueInputComponent",""],[1,"remove-group"],[1,"btn","btn-icon","btn-warning-outline",3,"title","click"],["shape","trash"],["clrInput","","type","text",3,"ngModel","placeholder","change","ngModelChange"],["clrInput","",3,"ngModel","currencyCode","ngModelChange"],["clrInput","","type","number","min","0","step","1",3,"ngModel","ngModelChange","change"],["type","checkbox","clrCheckbox","",3,"ngModel","change","ngModelChange"]],template:function(t,e){1&t&&(u.Vc(0,Tn,16,13,"div",0),u.ic(1,"button",1),u.pc("click",(function(){return e.addOption()})),u.dc(2,"clr-icon",2),u.Xc(3),u.sc(4,"translate"),u.hc(),u.ic(5,"div",3),u.ic(6,"table",4),u.ic(7,"thead"),u.ic(8,"tr"),u.Vc(9,Xn,3,3,"th",5),u.Vc(10,Gn,3,3,"th",5),u.ic(11,"th"),u.Xc(12),u.sc(13,"translate"),u.hc(),u.ic(14,"th"),u.Xc(15),u.sc(16,"translate"),u.hc(),u.ic(17,"th"),u.Xc(18),u.sc(19,"translate"),u.hc(),u.hc(),u.hc(),u.Vc(20,Un,13,11,"tr",6),u.hc(),u.hc()),2&t&&(u.yc("ngForOf",e.optionGroups),u.Rb(3),u.Zc(" ",u.tc(4,9,"catalog.add-option"),"\n"),u.Rb(6),u.yc("ngIf",1<e.variants.length),u.Rb(1),u.yc("ngIf",1<e.variants.length),u.Rb(2),u.Yc(u.tc(13,11,"catalog.sku")),u.Rb(3),u.Yc(u.tc(16,13,"catalog.price")),u.Rb(3),u.Yc(u.tc(19,15,"catalog.stock-on-hand")),u.Rb(2),u.yc("ngForOf",e.variants)("ngForTrackBy",e.trackByFn))},directives:function(){return[nt.o,dt.o,nt.p,dt.l,dt.u,m.eb,E.b,dt.s,E.z,E.p,E.s,Ia,dt.t,m.F,E.v,E.a,dt.i]},pipes:function(){return[lt.d]},styles:["[_nghost-%COMP%]{display:block;margin-bottom:120px}.option-groups[_ngcontent-%COMP%]{display:flex}.values[_ngcontent-%COMP%]{flex:1;margin:0 6px}.remove-group[_ngcontent-%COMP%]{padding-top:18px}.variants-preview[_ngcontent-%COMP%]   tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fafafa;color:#97979a}"]}),Pa.ctorParameters=function(){return[{type:m.K}]},Pa.propDecorators={variantsChange:[{type:u.O}]};var Fa={provide:E.n,useExisting:Object(u.kb)((function(){return Ia})),multi:!0},Ia=function(){function t(e){f(this,t),this.changeDetector=e,this.groupName="",this.disabled=!1,this.input="",this.isFocussed=!1,this.lastSelected=!1}return h(t,[{key:"registerOnChange",value:function(t){this.onChangeFn=t}},{key:"registerOnTouched",value:function(t){this.onTouchFn=t}},{key:"setDisabledState",value:function(t){this.disabled=t,this.changeDetector.markForCheck()}},{key:"writeValue",value:function(t){this.options=t||[]}},{key:"focus",value:function(){this.textArea.nativeElement.focus()}},{key:"removeOption",value:function(t){t.locked||(this.options=this.options.filter((function(e){return e.name!==t.name})),this.onChangeFn(this.options))}},{key:"handleKey",value:function(t){switch(t.key){case",":case"Enter":this.addOptionValue(),t.preventDefault();break;case"Backspace":this.lastSelected?(this.removeLastOption(),this.lastSelected=!1):""===this.input&&(this.lastSelected=!0);break;default:this.lastSelected=!1}}},{key:"handleBlur",value:function(){this.isFocussed=!1,this.addOptionValue()}},{key:"addOptionValue",value:function(){this.options=Object(at.unique)([].concat(a(this.options),a(this.parseInputIntoOptions(this.input)))),this.input="",this.onChangeFn(this.options)}},{key:"parseInputIntoOptions",value:function(t){return t.split(/[,\n]/).map((function(t){return t.trim()})).filter((function(t){return""!==t})).map((function(t){return{name:t,locked:!1}}))}},{key:"removeLastOption",value:function(){this.options[this.options.length-1].locked||(this.options=this.options.slice(0,this.options.length-1))}}]),t}();Ia.\u0275fac=function(t){return new(t||Ia)(u.cc(u.k))},Ia.\u0275cmp=u.Wb({type:Ia,selectors:[["vdr-option-value-input"]],viewQuery:function(t,e){var n;1&t&&u.Rc(En,!0),2&t&&u.Ic(n=u.qc())&&(e.textArea=n.first)},inputs:{groupName:"groupName"},features:[u.Qb([Fa])],decls:4,vars:5,consts:[[1,"input-wrapper",3,"click"],["class","chips",4,"ngIf"],[3,"ngModel","disabled","keyup","focus","blur","ngModelChange"],["textArea",""],[1,"chips"],[3,"icon","selected","locked","colorFrom","iconClick",4,"ngFor","ngForOf"],[3,"icon","colorFrom","iconClick"]],template:function(t,e){if(1&t){var n=u.jc();u.ic(0,"div",0),u.pc("click",(function(){return u.Mc(n),u.Jc(3).focus()})),u.Vc(1,Yn,2,1,"div",1),u.ic(2,"textarea",2,3),u.pc("keyup",(function(t){return e.handleKey(t)}))("focus",(function(){return e.isFocussed=!0}))("blur",(function(){return e.handleBlur()}))("ngModelChange",(function(t){return e.input=t})),u.hc(),u.hc()}2&t&&(u.Ub("focus",e.isFocussed),u.Rb(1),u.yc("ngIf",0<e.options.length),u.Rb(1),u.yc("ngModel",e.input)("disabled",e.disabled))},directives:[nt.p,m.eb,E.b,E.p,E.s,nt.o,m.B],styles:[".input-wrapper[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #bfc3cc!important;border-radius:3px!important;cursor:text}.input-wrapper.focus[_ngcontent-%COMP%]{border-color:#13b7f3!important;box-shadow:0 0 1px 1px #e3f6fc}.input-wrapper[_ngcontent-%COMP%]   .chips[_ngcontent-%COMP%]{padding:5px}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border:none;height:24px;margin-top:3px;padding:0 6px;width:100%}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:disabled{background-color:#fafafa}vdr-chip[_ngcontent-%COMP%]     .wrapper{margin:0 3px}vdr-chip.locked[_ngcontent-%COMP%]{opacity:.8}vdr-chip.selected[_ngcontent-%COMP%]     .wrapper{border-color:#ff9f07!important;box-shadow:0 0 1px 1px #ffb74d;opacity:.6}"]}),Ia.ctorParameters=function(){return[{type:u.k}]},Ia.propDecorators={groupName:[{type:u.D}],textArea:[{type:u.eb,args:["textArea",{static:!0}]}]};var Va=function(){function t(e,n,c){var a=this;f(this,t),this.modalService=e,this.changeDetector=n,this.viewportRuler=c,this.assets=[],this.compact=!1,this.change=new u.u,this.dropListEnterPredicate=function(t,e){if(e===a.placeholder)return!0;if(e!==a.activeContainer)return!1;var n=a.placeholder.element.nativeElement,c=t.dropContainer.element.nativeElement,r=e.element.nativeElement,i=r.parentElement&&r.parentElement.children,o=xa(i,a.source?n:c),s=xa(i,r);return a.source||(a.sourceIndex=o,a.source=t.dropContainer,n.style.width=c.clientWidth+"px",n.style.height=c.clientHeight+"px",c.parentElement&&c.parentElement.removeChild(c)),a.targetIndex=s,a.target=e,n.style.display="",r.parentElement&&r.parentElement.insertBefore(n,s>o?r.nextSibling:r),a.placeholder._dropListRef.enter(t._dragRef,t.element.nativeElement.offsetLeft,t.element.nativeElement.offsetTop),!1}}return h(t,[{key:"ngAfterViewInit",value:function(){var t=this.placeholder.element.nativeElement;t.style.display="none",t.parentElement&&t.parentElement.removeChild(t)}},{key:"selectAssets",value:function(){var t=this;this.modalService.fromComponent(m.n,{size:"xl"}).subscribe((function(e){e&&e.length&&(t.assets=Object(at.unique)(t.assets.concat(e),"id"),t.featuredAsset||(t.featuredAsset=e[0]),t.emitChangeEvent(t.assets,t.featuredAsset),t.changeDetector.markForCheck())}))}},{key:"setAsFeatured",value:function(t){this.featuredAsset=t,this.emitChangeEvent(this.assets,t)}},{key:"isFeatured",value:function(t){return!!this.featuredAsset&&this.featuredAsset.id===t.id}},{key:"previewAsset",value:function(t){this.modalService.fromComponent(m.p,{size:"xl",closable:!0,locals:{asset:t}}).subscribe()}},{key:"removeAsset",value:function(t){this.assets=this.assets.filter((function(e){return e.id!==t.id})),this.featuredAsset&&this.featuredAsset.id===t.id&&(this.featuredAsset=this.assets.length>0?this.assets[0]:void 0),this.emitChangeEvent(this.assets,this.featuredAsset)}},{key:"emitChangeEvent",value:function(t,e){this.change.emit({assetIds:t.map((function(t){return t.id})),featuredAssetId:e&&e.id})}},{key:"dragMoved",value:function(t){var e=this,n=this.getPointerPositionOnPage(t.event);this.listGroup._items.forEach((function(t){(function(t,e,n){var c=t.element.nativeElement.getBoundingClientRect(),a=c.top,r=c.bottom,i=c.left,o=c.right;return n>=a&&n<=r&&e>=i&&e<=o})(t,n.x,n.y)&&(e.activeContainer=t)}))}},{key:"dropListDropped",value:function(){if(this.target&&this.source){var t=this.placeholder.element.nativeElement,e=t.parentElement;t.style.display="none",e.removeChild(t),e.appendChild(t),e.insertBefore(this.source.element.nativeElement,e.children[this.sourceIndex]),this.target=null,this.source=null,this.sourceIndex!==this.targetIndex&&(Object(ot.f)(this.assets,this.sourceIndex,this.targetIndex),this.emitChangeEvent(this.assets,this.featuredAsset))}}},{key:"getPointerPositionOnPage",value:function(t){var e=function(t){return t.type.startsWith("touch")}(t)?t.touches[0]||t.changedTouches[0]:t,n=this.viewportRuler.getViewportScrollPosition();return{x:e.pageX-n.left,y:e.pageY-n.top}}}]),t}();function xa(t,e){return t?Array.prototype.indexOf.call(t,e):-1}Va.\u0275fac=function(t){return new(t||Va)(u.cc(m.Ab),u.cc(u.k),u.cc(st.d))},Va.\u0275cmp=u.Wb({type:Va,selectors:[["vdr-product-assets"]],viewQuery:function(t,e){var n;1&t&&(u.cd(Zn,!0,ot.d),u.cd(Wn,!0,ot.c)),2&t&&(u.Ic(n=u.qc())&&(e.listGroup=n.first),u.Ic(n=u.qc())&&(e.placeholder=n.first))},hostVars:2,hostBindings:function(t,e){2&t&&u.Ub("compact",e.compact)},inputs:{assets:"assets",compact:"compact",featuredAsset:"featuredAsset"},outputs:{change:"change"},decls:5,vars:2,consts:[["class","card",4,"ngIf","ngIfElse"],["compactView",""],["assetList",""],[1,"card"],[1,"card-img"],[1,"featured-asset"],[3,"src","click",4,"ngIf"],["class","placeholder",4,"ngIf"],[1,"card-block"],[4,"ngTemplateOutlet"],["class","card-footer",4,"vdrIfPermissions"],[3,"src","click"],[1,"placeholder"],["shape","image","size","128"],[1,"card-footer"],[1,"btn",3,"click"],["shape","attachment"],[1,"featured-asset","compact"],["class","compact-select btn btn-icon btn-sm btn-block",3,"title","click",4,"vdrIfPermissions"],["shape","image","size","150"],[1,"compact-select","btn","btn-icon","btn-sm","btn-block",3,"title","click"],["cdkDropListGroup","",1,"all-assets"],["dlg",""],["cdkDropList","",3,"cdkDropListDisabled","cdkDropListEnterPredicate","cdkDropListDropped"],["dl",""],["cdkDropList","",3,"cdkDropListDisabled","cdkDropListEnterPredicate","cdkDropListDropped",4,"ngFor","ngForOf"],["cdkDrag","",3,"cdkDragMoved"],["vdrDropdownTrigger","","tabindex","0",1,"asset-thumb",3,"title"],[3,"src"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"click"],["type","button","vdrDropdownItem","",3,"disabled","click"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",1,"remove-asset",3,"disabled","click"]],template:function(t,e){if(1&t&&(u.Vc(0,Hn,8,4,"div",0),u.Vc(1,cc,5,4,"ng-template",null,1,u.Wc),u.Vc(3,rc,6,7,"ng-template",null,2,u.Wc)),2&t){var n=u.Jc(2);u.yc("ngIf",!e.compact)("ngIfElse",n)}},directives:[nt.p,nt.u,m.rb,dt.o,ot.d,ot.c,nt.o,m.S,ot.a,m.V,m.U,m.T],pipes:[m.q,lt.d,m.ib],styles:["[_nghost-%COMP%]{display:block;width:340px}.compact[_nghost-%COMP%]{width:162px}.placeholder[_ngcontent-%COMP%]{color:#bfc3cc;text-align:center}.featured-asset[_ngcontent-%COMP%]{background:#f2f3f5;cursor:pointer;padding:6px;text-align:center}.featured-asset.compact[_ngcontent-%COMP%]{min-height:40px;padding:6px;position:relative;width:100%}.featured-asset[_ngcontent-%COMP%]   .compact-select[_ngcontent-%COMP%]{bottom:6px;margin:0;position:absolute;right:6px}.all-assets[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.all-assets[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{border:2px solid #f2f3f5;cursor:pointer;margin:3px;padding:0}.all-assets[_ngcontent-%COMP%]   .asset-thumb.featured[_ngcontent-%COMP%]{border-color:#13b7f3}.all-assets[_ngcontent-%COMP%]   .remove-asset[_ngcontent-%COMP%]{color:#ff9f07}.all-assets.compact[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{border-width:1px;margin:1px}.cdk-drag-preview[_ngcontent-%COMP%]{align-items:center;background-color:#fafafa;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);display:flex;justify-content:center;opacity:.9;width:50px}.cdk-drag-placeholder[_ngcontent-%COMP%]{height:50px;opacity:.8;width:60px}.cdk-drag-placeholder[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{background-color:#bfc3cc;height:100%;width:54px}.cdk-drag-placeholder[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:none}.all-assets.compact[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%], .all-assets.compact[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{width:50px}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.all-assets.cdk-drop-list-dragging[_ngcontent-%COMP%]   vdr-dropdown[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0}),Va.ctorParameters=function(){return[{type:m.Ab},{type:u.k},{type:st.d}]},Va.propDecorators={assets:[{type:u.D}],featuredAsset:[{type:u.D}],compact:[{type:u.w,args:["class.compact"]},{type:u.D}],change:[{type:u.O}],listGroup:[{type:u.eb,args:["dlg",{static:!1,read:ot.d}]}],placeholder:[{type:u.eb,args:["dl",{static:!1,read:ot.c}]}]};var Ma=function(){function t(){f(this,t),this.codeInputTouched=!1}return h(t,[{key:"ngOnInit",value:function(){var t,n=this,c=this.productOption.translations.find((function(t){return t.languageCode===n.activeLanguage}));if(this.name=null!==(t=null==c?void 0:c.name)&&void 0!==t?t:"",this.code=this.productOption.code,this.customFieldsForm=new E.i({}),this.customFields){var a,r=c&&c.customFields||{},i=e(this.customFields);try{for(i.s();!(a=i.n()).done;){var o=a.value,s=o.name,l="localeString"===o.type?r[s]:this.productOption.customFields[s];this.customFieldsForm.addControl(o.name,new E.f(l))}}catch(u){i.e(u)}finally{i.f()}}}},{key:"update",value:function(){var t=Object(m.Wb)({translatable:this.productOption,languageCode:this.activeLanguage,updatedFields:{code:this.code,name:this.name,customFields:this.customFieldsForm.value},customFieldConfig:this.customFields,defaultTranslation:{languageCode:this.activeLanguage,name:""}});this.resolveWith(t)}},{key:"cancel",value:function(){this.resolveWith()}},{key:"updateCode",value:function(t){this.codeInputTouched||this.productOption.code||(this.code=Object(tt.normalizeString)(t,"-"))}}]),t}();Ma.\u0275fac=function(t){return new(t||Ma)},Ma.\u0275cmp=u.Wb({type:Ma,selectors:[["vdr-update-product-option-dialog"]],decls:11,vars:9,consts:[["vdrDialogTitle",""],["for","name",3,"label"],["id","name","type","text","required","",3,"ngModel","ngModelChange","input"],["nameInput","ngModel"],["for","code",3,"label"],["id","code","type","text","required","","pattern","[a-z0-9_-]+",3,"ngModel","ngModelChange"],["codeInput","ngModel"],[4,"ngIf"],["vdrDialogButtons",""],[4,"ngFor","ngForOf"],["entityName","ProductOption",3,"customFieldsFormGroup","customField","readonly",4,"ngIf"],["entityName","ProductOption",3,"customFieldsFormGroup","customField","readonly"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,e){1&t&&(u.Vc(0,ic,2,3,"ng-template",0),u.ic(1,"vdr-form-field",1),u.sc(2,"translate"),u.ic(3,"input",2,3),u.pc("ngModelChange",(function(t){return e.name=t}))("input",(function(t){return e.updateCode(t.target.value)})),u.hc(),u.hc(),u.ic(5,"vdr-form-field",4),u.sc(6,"translate"),u.ic(7,"input",5,6),u.pc("ngModelChange",(function(t){return e.code=t})),u.hc(),u.hc(),u.Vc(9,lc,5,4,"section",7),u.Vc(10,uc,6,7,"ng-template",8)),2&t&&(u.Rb(1),u.yc("label",u.tc(2,5,"catalog.option-name")),u.Rb(2),u.yc("ngModel",e.name),u.Rb(2),u.yc("label",u.tc(6,7,"common.code")),u.Rb(2),u.yc("ngModel",e.code),u.Rb(2),u.yc("ngIf",e.customFields.length))},directives:[m.Q,m.db,m.eb,E.b,E.z,E.p,E.s,E.w,nt.p,m.P,dt.u,nt.o,m.H],pipes:[lt.d,m.ib],styles:[""],changeDetection:0});var Ra=function(){function t(e,n,c){f(this,t),this.changeDetector=e,this.modalService=n,this.dataService=c,this.assetChange=new u.u,this.selectionChange=new u.u,this.selectFacetValueClick=new u.u,this.updateProductOption=new u.u,this.selectedVariantIds=[],this.pagination={currentPage:1,itemsPerPage:10},this.formGroupMap=new Map,this.GlobalFlag=m.hb}return h(t,[{key:"ngOnInit",value:function(){var t=this;this.dataService.settings.getGlobalSettings("cache-first").single$.subscribe((function(e){var n=e.globalSettings;t.globalTrackInventory=n.trackInventory,t.globalOutOfStockThreshold=n.outOfStockThreshold,t.changeDetector.markForCheck()})),this.subscription=this.formArray.valueChanges.subscribe((function(){return t.changeDetector.markForCheck()})),this.subscription.add(this.formArray.valueChanges.pipe(Object(b.a)((function(t){return t.length})),Object(y.a)(1),Object(F.a)()).subscribe((function(){t.buildFormGroupMap()}))),this.buildFormGroupMap()}},{key:"ngOnChanges",value:function(t){var e,n;"facets"in t&&t.facets.currentValue&&(this.facetValues=Object(m.Zb)(this.facets)),"variants"in t&&(null===(e=t.variants.currentValue)||void 0===e?void 0:e.length)!==(null===(n=t.variants.previousValue)||void 0===n?void 0:n.length)&&(this.pagination.currentPage=1)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"trackById",value:function(t,e){return e.id}},{key:"inventoryIsNotTracked",value:function(t){var e,n=null===(e=t.get("trackInventory"))||void 0===e?void 0:e.value;return n===m.hb.FALSE||n===m.hb.INHERIT&&!1===this.globalTrackInventory}},{key:"getTaxCategoryName",value:function(t){var e=t.get(["taxCategoryId"]);if(e&&this.taxCategories){var n=this.taxCategories.find((function(t){return t.id===e.value}));return n?n.name:""}return""}},{key:"getSaleableStockLevel",value:function(t){var e=t.useGlobalOutOfStockThreshold?this.globalOutOfStockThreshold:t.outOfStockThreshold;return t.stockOnHand-t.stockAllocated-e}},{key:"areAllSelected",value:function(){return!!this.variants&&this.selectedVariantIds.length===this.variants.length}},{key:"onAssetChange",value:function(t,e){this.assetChange.emit(Object.assign({variantId:t},e));var n=this.variants.findIndex((function(e){return e.id===t}));this.formArray.at(n).markAsDirty()}},{key:"toggleSelectAll",value:function(){this.areAllSelected()?this.selectedVariantIds=[]:this.selectedVariantIds=this.variants.map((function(t){return t.id})),this.selectionChange.emit(this.selectedVariantIds)}},{key:"toggleSelectVariant",value:function(t){var e=this.selectedVariantIds.indexOf(t);-1<e?this.selectedVariantIds.splice(e,1):this.selectedVariantIds.push(t),this.selectionChange.emit(this.selectedVariantIds)}},{key:"optionGroupName",value:function(t){var e,n=this,c=this.optionGroups.find((function(e){return e.id===t}));if(c)return(null!==(e=null==c?void 0:c.translations.find((function(t){return t.languageCode===n.activeLanguage})))&&void 0!==e?e:c.translations[0]).name}},{key:"optionName",value:function(t){var e,n=this;return(null!==(e=t.translations.find((function(t){return t.languageCode===n.activeLanguage})))&&void 0!==e?e:t.translations[0]).name}},{key:"pendingFacetValues",value:function(t){var e=this;if(this.facets){var n=this.getFacetValueIds(t.id),c=t.facetValues.map((function(t){return t.id}));return n.filter((function(t){return!c.includes(t)})).map((function(t){return e.facetValues.find((function(e){return e.id===t}))})).filter(et.notNullOrUndefined)}return[]}},{key:"existingFacetValues",value:function(t){return a(this.getFacetValueIds(t.id)).filter((function(e){return t.facetValues.map((function(t){return t.id})).includes(e)})).map((function(e){return t.facetValues.find((function(t){return t.id===e}))})).filter(et.notNullOrUndefined)}},{key:"removeFacetValue",value:function(t,e){var n=this.formGroupMap.get(t.id);if(n){var c=n.value.facetValueIds.filter((function(t){return t!==e}));n.patchValue({facetValueIds:c}),n.markAsDirty()}}},{key:"isVariantSelected",value:function(t){return-1<this.selectedVariantIds.indexOf(t)}},{key:"editOption",value:function(t){var e=this;this.modalService.fromComponent(Ma,{size:"md",locals:{productOption:t,activeLanguage:this.activeLanguage,customFields:this.customOptionFields}}).subscribe((function(t){t&&e.updateProductOption.emit(t)}))}},{key:"buildFormGroupMap",value:function(){this.formGroupMap.clear();var t,n=e(this.formArray.controls);try{for(n.s();!(t=n.n()).done;){var c=t.value;this.formGroupMap.set(c.value.id,c)}}catch(a){n.e(a)}finally{n.f()}this.changeDetector.markForCheck()}},{key:"getFacetValueIds",value:function(t){var e;return(null===(e=this.formGroupMap.get(t))||void 0===e?void 0:e.value).facetValueIds}}]),t}();Ra.\u0275fac=function(t){return new(t||Ra)(u.cc(u.k),u.cc(m.Ab),u.cc(m.K))},Ra.\u0275cmp=u.Wb({type:Ra,selectors:[["vdr-product-variants-list"]],inputs:{formArray:["productVariantsFormArray","formArray"],variants:"variants",taxCategories:"taxCategories",facets:"facets",optionGroups:"optionGroups",customFields:"customFields",customOptionFields:"customOptionFields",activeLanguage:"activeLanguage"},outputs:{assetChange:"assetChange",selectionChange:"selectionChange",selectFacetValueClick:"selectFacetValueClick",updateProductOption:"updateProductOption"},features:[u.Pb],decls:6,vars:8,consts:[[1,"variants-list"],["class","variant-container card",3,"disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"table-footer"],[3,"itemsPerPage","itemsPerPageChange"],[3,"currentPage","itemsPerPage","pageChange"],[1,"variant-container","card"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"card-block","header-row"],[1,"details"],[1,"sku",3,"readonly"],["clrInput","","type","text","formControlName","sku",3,"readonly","placeholder"],[1,"name",3,"readonly"],["clrInput","","type","text","formControlName","name",3,"readonly","placeholder"],[1,"right-controls"],[4,"vdrIfPermissions"],[1,"card-block"],[1,"variant-body"],[1,"assets"],[3,"compact","assets","featuredAsset","change"],[1,"variant-form-inputs"],[1,"standard-fields"],[1,"variant-form-input-row"],[1,"tax-category"],[4,"vdrIfPermissions","vdrIfPermissionsElse"],["taxCategoryLabel",""],[1,"price"],["clrInput","","formControlName","price",3,"currencyCode","readonly"],[3,"price","currencyCode","priceIncludesTax","taxCategoryId"],[3,"content"],["clrInput","","type","number","min","0","step","1","formControlName","stockOnHand",3,"readonly","vdrDisabled"],[1,"clr-control-label"],[1,"value"],[1,"out-of-stock-threshold-wrapper"],[1,"flex"],["clrInput","","type","number",3,"formControl","readonly","vdrDisabled"],["type","checkbox","clrToggle","","name","useGlobalOutOfStockThreshold","formControlName","useGlobalOutOfStockThreshold",3,"vdrDisabled"],[1,"custom-fields"],["formGroupName","customFields",4,"ngIf"],[1,"options-facets"],[3,"entity"],[4,"ngIf"],[1,"flex-spacer"],[1,"facets"],[3,"facetValue","removable","remove",4,"ngFor","ngForOf"],["class","btn btn-sm btn-secondary",3,"click",4,"vdrIfPermissions"],["type","checkbox","clrToggle","","name","enabled","formControlName","enabled"],["clrSelect","","name","options","formControlName","taxCategoryId"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"tax-category-label"],["clrSelect","","name","options","formControlName","trackInventory"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","ProductVariant",3,"compact","customFieldsFormGroup","readonly","customField",4,"ngIf"],["entityName","ProductVariant",3,"compact","customFieldsFormGroup","readonly","customField"],[1,"options"],[3,"colorFrom","invert","icon","iconClick",4,"ngFor","ngForOf"],[3,"colorFrom","invert","icon","iconClick"],[1,"option-group-name"],[3,"facetValue","removable","remove"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"]],template:function(t,e){1&t&&(u.ic(0,"div",0),u.Vc(1,Vc,2,3,"div",1),u.sc(2,"paginate"),u.ic(3,"div",2),u.ic(4,"vdr-items-per-page-controls",3),u.pc("itemsPerPageChange",(function(t){return e.pagination.itemsPerPage=t})),u.hc(),u.ic(5,"vdr-pagination-controls",4),u.pc("pageChange",(function(t){return e.pagination.currentPage=t})),u.hc(),u.hc(),u.hc()),2&t&&(u.Rb(1),u.yc("ngForOf",u.uc(2,5,e.variants,e.pagination))("ngForTrackBy",e.trackById),u.Rb(3),u.yc("itemsPerPage",e.pagination.itemsPerPage),u.Rb(1),u.yc("currentPage",e.pagination.currentPage)("itemsPerPage",e.pagination.itemsPerPage))},directives:function(){return[nt.o,dt.l,m.sb,m.Eb,nt.p,E.q,E.j,m.Sb,dt.t,m.eb,E.b,dt.s,E.p,E.h,m.rb,Va,dt.u,m.F,wa,m.kb,E.v,m.R,E.g,dt.k,E.a,dt.i,m.ab,dt.B,E.A,dt.A,E.u,E.D,E.k,m.H,m.B,m.bb,dt.o]},pipes:function(){return[ut.b,m.ib,lt.d,m.Mb]},styles:[".with-selected[_ngcontent-%COMP%]{align-items:center;border:1px solid #f2f3f5;border-radius:3px;display:flex;min-height:52px;padding:6px 18px}.with-selected[_ngcontent-%COMP%] > label[_ngcontent-%COMP%], .with-selected[_ngcontent-%COMP%]   vdr-select-toggle[_ngcontent-%COMP%]{margin-right:12px}.variant-container[_ngcontent-%COMP%]{min-height:330px;transition:background-color .2s}.variant-container.disabled[_ngcontent-%COMP%]{background-color:#f2f3f5}.variant-container[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]{align-items:center;display:flex;flex-wrap:wrap}.variant-container[_ngcontent-%COMP%]   .variant-body[_ngcontent-%COMP%]{display:flex;flex-direction:column}@media screen and (min-width:768px){.variant-container[_ngcontent-%COMP%]   .variant-body[_ngcontent-%COMP%]{flex-direction:row}}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;margin-right:12px}@media screen and (min-width:768px){.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{flex-direction:row;height:36px}}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:1}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]     .clr-control-container{width:100%}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]     .clr-control-container input.clr-input{min-width:100%}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .sku[_ngcontent-%COMP%]{flex:0;margin-right:20px;width:160px}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]     .name input{min-width:300px}.variant-container[_ngcontent-%COMP%]   .right-controls[_ngcontent-%COMP%]{display:flex}.variant-container[_ngcontent-%COMP%]   .tax-category-label[_ngcontent-%COMP%]{margin-top:3px}.variant-container[_ngcontent-%COMP%]   .variant-form-inputs[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column}@media screen and (min-width:768px){.variant-container[_ngcontent-%COMP%]   .variant-form-inputs[_ngcontent-%COMP%]{flex-direction:row}}.variant-container[_ngcontent-%COMP%]   .variant-form-input-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}@media screen and (min-width:768px){.variant-container[_ngcontent-%COMP%]   .variant-form-input-row[_ngcontent-%COMP%]{margin:0 6px 8px 24px}}.variant-container[_ngcontent-%COMP%]   .variant-form-input-row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-bottom:24px;margin-right:24px}.variant-container[_ngcontent-%COMP%]   .track-inventory-toggle[_ngcontent-%COMP%]{margin-top:22px}.variant-container[_ngcontent-%COMP%]   .clr-form-control[_ngcontent-%COMP%]{margin-top:0}.variant-container[_ngcontent-%COMP%]   .facets[_ngcontent-%COMP%]{align-items:center;display:flex}.variant-container[_ngcontent-%COMP%]   .pricing[_ngcontent-%COMP%]{display:flex}.variant-container[_ngcontent-%COMP%]   .pricing[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-right:12px}.variant-container[_ngcontent-%COMP%]   .option-group-name[_ngcontent-%COMP%]{color:#97979a;font-size:10px;height:11px;margin-right:3px;text-transform:uppercase}.variant-container[_ngcontent-%COMP%]   .options-facets[_ngcontent-%COMP%]{color:#97979a;display:flex}.out-of-stock-threshold-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.out-of-stock-threshold-wrapper[_ngcontent-%COMP%]   clr-toggle-wrapper[_ngcontent-%COMP%]{margin-left:24px}.inventory-untracked[_ngcontent-%COMP%]{opacity:.5}.table-footer[_ngcontent-%COMP%]{align-items:baseline;display:flex;justify-content:space-between;margin-top:6px}"],changeDetection:0}),Ra.ctorParameters=function(){return[{type:u.k},{type:m.Ab},{type:m.K}]},Ra.propDecorators={formArray:[{type:u.D,args:["productVariantsFormArray"]}],variants:[{type:u.D}],taxCategories:[{type:u.D}],facets:[{type:u.D}],optionGroups:[{type:u.D}],customFields:[{type:u.D}],customOptionFields:[{type:u.D}],activeLanguage:[{type:u.D}],assetChange:[{type:u.O}],selectionChange:[{type:u.O}],selectFacetValueClick:[{type:u.O}],updateProductOption:[{type:u.O}]};var ja=function(){function t(e){f(this,t),this.changeDetector=e,this.formGroupMap=new Map}return h(t,[{key:"ngOnInit",value:function(){var t=this;this.subscription=this.formArray.valueChanges.pipe(Object(b.a)((function(t){return t.length})),Object(y.a)(1),Object(F.a)()).subscribe((function(){t.buildFormGroupMap()})),this.buildFormGroupMap()}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"optionGroupName",value:function(t){var e=this.optionGroups.find((function(e){return e.id===t}));return e&&e.name}},{key:"buildFormGroupMap",value:function(){this.formGroupMap.clear();var t,n=e(this.formArray.controls);try{for(n.s();!(t=n.n()).done;){var c=t.value;this.formGroupMap.set(c.value.id,c)}}catch(a){n.e(a)}finally{n.f()}this.changeDetector.markForCheck()}}]),t}();ja.\u0275fac=function(t){return new(t||ja)(u.cc(u.k))},ja.\u0275cmp=u.Wb({type:ja,selectors:[["vdr-product-variants-table"]],inputs:{formArray:["productVariantsFormArray","formArray"],variants:"variants",optionGroups:"optionGroups"},decls:20,vars:20,consts:[[3,"items"],[4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"left","align-middle"],[1,"card-img"],[1,"featured-asset"],[3,"src",4,"ngIf"],["class","placeholder",4,"ngIf"],["clrInput","","type","text","formControlName","name",3,"readonly","placeholder"],["clrInput","","type","text","formControlName","sku",3,"readonly","placeholder"],[1,"left","align-middle","price"],["clrInput","","formControlName","price",3,"currencyCode","readonly"],[1,"left","align-middle","stock"],["clrInput","","type","number","min","0","step","1","formControlName","stockOnHand",3,"readonly"],["type","checkbox","clrToggle","","name","enabled","formControlName","enabled",3,"vdrDisabled"],[3,"src"],[1,"placeholder"],["shape","image","size","48"]],template:function(t,e){1&t&&(u.ic(0,"vdr-data-table",0),u.dc(1,"vdr-dt-column"),u.ic(2,"vdr-dt-column"),u.Xc(3),u.sc(4,"translate"),u.hc(),u.ic(5,"vdr-dt-column"),u.Xc(6),u.sc(7,"translate"),u.hc(),u.Vc(8,xc,3,1,"ng-container",1),u.sc(9,"sort"),u.ic(10,"vdr-dt-column"),u.Xc(11),u.sc(12,"translate"),u.hc(),u.ic(13,"vdr-dt-column"),u.Xc(14),u.sc(15,"translate"),u.hc(),u.ic(16,"vdr-dt-column"),u.Xc(17),u.sc(18,"translate"),u.hc(),u.Vc(19,Dc,1,1,"ng-template"),u.hc()),2&t&&(u.yc("items",e.variants),u.Rb(3),u.Yc(u.tc(4,7,"common.name")),u.Rb(3),u.Yc(u.tc(7,9,"catalog.sku")),u.Rb(2),u.yc("ngForOf",u.uc(9,11,e.optionGroups,"id")),u.Rb(3),u.Yc(u.tc(12,14,"catalog.price")),u.Rb(3),u.Yc(u.tc(15,16,"catalog.stock-on-hand")),u.Rb(3),u.Yc(u.tc(18,18,"common.enabled")))},directives:[m.M,m.L,nt.o,nt.p,E.q,E.j,dt.t,m.eb,E.b,dt.s,E.p,E.h,m.F,E.v,dt.k,E.a,dt.i,m.R,dt.o],pipes:[lt.d,m.Mb,m.ib,m.q,m.Ob],styles:[".placeholder[_ngcontent-%COMP%]{color:#bfc3cc}.price[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .stock[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:96px}td[_ngcontent-%COMP%]{transition:background-color .2s}td.disabled[_ngcontent-%COMP%]{background-color:#f2f3f5}"],changeDetection:0}),ja.ctorParameters=function(){return[{type:u.k}]},ja.propDecorators={formArray:[{type:u.D,args:["productVariantsFormArray"]}],variants:[{type:u.D}],optionGroups:[{type:u.D}]};var wa=function(){function t(e){f(this,t),this.dataService=e,this.priceChange$=new W.a(0),this.taxCategoryIdChange$=new W.a("")}return h(t,[{key:"ngOnInit",value:function(){var t=this.dataService.settings.getTaxRates(99999,0,"cache-first").mapStream((function(t){return t.taxRates.items})),e=this.dataService.settings.getActiveChannel("cache-first").mapStream((function(t){return t.activeChannel}));this.taxRate$=Object(Y.a)(e,t,this.taxCategoryIdChange$).pipe(Object(b.a)((function(t){var e=n(t,3),c=e[0],a=e[1],r=e[2],i=c.defaultTaxZone;if(!i)return 0;var o=a.find((function(t){return t.zone.id===i.id&&t.category.id===r}));return o?o.value:0}))),this.grossPrice$=Object(Y.a)(this.taxRate$,this.priceChange$).pipe(Object(b.a)((function(t){var e=n(t,2),c=e[0],a=e[1];return Math.round(a*((100+c)/100))/100})))}},{key:"ngOnChanges",value:function(t){"price"in t&&this.priceChange$.next(t.price.currentValue),"taxCategoryId"in t&&this.taxCategoryIdChange$.next(t.taxCategoryId.currentValue)}}]),t}();wa.\u0275fac=function(t){return new(t||wa)(u.cc(m.K))},wa.\u0275cmp=u.Wb({type:wa,selectors:[["vdr-variant-price-detail"]],inputs:{priceIncludesTax:"priceIncludesTax",price:"price",currencyCode:"currencyCode",taxCategoryId:"taxCategoryId"},features:[u.Pb],decls:5,vars:5,consts:[[1,"clr-control-label"],["class","value",4,"ngIf"],[1,"value"]],template:function(t,e){1&t&&(u.ic(0,"label",0),u.Xc(1),u.sc(2,"translate"),u.hc(),u.Vc(3,_c,4,8,"div",1),u.Vc(4,$c,6,14,"div",1)),2&t&&(u.Rb(1),u.Yc(u.tc(2,3,"catalog.taxes")),u.Rb(2),u.yc("ngIf",e.priceIncludesTax),u.Rb(1),u.yc("ngIf",!e.priceIncludesTax))},directives:[dt.u,nt.p],pipes:[lt.d,nt.b,nt.d],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.value[_ngcontent-%COMP%]{margin-top:3px}"],changeDetection:0}),wa.ctorParameters=function(){return[{type:m.K}]},wa.propDecorators={priceIncludesTax:[{type:u.D}],price:[{type:u.D}],currencyCode:[{type:u.D}],taxCategoryId:[{type:u.D}]};var Da=function t(){f(this,t)};Da.\u0275mod=u.ac({type:Da}),Da.\u0275inj=u.Zb({factory:function(t){return new(t||Da)},imports:[[m.Kb,g.i.forChild(ga)]]})}}])}();