!function(){function e(){var t=w(["\n    query GetReview($id: ID!) {\n        productReview(id: $id) {\n            ...ProductReview\n            product {\n                id\n                name\n                featuredAsset {\n                    id\n                    preview\n                }\n            }\n            productVariant {\n                id\n                name\n                featuredAsset {\n                    id\n                    preview\n                }\n            }\n        }\n    }\n    ","\n"]);return e=function(){return t},t}function t(){var e=w(["\n    query GetProductName($id: ID!) {\n        product(id: $id) {\n            id\n            name\n        }\n    }\n"]);return t=function(){return e},e}function n(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(){var e=w(["\n    query GetReviewsHistogram($id: ID!) {\n        product(id: $id) {\n            id\n            name\n            featuredAsset {\n                id\n                preview\n            }\n            customFields {\n                reviewRating\n                reviewCount\n            }\n            reviewsHistogram {\n                bin\n                frequency\n            }\n        }\n    }\n"]);return i=function(){return e},e}function c(){var e=w(["\n    query GetReviewForProduct($productId: ID!, $options: ProductReviewListOptions) {\n        product(id: $productId) {\n            id\n            reviews(options: $options) {\n                items {\n                    ...ProductReview\n                }\n                totalItems\n            }\n        }\n    }\n    ","\n"]);return c=function(){return e},e}function a(){var e=w(["\n    mutation RejectReview($id: ID!) {\n        rejectProductReview(id: $id) {\n            id\n            state\n        }\n    }\n"]);return a=function(){return e},e}function o(){var e=w(["\n    mutation ApproveReview($id: ID!) {\n        approveProductReview(id: $id) {\n            id\n            state\n            product {\n                id\n                customFields {\n                    reviewCount\n                    reviewRating\n                }\n            }\n        }\n    }\n"]);return o=function(){return e},e}function s(){var e=w(["\n    mutation UpdateReview($input: UpdateProductReviewInput!) {\n        updateProductReview(input: $input) {\n            ...ProductReview\n        }\n    }\n    ","\n"]);return s=function(){return e},e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}function y(){var e=w(["\n    query GetAllReviews($options: ProductReviewListOptions) {\n        productReviews(options: $options) {\n            items {\n                ...ProductReview\n                product {\n                    id\n                    name\n                    featuredAsset {\n                        id\n                        preview\n                    }\n                }\n            }\n            totalItems\n        }\n    }\n    ","\n"]);return y=function(){return e},e}function R(){var e=w(["\n    fragment ProductReview on ProductReview {\n        id\n        createdAt\n        updatedAt\n        authorName\n        authorLocation\n        summary\n        body\n        rating\n        state\n        upvotes\n        downvotes\n        response\n        responseCreatedAt\n    }\n"]);return R=function(){return e},e}function w(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"5lmp":function(r,d,f){"use strict";f.r(d),f.d(d,"ReviewsUiLazyModule",(function(){return Ie})),f.d(d,"productReviewsBreadcrumb",(function(){return Te})),f.d(d,"reviewDetailBreadcrumb",(function(){return Be}));var v,w,P,C,S,O,D,k,A,N,M=f("sEIs"),I=f("YtkY"),T=f("ixhn");!function(e){e.Tax="TAX",e.Promotion="PROMOTION",e.Shipping="SHIPPING",e.Refund="REFUND",e.TaxRefund="TAX_REFUND",e.PromotionRefund="PROMOTION_REFUND",e.ShippingRefund="SHIPPING_REFUND"}(v||(v={})),function(e){e.Image="IMAGE",e.Video="VIDEO",e.Binary="BINARY"}(w||(w={})),function(e){e.Aed="AED",e.Afn="AFN",e.All="ALL",e.Amd="AMD",e.Ang="ANG",e.Aoa="AOA",e.Ars="ARS",e.Aud="AUD",e.Awg="AWG",e.Azn="AZN",e.Bam="BAM",e.Bbd="BBD",e.Bdt="BDT",e.Bgn="BGN",e.Bhd="BHD",e.Bif="BIF",e.Bmd="BMD",e.Bnd="BND",e.Bob="BOB",e.Brl="BRL",e.Bsd="BSD",e.Btn="BTN",e.Bwp="BWP",e.Byn="BYN",e.Bzd="BZD",e.Cad="CAD",e.Cdf="CDF",e.Chf="CHF",e.Clp="CLP",e.Cny="CNY",e.Cop="COP",e.Crc="CRC",e.Cuc="CUC",e.Cup="CUP",e.Cve="CVE",e.Czk="CZK",e.Djf="DJF",e.Dkk="DKK",e.Dop="DOP",e.Dzd="DZD",e.Egp="EGP",e.Ern="ERN",e.Etb="ETB",e.Eur="EUR",e.Fjd="FJD",e.Fkp="FKP",e.Gbp="GBP",e.Gel="GEL",e.Ghs="GHS",e.Gip="GIP",e.Gmd="GMD",e.Gnf="GNF",e.Gtq="GTQ",e.Gyd="GYD",e.Hkd="HKD",e.Hnl="HNL",e.Hrk="HRK",e.Htg="HTG",e.Huf="HUF",e.Idr="IDR",e.Ils="ILS",e.Inr="INR",e.Iqd="IQD",e.Irr="IRR",e.Isk="ISK",e.Jmd="JMD",e.Jod="JOD",e.Jpy="JPY",e.Kes="KES",e.Kgs="KGS",e.Khr="KHR",e.Kmf="KMF",e.Kpw="KPW",e.Krw="KRW",e.Kwd="KWD",e.Kyd="KYD",e.Kzt="KZT",e.Lak="LAK",e.Lbp="LBP",e.Lkr="LKR",e.Lrd="LRD",e.Lsl="LSL",e.Lyd="LYD",e.Mad="MAD",e.Mdl="MDL",e.Mga="MGA",e.Mkd="MKD",e.Mmk="MMK",e.Mnt="MNT",e.Mop="MOP",e.Mru="MRU",e.Mur="MUR",e.Mvr="MVR",e.Mwk="MWK",e.Mxn="MXN",e.Myr="MYR",e.Mzn="MZN",e.Nad="NAD",e.Ngn="NGN",e.Nio="NIO",e.Nok="NOK",e.Npr="NPR",e.Nzd="NZD",e.Omr="OMR",e.Pab="PAB",e.Pen="PEN",e.Pgk="PGK",e.Php="PHP",e.Pkr="PKR",e.Pln="PLN",e.Pyg="PYG",e.Qar="QAR",e.Ron="RON",e.Rsd="RSD",e.Rub="RUB",e.Rwf="RWF",e.Sar="SAR",e.Sbd="SBD",e.Scr="SCR",e.Sdg="SDG",e.Sek="SEK",e.Sgd="SGD",e.Shp="SHP",e.Sll="SLL",e.Sos="SOS",e.Srd="SRD",e.Ssp="SSP",e.Stn="STN",e.Svc="SVC",e.Syp="SYP",e.Szl="SZL",e.Thb="THB",e.Tjs="TJS",e.Tmt="TMT",e.Tnd="TND",e.Top="TOP",e.Try="TRY",e.Ttd="TTD",e.Twd="TWD",e.Tzs="TZS",e.Uah="UAH",e.Ugx="UGX",e.Usd="USD",e.Uyu="UYU",e.Uzs="UZS",e.Ves="VES",e.Vnd="VND",e.Vuv="VUV",e.Wst="WST",e.Xaf="XAF",e.Xcd="XCD",e.Xof="XOF",e.Xpf="XPF",e.Yer="YER",e.Zar="ZAR",e.Zmw="ZMW",e.Zwl="ZWL"}(P||(P={})),function(e){e.Deleted="DELETED",e.NotDeleted="NOT_DELETED"}(C||(C={})),function(e){e.OrderStateTransition="ORDER_STATE_TRANSITION",e.OrderPaymentTransition="ORDER_PAYMENT_TRANSITION",e.OrderFullfillment="ORDER_FULLFILLMENT",e.OrderCancellation="ORDER_CANCELLATION",e.OrderRefundTransition="ORDER_REFUND_TRANSITION",e.OrderNote="ORDER_NOTE",e.OrderCouponApplied="ORDER_COUPON_APPLIED",e.OrderCouponRemoved="ORDER_COUPON_REMOVED"}(S||(S={})),function(e){e.Pending="PENDING",e.Running="RUNNING",e.Completed="COMPLETED",e.Retrying="RETRYING",e.Failed="FAILED"}(O||(O={})),function(e){e.Aa="aa",e.Ab="ab",e.Af="af",e.Ak="ak",e.Sq="sq",e.Am="am",e.Ar="ar",e.An="an",e.Hy="hy",e.As="as",e.Av="av",e.Ae="ae",e.Ay="ay",e.Az="az",e.Ba="ba",e.Bm="bm",e.Eu="eu",e.Be="be",e.Bn="bn",e.Bh="bh",e.Bi="bi",e.Bs="bs",e.Br="br",e.Bg="bg",e.My="my",e.Ca="ca",e.Ch="ch",e.Ce="ce",e.Zh="zh",e.Cu="cu",e.Cv="cv",e.Kw="kw",e.Co="co",e.Cr="cr",e.Cs="cs",e.Da="da",e.Dv="dv",e.Nl="nl",e.Dz="dz",e.En="en",e.Eo="eo",e.Et="et",e.Ee="ee",e.Fo="fo",e.Fj="fj",e.Fi="fi",e.Fr="fr",e.Fy="fy",e.Ff="ff",e.Ka="ka",e.De="de",e.Gd="gd",e.Ga="ga",e.Gl="gl",e.Gv="gv",e.El="el",e.Gn="gn",e.Gu="gu",e.Ht="ht",e.Ha="ha",e.He="he",e.Hz="hz",e.Hi="hi",e.Ho="ho",e.Hr="hr",e.Hu="hu",e.Ig="ig",e.Is="is",e.Io="io",e.Ii="ii",e.Iu="iu",e.Ie="ie",e.Ia="ia",e.Id="id",e.Ik="ik",e.It="it",e.Jv="jv",e.Ja="ja",e.Kl="kl",e.Kn="kn",e.Ks="ks",e.Kr="kr",e.Kk="kk",e.Km="km",e.Ki="ki",e.Rw="rw",e.Ky="ky",e.Kv="kv",e.Kg="kg",e.Ko="ko",e.Kj="kj",e.Ku="ku",e.Lo="lo",e.La="la",e.Lv="lv",e.Li="li",e.Ln="ln",e.Lt="lt",e.Lb="lb",e.Lu="lu",e.Lg="lg",e.Mk="mk",e.Mh="mh",e.Ml="ml",e.Mi="mi",e.Mr="mr",e.Ms="ms",e.Mg="mg",e.Mt="mt",e.Mn="mn",e.Na="na",e.Nv="nv",e.Nr="nr",e.Nd="nd",e.Ng="ng",e.Ne="ne",e.Nn="nn",e.Nb="nb",e.No="no",e.Ny="ny",e.Oc="oc",e.Oj="oj",e.Or="or",e.Om="om",e.Os="os",e.Pa="pa",e.Fa="fa",e.Pi="pi",e.Pl="pl",e.Pt="pt",e.Ps="ps",e.Qu="qu",e.Rm="rm",e.Ro="ro",e.Rn="rn",e.Ru="ru",e.Sg="sg",e.Sa="sa",e.Si="si",e.Sk="sk",e.Sl="sl",e.Se="se",e.Sm="sm",e.Sn="sn",e.Sd="sd",e.So="so",e.St="st",e.Es="es",e.Sc="sc",e.Sr="sr",e.Ss="ss",e.Su="su",e.Sw="sw",e.Sv="sv",e.Ty="ty",e.Ta="ta",e.Tt="tt",e.Te="te",e.Tg="tg",e.Tl="tl",e.Th="th",e.Bo="bo",e.Ti="ti",e.To="to",e.Tn="tn",e.Ts="ts",e.Tk="tk",e.Tr="tr",e.Tw="tw",e.Ug="ug",e.Uk="uk",e.Ur="ur",e.Uz="uz",e.Ve="ve",e.Vi="vi",e.Vo="vo",e.Cy="cy",e.Wa="wa",e.Wo="wo",e.Xh="xh",e.Yi="yi",e.Yo="yo",e.Za="za",e.Zu="zu"}(D||(D={})),function(e){e.Authenticated="Authenticated",e.SuperAdmin="SuperAdmin",e.Owner="Owner",e.Public="Public",e.CreateCatalog="CreateCatalog",e.ReadCatalog="ReadCatalog",e.UpdateCatalog="UpdateCatalog",e.DeleteCatalog="DeleteCatalog",e.CreateCustomer="CreateCustomer",e.ReadCustomer="ReadCustomer",e.UpdateCustomer="UpdateCustomer",e.DeleteCustomer="DeleteCustomer",e.CreateAdministrator="CreateAdministrator",e.ReadAdministrator="ReadAdministrator",e.UpdateAdministrator="UpdateAdministrator",e.DeleteAdministrator="DeleteAdministrator",e.CreateOrder="CreateOrder",e.ReadOrder="ReadOrder",e.UpdateOrder="UpdateOrder",e.DeleteOrder="DeleteOrder",e.CreatePromotion="CreatePromotion",e.ReadPromotion="ReadPromotion",e.UpdatePromotion="UpdatePromotion",e.DeletePromotion="DeletePromotion",e.CreateSettings="CreateSettings",e.ReadSettings="ReadSettings",e.UpdateSettings="UpdateSettings",e.DeleteSettings="DeleteSettings"}(k||(k={})),function(e){e.Asc="ASC",e.Desc="DESC"}(A||(A={})),function(e){e.Adjustment="ADJUSTMENT",e.Sale="SALE",e.Cancellation="CANCELLATION",e.Return="RETURN"}(N||(N={}));var B,E=f("H5qd"),F=f.n(E),L=F.a(R()),j=F.a(y(),L),U=f("EM62"),x=f("nIj0"),K=f("Kej3"),G=f("CwY5"),_=f("2kYt"),X=((B=function(){function e(){h(this,e)}return b(e,[{key:"getIcon",value:function(e){switch(e){case"new":return"bubble-exclamation";case"approved":return"check-circle";case"rejected":return"times-circle"}}}]),e}()).\u0275fac=function(e){return new(e||B)},B.\u0275cmp=U.Wb({type:B,selectors:[["kb-review-state-label"]],inputs:{state:"state"},decls:4,vars:5,consts:[[1,"state-icon",3,"ngClass"]],template:function(e,t){1&e&&(U.ic(0,"vdr-chip"),U.dc(1,"clr-icon",0),U.Xc(2),U.sc(3,"titlecase"),U.hc()),2&e&&(U.Rb(1),U.yc("ngClass",t.state),U.Sb("shape",t.getIcon(t.state)),U.Rb(1),U.Zc(" ",U.tc(3,3,t.state),"\n"))},directives:[T.B,K.o,_.n],pipes:[_.z],styles:[".state-icon[_ngcontent-%COMP%]{margin-right:3px}.state-icon.new[_ngcontent-%COMP%]{color:#ff9f07}.state-icon.approved[_ngcontent-%COMP%]{color:#308300}.state-icon.rejected[_ngcontent-%COMP%]{color:#c92100}"],changeDetection:0}),B),$=f("s2Ay"),H=function(e){return["/extensions","product-reviews",e]};function q(e,t){if(1&e&&(U.ic(0,"td",7),U.Xc(1),U.sc(2,"date"),U.hc(),U.ic(3,"td",7),U.Xc(4),U.hc(),U.ic(5,"td",7),U.ic(6,"div",8),U.dc(7,"img",9),U.ic(8,"span",10),U.Xc(9),U.hc(),U.hc(),U.hc(),U.ic(10,"td",7),U.dc(11,"kb-star-rating",11),U.hc(),U.ic(12,"td",7),U.Xc(13),U.hc(),U.ic(14,"td",7),U.dc(15,"kb-review-state-label",12),U.hc(),U.ic(16,"td",13),U.dc(17,"vdr-table-row-action",14),U.sc(18,"translate"),U.hc()),2&e){var n=t.item;U.Rb(1),U.Zc(" ",U.uc(2,9,n.createdAt,"mediumDate")," "),U.Rb(3),U.Yc(n.authorName),U.Rb(3),U.yc("src",(null==n.product.featuredAsset?null:n.product.featuredAsset.preview)+"?preset=tiny",U.Oc),U.Rb(2),U.Yc(n.product.name),U.Rb(2),U.yc("rating",n.rating),U.Rb(2),U.Yc(n.summary),U.Rb(2),U.yc("state",n.state),U.Rb(2),U.yc("label",U.tc(18,12,"common.edit"))("linkTo",U.Dc(14,H,n.id))}}var V,Y=((V=function(e){u(n,e);var t=l(n);function n(e,r,i){var c,a;return h(this,n),(a=t.call(this,r,i)).dataService=e,a.filteredState="new",m((c=p(a),g(n.prototype)),"setQueryFn",c).call(c,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.dataService.query(j,t)}),(function(e){return e.productReviews}),(function(e,t){return{productId:i.snapshot.paramMap.get("id"),options:Object.assign({skip:e,take:t,sort:{createdAt:A.Desc}},null!=a.filteredState?{filter:{state:{eq:a.filteredState}}}:{})}})),a}return n}(T.w)).\u0275fac=function(e){return new(e||V)(U.cc(T.K),U.cc(M.e),U.cc(M.a))},V.\u0275cmp=U.Wb({type:V,selectors:[["kb-all-product-reviews-list"]],features:[U.Ob],decls:32,vars:14,consts:[[1,"filter-controls"],["clrSelect","","name","state",3,"ngModel","ngModelChange","change"],[3,"ngValue"],["value","new"],["value","approved"],["value","rejected"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"left","align-middle"],[1,"product-info"],["width","50","height","50",3,"src"],[1,"product-name"],[3,"rating"],[3,"state"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"]],template:function(e,t){1&e&&(U.ic(0,"vdr-action-bar"),U.ic(1,"vdr-ab-left"),U.ic(2,"div",0),U.ic(3,"select",1),U.pc("ngModelChange",(function(e){return t.filteredState=e}))("change",(function(){return t.refresh()})),U.ic(4,"option",2),U.Xc(5,"All reviews"),U.hc(),U.ic(6,"option",3),U.Xc(7,"Reviews pending approval"),U.hc(),U.ic(8,"option",4),U.Xc(9,"Approved reviews"),U.hc(),U.ic(10,"option",5),U.Xc(11,"Rejected reviews"),U.hc(),U.hc(),U.hc(),U.hc(),U.dc(12,"vdr-ab-right"),U.hc(),U.ic(13,"vdr-data-table",6),U.pc("pageChange",(function(e){return t.setPageNumber(e)}))("itemsPerPageChange",(function(e){return t.setItemsPerPage(e)})),U.sc(14,"async"),U.sc(15,"async"),U.sc(16,"async"),U.sc(17,"async"),U.ic(18,"vdr-dt-column"),U.Xc(19,"Submitted"),U.hc(),U.ic(20,"vdr-dt-column"),U.Xc(21,"Author"),U.hc(),U.ic(22,"vdr-dt-column"),U.Xc(23,"Product"),U.hc(),U.ic(24,"vdr-dt-column"),U.Xc(25,"Rating"),U.hc(),U.ic(26,"vdr-dt-column"),U.Xc(27,"Summary"),U.hc(),U.ic(28,"vdr-dt-column"),U.Xc(29,"Status"),U.hc(),U.dc(30,"vdr-dt-column"),U.Vc(31,q,19,16,"ng-template"),U.hc()),2&e&&(U.Rb(3),U.yc("ngModel",t.filteredState),U.Rb(1),U.yc("ngValue",null),U.Rb(9),U.yc("items",U.tc(14,6,t.items$))("itemsPerPage",U.tc(15,8,t.itemsPerPage$))("totalItems",U.tc(16,10,t.totalItems$))("currentPage",U.tc(17,12,t.currentPage$)))},directives:[T.c,T.e,T.eb,x.A,K.A,x.p,x.s,x.u,x.D,T.f,T.M,T.L,G.a,X,T.Pb],pipes:[_.b,_.f,$.d],styles:[".filter-controls[_ngcontent-%COMP%]{margin-bottom:12px}.product-info[_ngcontent-%COMP%]{display:flex;align-items:center}.product-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:20vw;margin-left:6px}"],changeDetection:0}),V),z=f("ROBh"),Z=f("TLy2"),W=f("xVbo"),J=f("7SLS"),Q=F.a(s(),L),ee=F.a(o()),te=F.a(a());function ne(e,t){if(1&e){var n=U.jc();U.ic(0,"button",25),U.pc("click",(function(){return U.Mc(n),U.rc(2).approve()})),U.dc(1,"clr-icon",26),U.Xc(2," Approve "),U.hc()}if(2&e){var r=U.rc(2);U.yc("disabled",r.detailForm.invalid)}}function re(e,t){if(1&e){var n=U.jc();U.ic(0,"button",27),U.pc("click",(function(){return U.Mc(n),U.rc(2).reject()})),U.dc(1,"clr-icon",28),U.Xc(2," Reject "),U.hc()}if(2&e){var r=U.rc(2);U.yc("disabled",r.detailForm.invalid)}}function ie(e,t){1&e&&(U.gc(0),U.Vc(1,ne,3,1,"button",23),U.Vc(2,re,3,1,"button",24),U.fc()),2&e&&(U.Rb(1),U.yc("vdrIfPermissions","UpdateCatalog"),U.Rb(1),U.yc("vdrIfPermissions","UpdateCatalog"))}function ce(e,t){if(1&e){var n=U.jc();U.ic(0,"button",30),U.pc("click",(function(){return U.Mc(n),U.rc(2).save()})),U.Xc(1),U.sc(2,"translate"),U.hc()}if(2&e){var r=U.rc(2);U.yc("disabled",r.detailForm.invalid||r.detailForm.pristine),U.Rb(1),U.Zc(" ",U.tc(2,2,"common.update")," ")}}function ae(e,t){1&e&&U.Vc(0,ce,3,4,"button",29),2&e&&U.yc("vdrIfPermissions","UpdateCatalog")}var oe=function(e){return["/catalog","products",e]};function se(e,t){if(1&e&&(U.ic(0,"div",31),U.ic(1,"div",32),U.dc(2,"img",33),U.hc(),U.ic(3,"div",34),U.ic(4,"a",35),U.Xc(5),U.hc(),U.hc(),U.hc()),2&e){var n=t.ngIf;U.Rb(2),U.yc("src",n.product.featuredAsset.preview+"?preset=small",U.Oc),U.Rb(2),U.yc("routerLink",U.Dc(3,oe,n.product.id)),U.Rb(1),U.Yc(n.product.name)}}var ue,de=((ue=function(e){u(n,e);var t=l(n);function n(e,r,i,c,a,o,s){var u;return h(this,n),(u=t.call(this,e,r,i,a)).formBuilder=c,u.dataService=a,u.changeDetector=o,u.notificationService=s,u.detailForm=u.formBuilder.group({summary:["",x.C.required],body:"",rating:[0,x.C.required],authorName:["",x.C.required],authorLocation:"",state:"",response:""}),u}return b(n,[{key:"ngOnInit",value:function(){this.init(),this.reviewState$=this.entity$.pipe(Object(I.a)((function(e){return e.state})))}},{key:"approve",value:function(){var e=this;this.saveChanges().pipe(Object(Z.a)((function(){return e.dataService.mutate(ee,{id:e.id})}))).subscribe((function(){e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success("Review was approved")}),(function(){e.notificationService.error("An error occurred when attempting to approve the review")}))}},{key:"reject",value:function(){var e=this;this.saveChanges().pipe(Object(Z.a)((function(){return e.dataService.mutate(te,{id:e.id})}))).subscribe((function(){e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success("Review was rejected")}),(function(){e.notificationService.error("An error occurred when attempting to reject the review")}))}},{key:"save",value:function(){var e=this;this.saveChanges().pipe(Object(W.a)((function(e){return!!e}))).subscribe((function(){e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success("common.notify-update-success",{entity:"ProductReview"})}),(function(){e.notificationService.error("common.notify-update-error",{entity:"ProductReview"})}))}},{key:"saveChanges",value:function(){if(this.detailForm.dirty){var e=this.detailForm.value,t={id:this.id,summary:e.summary,body:e.body,response:e.response};return this.dataService.mutate(Q,{input:t}).pipe(Object(J.a)(!0))}return Object(z.a)(!1)}},{key:"setFormValues",value:function(e){this.detailForm.patchValue({summary:e.summary,body:e.body,rating:e.rating,authorName:e.authorName,authorLocation:e.authorLocation,state:e.state,response:e.response})}}]),n}(T.u)).\u0275fac=function(e){return new(e||ue)(U.cc(M.a),U.cc(M.e),U.cc(T.Jb),U.cc(x.e),U.cc(T.K),U.cc(U.k),U.cc(T.Bb))},ue.\u0275cmp=U.Wb({type:ue,selectors:[["kb-product-review-detail"]],features:[U.Ob],decls:36,vars:30,consts:[[1,"review-info"],[3,"entity"],[3,"state"],[4,"ngIf","ngIfElse"],["updateButton",""],[1,"clr-row"],[1,"clr-col"],[1,"form",3,"formGroup"],[1,"form-block"],["label","Summary","for","summary"],["id","summary","type","text","formControlName","summary",3,"readonly"],["label","Rating","for","rating"],[3,"rating"],["label","Body","for","body"],["clrTextarea","","id","body","formControlName","body",3,"readonly"],["label","Author name","for","authorName"],["id","authorName","type","text","formControlName","authorName",3,"readonly"],["label","Author location","for","authorLocation"],["id","authorLocation","type","text","formControlName","authorLocation",3,"readonly"],["label","Response","for","response"],["clrTextarea","","id","response","formControlName","response",3,"readonly"],[1,"clr-col-4"],["class","card",4,"ngIf"],["class","btn btn-success",3,"disabled","click",4,"vdrIfPermissions"],["class","btn btn-warning",3,"disabled","click",4,"vdrIfPermissions"],[1,"btn","btn-success",3,"disabled","click"],["shape","check"],[1,"btn","btn-warning",3,"disabled","click"],["shape","times"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"btn","btn-primary",3,"disabled","click"],[1,"card"],[1,"card-img"],[1,"product-image",3,"src"],[1,"card-footer"],[3,"routerLink"]],template:function(e,t){if(1&e&&(U.ic(0,"vdr-action-bar"),U.ic(1,"vdr-ab-left"),U.ic(2,"div",0),U.dc(3,"vdr-entity-info",1),U.sc(4,"async"),U.dc(5,"kb-review-state-label",2),U.sc(6,"async"),U.hc(),U.hc(),U.ic(7,"vdr-ab-right"),U.Vc(8,ie,3,2,"ng-container",3),U.sc(9,"async"),U.Vc(10,ae,1,1,"ng-template",null,4,U.Wc),U.hc(),U.hc(),U.ic(12,"div",5),U.ic(13,"div",6),U.ic(14,"form",7),U.ic(15,"section",8),U.ic(16,"vdr-form-field",9),U.dc(17,"input",10),U.sc(18,"hasPermission"),U.hc(),U.ic(19,"vdr-form-field",11),U.dc(20,"kb-star-rating",12),U.hc(),U.ic(21,"vdr-form-field",13),U.dc(22,"textarea",14),U.sc(23,"hasPermission"),U.hc(),U.ic(24,"vdr-form-field",15),U.dc(25,"input",16),U.sc(26,"hasPermission"),U.hc(),U.ic(27,"vdr-form-field",17),U.dc(28,"input",18),U.sc(29,"hasPermission"),U.hc(),U.ic(30,"vdr-form-field",19),U.dc(31,"textarea",20),U.sc(32,"hasPermission"),U.hc(),U.hc(),U.hc(),U.hc(),U.ic(33,"div",21),U.Vc(34,se,6,5,"div",22),U.sc(35,"async"),U.hc(),U.hc()),2&e){var n,r=U.Jc(11);U.Rb(3),U.yc("entity",U.tc(4,12,t.entity$)),U.Rb(2),U.yc("state",U.tc(6,14,t.reviewState$)),U.Rb(3),U.yc("ngIf","new"===U.tc(9,16,t.reviewState$))("ngIfElse",r),U.Rb(6),U.yc("formGroup",t.detailForm),U.Rb(3),U.yc("readonly",!U.tc(18,18,"UpdateCatalog")),U.Rb(3),U.yc("rating",null==(n=t.detailForm.get("rating"))?null:n.value),U.Rb(2),U.yc("readonly",!U.tc(23,20,"UpdateCatalog")),U.Rb(3),U.yc("readonly",!U.tc(26,22,"UpdateCatalog")),U.Rb(3),U.yc("readonly",!U.tc(29,24,"UpdateCatalog")),U.Rb(3),U.yc("readonly",!U.tc(32,26,"UpdateCatalog")),U.Rb(3),U.yc("ngIf",U.tc(35,28,t.entity$))}},directives:[T.c,T.e,T.ab,X,T.f,_.p,x.E,x.q,x.j,T.db,T.eb,x.b,x.p,x.h,G.a,K.H,T.rb,K.o,M.h],pipes:[_.b,T.ib,$.d],styles:[".review-info[_ngcontent-%COMP%]{display:flex;align-items:center}.rating-input[_ngcontent-%COMP%]{max-width:64px;margin-right:6px}  .clr-form-control{flex:1}  .clr-form-control .clr-control-container{width:100%}  .clr-form-control textarea{width:100%;height:250px}.product-image[_ngcontent-%COMP%]{max-width:300px;margin:auto}"]}),ue),le=f("wqq/"),fe=F.a(c(),L),pe=F.a(i());function me(e,t){if(1&e){var n=U.jc();U.ic(0,"div",1),U.dc(1,"kb-star-rating",2),U.ic(2,"div",3),U.dc(3,"div",4),U.hc(),U.ic(4,"div",5),U.Xc(5),U.hc(),U.ic(6,"button",6),U.pc("click",(function(){U.Mc(n);var e=t.$implicit;return U.rc().toggleBinFilter(e)})),U.dc(7,"clr-icon",7),U.hc(),U.hc()}if(2&e){var r=t.$implicit,i=U.rc();U.Rb(1),U.yc("rating",r)("showLabel",!1),U.Rb(2),U.Sc("width",i.getPercentage(r),"%"),U.Rb(2),U.Zc(" ",i.getFrequency(r)," "),U.Rb(1),U.Ub("active",i.filteredBin===r),U.yc("disabled",0===i.getFrequency(r))}}var ge,he=((ge=function(){function e(){h(this,e),this.binData=[],this.filterChange=new U.u,this.bins=[5,4,3,2,1],this.filteredBin=null}return b(e,[{key:"ngOnChanges",value:function(){this.max=this.binData?Math.max.apply(Math,n(this.binData.map((function(e){return e.frequency})))):0}},{key:"getPercentage",value:function(e){if(!this.binData)return 0;var t=this.binData.find((function(t){return t.bin===e}));return t?Math.round(t.frequency/this.max*100):0}},{key:"getFrequency",value:function(e){if(!this.binData)return 0;var t=this.binData.find((function(t){return t.bin===e}));return t?t.frequency:0}},{key:"toggleBinFilter",value:function(e){this.filteredBin===e?this.filteredBin=null:this.filteredBin=e,this.filterChange.emit(this.filteredBin)}}]),e}()).\u0275fac=function(e){return new(e||ge)},ge.\u0275cmp=U.Wb({type:ge,selectors:[["kb-review-histogram"]],inputs:{binData:"binData"},outputs:{filterChange:"filterChange"},features:[U.Pb],decls:1,vars:1,consts:[["class","bar-container",4,"ngFor","ngForOf"],[1,"bar-container"],[3,"rating","showLabel"],[1,"bar"],[1,"fill"],[1,"frequency"],["title","Filter reviews with this rating",1,"icon-button","filter-button",3,"disabled","click"],["shape","filter-2"]],template:function(e,t){1&e&&U.Vc(0,me,8,8,"div",0),2&e&&U.yc("ngForOf",t.bins)},directives:[_.o,G.a,K.o],styles:["[_nghost-%COMP%]{display:block;margin-bottom:6px}.bar-container[_ngcontent-%COMP%]{display:flex;align-items:center}.bar[_ngcontent-%COMP%]{background-color:#f2f3f5;width:100px;margin:0 6px}.fill[_ngcontent-%COMP%]{background-color:#cab526;text-align:right;height:12px}.frequency[_ngcontent-%COMP%]{color:#3f4445;font-size:12px;min-width:16px;line-height:12px}.filter-button[_ngcontent-%COMP%]{margin-left:6px;border-radius:3px;line-height:16px}.filter-button[disabled][_ngcontent-%COMP%]{opacity:.5;cursor:default}.filter-button.active[_ngcontent-%COMP%]{background-color:#13b7f3;color:#fff}"],changeDetection:0}),ge);function ve(e,t){if(1&e&&(U.ic(0,"div",4),U.dc(1,"img",5),U.dc(2,"kb-star-rating",6),U.hc()),2&e){var n=t.ngIf;U.Rb(1),U.yc("src",(null==n.featuredAsset?null:n.featuredAsset.preview)+"?preset=tiny",U.Oc),U.Rb(1),U.yc("rating",n.customFields.reviewRating)}}var be=function(e){return["/extensions","product-reviews",e]};function ye(e,t){if(1&e&&(U.ic(0,"td",7),U.Xc(1),U.sc(2,"date"),U.hc(),U.ic(3,"td",7),U.Xc(4),U.hc(),U.ic(5,"td",7),U.dc(6,"kb-star-rating",6),U.hc(),U.ic(7,"td",7),U.Xc(8),U.hc(),U.ic(9,"td",7),U.dc(10,"kb-review-state-label",8),U.hc(),U.ic(11,"td",9),U.dc(12,"vdr-table-row-action",10),U.sc(13,"translate"),U.hc()),2&e){var n=t.item;U.Rb(1),U.Zc(" ",U.uc(2,7,n.createdAt,"mediumDate")," "),U.Rb(3),U.Yc(n.authorName),U.Rb(2),U.yc("rating",n.rating),U.Rb(2),U.Yc(n.summary),U.Rb(2),U.yc("state",n.state),U.Rb(2),U.yc("label",U.tc(13,10,"common.edit"))("linkTo",U.Dc(12,be,n.id))}}var Re,we,Pe,Ce,Se=((Re=function(e){u(n,e);var t=l(n);function n(e,r,i){var c,a;return h(this,n),(a=t.call(this,r,i)).dataService=e,m((c=p(a),g(n.prototype)),"setQueryFn",c).call(c,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.dataService.query(fe,t)}),(function(e){return e.product.reviews}),(function(e,t){return{productId:i.snapshot.paramMap.get("id"),options:Object.assign({skip:e,take:t,sort:{createdAt:A.Desc}},null!=a.filteredRating?{filter:{rating:{eq:a.filteredRating}}}:{})}})),a}return b(n,[{key:"ngOnInit",value:function(){m(g(n.prototype),"ngOnInit",this).call(this);var e=this.dataService.query(pe,{id:this.route.snapshot.paramMap.get("id")||""}).single$.pipe(Object(le.a)(1));this.histogramBinData$=e.pipe(Object(I.a)((function(e){return e.product?e.product.reviewsHistogram:[]}))),this.product$=e.pipe(Object(I.a)((function(e){return e.product})))}},{key:"applyRatingFilters",value:function(e){this.filteredRating=e,this.refresh()}}]),n}(T.w)).\u0275fac=function(e){return new(e||Re)(U.cc(T.K),U.cc(M.e),U.cc(M.a))},Re.\u0275cmp=U.Wb({type:Re,selectors:[["kb-product-reviews-list"]],features:[U.Ob],decls:25,vars:18,consts:[[1,"summary"],["class","image-preview",4,"ngIf"],[3,"binData","filterChange"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"image-preview"],[3,"src"],[3,"rating"],[1,"left","align-middle"],[3,"state"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"]],template:function(e,t){1&e&&(U.ic(0,"vdr-action-bar"),U.ic(1,"vdr-ab-left"),U.ic(2,"div",0),U.Vc(3,ve,3,2,"div",1),U.sc(4,"async"),U.ic(5,"kb-review-histogram",2),U.pc("filterChange",(function(e){return t.applyRatingFilters(e)})),U.sc(6,"async"),U.hc(),U.hc(),U.hc(),U.dc(7,"vdr-ab-right"),U.hc(),U.ic(8,"vdr-data-table",3),U.pc("pageChange",(function(e){return t.setPageNumber(e)}))("itemsPerPageChange",(function(e){return t.setItemsPerPage(e)})),U.sc(9,"async"),U.sc(10,"async"),U.sc(11,"async"),U.sc(12,"async"),U.ic(13,"vdr-dt-column"),U.Xc(14,"Submitted"),U.hc(),U.ic(15,"vdr-dt-column"),U.Xc(16,"Author"),U.hc(),U.ic(17,"vdr-dt-column"),U.Xc(18,"Rating"),U.hc(),U.ic(19,"vdr-dt-column"),U.Xc(20,"Summary"),U.hc(),U.ic(21,"vdr-dt-column"),U.Xc(22,"Status"),U.hc(),U.dc(23,"vdr-dt-column"),U.Vc(24,ye,14,14,"ng-template"),U.hc()),2&e&&(U.Rb(3),U.yc("ngIf",U.tc(4,6,t.product$)),U.Rb(2),U.yc("binData",U.tc(6,8,t.histogramBinData$)),U.Rb(3),U.yc("items",U.tc(9,10,t.items$))("itemsPerPage",U.tc(10,12,t.itemsPerPage$))("totalItems",U.tc(11,14,t.totalItems$))("currentPage",U.tc(12,16,t.currentPage$)))},directives:[T.c,T.e,_.p,he,T.f,T.M,T.L,G.a,X,T.Pb],pipes:[_.b,_.f,$.d],styles:[".summary[_ngcontent-%COMP%]{display:flex}.image-preview[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:12px;margin-right:6px;background-color:#f2f3f5}"],changeDetection:0}),Re),Oe=F.a(t()),De=((we=function(){function e(t){h(this,e),this.dataService=t}return b(e,[{key:"resolve",value:function(e){return this.dataService.query(Oe,{id:e.paramMap.get("id")||""}).mapSingle((function(e){return e.product}))}}]),e}()).\u0275fac=function(e){return new(e||we)(U.mc(T.K))},we.\u0275prov=U.Yb({token:we,factory:we.\u0275fac}),we),ke=f("J+dc"),Ae=F.a(e(),L),Ne=((Pe=function(){function e(t){h(this,e),this.dataService=t}return b(e,[{key:"resolve",value:function(e){var t=this.dataService.query(Ae,{id:e.paramMap.get("id")||""}).mapStream((function(e){return e.productReview})).pipe(Object(le.a)(1));return t.pipe(Object(ke.a)(1),Object(I.a)((function(){return t})))}}]),e}()).\u0275fac=function(e){return new(e||Pe)(U.mc(T.K))},Pe.\u0275prov=U.Yb({token:Pe,factory:Pe.\u0275fac}),Pe),Me=f("BhNn"),Ie=((Ce=function e(){h(this,e)}).\u0275mod=U.ac({type:Ce}),Ce.\u0275inj=U.Zb({factory:function(e){return new(e||Ce)},providers:[De,Ne],imports:[[Me.a,M.i.forChild([{path:"product/:id",component:Se,resolve:{data:De},data:{breadcrumb:Te}},{path:"",pathMatch:"full",component:Y,data:{breadcrumb:[{label:"Product reviews",link:["/extensions","product-reviews"]}]}},{path:":id",component:de,resolve:{entity:Ne},data:{breadcrumb:Be}}])]]}),Ce);function Te(e,t){return[{label:"breadcrumb.products",link:["/catalog","products"]},{label:""+e.data.name,link:["/catalog","products",t.id]},{label:"Reviews",link:[""]}]}function Be(e){return e.entity.pipe(Object(I.a)((function(e){return[{label:"Product reviews",link:["/extensions","product-reviews"]},{label:""+e.id,link:[]}]})))}}}])}();