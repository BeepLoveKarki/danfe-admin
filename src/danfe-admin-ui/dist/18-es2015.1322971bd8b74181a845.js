(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{tB2i:function(c,e,t){"use strict";t.r(e),t.d(e,"HealthCheckComponent",(function(){return E})),t.d(e,"JobListComponent",(function(){return N})),t.d(e,"JobStateLabelComponent",(function(){return Y})),t.d(e,"SystemModule",(function(){return Z})),t.d(e,"systemRoutes",(function(){return T})),t.d(e,"\u02750",(function(){return V})),t.d(e,"\u02751",(function(){return F}));var s=t("EM62"),n=t("ixhn"),r=t("nIj0"),a=t("sEIs"),i=t("8lHc"),o=t("kuMc"),l=t("xVbo"),u=t("YtkY"),d=t("OxKu"),h=t("2kYt"),b=t("Kej3"),m=t("s2Ay"),p=t("jY47");function f(c,e){1&c&&(s.gc(0),s.Xc(1),s.sc(2,"translate"),s.fc()),2&c&&(s.Rb(1),s.Zc(" ",s.tc(2,1,"system.health-all-systems-up")," "))}function g(c,e){1&c&&(s.Xc(0),s.sc(1,"translate")),2&c&&s.Zc(" ",s.tc(1,1,"system.health-error")," ")}const y=function(c,e){return{"is-success":c,"is-danger":e}};function v(c,e){if(1&c&&(s.ic(0,"div",7),s.ic(1,"div",8),s.dc(2,"clr-icon",9),s.hc(),s.ic(3,"div",10),s.Vc(4,f,3,3,"ng-container",11),s.Vc(5,g,2,3,"ng-template",null,12,s.Wc),s.ic(7,"div",13),s.Xc(8),s.sc(9,"translate"),s.sc(10,"date"),s.sc(11,"async"),s.hc(),s.hc(),s.hc()),2&c){const c=e.ngIf,t=s.Jc(6),n=s.rc();s.Rb(2),s.yc("ngClass",s.Ec(13,y,"ok"===c,"ok"!==c)),s.Sb("shape","ok"===c?"check-circle":"exclamation-circle"),s.Rb(2),s.yc("ngIf","ok"===c)("ngIfElse",t),s.Rb(4),s.ad(" ",s.tc(9,6,"system.health-last-checked"),": ",s.uc(10,8,s.tc(11,11,n.healthCheckService.lastCheck$),"mediumTime")," ")}}function R(c,e){1&c&&(s.gc(0),s.dc(1,"clr-icon",17),s.Xc(2),s.sc(3,"translate"),s.fc()),2&c&&(s.Rb(2),s.Zc(" ",s.tc(3,1,"system.health-status-up")," "))}function j(c,e){1&c&&(s.dc(0,"clr-icon",18),s.Xc(1),s.sc(2,"translate")),2&c&&(s.Rb(1),s.Zc(" ",s.tc(2,1,"system.health-status-down")," "))}function k(c,e){if(1&c&&(s.ic(0,"tr"),s.ic(1,"td",14),s.Xc(2),s.hc(),s.ic(3,"td",14),s.ic(4,"vdr-chip",15),s.Vc(5,R,4,3,"ng-container",11),s.Vc(6,j,3,3,"ng-template",null,16,s.Wc),s.hc(),s.hc(),s.ic(8,"td",14),s.Xc(9),s.hc(),s.hc()),2&c){const c=e.$implicit,t=s.Jc(7);s.Rb(2),s.Yc(c.key),s.Rb(2),s.yc("colorType","up"===c.result.status?"success":"error"),s.Rb(1),s.yc("ngIf","up"===c.result.status)("ngIfElse",t),s.Rb(4),s.Yc(c.result.message)}}function I(c,e){1&c&&(s.gc(0),s.Xc(1),s.sc(2,"translate"),s.fc()),2&c&&(s.Rb(1),s.Zc(" ",s.tc(2,1,"system.all-job-queues")," "))}function w(c,e){if(1&c&&(s.ic(0,"vdr-chip",8),s.Xc(1),s.hc()),2&c){const c=s.rc().item;s.yc("colorFrom",c.name),s.Rb(1),s.Yc(c.name)}}function C(c,e){if(1&c&&(s.Vc(0,I,3,3,"ng-container",6),s.Vc(1,w,2,2,"ng-template",null,7,s.Wc)),2&c){const c=e.item,t=s.Jc(2);s.yc("ngIf","all"===c.name)("ngIfElse",t)}}function P(c,e){if(1&c&&(s.ic(0,"vdr-dropdown"),s.ic(1,"button",13),s.sc(2,"translate"),s.dc(3,"clr-icon",14),s.hc(),s.ic(4,"vdr-dropdown-menu"),s.ic(5,"div",15),s.dc(6,"vdr-object-tree",16),s.hc(),s.hc(),s.hc()),2&c){const c=s.rc().item;s.Rb(1),s.yc("title",s.tc(2,2,"system.job-data")),s.Rb(5),s.yc("value",c.data)}}function X(c,e){if(1&c&&(s.ic(0,"vdr-dropdown"),s.ic(1,"button",17),s.dc(2,"clr-icon",14),s.Xc(3),s.sc(4,"translate"),s.hc(),s.ic(5,"vdr-dropdown-menu"),s.ic(6,"div",15),s.dc(7,"vdr-object-tree",16),s.hc(),s.hc(),s.hc()),2&c){const c=s.rc().item;s.Rb(3),s.Zc(" ",s.tc(4,2,"system.job-result")," "),s.Rb(4),s.yc("value",c.result)}}function O(c,e){if(1&c&&(s.ic(0,"vdr-dropdown"),s.ic(1,"button",17),s.dc(2,"clr-icon",18),s.Xc(3),s.sc(4,"translate"),s.hc(),s.ic(5,"vdr-dropdown-menu"),s.ic(6,"div",15),s.Xc(7),s.hc(),s.hc(),s.hc()),2&c){const c=s.rc().item;s.Rb(3),s.Zc(" ",s.tc(4,2,"system.job-error")," "),s.Rb(4),s.Zc(" ",c.error," ")}}function S(c,e){if(1&c&&(s.ic(0,"td",9),s.dc(1,"vdr-entity-info",10),s.hc(),s.ic(2,"td",9),s.Vc(3,P,7,4,"vdr-dropdown",11),s.ic(4,"vdr-chip",8),s.Xc(5),s.hc(),s.hc(),s.ic(6,"td",9),s.Xc(7),s.sc(8,"timeAgo"),s.hc(),s.ic(9,"td",9),s.dc(10,"vdr-job-state-label",12),s.hc(),s.ic(11,"td",9),s.Xc(12),s.sc(13,"duration"),s.hc(),s.ic(14,"td",9),s.Vc(15,X,8,4,"vdr-dropdown",11),s.Vc(16,O,8,4,"vdr-dropdown",11),s.hc()),2&c){const c=e.item,t=s.rc();s.Rb(1),s.yc("entity",c),s.Rb(2),s.yc("ngIf",c.data),s.Rb(1),s.yc("colorFrom",c.queueName),s.Rb(1),s.Yc(c.queueName),s.Rb(2),s.Yc(s.tc(8,9,c.createdAt)),s.Rb(3),s.yc("job",c),s.Rb(2),s.Yc(s.tc(13,11,c.duration)),s.Rb(3),s.yc("ngIf",t.hasResult(c)),s.Rb(1),s.yc("ngIf",c.error)}}function x(c,e){if(1&c&&(s.ic(0,"span",2),s.Xc(1),s.sc(2,"percent"),s.hc()),2&c){const c=s.rc();s.Rb(1),s.Zc(" ",s.tc(2,1,c.job.progress/100)," ")}}class E{constructor(c){this.healthCheckService=c}}E.\u0275fac=function(c){return new(c||E)(s.cc(n.jb))},E.\u0275cmp=s.Wb({type:E,selectors:[["vdr-health-check"]],decls:25,vars:18,consts:[["class","system-status-header",4,"ngIf"],["locationId","system-status"],[1,"btn","btn-secondary",3,"click"],["shape","refresh"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"],[1,"system-status-header"],[1,"status-icon"],["size","48",3,"ngClass"],[1,"status-detail"],[4,"ngIf","ngIfElse"],["error",""],[1,"last-checked"],[1,"align-middle","left"],[3,"colorType"],["down",""],["shape","check-circle"],["shape","exclamation-circle"]],template:function(c,e){1&c&&(s.ic(0,"vdr-action-bar"),s.ic(1,"vdr-ab-left"),s.Vc(2,v,12,16,"div",0),s.sc(3,"async"),s.hc(),s.ic(4,"vdr-ab-right"),s.dc(5,"vdr-action-bar-items",1),s.ic(6,"button",2),s.pc("click",(function(){return e.healthCheckService.refresh()})),s.dc(7,"clr-icon",3),s.Xc(8),s.sc(9,"translate"),s.hc(),s.hc(),s.hc(),s.ic(10,"table",4),s.ic(11,"thead"),s.ic(12,"tr"),s.ic(13,"th",5),s.Xc(14),s.sc(15,"translate"),s.hc(),s.ic(16,"th",5),s.Xc(17),s.sc(18,"translate"),s.hc(),s.ic(19,"th",5),s.Xc(20),s.sc(21,"translate"),s.hc(),s.hc(),s.hc(),s.ic(22,"tbody"),s.Vc(23,k,10,5,"tr",6),s.sc(24,"async"),s.hc(),s.hc()),2&c&&(s.Rb(2),s.yc("ngIf",s.tc(3,6,e.healthCheckService.status$)),s.Rb(6),s.Zc(" ",s.tc(9,8,"system.health-refresh")," "),s.Rb(6),s.Zc(" ",s.tc(15,10,"common.name")," "),s.Rb(3),s.Zc(" ",s.tc(18,12,"system.health-status")," "),s.Rb(3),s.Zc(" ",s.tc(21,14,"system.health-message")," "),s.Rb(3),s.yc("ngForOf",s.tc(24,16,e.healthCheckService.details$)))},directives:[n.c,n.e,h.p,n.f,n.d,b.o,h.o,h.n,n.B],pipes:[h.b,m.d,h.f],styles:[".system-status-header[_ngcontent-%COMP%]{align-items:flex-start;display:flex;justify-content:space-between}.system-status-header[_ngcontent-%COMP%]   .status-detail[_ngcontent-%COMP%]{font-weight:700}.system-status-header[_ngcontent-%COMP%]   .last-checked[_ngcontent-%COMP%]{color:#525456;font-weight:400}"],changeDetection:0}),E.ctorParameters=()=>[{type:n.jb}];class N extends n.w{constructor(c,e,t,s,a){super(s,a),this.dataService=c,this.modalService=e,this.notificationService=t,this.liveUpdate=new r.f(!0),this.hideSettled=new r.f(!0),this.queueFilter=new r.f("all"),super.setQueryFn((...c)=>this.dataService.settings.getAllJobs(...c),c=>c.jobs,(c,e)=>{const t="all"===this.queueFilter.value?null:{queueName:{eq:this.queueFilter.value}},s=this.hideSettled.value;return{options:{skip:c,take:e,filter:Object.assign(Object.assign({},t),s?{isSettled:{eq:!1}}:{}),sort:{createdAt:n.Lb.DESC}}}})}ngOnInit(){super.ngOnInit(),Object(i.a)(5e3,2e3).pipe(Object(o.a)(this.destroy$),Object(l.a)(()=>this.liveUpdate.value)).subscribe(()=>{this.refresh()}),this.queues$=this.dataService.settings.getJobQueues().mapStream(c=>c.jobQueues).pipe(Object(u.a)(c=>[{name:"all",running:!0},...c]))}hasResult(c){const e=c.result;return null!=e&&("object"!=typeof e||Object.keys(e).length>0)}}N.\u0275fac=function(c){return new(c||N)(s.cc(n.K),s.cc(n.Ab),s.cc(n.Bb),s.cc(a.e),s.cc(a.a))},N.\u0275cmp=s.Wb({type:N,selectors:[["vdr-job-list"]],features:[s.Ob],decls:40,vars:45,consts:[["type","checkbox","clrCheckbox","","name","live-update",3,"formControl"],["type","checkbox","clrCheckbox","","name","hide-settled",3,"formControl","change"],["bindValue","name",3,"addTag","items","hideSelected","multiple","markFirst","clearable","searchable","formControl","change"],["ng-label-tmp","","ng-option-tmp",""],["locationId","job-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[4,"ngIf","ngIfElse"],["others",""],[3,"colorFrom"],[1,"left","align-middle"],[3,"entity"],[4,"ngIf"],[3,"job"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-icon",3,"title"],["shape","details"],[1,"result-detail"],[3,"value"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-sm","details-button"],["shape","exclamation-circle"]],template:function(c,e){1&c&&(s.ic(0,"vdr-action-bar"),s.ic(1,"vdr-ab-left"),s.ic(2,"clr-checkbox-container"),s.ic(3,"clr-checkbox-wrapper"),s.dc(4,"input",0),s.ic(5,"label"),s.Xc(6),s.sc(7,"translate"),s.hc(),s.hc(),s.ic(8,"clr-checkbox-wrapper"),s.ic(9,"input",1),s.pc("change",(function(){return e.refresh()})),s.hc(),s.ic(10,"label"),s.Xc(11),s.sc(12,"translate"),s.hc(),s.hc(),s.hc(),s.hc(),s.ic(13,"vdr-ab-right"),s.ic(14,"ng-select",2),s.pc("change",(function(){return e.refresh()})),s.sc(15,"async"),s.Vc(16,C,3,2,"ng-template",3),s.hc(),s.dc(17,"vdr-action-bar-items",4),s.hc(),s.hc(),s.ic(18,"vdr-data-table",5),s.pc("pageChange",(function(c){return e.setPageNumber(c)}))("itemsPerPageChange",(function(c){return e.setItemsPerPage(c)})),s.sc(19,"async"),s.sc(20,"async"),s.sc(21,"async"),s.sc(22,"async"),s.dc(23,"vdr-dt-column"),s.ic(24,"vdr-dt-column"),s.Xc(25),s.sc(26,"translate"),s.hc(),s.ic(27,"vdr-dt-column"),s.Xc(28),s.sc(29,"translate"),s.hc(),s.ic(30,"vdr-dt-column"),s.Xc(31),s.sc(32,"translate"),s.hc(),s.ic(33,"vdr-dt-column"),s.Xc(34),s.sc(35,"translate"),s.hc(),s.ic(36,"vdr-dt-column"),s.Xc(37),s.sc(38,"translate"),s.hc(),s.Vc(39,S,17,13,"ng-template"),s.hc()),2&c&&(s.Rb(4),s.yc("formControl",e.liveUpdate),s.Rb(2),s.Yc(s.tc(7,21,"common.live-update")),s.Rb(3),s.yc("formControl",e.hideSettled),s.Rb(2),s.Yc(s.tc(12,23,"system.hide-settled-jobs")),s.Rb(3),s.yc("addTag",!1)("items",s.tc(15,25,e.queues$))("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",e.queueFilter),s.Rb(4),s.yc("items",s.tc(19,27,e.items$))("itemsPerPage",s.tc(20,29,e.itemsPerPage$))("totalItems",s.tc(21,31,e.totalItems$))("currentPage",s.tc(22,33,e.currentPage$)),s.Rb(7),s.Yc(s.tc(26,35,"system.job-queue-name")),s.Rb(3),s.Yc(s.tc(29,37,"common.created-at")),s.Rb(3),s.Yc(s.tc(32,39,"system.job-state")),s.Rb(3),s.Yc(s.tc(35,41,"system.job-duration")),s.Rb(3),s.Yc(s.tc(38,43,"system.job-result")))},directives:function(){return[n.c,n.e,b.j,b.k,n.eb,r.a,b.i,r.p,r.g,b.u,n.f,p.a,p.e,p.d,n.d,n.M,n.L,h.p,n.B,n.ab,Y,n.S,n.V,b.o,n.U,n.Cb]},pipes:function(){return[m.d,h.b,n.Qb,n.W]},styles:[".result-detail[_ngcontent-%COMP%]{margin:0 12px}"],changeDetection:0}),N.ctorParameters=()=>[{type:n.K},{type:n.Ab},{type:n.Bb},{type:a.e},{type:a.a}];class Y{get iconShape(){switch(this.job.state){case n.ub.COMPLETED:return"check-circle";case n.ub.FAILED:return"exclamation-circle";case n.ub.PENDING:case n.ub.RETRYING:return"hourglass";case n.ub.RUNNING:return"sync"}}get colorType(){switch(this.job.state){case n.ub.COMPLETED:return"success";case n.ub.FAILED:return"error";case n.ub.PENDING:case n.ub.RETRYING:return"";case n.ub.RUNNING:return"warning"}}}Y.\u0275fac=function(c){return new(c||Y)},Y.\u0275cmp=s.Wb({type:Y,selectors:[["vdr-job-state-label"]],inputs:{job:"job"},decls:5,vars:6,consts:[[3,"colorType"],["class","progress",4,"ngIf"],[1,"progress"]],template:function(c,e){1&c&&(s.ic(0,"vdr-chip",0),s.dc(1,"clr-icon"),s.Xc(2),s.sc(3,"titlecase"),s.Vc(4,x,3,3,"span",1),s.hc()),2&c&&(s.yc("colorType",e.colorType),s.Rb(1),s.Sb("shape",e.iconShape),s.Rb(1),s.Zc(" ",s.tc(3,4,e.job.state)," "),s.Rb(2),s.yc("ngIf","RUNNING"===e.job.state))},directives:[n.B,b.o,h.p],pipes:[h.z,h.w],styles:[".progress[_ngcontent-%COMP%]{margin-left:3px}clr-icon[_ngcontent-%COMP%]{min-width:12px}"],changeDetection:0}),Y.propDecorators={job:[{type:s.D}]};const V={breadcrumb:Object(d.a)("breadcrumb.job-queue")},F={breadcrumb:Object(d.a)("breadcrumb.system-status")},T=[{path:"jobs",component:N,data:V},{path:"system-status",component:E,data:F}];class Z{}Z.\u0275mod=s.ac({type:Z}),Z.\u0275inj=s.Zb({factory:function(c){return new(c||Z)},imports:[[n.Kb,a.i.forChild(T)]]})}}]);