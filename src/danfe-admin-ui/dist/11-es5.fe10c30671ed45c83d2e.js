function _templateObject5(){var e=_taggedTemplateLiteral(["\n  query GetPhone($id: ID!) {\n    SubscriptionPhone(id: $id) {\n      ...SubscribedPhones\n    }\n  }\n  ","\n"]);return _templateObject5=function(){return e},e}function _templateObject4(){var e=_taggedTemplateLiteral(["\n    mutation CreatePhone($input: [PhoneAddInput!]!) {\n        addSubscriptionPhone(input: $input) {\n            ...SubscribedPhones\n        }\n    }\n    ","\n"]);return _templateObject4=function(){return e},e}function _templateObject3(){var e=_taggedTemplateLiteral(["\n    mutation UpdatePhone($input: [PhoneUpdateInput!]!) {\n        updateSubscriptionPhone(input: $input) {\n            ...SubscribedPhones\n        }\n    }\n    ","\n"]);return _templateObject3=function(){return e},e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(e);if(t){var c=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,c)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var c=Object.getOwnPropertyDescriptor(r,t);return c.get?c.get.call(n):c.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _templateObject2(){var e=_taggedTemplateLiteral(["\n   mutation DeletePhone($input:[ID!]!){\n      deleteSubscriptionPhone(id:$input){\n\t     ...SubscribedPhones \n\t  }\n   }\n   ","\n"]);return _templateObject2=function(){return e},e}function _templateObject(){var e=_taggedTemplateLiteral(["\n    query GetAllPhones($options: PhoneListOptions){\n\t\tSubscriptionPhones(options: $options){\n\t\t\titems{\n\t\t\t...SubscribedPhones\n\t\t\t}\n\t\t\ttotalItems\n       }\n    }\n\t","\n"]);return _templateObject=function(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"hr/e":function(e,t,n){"use strict";n.r(t);var r=n("sEIs"),c=n("ixhn"),i=n("nIj0"),o=n("OxKu"),a=n("FOa3"),s=n("6Oco"),u=n("mWib"),l=n("kuMc"),d=n("TLy2"),p=n("7RXT"),b=n("H5qd"),f=n.n(b),h=n("JReq"),m=f.a(_templateObject(),h.b),v=f.a(_templateObject2(),h.b),y=n("EM62"),g=n("DEd4"),P=n("Kej3"),_=n("s2Ay"),O=n("2kYt");function S(e,t){if(1&e){var n=y.oc();y.nc(0,"a",5),y.vc("click",(function(){return y.Sc(n),y.xc().downloadcsv()})),y.ic(1,"clr-icon",6),y.bd(2),y.yc(3,"translate"),y.mc()}2&e&&(y.Vb(2),y.dd(" ",y.zc(3,1,"vdr-subscription-plugin.download-csv")," "))}var k=function(){return["./create"]};function j(e,t){1&e&&(y.nc(0,"a",7),y.ic(1,"clr-icon",8),y.bd(2),y.yc(3,"translate"),y.mc()),2&e&&(y.Ec("routerLink",y.Ic(4,k)),y.Vb(2),y.dd(" ",y.zc(3,2,"vdr-subscription-plugin.create-new-phone")," "))}var w=function(e){return["/extensions","subscribedphones",e]};function C(e,t){if(1&e&&(y.nc(0,"td",11),y.ic(1,"vdr-table-row-action",12),y.yc(2,"translate"),y.mc()),2&e){var n=y.xc().item;y.Vb(1),y.Ec("label",y.zc(2,2,"common.edit"))("linkTo",y.Jc(4,w,n.id))}}function I(e,t){if(1&e){var n=y.oc();y.nc(0,"td",11),y.nc(1,"vdr-dropdown"),y.nc(2,"button",13),y.bd(3),y.yc(4,"translate"),y.ic(5,"clr-icon",14),y.mc(),y.nc(6,"vdr-dropdown-menu",15),y.nc(7,"button",16),y.vc("click",(function(){y.Sc(n);var e=y.xc().item;return y.xc().deletePhone(e.id)})),y.ic(8,"clr-icon",17),y.bd(9),y.yc(10,"translate"),y.mc(),y.mc(),y.mc(),y.mc()}2&e&&(y.Vb(3),y.dd(" ",y.zc(4,2,"common.actions")," "),y.Vb(6),y.dd(" ",y.zc(10,4,"common.delete")," "))}function V(e,t){if(1&e&&(y.nc(0,"td",9),y.bd(1),y.mc(),y.nc(2,"td",9),y.bd(3),y.yc(4,"date"),y.mc(),y.nc(5,"td",9),y.bd(6),y.yc(7,"date"),y.mc(),y.Zc(8,C,3,6,"td",10),y.Zc(9,I,11,6,"td",10)),2&e){var n=t.item;y.Vb(1),y.cd(n.phone),y.Vb(2),y.cd(y.Ac(4,5,n.createdAt,"longDate")),y.Vb(3),y.cd(y.Ac(7,8,n.updatedAt,"longDate")),y.Vb(2),y.Ec("vdrIfPermissions","UpdateSettings"),y.Vb(1),y.Ec("vdrIfPermissions","DeleteSettings")}}var T=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,c,o,s,u){var l,d;return _classCallCheck(this,n),(d=t.call(this,s,u)).dataService=e,d.modalService=r,d.notificationService=c,d.apollo=o,d.searchTerm=new i.f(""),_get((l=_assertThisInitialized(d),_getPrototypeOf(n.prototype)),"setQueryFn",l).call(l,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d.dataService.query(m,t)}),(function(e){return e.SubscriptionPhones}),(function(e,t){return{options:{skip:e,take:t,filter:{phone:{contains:d.getfilter()}},sort:{updatedAt:a.a.Desc}}}})),d}return _createClass(n,[{key:"getfilter",value:function(){return this.searchTerm.value?this.searchTerm.value.toString():""}},{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.searchTerm.valueChanges.pipe(Object(u.a)(250),Object(l.a)(this.destroy$)).subscribe((function(){e.refresh()}))}},{key:"downloadcsv",value:function(){this.apollo.watchQuery({query:m,variables:[]}).valueChanges.subscribe((function(e){p.a.exportToCsv("danfe-subscribed-phones.csv",e.data.SubscriptionPhones.items)}))}},{key:"deletePhone",value:function(e){var t=this,n=[e];this.modalService.dialog({title:Object(o.a)("vdr-subscription-plugin.confirm-delete-phone"),buttons:[{type:"secondary",label:Object(o.a)("common.cancel")},{type:"danger",label:Object(o.a)("common.delete"),returnValue:!0}]}).pipe(Object(d.a)((function(e){return e?t.dataService.mutate(v,{input:n}):s.a}))).subscribe((function(){t.notificationService.success(Object(o.a)("common.notify-delete-success"),{entity:"Phone"}),t.refresh()}),(function(e){t.notificationService.error(Object(o.a)("common.notify-delete-error"),{entity:"Phone"})}))}}]),n}(c.w);T.\u0275fac=function(e){return new(e||T)(y.hc(c.K),y.hc(c.yb),y.hc(c.zb),y.hc(g.b),y.hc(r.e),y.hc(r.a))},T.\u0275cmp=y.bc({type:T,selectors:[["vdr-all-phones-list"]],features:[y.Sb],decls:25,vars:27,consts:[["type","number","name","searchTerm",1,"clr-input","search-input",3,"formControl","placeholder"],["locationId","phone-list"],["href","javascript:void(0)","class","btn btn-primary","id","downloadbtn",3,"click",4,"vdrIfPermissions"],["class","btn btn-primary","id","createbtn",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],["href","javascript:void(0)","id","downloadbtn",1,"btn","btn-primary",3,"click"],["shape","download-cloud"],["id","createbtn",1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],["class","right align-middle",4,"vdrIfPermissions"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(y.nc(0,"vdr-action-bar"),y.nc(1,"vdr-ab-left"),y.ic(2,"input",0),y.yc(3,"translate"),y.mc(),y.nc(4,"vdr-ab-right"),y.ic(5,"vdr-action-bar-items",1),y.Zc(6,S,4,3,"a",2),y.Zc(7,j,4,5,"a",3),y.mc(),y.mc(),y.nc(8,"vdr-data-table",4),y.vc("pageChange",(function(e){return t.setPageNumber(e)}))("itemsPerPageChange",(function(e){return t.setItemsPerPage(e)})),y.yc(9,"async"),y.yc(10,"async"),y.yc(11,"async"),y.yc(12,"async"),y.nc(13,"vdr-dt-column"),y.bd(14),y.yc(15,"translate"),y.mc(),y.nc(16,"vdr-dt-column"),y.bd(17),y.yc(18,"translate"),y.mc(),y.nc(19,"vdr-dt-column"),y.bd(20),y.yc(21,"translate"),y.mc(),y.ic(22,"vdr-dt-column"),y.ic(23,"vdr-dt-column"),y.Zc(24,V,10,11,"ng-template"),y.mc()),2&e&&(y.Vb(2),y.Ec("formControl",t.searchTerm)("placeholder",y.zc(3,11,"vdr-subscription-plugin.search-by-phone")),y.Vb(4),y.Ec("vdrIfPermissions","CreateSettings"),y.Vb(1),y.Ec("vdrIfPermissions","CreateSettings"),y.Vb(1),y.Ec("items",y.zc(9,13,t.items$))("itemsPerPage",y.zc(10,15,t.itemsPerPage$))("totalItems",y.zc(11,17,t.totalItems$))("currentPage",y.zc(12,19,t.currentPage$)),y.Vb(6),y.cd(y.zc(15,21,"vdr-subscription-plugin.phone")),y.Vb(3),y.cd(y.zc(18,23,"vdr-subscription-plugin.created")),y.Vb(3),y.cd(y.zc(21,25,"vdr-subscription-plugin.updated")))},directives:[c.c,c.e,c.eb,i.v,i.b,i.p,i.g,c.f,c.d,c.pb,c.M,c.L,P.o,r.h,c.Nb,c.S,c.V,c.U,c.T],pipes:[_.d,O.b,O.f],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"],changeDetection:0});var z=n("ROBh"),E=n("xVbo"),x=n("7SLS"),D=f.a(_templateObject3(),h.b),F=f.a(_templateObject4(),h.b);function R(e,t){if(1&e){var n=y.oc();y.nc(0,"button",5),y.vc("click",(function(){return y.Sc(n),y.xc().create()})),y.bd(1),y.yc(2,"translate"),y.mc()}if(2&e){var r=y.xc();y.Ec("disabled",!(r.detailForm.valid&&r.detailForm.dirty)),y.Vb(1),y.dd(" ",y.zc(2,2,"common.create")," ")}}function $(e,t){if(1&e){var n=y.oc();y.nc(0,"button",6),y.vc("click",(function(){return y.Sc(n),y.xc().save()})),y.bd(1),y.yc(2,"translate"),y.mc()}if(2&e){var r=y.xc();y.Ec("disabled",!(r.detailForm.valid&&r.detailForm.dirty)),y.Vb(1),y.dd(" ",y.zc(2,2,"common.update")," ")}}var A=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,c,o,a,s,u){var l;return _classCallCheck(this,n),(l=t.call(this,e,r,c,a)).formBuilder=o,l.dataService=a,l.changeDetector=s,l.notificationService=u,l.which=!1,l.detailForm=l.formBuilder.group({phone:["",i.C.required]}),l}return _createClass(n,[{key:"ngOnInit",value:function(){"/extensions/subscribedphones/create"!=this.router.url?(this.which=!1,this.init()):this.which=!0}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"create",value:function(){var e=this;this.addNew().pipe(Object(E.a)((function(e){return!!e}))).subscribe((function(){e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success("common.notify-create-success",{entity:"Phone"})}),(function(){e.notificationService.error("common.notify-create-error",{entity:"Phone"})}))}},{key:"save",value:function(){var e=this;this.saveChanges().pipe(Object(E.a)((function(e){return!!e}))).subscribe((function(){e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success("common.notify-update-success",{entity:"Phone"})}),(function(){e.notificationService.error("common.notify-update-error",{entity:"Phone"})}))}},{key:"addNew",value:function(){if(this.detailForm.dirty){var e=[{phone:this.detailForm.value.phone.toString()}];return this.dataService.mutate(F,{input:e}).pipe(Object(x.a)(!0))}return Object(z.a)(!1)}},{key:"saveChanges",value:function(){if(this.detailForm.dirty){var e=this.detailForm.value.phone.toString(),t=[{id:this.id,phone:e}];return this.dataService.mutate(D,{input:t}).pipe(Object(x.a)(!0))}return Object(z.a)(!1)}},{key:"setFormValues",value:function(e){this.detailForm.patchValue({phone:parseInt(e.phone)})}}]),n}(c.u);A.\u0275fac=function(e){return new(e||A)(y.hc(r.a),y.hc(r.e),y.hc(c.Ib),y.hc(i.e),y.hc(c.K),y.hc(y.k),y.hc(c.zb))},A.\u0275cmp=y.bc({type:A,selectors:[["vdr-subscription-phone-detail"]],features:[y.Sb],decls:9,vars:7,consts:[["class","btn btn-primary","id","custbtn",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","phone",3,"label"],["id","phone","type","number","formControlName","phone",3,"readonly"],["id","custbtn",1,"btn","btn-primary",3,"disabled","click"],["id","editbtn",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){if(1&e&&(y.nc(0,"vdr-action-bar"),y.nc(1,"vdr-ab-right"),y.Zc(2,R,3,4,"button",0),y.Zc(3,$,3,4,"ng-template",null,1,y.ad),y.mc(),y.mc(),y.nc(5,"form",2),y.nc(6,"vdr-form-field",3),y.yc(7,"translate"),y.ic(8,"input",4),y.mc(),y.mc()),2&e){var n=y.Pc(4);y.Vb(2),y.Ec("ngIf",t.which)("ngIfElse",n),y.Vb(3),y.Ec("formGroup",t.detailForm),y.Vb(1),y.Ec("label",y.zc(7,5,"vdr-subscription-plugin.phone-label")),y.Vb(2),y.Ec("readonly",!1)}},directives:[c.c,c.f,O.p,i.E,i.q,i.j,c.db,c.eb,i.v,i.b,i.p,i.h],pipes:[_.d],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]});var L=f.a(_templateObject5(),h.b),q=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){return _classCallCheck(this,n),t.call(this,e,{__typename:"Phone",id:"",phone:"",createdAt:"",updatedAt:""},(function(e){return r.query(L,{id:e}).mapStream((function(e){return e.SubscriptionPhone}))}))}return n}(c.v);q.\u0275fac=function(e){return new(e||q)(y.rc(r.e),y.rc(c.K))},q.\u0275prov=y.dc({token:q,factory:q.\u0275fac});var B=n("YtkY");n.d(t,"PhoneSubscriptionUIModule",(function(){return M})),n.d(t,"phoneDetailBreadcrumb",(function(){return N}));var M=function e(){_classCallCheck(this,e)};function N(e){return e.entity.pipe(Object(B.a)((function(e){return[{label:"Subscribed Phones",link:["/extensions","subscribedphones"]},{label:"".concat(e.phone),link:[]}]})))}M.\u0275mod=y.fc({type:M}),M.\u0275inj=y.ec({factory:function(e){return new(e||M)},providers:[q],imports:[[c.Jb,r.i.forChild([{path:"",pathMatch:"full",component:T,data:{breadcrumb:"Subscribed Phones"}},{path:"create",component:A,data:{breadcrumb:[{label:"Subscribed Phones",link:["/extensions","subscribedphones"]},{label:"Create Phone",link:[]}]}},{path:":id",component:A,resolve:Object(c.Tb)(q),data:{breadcrumb:N}}])]]})}}]);