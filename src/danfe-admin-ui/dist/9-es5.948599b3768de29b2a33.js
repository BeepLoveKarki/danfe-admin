!function(){function t(){var e=p(["\n  query GetEmail($id: ID!) {\n    SubscriptionEmail(id: $id) {\n      ...SubscribedEmails\n    }\n  }\n  ","\n"]);return t=function(){return e},e}function e(){var t=p(["\n    mutation CreateEmail($input: [EmailAddInput!]!) {\n        addSubscriptionEmail(input: $input) {\n            ...SubscribedEmails\n        }\n    }\n    ","\n"]);return e=function(){return t},t}function n(){var t=p(["\n    mutation UpdateEmail($input: [EmailUpdateInput!]!) {\n        updateSubscriptionEmail(input: $input) {\n            ...SubscribedEmails\n        }\n    }\n    ","\n"]);return n=function(){return t},t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var c=b(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(i){var c=Object.getOwnPropertyDescriptor(i,e);return c.get?c.get.call(n):c.value}})(t,e,n||t)}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(){var t=p(["\n   mutation DeleteEmail($input:[ID!]!){\n      deleteSubscriptionEmail(id:$input){\n\t     ...SubscribedEmails \n\t  }\n   }\n   ","\n"]);return m=function(){return t},t}function f(){var t=p(["\n    query GetAllEmails($options: EmailListOptions){\n\t\tSubscriptionEmails(options: $options){\n\t\t\titems{\n\t\t\t...SubscribedEmails\n\t\t\t}\n\t\t\ttotalItems\n       }\n    }\n\t","\n"]);return f=function(){return t},t}function p(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{UmAP:function(c,o,u){"use strict";u.r(o),u.d(o,"MailSubscriptionUIModule",(function(){return ct})),u.d(o,"mailDetailBreadcrumb",(function(){return rt}));var p=u("sEIs"),v=u("ixhn"),h=u("nIj0"),y=u("OxKu"),g=u("FOa3"),k=u("6Oco"),w=u("mWib"),O=u("kuMc"),S=u("TLy2"),E=u("7RXT"),P=u("H5qd"),j=u.n(P),R=u("JReq"),I=j.a(f(),R.a),C=j.a(m(),R.a),D=u("EM62"),F=u("DEd4"),x=u("Kej3"),M=u("s2Ay"),$=u("2kYt");function T(t,e){if(1&t){var n=D.jc();D.ic(0,"a",5),D.pc("click",(function(){return D.Mc(n),D.rc().downloadcsv()})),D.dc(1,"clr-icon",6),D.Xc(2),D.sc(3,"translate"),D.hc()}2&t&&(D.Rb(2),D.Zc(" ",D.tc(3,1,"vdr-subscription-plugin.download-csv")," "))}var A=function(){return["./create"]};function V(t,e){1&t&&(D.ic(0,"a",7),D.dc(1,"clr-icon",8),D.Xc(2),D.sc(3,"translate"),D.hc()),2&t&&(D.yc("routerLink",D.Cc(4,A)),D.Rb(2),D.Zc(" ",D.tc(3,2,"vdr-subscription-plugin.create-new-email")," "))}var X=function(t){return["/extensions","subscribedmails",t]};function _(t,e){if(1&t&&(D.ic(0,"td",11),D.dc(1,"vdr-table-row-action",12),D.sc(2,"translate"),D.hc()),2&t){var n=D.rc().item;D.Rb(1),D.yc("label",D.tc(2,2,"common.edit"))("linkTo",D.Dc(4,X,n.id))}}function Y(t,e){if(1&t){var n=D.jc();D.ic(0,"td",11),D.ic(1,"vdr-dropdown"),D.ic(2,"button",13),D.Xc(3),D.sc(4,"translate"),D.dc(5,"clr-icon",14),D.hc(),D.ic(6,"vdr-dropdown-menu",15),D.ic(7,"button",16),D.pc("click",(function(){D.Mc(n);var t=D.rc().item;return D.rc().deleteEmail(t.id)})),D.dc(8,"clr-icon",17),D.Xc(9),D.sc(10,"translate"),D.hc(),D.hc(),D.hc(),D.hc()}2&t&&(D.Rb(3),D.Zc(" ",D.tc(4,2,"common.actions")," "),D.Rb(6),D.Zc(" ",D.tc(10,4,"common.delete")," "))}function q(t,e){if(1&t&&(D.ic(0,"td",9),D.Xc(1),D.hc(),D.ic(2,"td",9),D.Xc(3),D.sc(4,"date"),D.hc(),D.ic(5,"td",9),D.Xc(6),D.sc(7,"date"),D.hc(),D.Vc(8,_,3,6,"td",10),D.Vc(9,Y,11,6,"td",10)),2&t){var n=e.item;D.Rb(1),D.Yc(n.email),D.Rb(2),D.Yc(D.uc(4,5,n.createdAt,"longDate")),D.Rb(3),D.Yc(D.uc(7,8,n.updatedAt,"longDate")),D.Rb(2),D.yc("vdrIfPermissions","UpdateSettings"),D.Rb(1),D.yc("vdrIfPermissions","DeleteSettings")}}var B,L=((B=function(t){a(n,t);var e=s(n);function n(t,c,r,a,o,s){var u,m;return i(this,n),(m=e.call(this,o,s)).dataService=t,m.modalService=c,m.notificationService=r,m.apollo=a,m.searchTerm=new h.f(""),d((u=l(m),b(n.prototype)),"setQueryFn",u).call(u,(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return m.dataService.query(I,e)}),(function(t){return t.SubscriptionEmails}),(function(t,e){return{options:{skip:t,take:e,filter:{email:{contains:m.searchTerm.value}},sort:{updatedAt:g.a.Desc}}}})),m}return r(n,[{key:"ngOnInit",value:function(){var t=this;d(b(n.prototype),"ngOnInit",this).call(this),this.searchTerm.valueChanges.pipe(Object(w.a)(250),Object(O.a)(this.destroy$)).subscribe((function(){t.refresh()}))}},{key:"downloadcsv",value:function(){this.apollo.watchQuery({query:I,variables:[]}).valueChanges.subscribe((function(t){E.a.exportToCsv("danfe-subscribed-emails.csv",t.data.SubscriptionEmails.items)}))}},{key:"deleteEmail",value:function(t){var e=this,n=[t];this.modalService.dialog({title:Object(y.a)("vdr-subscription-plugin.confirm-delete-email"),buttons:[{type:"secondary",label:Object(y.a)("common.cancel")},{type:"danger",label:Object(y.a)("common.delete"),returnValue:!0}]}).pipe(Object(S.a)((function(t){return t?e.dataService.mutate(C,{input:n}):k.a}))).subscribe((function(){e.notificationService.success(Object(y.a)("common.notify-delete-success"),{entity:"Email"}),e.refresh()}),(function(t){e.notificationService.error(Object(y.a)("common.notify-delete-error"),{entity:"Email"})}))}}]),n}(v.w)).\u0275fac=function(t){return new(t||B)(D.cc(v.K),D.cc(v.Ab),D.cc(v.Bb),D.cc(F.b),D.cc(p.e),D.cc(p.a))},B.\u0275cmp=D.Wb({type:B,selectors:[["vdr-all-mails-list"]],features:[D.Ob],decls:25,vars:27,consts:[["type","text","name","searchTerm",1,"clr-input","search-input",3,"formControl","placeholder"],["locationId","email-list"],["href","javascript:void(0)","class","btn btn-primary","id","downloadbtn",3,"click",4,"vdrIfPermissions"],["class","btn btn-primary","id","createbtn",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],["href","javascript:void(0)","id","downloadbtn",1,"btn","btn-primary",3,"click"],["shape","download-cloud"],["id","createbtn",1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],["class","right align-middle",4,"vdrIfPermissions"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click"],["shape","trash",1,"is-danger"]],template:function(t,e){1&t&&(D.ic(0,"vdr-action-bar"),D.ic(1,"vdr-ab-left"),D.dc(2,"input",0),D.sc(3,"translate"),D.hc(),D.ic(4,"vdr-ab-right"),D.dc(5,"vdr-action-bar-items",1),D.Vc(6,T,4,3,"a",2),D.Vc(7,V,4,5,"a",3),D.hc(),D.hc(),D.ic(8,"vdr-data-table",4),D.pc("pageChange",(function(t){return e.setPageNumber(t)}))("itemsPerPageChange",(function(t){return e.setItemsPerPage(t)})),D.sc(9,"async"),D.sc(10,"async"),D.sc(11,"async"),D.sc(12,"async"),D.ic(13,"vdr-dt-column"),D.Xc(14),D.sc(15,"translate"),D.hc(),D.ic(16,"vdr-dt-column"),D.Xc(17),D.sc(18,"translate"),D.hc(),D.ic(19,"vdr-dt-column"),D.Xc(20),D.sc(21,"translate"),D.hc(),D.dc(22,"vdr-dt-column"),D.dc(23,"vdr-dt-column"),D.Vc(24,q,10,11,"ng-template"),D.hc()),2&t&&(D.Rb(2),D.yc("formControl",e.searchTerm)("placeholder",D.tc(3,11,"vdr-subscription-plugin.search-by-email")),D.Rb(4),D.yc("vdrIfPermissions","CreateSettings"),D.Rb(1),D.yc("vdrIfPermissions","CreateSettings"),D.Rb(1),D.yc("items",D.tc(9,13,e.items$))("itemsPerPage",D.tc(10,15,e.itemsPerPage$))("totalItems",D.tc(11,17,e.totalItems$))("currentPage",D.tc(12,19,e.currentPage$)),D.Rb(6),D.Yc(D.tc(15,21,"vdr-subscription-plugin.email")),D.Rb(3),D.Yc(D.tc(18,23,"vdr-subscription-plugin.created")),D.Rb(3),D.Yc(D.tc(21,25,"vdr-subscription-plugin.updated")))},directives:[v.c,v.e,v.eb,h.b,h.p,h.g,v.f,v.d,v.rb,v.M,v.L,x.o,p.h,v.Pb,v.S,v.V,v.U,v.T],pipes:[M.d,$.b,$.f],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"],changeDetection:0}),B),Z=u("ROBh"),K=u("xVbo"),U=u("7SLS"),J=j.a(n(),R.a),G=j.a(e(),R.a);function N(t,e){if(1&t){var n=D.jc();D.ic(0,"button",5),D.pc("click",(function(){return D.Mc(n),D.rc().create()})),D.Xc(1),D.sc(2,"translate"),D.hc()}if(2&t){var i=D.rc();D.yc("disabled",!(i.detailForm.valid&&i.detailForm.dirty)),D.Rb(1),D.Zc(" ",D.tc(2,2,"common.create")," ")}}function W(t,e){if(1&t){var n=D.jc();D.ic(0,"button",6),D.pc("click",(function(){return D.Mc(n),D.rc().save()})),D.Xc(1),D.sc(2,"translate"),D.hc()}if(2&t){var i=D.rc();D.yc("disabled",!(i.detailForm.valid&&i.detailForm.dirty)),D.Rb(1),D.Zc(" ",D.tc(2,2,"common.update")," ")}}var z,Q,H,tt=((z=function(t){a(n,t);var e=s(n);function n(t,c,r,a,o,s,u){var l;return i(this,n),(l=e.call(this,t,c,r,o)).formBuilder=a,l.dataService=o,l.changeDetector=s,l.notificationService=u,l.which=!1,l.detailForm=l.formBuilder.group({email:["",h.C.required]}),l}return r(n,[{key:"ngOnInit",value:function(){"/extensions/subscribedmails/create"!=this.router.url?(this.which=!1,this.init()):this.which=!0}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"create",value:function(){var t=this;this.addNew().pipe(Object(K.a)((function(t){return!!t}))).subscribe((function(){t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success("common.notify-create-success",{entity:"Email"})}),(function(){t.notificationService.error("common.notify-create-error",{entity:"Email"})}))}},{key:"save",value:function(){var t=this;this.saveChanges().pipe(Object(K.a)((function(t){return!!t}))).subscribe((function(){t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success("common.notify-update-success",{entity:"Email"})}),(function(){t.notificationService.error("common.notify-update-error",{entity:"Email"})}))}},{key:"addNew",value:function(){if(this.detailForm.dirty){var t=[{email:this.detailForm.value.email}];return this.dataService.mutate(G,{input:t}).pipe(Object(U.a)(!0))}return Object(Z.a)(!1)}},{key:"saveChanges",value:function(){if(this.detailForm.dirty){var t=this.detailForm.value,e=[{id:this.id,email:t.email}];return this.dataService.mutate(J,{input:e}).pipe(Object(U.a)(!0))}return Object(Z.a)(!1)}},{key:"setFormValues",value:function(t){this.detailForm.patchValue({email:t.email})}}]),n}(v.u)).\u0275fac=function(t){return new(t||z)(D.cc(p.a),D.cc(p.e),D.cc(v.Jb),D.cc(h.e),D.cc(v.K),D.cc(D.k),D.cc(v.Bb))},z.\u0275cmp=D.Wb({type:z,selectors:[["vdr-subscription-mail-detail"]],features:[D.Ob],decls:9,vars:7,consts:[["class","btn btn-primary","id","custbtn",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","email",3,"label"],["id","email","type","email","formControlName","email",3,"readonly"],["id","custbtn",1,"btn","btn-primary",3,"disabled","click"],["id","editbtn",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(D.ic(0,"vdr-action-bar"),D.ic(1,"vdr-ab-right"),D.Vc(2,N,3,4,"button",0),D.Vc(3,W,3,4,"ng-template",null,1,D.Wc),D.hc(),D.hc(),D.ic(5,"form",2),D.ic(6,"vdr-form-field",3),D.sc(7,"translate"),D.dc(8,"input",4),D.hc(),D.hc()),2&t){var n=D.Jc(4);D.Rb(2),D.yc("ngIf",e.which)("ngIfElse",n),D.Rb(3),D.yc("formGroup",e.detailForm),D.Rb(1),D.yc("label",D.tc(7,5,"vdr-subscription-plugin.email-label")),D.Rb(2),D.yc("readonly",!1)}},directives:[v.c,v.f,$.p,h.E,h.q,h.j,v.db,v.eb,h.b,h.p,h.h],pipes:[M.d],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]}),z),et=j.a(t(),R.a),nt=((Q=function(t){a(n,t);var e=s(n);function n(t,c){return i(this,n),e.call(this,t,{__typename:"Email",id:"",email:"",createdAt:"",updatedAt:""},(function(t){return c.query(et,{id:t}).mapStream((function(t){return t.SubscriptionEmail}))}))}return n}(v.v)).\u0275fac=function(t){return new(t||Q)(D.mc(p.e),D.mc(v.K))},Q.\u0275prov=D.Yb({token:Q,factory:Q.\u0275fac}),Q),it=u("YtkY"),ct=((H=function t(){i(this,t)}).\u0275mod=D.ac({type:H}),H.\u0275inj=D.Zb({factory:function(t){return new(t||H)},providers:[nt],imports:[[v.Kb,p.i.forChild([{path:"",pathMatch:"full",component:L,data:{breadcrumb:"Subscribed Mails"}},{path:"create",component:tt,data:{breadcrumb:[{label:"Subscribed Mails",link:["/extensions","subscribedmails"]},{label:"Create Email",link:[]}]}},{path:":id",component:tt,resolve:Object(v.Vb)(nt),data:{breadcrumb:rt}}])]]}),H);function rt(t){return t.entity.pipe(Object(it.a)((function(t){return[{label:"Subscribed Mails",link:["/extensions","subscribedmails"]},{label:""+t.email,link:[]}]})))}}}])}();