(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{tB2i:function(e,c,t){"use strict";t.r(c),t.d(c,"HealthCheckComponent",(function(){return S})),t.d(c,"JobListComponent",(function(){return N})),t.d(c,"JobStateLabelComponent",(function(){return E})),t.d(c,"SystemModule",(function(){return D})),t.d(c,"systemRoutes",(function(){return q})),t.d(c,"\u02750",(function(){return T})),t.d(c,"\u02751",(function(){return M}));var n=t("D57K"),s=t("EM62"),r=t("ixhn"),o=t("nIj0"),a=t("sEIs"),d=t("8lHc"),i=t("kuMc"),l=t("xVbo"),u=t("YtkY"),b=t("OxKu"),m=t("2kYt"),h=t("Kej3"),p=t("s2Ay"),f=t("jY47");function g(e,c){1&e&&(s.mc(0),s.cd(1),s.zc(2,"translate"),s.lc()),2&e&&(s.Wb(1),s.ed(" ",s.Ac(2,1,"system.health-all-systems-up")," "))}function y(e,c){1&e&&(s.cd(0),s.zc(1,"translate")),2&e&&s.ed(" ",s.Ac(1,1,"system.health-error")," ")}const v=function(e,c){return{"is-success":e,"is-danger":c}};function j(e,c){if(1&e&&(s.oc(0,"div",7),s.oc(1,"div",8),s.jc(2,"clr-icon",9),s.nc(),s.oc(3,"div",10),s.ad(4,g,3,3,"ng-container",11),s.ad(5,y,2,3,"ng-template",null,12,s.bd),s.oc(7,"div",13),s.cd(8),s.zc(9,"translate"),s.zc(10,"date"),s.zc(11,"async"),s.nc(),s.nc(),s.nc()),2&e){const e=c.ngIf,t=s.Qc(6),n=s.yc();s.Wb(2),s.Fc("ngClass",s.Lc(13,v,"ok"===e,"ok"!==e)),s.Xb("shape","ok"===e?"check-circle":"exclamation-circle"),s.Wb(2),s.Fc("ngIf","ok"===e)("ngIfElse",t),s.Wb(4),s.fd(" ",s.Ac(9,6,"system.health-last-checked"),": ",s.Bc(10,8,s.Ac(11,11,n.healthCheckService.lastCheck$),"mediumTime")," ")}}function W(e,c){1&e&&(s.mc(0),s.jc(1,"clr-icon",17),s.cd(2),s.zc(3,"translate"),s.lc()),2&e&&(s.Wb(2),s.ed(" ",s.Ac(3,1,"system.health-status-up")," "))}function k(e,c){1&e&&(s.jc(0,"clr-icon",18),s.cd(1),s.zc(2,"translate")),2&e&&(s.Wb(1),s.ed(" ",s.Ac(2,1,"system.health-status-down")," "))}function w(e,c){if(1&e&&(s.oc(0,"tr"),s.oc(1,"td",14),s.cd(2),s.nc(),s.oc(3,"td",14),s.oc(4,"vdr-chip",15),s.ad(5,W,4,3,"ng-container",11),s.ad(6,k,3,3,"ng-template",null,16,s.bd),s.nc(),s.nc(),s.oc(8,"td",14),s.cd(9),s.nc(),s.nc()),2&e){const e=c.$implicit,t=s.Qc(7);s.Wb(2),s.dd(e.key),s.Wb(2),s.Fc("colorType","up"===e.result.status?"success":"error"),s.Wb(1),s.Fc("ngIf","up"===e.result.status)("ngIfElse",t),s.Wb(4),s.dd(e.result.message)}}function A(e,c){1&e&&(s.mc(0),s.cd(1),s.zc(2,"translate"),s.lc()),2&e&&(s.Wb(1),s.ed(" ",s.Ac(2,1,"system.all-job-queues")," "))}function I(e,c){if(1&e&&(s.oc(0,"vdr-chip",8),s.cd(1),s.nc()),2&e){const e=s.yc().item;s.Fc("colorFrom",e.name),s.Wb(1),s.dd(e.name)}}function F(e,c){if(1&e&&(s.ad(0,A,3,3,"ng-container",6),s.ad(1,I,2,2,"ng-template",null,7,s.bd)),2&e){const e=c.item,t=s.Qc(2);s.Fc("ngIf","all"===e.name)("ngIfElse",t)}}function z(e,c){if(1&e&&(s.oc(0,"vdr-dropdown"),s.oc(1,"button",13),s.zc(2,"translate"),s.jc(3,"clr-icon",14),s.nc(),s.oc(4,"vdr-dropdown-menu"),s.oc(5,"div",15),s.jc(6,"vdr-object-tree",16),s.nc(),s.nc(),s.nc()),2&e){const e=s.yc().item;s.Wb(1),s.Fc("title",s.Ac(2,2,"system.job-data")),s.Wb(5),s.Fc("value",e.data)}}function C(e,c){if(1&e&&(s.oc(0,"vdr-dropdown"),s.oc(1,"button",17),s.jc(2,"clr-icon",14),s.cd(3),s.zc(4,"translate"),s.nc(),s.oc(5,"vdr-dropdown-menu"),s.oc(6,"div",15),s.jc(7,"vdr-object-tree",16),s.nc(),s.nc(),s.nc()),2&e){const e=s.yc().item;s.Wb(3),s.ed(" ",s.Ac(4,2,"system.job-result")," "),s.Wb(4),s.Fc("value",e.result)}}function O(e,c){if(1&e&&(s.oc(0,"vdr-dropdown"),s.oc(1,"button",17),s.jc(2,"clr-icon",18),s.cd(3),s.zc(4,"translate"),s.nc(),s.oc(5,"vdr-dropdown-menu"),s.oc(6,"div",15),s.cd(7),s.nc(),s.nc(),s.nc()),2&e){const e=s.yc().item;s.Wb(3),s.ed(" ",s.Ac(4,2,"system.job-error")," "),s.Wb(4),s.ed(" ",e.error," ")}}function P(e,c){if(1&e&&(s.oc(0,"td",9),s.jc(1,"vdr-entity-info",10),s.nc(),s.oc(2,"td",9),s.ad(3,z,7,4,"vdr-dropdown",11),s.oc(4,"vdr-chip",8),s.cd(5),s.nc(),s.nc(),s.oc(6,"td",9),s.cd(7),s.zc(8,"timeAgo"),s.nc(),s.oc(9,"td",9),s.jc(10,"vdr-job-state-label",12),s.nc(),s.oc(11,"td",9),s.cd(12),s.zc(13,"duration"),s.nc(),s.oc(14,"td",9),s.ad(15,C,8,4,"vdr-dropdown",11),s.ad(16,O,8,4,"vdr-dropdown",11),s.nc()),2&e){const e=c.item,t=s.yc();s.Wb(1),s.Fc("entity",e),s.Wb(2),s.Fc("ngIf",e.data),s.Wb(1),s.Fc("colorFrom",e.queueName),s.Wb(1),s.dd(e.queueName),s.Wb(2),s.dd(s.Ac(8,9,e.createdAt)),s.Wb(3),s.Fc("job",e),s.Wb(2),s.dd(s.Ac(13,11,e.duration)),s.Wb(3),s.Fc("ngIf",t.hasResult(e)),s.Wb(1),s.Fc("ngIf",e.error)}}function x(e,c){if(1&e&&(s.oc(0,"span",2),s.cd(1),s.zc(2,"percent"),s.nc()),2&e){const e=s.yc();s.Wb(1),s.ed(" ",s.Ac(2,1,e.job.progress/100)," ")}}let S=class{constructor(e){this.healthCheckService=e}};S.\u0275fac=function(e){return new(e||S)(s.ic(r.hb))},S.\u0275cmp=s.cc({type:S,selectors:[["vdr-health-check"]],decls:25,vars:18,consts:[["class","system-status-header",4,"ngIf"],["locationId","system-status"],[1,"btn","btn-secondary",3,"click"],["shape","refresh"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"],[1,"system-status-header"],[1,"status-icon"],["size","48",3,"ngClass"],[1,"status-detail"],[4,"ngIf","ngIfElse"],["error",""],[1,"last-checked"],[1,"align-middle","left"],[3,"colorType"],["down",""],["shape","check-circle"],["shape","exclamation-circle"]],template:function(e,c){1&e&&(s.oc(0,"vdr-action-bar"),s.oc(1,"vdr-ab-left"),s.ad(2,j,12,16,"div",0),s.zc(3,"async"),s.nc(),s.oc(4,"vdr-ab-right"),s.jc(5,"vdr-action-bar-items",1),s.oc(6,"button",2),s.wc("click",(function(){return c.healthCheckService.refresh()})),s.jc(7,"clr-icon",3),s.cd(8),s.zc(9,"translate"),s.nc(),s.nc(),s.nc(),s.oc(10,"table",4),s.oc(11,"thead"),s.oc(12,"tr"),s.oc(13,"th",5),s.cd(14),s.zc(15,"translate"),s.nc(),s.oc(16,"th",5),s.cd(17),s.zc(18,"translate"),s.nc(),s.oc(19,"th",5),s.cd(20),s.zc(21,"translate"),s.nc(),s.nc(),s.nc(),s.oc(22,"tbody"),s.ad(23,w,10,5,"tr",6),s.zc(24,"async"),s.nc(),s.nc()),2&e&&(s.Wb(2),s.Fc("ngIf",s.Ac(3,6,c.healthCheckService.status$)),s.Wb(6),s.ed(" ",s.Ac(9,8,"system.health-refresh")," "),s.Wb(6),s.ed(" ",s.Ac(15,10,"common.name")," "),s.Wb(3),s.ed(" ",s.Ac(18,12,"system.health-status")," "),s.Wb(3),s.ed(" ",s.Ac(21,14,"system.health-message")," "),s.Wb(3),s.Fc("ngForOf",s.Ac(24,16,c.healthCheckService.details$)))},directives:[r.c,r.e,m.p,r.f,r.d,h.o,m.o,m.n,r.B],pipes:[m.b,p.d,m.f],styles:[".system-status-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.system-status-header[_ngcontent-%COMP%]   .status-detail[_ngcontent-%COMP%]{font-weight:700}.system-status-header[_ngcontent-%COMP%]   .last-checked[_ngcontent-%COMP%]{font-weight:400;color:#525456}"],changeDetection:0}),S.ctorParameters=()=>[{type:r.hb}],S=Object(n.c)([Object(n.f)("design:paramtypes",[r.hb])],S);let N=class extends r.w{constructor(e,c,t,n,s){super(n,s),this.dataService=e,this.modalService=c,this.notificationService=t,this.liveUpdate=new o.f(!0),this.hideSettled=new o.f(!0),this.queueFilter=new o.f("all"),super.setQueryFn((...e)=>this.dataService.settings.getAllJobs(...e),e=>e.jobs,(e,c)=>{const t="all"===this.queueFilter.value?null:{queueName:{eq:this.queueFilter.value}},n=this.hideSettled.value;return{options:{skip:e,take:c,filter:Object.assign(Object.assign({},t),n?{isSettled:{eq:!1}}:{}),sort:{createdAt:r.Ib.DESC}}}})}ngOnInit(){super.ngOnInit(),Object(d.a)(5e3,2e3).pipe(Object(i.a)(this.destroy$),Object(l.a)(()=>this.liveUpdate.value)).subscribe(()=>{this.refresh()}),this.queues$=this.dataService.settings.getJobQueues().mapStream(e=>e.jobQueues).pipe(Object(u.a)(e=>[{name:"all",running:!0},...e]))}hasResult(e){const c=e.result;return null!=c&&("object"!=typeof c||Object.keys(c).length>0)}};N.\u0275fac=function(e){return new(e||N)(s.ic(r.K),s.ic(r.xb),s.ic(r.yb),s.ic(a.e),s.ic(a.a))},N.\u0275cmp=s.cc({type:N,selectors:[["vdr-job-list"]],features:[s.Tb],decls:40,vars:45,consts:[["type","checkbox","clrCheckbox","","name","live-update",3,"formControl"],["type","checkbox","clrCheckbox","","name","hide-settled",3,"formControl","change"],["bindValue","name",3,"addTag","items","hideSelected","multiple","markFirst","clearable","searchable","formControl","change"],["ng-label-tmp","","ng-option-tmp",""],["locationId","job-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[4,"ngIf","ngIfElse"],["others",""],[3,"colorFrom"],[1,"left","align-middle"],[3,"entity"],[4,"ngIf"],[3,"job"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-icon",3,"title"],["shape","details"],[1,"result-detail"],[3,"value"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-sm","details-button"],["shape","exclamation-circle"]],template:function(e,c){1&e&&(s.oc(0,"vdr-action-bar"),s.oc(1,"vdr-ab-left"),s.oc(2,"clr-checkbox-container"),s.oc(3,"clr-checkbox-wrapper"),s.jc(4,"input",0),s.oc(5,"label"),s.cd(6),s.zc(7,"translate"),s.nc(),s.nc(),s.oc(8,"clr-checkbox-wrapper"),s.oc(9,"input",1),s.wc("change",(function(){return c.refresh()})),s.nc(),s.oc(10,"label"),s.cd(11),s.zc(12,"translate"),s.nc(),s.nc(),s.nc(),s.nc(),s.oc(13,"vdr-ab-right"),s.oc(14,"ng-select",2),s.wc("change",(function(){return c.refresh()})),s.zc(15,"async"),s.ad(16,F,3,2,"ng-template",3),s.nc(),s.jc(17,"vdr-action-bar-items",4),s.nc(),s.nc(),s.oc(18,"vdr-data-table",5),s.wc("pageChange",(function(e){return c.setPageNumber(e)}))("itemsPerPageChange",(function(e){return c.setItemsPerPage(e)})),s.zc(19,"async"),s.zc(20,"async"),s.zc(21,"async"),s.zc(22,"async"),s.jc(23,"vdr-dt-column"),s.oc(24,"vdr-dt-column"),s.cd(25),s.zc(26,"translate"),s.nc(),s.oc(27,"vdr-dt-column"),s.cd(28),s.zc(29,"translate"),s.nc(),s.oc(30,"vdr-dt-column"),s.cd(31),s.zc(32,"translate"),s.nc(),s.oc(33,"vdr-dt-column"),s.cd(34),s.zc(35,"translate"),s.nc(),s.oc(36,"vdr-dt-column"),s.cd(37),s.zc(38,"translate"),s.nc(),s.ad(39,P,17,13,"ng-template"),s.nc()),2&e&&(s.Wb(4),s.Fc("formControl",c.liveUpdate),s.Wb(2),s.dd(s.Ac(7,21,"common.live-update")),s.Wb(3),s.Fc("formControl",c.hideSettled),s.Wb(2),s.dd(s.Ac(12,23,"system.hide-settled-jobs")),s.Wb(3),s.Fc("addTag",!1)("items",s.Ac(15,25,c.queues$))("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",c.queueFilter),s.Wb(4),s.Fc("items",s.Ac(19,27,c.items$))("itemsPerPage",s.Ac(20,29,c.itemsPerPage$))("totalItems",s.Ac(21,31,c.totalItems$))("currentPage",s.Ac(22,33,c.currentPage$)),s.Wb(7),s.dd(s.Ac(26,35,"system.job-queue-name")),s.Wb(3),s.dd(s.Ac(29,37,"common.created-at")),s.Wb(3),s.dd(s.Ac(32,39,"system.job-state")),s.Wb(3),s.dd(s.Ac(35,41,"system.job-duration")),s.Wb(3),s.dd(s.Ac(38,43,"system.job-result")))},directives:function(){return[r.c,r.e,h.j,h.k,r.db,o.a,h.i,o.p,o.g,h.t,r.f,f.a,f.e,f.d,r.d,r.M,r.L,m.p,r.B,r.Z,E,r.S,r.V,h.o,r.U,r.zb]},pipes:function(){return[p.d,m.b,r.Mb,r.W]},styles:[".result-detail[_ngcontent-%COMP%]{margin:0 12px}"],changeDetection:0}),N.ctorParameters=()=>[{type:r.K},{type:r.xb},{type:r.yb},{type:a.e},{type:a.a}],N=Object(n.c)([Object(n.f)("design:paramtypes",[r.K,r.xb,r.yb,a.e,a.a])],N);let E=class{get iconShape(){switch(this.job.state){case r.rb.COMPLETED:return"check-circle";case r.rb.FAILED:return"exclamation-circle";case r.rb.PENDING:case r.rb.RETRYING:return"hourglass";case r.rb.RUNNING:return"sync"}}get colorType(){switch(this.job.state){case r.rb.COMPLETED:return"success";case r.rb.FAILED:return"error";case r.rb.PENDING:case r.rb.RETRYING:return"";case r.rb.RUNNING:return"warning"}}};E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=s.cc({type:E,selectors:[["vdr-job-state-label"]],inputs:{job:"job"},decls:5,vars:6,consts:[[3,"colorType"],["class","progress",4,"ngIf"],[1,"progress"]],template:function(e,c){1&e&&(s.oc(0,"vdr-chip",0),s.jc(1,"clr-icon"),s.cd(2),s.zc(3,"titlecase"),s.ad(4,x,3,3,"span",1),s.nc()),2&e&&(s.Fc("colorType",c.colorType),s.Wb(1),s.Xb("shape",c.iconShape),s.Wb(1),s.ed(" ",s.Ac(3,4,c.job.state)," "),s.Wb(2),s.Fc("ngIf","RUNNING"===c.job.state))},directives:[r.B,h.o,m.p],pipes:[m.z,m.w],styles:[".progress[_ngcontent-%COMP%]{margin-left:3px}clr-icon[_ngcontent-%COMP%]{min-width:12px}"],changeDetection:0}),Object(n.c)([Object(s.D)(),Object(n.f)("design:type",Object)],E.prototype,"job",void 0);const T={breadcrumb:Object(b.a)("breadcrumb.job-queue")},M={breadcrumb:Object(b.a)("breadcrumb.system-status")},q=[{path:"jobs",component:N,data:T},{path:"system-status",component:S,data:M}];let D=class{};D.\u0275mod=s.gc({type:D}),D.\u0275inj=s.fc({factory:function(e){return new(e||D)},imports:[[r.Hb,a.i.forChild(q)]]})}}]);