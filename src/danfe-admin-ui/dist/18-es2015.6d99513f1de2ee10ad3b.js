(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{tB2i:function(e,c,t){"use strict";t.r(c),t.d(c,"HealthCheckComponent",(function(){return N})),t.d(c,"JobListComponent",(function(){return F})),t.d(c,"JobStateLabelComponent",(function(){return T})),t.d(c,"SystemModule",(function(){return Z})),t.d(c,"systemRoutes",(function(){return M})),t.d(c,"\u02750",(function(){return q})),t.d(c,"\u02751",(function(){return D}));var n=t("D57K"),s=t("EM62"),r=t("ixhn"),a=t("nIj0"),o=t("sEIs"),i=t("8lHc"),d=t("kuMc"),l=t("xVbo"),b=t("YtkY"),m=t("OxKu"),u=t("2kYt"),h=t("Kej3"),p=t("s2Ay"),y=t("jY47");function f(e,c){1&e&&(s.lc(0),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Vb(1),s.dd(" ",s.zc(2,1,"system.health-all-systems-up")," "))}function g(e,c){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.dd(" ",s.zc(1,1,"system.health-error")," ")}const v=function(e,c){return{"is-success":e,"is-danger":c}};function j(e,c){if(1&e&&(s.nc(0,"div",7),s.nc(1,"div",8),s.ic(2,"clr-icon",9),s.mc(),s.nc(3,"div",10),s.Zc(4,f,3,3,"ng-container",11),s.Zc(5,g,2,3,"ng-template",null,12,s.ad),s.nc(7,"div",13),s.bd(8),s.yc(9,"translate"),s.yc(10,"date"),s.yc(11,"async"),s.mc(),s.mc(),s.mc()),2&e){const e=c.ngIf,t=s.Pc(6),n=s.xc();s.Vb(2),s.Ec("ngClass",s.Kc(13,v,"ok"===e,"ok"!==e)),s.Wb("shape","ok"===e?"check-circle":"exclamation-circle"),s.Vb(2),s.Ec("ngIf","ok"===e)("ngIfElse",t),s.Vb(4),s.ed(" ",s.zc(9,6,"system.health-last-checked"),": ",s.Ac(10,8,s.zc(11,11,n.healthCheckService.lastCheck$),"mediumTime")," ")}}function V(e,c){1&e&&(s.lc(0),s.ic(1,"clr-icon",17),s.bd(2),s.yc(3,"translate"),s.kc()),2&e&&(s.Vb(2),s.dd(" ",s.zc(3,1,"system.health-status-up")," "))}function k(e,c){1&e&&(s.ic(0,"clr-icon",18),s.bd(1),s.yc(2,"translate")),2&e&&(s.Vb(1),s.dd(" ",s.zc(2,1,"system.health-status-down")," "))}function E(e,c){if(1&e&&(s.nc(0,"tr"),s.nc(1,"td",14),s.bd(2),s.mc(),s.nc(3,"td",14),s.nc(4,"vdr-chip",15),s.Zc(5,V,4,3,"ng-container",11),s.Zc(6,k,3,3,"ng-template",null,16,s.ad),s.mc(),s.mc(),s.nc(8,"td",14),s.bd(9),s.mc(),s.mc()),2&e){const e=c.$implicit,t=s.Pc(7);s.Vb(2),s.cd(e.key),s.Vb(2),s.Ec("colorType","up"===e.result.status?"success":"error"),s.Vb(1),s.Ec("ngIf","up"===e.result.status)("ngIfElse",t),s.Vb(4),s.cd(e.result.message)}}function I(e,c){1&e&&(s.lc(0),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Vb(1),s.dd(" ",s.zc(2,1,"system.all-job-queues")," "))}function w(e,c){if(1&e&&(s.nc(0,"vdr-chip",8),s.bd(1),s.mc()),2&e){const e=s.xc().item;s.Ec("colorFrom",e.name),s.Vb(1),s.cd(e.name)}}function z(e,c){if(1&e&&(s.Zc(0,I,3,3,"ng-container",6),s.Zc(1,w,2,2,"ng-template",null,7,s.ad)),2&e){const e=c.item,t=s.Pc(2);s.Ec("ngIf","all"===e.name)("ngIfElse",t)}}function C(e,c){if(1&e&&(s.nc(0,"vdr-dropdown"),s.nc(1,"button",13),s.yc(2,"translate"),s.ic(3,"clr-icon",14),s.mc(),s.nc(4,"vdr-dropdown-menu"),s.nc(5,"div",15),s.ic(6,"vdr-object-tree",16),s.mc(),s.mc(),s.mc()),2&e){const e=s.xc().item;s.Vb(1),s.Ec("title",s.zc(2,2,"system.job-data")),s.Vb(5),s.Ec("value",e.data)}}function O(e,c){if(1&e&&(s.nc(0,"vdr-dropdown"),s.nc(1,"button",17),s.ic(2,"clr-icon",14),s.bd(3),s.yc(4,"translate"),s.mc(),s.nc(5,"vdr-dropdown-menu"),s.nc(6,"div",15),s.ic(7,"vdr-object-tree",16),s.mc(),s.mc(),s.mc()),2&e){const e=s.xc().item;s.Vb(3),s.dd(" ",s.zc(4,2,"system.job-result")," "),s.Vb(4),s.Ec("value",e.result)}}function P(e,c){if(1&e&&(s.nc(0,"vdr-dropdown"),s.nc(1,"button",17),s.ic(2,"clr-icon",18),s.bd(3),s.yc(4,"translate"),s.mc(),s.nc(5,"vdr-dropdown-menu"),s.nc(6,"div",15),s.bd(7),s.mc(),s.mc(),s.mc()),2&e){const e=s.xc().item;s.Vb(3),s.dd(" ",s.zc(4,2,"system.job-error")," "),s.Vb(4),s.dd(" ",e.error," ")}}function x(e,c){if(1&e&&(s.nc(0,"td",9),s.ic(1,"vdr-entity-info",10),s.mc(),s.nc(2,"td",9),s.Zc(3,C,7,4,"vdr-dropdown",11),s.nc(4,"vdr-chip",8),s.bd(5),s.mc(),s.mc(),s.nc(6,"td",9),s.bd(7),s.yc(8,"timeAgo"),s.mc(),s.nc(9,"td",9),s.ic(10,"vdr-job-state-label",12),s.mc(),s.nc(11,"td",9),s.bd(12),s.yc(13,"duration"),s.mc(),s.nc(14,"td",9),s.Zc(15,O,8,4,"vdr-dropdown",11),s.Zc(16,P,8,4,"vdr-dropdown",11),s.mc()),2&e){const e=c.item,t=s.xc();s.Vb(1),s.Ec("entity",e),s.Vb(2),s.Ec("ngIf",e.data),s.Vb(1),s.Ec("colorFrom",e.queueName),s.Vb(1),s.cd(e.queueName),s.Vb(2),s.cd(s.zc(8,9,e.createdAt)),s.Vb(3),s.Ec("job",e),s.Vb(2),s.cd(s.zc(13,11,e.duration)),s.Vb(3),s.Ec("ngIf",t.hasResult(e)),s.Vb(1),s.Ec("ngIf",e.error)}}function S(e,c){if(1&e&&(s.nc(0,"span",2),s.bd(1),s.yc(2,"percent"),s.mc()),2&e){const e=s.xc();s.Vb(1),s.dd(" ",s.zc(2,1,e.job.progress/100)," ")}}let N=class{constructor(e){this.healthCheckService=e}};N.\u0275fac=function(e){return new(e||N)(s.hc(r.ib))},N.\u0275cmp=s.bc({type:N,selectors:[["vdr-health-check"]],decls:25,vars:18,consts:[["class","system-status-header",4,"ngIf"],["locationId","system-status"],[1,"btn","btn-secondary",3,"click"],["shape","refresh"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"],[1,"system-status-header"],[1,"status-icon"],["size","48",3,"ngClass"],[1,"status-detail"],[4,"ngIf","ngIfElse"],["error",""],[1,"last-checked"],[1,"align-middle","left"],[3,"colorType"],["down",""],["shape","check-circle"],["shape","exclamation-circle"]],template:function(e,c){1&e&&(s.nc(0,"vdr-action-bar"),s.nc(1,"vdr-ab-left"),s.Zc(2,j,12,16,"div",0),s.yc(3,"async"),s.mc(),s.nc(4,"vdr-ab-right"),s.ic(5,"vdr-action-bar-items",1),s.nc(6,"button",2),s.vc("click",(function(){return c.healthCheckService.refresh()})),s.ic(7,"clr-icon",3),s.bd(8),s.yc(9,"translate"),s.mc(),s.mc(),s.mc(),s.nc(10,"table",4),s.nc(11,"thead"),s.nc(12,"tr"),s.nc(13,"th",5),s.bd(14),s.yc(15,"translate"),s.mc(),s.nc(16,"th",5),s.bd(17),s.yc(18,"translate"),s.mc(),s.nc(19,"th",5),s.bd(20),s.yc(21,"translate"),s.mc(),s.mc(),s.mc(),s.nc(22,"tbody"),s.Zc(23,E,10,5,"tr",6),s.yc(24,"async"),s.mc(),s.mc()),2&e&&(s.Vb(2),s.Ec("ngIf",s.zc(3,6,c.healthCheckService.status$)),s.Vb(6),s.dd(" ",s.zc(9,8,"system.health-refresh")," "),s.Vb(6),s.dd(" ",s.zc(15,10,"common.name")," "),s.Vb(3),s.dd(" ",s.zc(18,12,"system.health-status")," "),s.Vb(3),s.dd(" ",s.zc(21,14,"system.health-message")," "),s.Vb(3),s.Ec("ngForOf",s.zc(24,16,c.healthCheckService.details$)))},directives:[r.c,r.e,u.p,r.f,r.d,h.o,u.o,u.n,r.B],pipes:[u.b,p.d,u.f],styles:[".system-status-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.system-status-header[_ngcontent-%COMP%]   .status-detail[_ngcontent-%COMP%]{font-weight:700}.system-status-header[_ngcontent-%COMP%]   .last-checked[_ngcontent-%COMP%]{font-weight:400;color:#525456}"],changeDetection:0}),N.ctorParameters=()=>[{type:r.ib}],N=Object(n.c)([Object(n.f)("design:paramtypes",[r.ib])],N);let F=class extends r.w{constructor(e,c,t,n,s){super(n,s),this.dataService=e,this.modalService=c,this.notificationService=t,this.liveUpdate=new a.f(!0),this.hideSettled=new a.f(!0),this.queueFilter=new a.f("all"),super.setQueryFn((...e)=>this.dataService.settings.getAllJobs(...e),e=>e.jobs,(e,c)=>{const t="all"===this.queueFilter.value?null:{queueName:{eq:this.queueFilter.value}},n=this.hideSettled.value;return{options:{skip:e,take:c,filter:Object.assign(Object.assign({},t),n?{isSettled:{eq:!1}}:{}),sort:{createdAt:r.Kb.DESC}}}})}ngOnInit(){super.ngOnInit(),Object(i.a)(5e3,2e3).pipe(Object(d.a)(this.destroy$),Object(l.a)(()=>this.liveUpdate.value)).subscribe(()=>{this.refresh()}),this.queues$=this.dataService.settings.getJobQueues().mapStream(e=>e.jobQueues).pipe(Object(b.a)(e=>[{name:"all",running:!0},...e]))}hasResult(e){const c=e.result;return null!=c&&("object"!=typeof c||Object.keys(c).length>0)}};F.\u0275fac=function(e){return new(e||F)(s.hc(r.K),s.hc(r.yb),s.hc(r.zb),s.hc(o.e),s.hc(o.a))},F.\u0275cmp=s.bc({type:F,selectors:[["vdr-job-list"]],features:[s.Sb],decls:40,vars:45,consts:[["type","checkbox","clrCheckbox","","name","live-update",3,"formControl"],["type","checkbox","clrCheckbox","","name","hide-settled",3,"formControl","change"],["bindValue","name",3,"addTag","items","hideSelected","multiple","markFirst","clearable","searchable","formControl","change"],["ng-label-tmp","","ng-option-tmp",""],["locationId","job-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[4,"ngIf","ngIfElse"],["others",""],[3,"colorFrom"],[1,"left","align-middle"],[3,"entity"],[4,"ngIf"],[3,"job"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-icon",3,"title"],["shape","details"],[1,"result-detail"],[3,"value"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-sm","details-button"],["shape","exclamation-circle"]],template:function(e,c){1&e&&(s.nc(0,"vdr-action-bar"),s.nc(1,"vdr-ab-left"),s.nc(2,"clr-checkbox-container"),s.nc(3,"clr-checkbox-wrapper"),s.ic(4,"input",0),s.nc(5,"label"),s.bd(6),s.yc(7,"translate"),s.mc(),s.mc(),s.nc(8,"clr-checkbox-wrapper"),s.nc(9,"input",1),s.vc("change",(function(){return c.refresh()})),s.mc(),s.nc(10,"label"),s.bd(11),s.yc(12,"translate"),s.mc(),s.mc(),s.mc(),s.mc(),s.nc(13,"vdr-ab-right"),s.nc(14,"ng-select",2),s.vc("change",(function(){return c.refresh()})),s.yc(15,"async"),s.Zc(16,z,3,2,"ng-template",3),s.mc(),s.ic(17,"vdr-action-bar-items",4),s.mc(),s.mc(),s.nc(18,"vdr-data-table",5),s.vc("pageChange",(function(e){return c.setPageNumber(e)}))("itemsPerPageChange",(function(e){return c.setItemsPerPage(e)})),s.yc(19,"async"),s.yc(20,"async"),s.yc(21,"async"),s.yc(22,"async"),s.ic(23,"vdr-dt-column"),s.nc(24,"vdr-dt-column"),s.bd(25),s.yc(26,"translate"),s.mc(),s.nc(27,"vdr-dt-column"),s.bd(28),s.yc(29,"translate"),s.mc(),s.nc(30,"vdr-dt-column"),s.bd(31),s.yc(32,"translate"),s.mc(),s.nc(33,"vdr-dt-column"),s.bd(34),s.yc(35,"translate"),s.mc(),s.nc(36,"vdr-dt-column"),s.bd(37),s.yc(38,"translate"),s.mc(),s.Zc(39,x,17,13,"ng-template"),s.mc()),2&e&&(s.Vb(4),s.Ec("formControl",c.liveUpdate),s.Vb(2),s.cd(s.zc(7,21,"common.live-update")),s.Vb(3),s.Ec("formControl",c.hideSettled),s.Vb(2),s.cd(s.zc(12,23,"system.hide-settled-jobs")),s.Vb(3),s.Ec("addTag",!1)("items",s.zc(15,25,c.queues$))("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",c.queueFilter),s.Vb(4),s.Ec("items",s.zc(19,27,c.items$))("itemsPerPage",s.zc(20,29,c.itemsPerPage$))("totalItems",s.zc(21,31,c.totalItems$))("currentPage",s.zc(22,33,c.currentPage$)),s.Vb(7),s.cd(s.zc(26,35,"system.job-queue-name")),s.Vb(3),s.cd(s.zc(29,37,"common.created-at")),s.Vb(3),s.cd(s.zc(32,39,"system.job-state")),s.Vb(3),s.cd(s.zc(35,41,"system.job-duration")),s.Vb(3),s.cd(s.zc(38,43,"system.job-result")))},directives:function(){return[r.c,r.e,h.j,h.k,r.eb,a.a,h.i,a.p,a.g,h.t,r.f,y.a,y.e,y.d,r.d,r.M,r.L,u.p,r.B,r.ab,T,r.S,r.V,h.o,r.U,r.Ab]},pipes:function(){return[p.d,u.b,r.Ob,r.W]},styles:[".result-detail[_ngcontent-%COMP%]{margin:0 12px}"],changeDetection:0}),F.ctorParameters=()=>[{type:r.K},{type:r.yb},{type:r.zb},{type:o.e},{type:o.a}],F=Object(n.c)([Object(n.f)("design:paramtypes",[r.K,r.yb,r.zb,o.e,o.a])],F);let T=class{get iconShape(){switch(this.job.state){case r.sb.COMPLETED:return"check-circle";case r.sb.FAILED:return"exclamation-circle";case r.sb.PENDING:case r.sb.RETRYING:return"hourglass";case r.sb.RUNNING:return"sync"}}get colorType(){switch(this.job.state){case r.sb.COMPLETED:return"success";case r.sb.FAILED:return"error";case r.sb.PENDING:case r.sb.RETRYING:return"";case r.sb.RUNNING:return"warning"}}};T.\u0275fac=function(e){return new(e||T)},T.\u0275cmp=s.bc({type:T,selectors:[["vdr-job-state-label"]],inputs:{job:"job"},decls:5,vars:6,consts:[[3,"colorType"],["class","progress",4,"ngIf"],[1,"progress"]],template:function(e,c){1&e&&(s.nc(0,"vdr-chip",0),s.ic(1,"clr-icon"),s.bd(2),s.yc(3,"titlecase"),s.Zc(4,S,3,3,"span",1),s.mc()),2&e&&(s.Ec("colorType",c.colorType),s.Vb(1),s.Wb("shape",c.iconShape),s.Vb(1),s.dd(" ",s.zc(3,4,c.job.state)," "),s.Vb(2),s.Ec("ngIf","RUNNING"===c.job.state))},directives:[r.B,h.o,u.p],pipes:[u.z,u.w],styles:[".progress[_ngcontent-%COMP%]{margin-left:3px}clr-icon[_ngcontent-%COMP%]{min-width:12px}"],changeDetection:0}),Object(n.c)([Object(s.D)(),Object(n.f)("design:type",Object)],T.prototype,"job",void 0);const q={breadcrumb:Object(m.a)("breadcrumb.job-queue")},D={breadcrumb:Object(m.a)("breadcrumb.system-status")},M=[{path:"jobs",component:F,data:q},{path:"system-status",component:N,data:D}];let Z=class{};Z.\u0275mod=s.fc({type:Z}),Z.\u0275inj=s.ec({factory:function(e){return new(e||Z)},imports:[[r.Jb,o.i.forChild(M)]]})}}]);