function _templateObject5(){var t=_taggedTemplateLiteral(["\n  query GetEmail($id: ID!) {\n    SubscriptionEmail(id: $id) {\n      ...SubscribedEmails\n    }\n  }\n  ","\n"]);return _templateObject5=function(){return t},t}function _templateObject4(){var t=_taggedTemplateLiteral(["\n    mutation CreateEmail($input: [EmailAddInput!]!) {\n        addSubscriptionEmail(input: $input) {\n            ...SubscribedEmails\n        }\n    }\n    ","\n"]);return _templateObject4=function(){return t},t}function _templateObject3(){var t=_taggedTemplateLiteral(["\n    mutation UpdateEmail($input: [EmailUpdateInput!]!) {\n        updateSubscriptionEmail(input: $input) {\n            ...SubscribedEmails\n        }\n    }\n    ","\n"]);return _templateObject3=function(){return t},t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(t);if(e){var r=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=_superPropBase(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _templateObject2(){var t=_taggedTemplateLiteral(["\n   mutation DeleteEmail($input:[ID!]!){\n      deleteSubscriptionEmail(id:$input){\n\t     ...SubscribedEmails \n\t  }\n   }\n   ","\n"]);return _templateObject2=function(){return t},t}function _templateObject(){var t=_taggedTemplateLiteral(["\n    query GetAllEmails($options: EmailListOptions){\n\t\tSubscriptionEmails(options: $options){\n\t\t\titems{\n\t\t\t...SubscribedEmails\n\t\t\t}\n\t\t\ttotalItems\n       }\n    }\n\t","\n"]);return _templateObject=function(){return t},t}function _taggedTemplateLiteral(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{UmAP:function(t,e,n){"use strict";n.r(e);var i=n("sEIs"),r=n("ixhn"),c=n("nIj0"),a=n("OxKu"),o=n("FOa3"),s=n("6Oco"),l=n("mWib"),u=n("kuMc"),d=n("TLy2"),p=n("7RXT"),m=n("H5qd"),b=n.n(m),f=n("JReq"),v=b.a(_templateObject(),f.a),h=b.a(_templateObject2(),f.a),y=n("EM62"),g=n("DEd4"),_=n("Kej3"),O=n("s2Ay"),j=n("2kYt");function P(t,e){if(1&t){var n=y.pc();y.oc(0,"a",5),y.wc("click",(function(){return y.Tc(n),y.yc().downloadcsv()})),y.jc(1,"clr-icon",6),y.cd(2),y.zc(3,"translate"),y.nc()}2&t&&(y.Wb(2),y.ed(" ",y.Ac(3,1,"vdr-subscription-plugin.download-csv")," "))}var k=function(){return["./create"]};function w(t,e){1&t&&(y.oc(0,"a",7),y.jc(1,"clr-icon",8),y.cd(2),y.zc(3,"translate"),y.nc()),2&t&&(y.Fc("routerLink",y.Jc(4,k)),y.Wb(2),y.ed(" ",y.Ac(3,2,"vdr-subscription-plugin.create-new-email")," "))}var S=function(t){return["/extensions","subscribedmails",t]};function C(t,e){if(1&t&&(y.oc(0,"td",11),y.jc(1,"vdr-table-row-action",12),y.zc(2,"translate"),y.nc()),2&t){var n=y.yc().item;y.Wb(1),y.Fc("label",y.Ac(2,2,"common.edit"))("linkTo",y.Kc(4,S,n.id))}}function E(t,e){if(1&t){var n=y.pc();y.oc(0,"td",11),y.oc(1,"vdr-dropdown"),y.oc(2,"button",13),y.cd(3),y.zc(4,"translate"),y.jc(5,"clr-icon",14),y.nc(),y.oc(6,"vdr-dropdown-menu",15),y.oc(7,"button",16),y.wc("click",(function(){y.Tc(n);var t=y.yc().item;return y.yc().deleteEmail(t.id)})),y.jc(8,"clr-icon",17),y.cd(9),y.zc(10,"translate"),y.nc(),y.nc(),y.nc(),y.nc()}2&t&&(y.Wb(3),y.ed(" ",y.Ac(4,2,"common.actions")," "),y.Wb(6),y.ed(" ",y.Ac(10,4,"common.delete")," "))}function F(t,e){if(1&t&&(y.oc(0,"td",9),y.cd(1),y.nc(),y.oc(2,"td",9),y.cd(3),y.zc(4,"date"),y.nc(),y.oc(5,"td",9),y.cd(6),y.zc(7,"date"),y.nc(),y.ad(8,C,3,6,"td",10),y.ad(9,E,11,6,"td",10)),2&t){var n=e.item;y.Wb(1),y.dd(n.email),y.Wb(2),y.dd(y.Bc(4,5,n.createdAt,"longDate")),y.Wb(3),y.dd(y.Bc(7,8,n.updatedAt,"longDate")),y.Wb(2),y.Fc("vdrIfPermissions","UpdateSettings"),y.Wb(1),y.Fc("vdrIfPermissions","DeleteSettings")}}var I=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,r,a,s,l){var u,d;return _classCallCheck(this,n),(d=e.call(this,s,l)).dataService=t,d.modalService=i,d.notificationService=r,d.apollo=a,d.searchTerm=new c.f(""),_get((u=_assertThisInitialized(d),_getPrototypeOf(n.prototype)),"setQueryFn",u).call(u,(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d.dataService.query(v,e)}),(function(t){return t.SubscriptionEmails}),(function(t,e){return{options:{skip:t,take:e,filter:{email:{contains:d.searchTerm.value}},sort:{updatedAt:o.a.Desc}}}})),d}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.searchTerm.valueChanges.pipe(Object(l.a)(250),Object(u.a)(this.destroy$)).subscribe((function(){t.refresh()}))}},{key:"downloadcsv",value:function(){this.apollo.watchQuery({query:v,variables:[]}).valueChanges.subscribe((function(t){p.a.exportToCsv("danfe-subscribed-emails.csv",t.data.SubscriptionEmails.items)}))}},{key:"deleteEmail",value:function(t){var e=this,n=[t];this.modalService.dialog({title:Object(a.a)("vdr-subscription-plugin.confirm-delete-email"),buttons:[{type:"secondary",label:Object(a.a)("common.cancel")},{type:"danger",label:Object(a.a)("common.delete"),returnValue:!0}]}).pipe(Object(d.a)((function(t){return t?e.dataService.mutate(h,{input:n}):s.a}))).subscribe((function(){e.notificationService.success(Object(a.a)("common.notify-delete-success"),{entity:"Email"}),e.refresh()}),(function(t){e.notificationService.error(Object(a.a)("common.notify-delete-error"),{entity:"Email"})}))}}]),n}(r.w);I.\u0275fac=function(t){return new(t||I)(y.ic(r.K),y.ic(r.xb),y.ic(r.yb),y.ic(g.b),y.ic(i.e),y.ic(i.a))},I.\u0275cmp=y.cc({type:I,selectors:[["vdr-all-mails-list"]],features:[y.Tb],decls:25,vars:27,consts:[["type","text","name","searchTerm",1,"clr-input","search-input",3,"formControl","placeholder"],["locationId","email-list"],["href","javascript:void(0)","class","btn btn-primary","id","downloadbtn",3,"click",4,"vdrIfPermissions"],["class","btn btn-primary","id","createbtn",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],["href","javascript:void(0)","id","downloadbtn",1,"btn","btn-primary",3,"click"],["shape","download-cloud"],["id","createbtn",1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],["class","right align-middle",4,"vdrIfPermissions"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click"],["shape","trash",1,"is-danger"]],template:function(t,e){1&t&&(y.oc(0,"vdr-action-bar"),y.oc(1,"vdr-ab-left"),y.jc(2,"input",0),y.zc(3,"translate"),y.nc(),y.oc(4,"vdr-ab-right"),y.jc(5,"vdr-action-bar-items",1),y.ad(6,P,4,3,"a",2),y.ad(7,w,4,5,"a",3),y.nc(),y.nc(),y.oc(8,"vdr-data-table",4),y.wc("pageChange",(function(t){return e.setPageNumber(t)}))("itemsPerPageChange",(function(t){return e.setItemsPerPage(t)})),y.zc(9,"async"),y.zc(10,"async"),y.zc(11,"async"),y.zc(12,"async"),y.oc(13,"vdr-dt-column"),y.cd(14),y.zc(15,"translate"),y.nc(),y.oc(16,"vdr-dt-column"),y.cd(17),y.zc(18,"translate"),y.nc(),y.oc(19,"vdr-dt-column"),y.cd(20),y.zc(21,"translate"),y.nc(),y.jc(22,"vdr-dt-column"),y.jc(23,"vdr-dt-column"),y.ad(24,F,10,11,"ng-template"),y.nc()),2&t&&(y.Wb(2),y.Fc("formControl",e.searchTerm)("placeholder",y.Ac(3,11,"vdr-subscription-plugin.search-by-email")),y.Wb(4),y.Fc("vdrIfPermissions","CreateSettings"),y.Wb(1),y.Fc("vdrIfPermissions","CreateSettings"),y.Wb(1),y.Fc("items",y.Ac(9,13,e.items$))("itemsPerPage",y.Ac(10,15,e.itemsPerPage$))("totalItems",y.Ac(11,17,e.totalItems$))("currentPage",y.Ac(12,19,e.currentPage$)),y.Wb(6),y.dd(y.Ac(15,21,"vdr-subscription-plugin.email")),y.Wb(3),y.dd(y.Ac(18,23,"vdr-subscription-plugin.created")),y.Wb(3),y.dd(y.Ac(21,25,"vdr-subscription-plugin.updated")))},directives:[r.c,r.e,r.db,c.b,c.p,c.g,r.f,r.d,r.ob,r.M,r.L,_.o,i.h,r.Lb,r.S,r.V,r.U,r.T],pipes:[O.d,j.b,j.f],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"],changeDetection:0});var T=n("ROBh"),A=n("xVbo"),W=n("7SLS"),z=b.a(_templateObject3(),f.a),D=b.a(_templateObject4(),f.a);function R(t,e){if(1&t){var n=y.pc();y.oc(0,"button",5),y.wc("click",(function(){return y.Tc(n),y.yc().create()})),y.cd(1),y.zc(2,"translate"),y.nc()}if(2&t){var i=y.yc();y.Fc("disabled",!(i.detailForm.valid&&i.detailForm.dirty)),y.Wb(1),y.ed(" ",y.Ac(2,2,"common.create")," ")}}function x(t,e){if(1&t){var n=y.pc();y.oc(0,"button",6),y.wc("click",(function(){return y.Tc(n),y.yc().save()})),y.cd(1),y.zc(2,"translate"),y.nc()}if(2&t){var i=y.yc();y.Fc("disabled",!(i.detailForm.valid&&i.detailForm.dirty)),y.Wb(1),y.ed(" ",y.Ac(2,2,"common.update")," ")}}var $=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,r,a,o,s,l){var u;return _classCallCheck(this,n),(u=e.call(this,t,i,r,o)).formBuilder=a,u.dataService=o,u.changeDetector=s,u.notificationService=l,u.which=!1,u.detailForm=u.formBuilder.group({email:["",c.C.required]}),u}return _createClass(n,[{key:"ngOnInit",value:function(){"/extensions/subscribedmails/create"!=this.router.url?(this.which=!1,this.init()):this.which=!0}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"create",value:function(){var t=this;this.addNew().pipe(Object(A.a)((function(t){return!!t}))).subscribe((function(){t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success("common.notify-create-success",{entity:"Email"})}),(function(){t.notificationService.error("common.notify-create-error",{entity:"Email"})}))}},{key:"save",value:function(){var t=this;this.saveChanges().pipe(Object(A.a)((function(t){return!!t}))).subscribe((function(){t.detailForm.markAsPristine(),t.changeDetector.markForCheck(),t.notificationService.success("common.notify-update-success",{entity:"Email"})}),(function(){t.notificationService.error("common.notify-update-error",{entity:"Email"})}))}},{key:"addNew",value:function(){if(this.detailForm.dirty){var t=[{email:this.detailForm.value.email}];return this.dataService.mutate(D,{input:t}).pipe(Object(W.a)(!0))}return Object(T.a)(!1)}},{key:"saveChanges",value:function(){if(this.detailForm.dirty){var t=this.detailForm.value,e=[{id:this.id,email:t.email}];return this.dataService.mutate(z,{input:e}).pipe(Object(W.a)(!0))}return Object(T.a)(!1)}},{key:"setFormValues",value:function(t){this.detailForm.patchValue({email:t.email})}}]),n}(r.u);$.\u0275fac=function(t){return new(t||$)(y.ic(i.a),y.ic(i.e),y.ic(r.Gb),y.ic(c.e),y.ic(r.K),y.ic(y.k),y.ic(r.yb))},$.\u0275cmp=y.cc({type:$,selectors:[["vdr-subscription-mail-detail"]],features:[y.Tb],decls:9,vars:7,consts:[["class","btn btn-primary","id","custbtn",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","email",3,"label"],["id","email","type","email","formControlName","email",3,"readonly"],["id","custbtn",1,"btn","btn-primary",3,"disabled","click"],["id","editbtn",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(y.oc(0,"vdr-action-bar"),y.oc(1,"vdr-ab-right"),y.ad(2,R,3,4,"button",0),y.ad(3,x,3,4,"ng-template",null,1,y.bd),y.nc(),y.nc(),y.oc(5,"form",2),y.oc(6,"vdr-form-field",3),y.zc(7,"translate"),y.jc(8,"input",4),y.nc(),y.nc()),2&t){var n=y.Qc(4);y.Wb(2),y.Fc("ngIf",e.which)("ngIfElse",n),y.Wb(3),y.Fc("formGroup",e.detailForm),y.Wb(1),y.Fc("label",y.Ac(7,5,"vdr-subscription-plugin.email-label")),y.Wb(2),y.Fc("readonly",!1)}},directives:[r.c,r.f,j.p,c.E,c.q,c.j,r.cb,r.db,c.b,c.p,c.h],pipes:[O.d],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]});var L=b.a(_templateObject5(),f.a),M=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i){return _classCallCheck(this,n),e.call(this,t,{__typename:"Email",id:"",email:"",createdAt:"",updatedAt:""},(function(t){return i.query(L,{id:t}).mapStream((function(t){return t.SubscriptionEmail}))}))}return n}(r.v);M.\u0275fac=function(t){return new(t||M)(y.sc(i.e),y.sc(r.K))},M.\u0275prov=y.ec({token:M,factory:M.\u0275fac});var q=n("YtkY");n.d(e,"MailSubscriptionUIModule",(function(){return B})),n.d(e,"mailDetailBreadcrumb",(function(){return K}));var B=function t(){_classCallCheck(this,t)};function K(t){return t.entity.pipe(Object(q.a)((function(t){return[{label:"Subscribed Mails",link:["/extensions","subscribedmails"]},{label:"".concat(t.email),link:[]}]})))}B.\u0275mod=y.gc({type:B}),B.\u0275inj=y.fc({factory:function(t){return new(t||B)},providers:[M],imports:[[r.Hb,i.i.forChild([{path:"",pathMatch:"full",component:I,data:{breadcrumb:"Subscribed Mails"}},{path:"create",component:$,data:{breadcrumb:[{label:"Subscribed Mails",link:["/extensions","subscribedmails"]},{label:"Create Email",link:[]}]}},{path:":id",component:$,resolve:Object(r.Rb)(M),data:{breadcrumb:K}}])]]})}}]);